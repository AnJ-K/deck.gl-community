/*! For license information please see 1876.9773045e.js.LICENSE.txt */
(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[1876],{2332:(t,e,n)=>{var i;!function(r,o,s,a){"use strict";var A,u=["","webkit","Moz","MS","ms","o"],l=o.createElement("div"),c="function",h=Math.round,f=Math.abs,p=Date.now;function d(t,e,n){return setTimeout(b(t,n),e)}function g(t,e,n){return!!Array.isArray(t)&&(_(t,n[e],n),!0)}function _(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==a)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function m(t,e,n){var i="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=r.console&&(r.console.warn||r.console.log);return o&&o.call(r.console,i,n),t.apply(this,arguments)}}A="function"!=typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==a&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e}:Object.assign;var y=m((function(t,e,n){for(var i=Object.keys(e),r=0;r<i.length;)(!n||n&&t[i[r]]===a)&&(t[i[r]]=e[i[r]]),r++;return t}),"extend","Use `assign`."),v=m((function(t,e){return y(t,e,!0)}),"merge","Use `assign`.");function E(t,e,n){var i,r=e.prototype;(i=t.prototype=Object.create(r)).constructor=t,i._super=r,n&&A(i,n)}function b(t,e){return function(){return t.apply(e,arguments)}}function w(t,e){return typeof t==c?t.apply(e&&e[0]||a,e):t}function x(t,e){return t===a?e:t}function S(t,e,n){_(R(e),(function(e){t.addEventListener(e,n,!1)}))}function C(t,e,n){_(R(e),(function(e){t.removeEventListener(e,n,!1)}))}function T(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function I(t,e){return t.indexOf(e)>-1}function R(t){return t.trim().split(/\s+/g)}function P(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function M(t){return Array.prototype.slice.call(t,0)}function L(t,e,n){for(var i=[],r=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];P(r,s)<0&&i.push(t[o]),r[o]=s,o++}return n&&(i=e?i.sort((function(t,n){return t[e]>n[e]})):i.sort()),i}function N(t,e){for(var n,i,r=e[0].toUpperCase()+e.slice(1),o=0;o<u.length;){if((i=(n=u[o])?n+r:e)in t)return i;o++}return a}var O=1;function D(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||r}var F="ontouchstart"in r,k=N(r,"PointerEvent")!==a,B=F&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),U="touch",G="mouse",z=25,V=1,j=4,W=8,H=1,X=2,Y=4,q=8,Q=16,$=X|Y,K=q|Q,Z=$|K,J=["x","y"],tt=["clientX","clientY"];function et(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){w(t.options.enable,[t])&&n.handler(e)},this.init()}function nt(t,e,n){var i=n.pointers.length,r=n.changedPointers.length,o=e&V&&i-r==0,s=e&(j|W)&&i-r==0;n.isFirst=!!o,n.isFinal=!!s,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,i=e.pointers,r=i.length;n.firstInput||(n.firstInput=it(e));r>1&&!n.firstMultiple?n.firstMultiple=it(e):1===r&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,A=s?s.center:o.center,u=e.center=rt(i);e.timeStamp=p(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=At(A,u),e.distance=at(A,u),function(t,e){var n=e.center,i=t.offsetDelta||{},r=t.prevDelta||{},o=t.prevInput||{};e.eventType!==V&&o.eventType!==j||(r=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y});e.deltaX=r.x+(n.x-i.x),e.deltaY=r.y+(n.y-i.y)}(n,e),e.offsetDirection=st(e.deltaX,e.deltaY);var l=ot(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=l.x,e.overallVelocityY=l.y,e.overallVelocity=f(l.x)>f(l.y)?l.x:l.y,e.scale=s?(c=s.pointers,h=i,at(h[0],h[1],tt)/at(c[0],c[1],tt)):1,e.rotation=s?function(t,e){return At(e[1],e[0],tt)+At(t[1],t[0],tt)}(s.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,i,r,o,s=t.lastInterval||e,A=e.timeStamp-s.timeStamp;if(e.eventType!=W&&(A>z||s.velocity===a)){var u=e.deltaX-s.deltaX,l=e.deltaY-s.deltaY,c=ot(A,u,l);i=c.x,r=c.y,n=f(c.x)>f(c.y)?c.x:c.y,o=st(u,l),t.lastInterval=e}else n=s.velocity,i=s.velocityX,r=s.velocityY,o=s.direction;e.velocity=n,e.velocityX=i,e.velocityY=r,e.direction=o}(n,e);var c,h;var d=t.element;T(e.srcEvent.target,d)&&(d=e.srcEvent.target);e.target=d}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function it(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:h(t.pointers[n].clientX),clientY:h(t.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:e,center:rt(e),deltaX:t.deltaX,deltaY:t.deltaY}}function rt(t){var e=t.length;if(1===e)return{x:h(t[0].clientX),y:h(t[0].clientY)};for(var n=0,i=0,r=0;r<e;)n+=t[r].clientX,i+=t[r].clientY,r++;return{x:h(n/e),y:h(i/e)}}function ot(t,e,n){return{x:e/t||0,y:n/t||0}}function st(t,e){return t===e?H:f(t)>=f(e)?t<0?X:Y:e<0?q:Q}function at(t,e,n){n||(n=J);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return Math.sqrt(i*i+r*r)}function At(t,e,n){n||(n=J);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return 180*Math.atan2(r,i)/Math.PI}et.prototype={handler:function(){},init:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(D(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(D(this.element),this.evWin,this.domHandler)}};var ut={mousedown:V,mousemove:2,mouseup:j},lt="mousedown",ct="mousemove mouseup";function ht(){this.evEl=lt,this.evWin=ct,this.pressed=!1,et.apply(this,arguments)}E(ht,et,{handler:function(t){var e=ut[t.type];e&V&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=j),this.pressed&&(e&j&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:G,srcEvent:t}))}});var ft={pointerdown:V,pointermove:2,pointerup:j,pointercancel:W,pointerout:W},pt={2:U,3:"pen",4:G,5:"kinect"},dt="pointerdown",gt="pointermove pointerup pointercancel";function _t(){this.evEl=dt,this.evWin=gt,et.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(dt="MSPointerDown",gt="MSPointerMove MSPointerUp MSPointerCancel"),E(_t,et,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),r=ft[i],o=pt[t.pointerType]||t.pointerType,s=o==U,a=P(e,t.pointerId,"pointerId");r&V&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):r&(j|W)&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var mt={touchstart:V,touchmove:2,touchend:j,touchcancel:W};function yt(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,et.apply(this,arguments)}function vt(t,e){var n=M(t.touches),i=M(t.changedTouches);return e&(j|W)&&(n=L(n.concat(i),"identifier",!0)),[n,i]}E(yt,et,{handler:function(t){var e=mt[t.type];if(e===V&&(this.started=!0),this.started){var n=vt.call(this,t,e);e&(j|W)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:U,srcEvent:t})}}});var Et={touchstart:V,touchmove:2,touchend:j,touchcancel:W},bt="touchstart touchmove touchend touchcancel";function wt(){this.evTarget=bt,this.targetIds={},et.apply(this,arguments)}function xt(t,e){var n=M(t.touches),i=this.targetIds;if(e&(2|V)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,o,s=M(t.changedTouches),a=[],A=this.target;if(o=n.filter((function(t){return T(t.target,A)})),e===V)for(r=0;r<o.length;)i[o[r].identifier]=!0,r++;for(r=0;r<s.length;)i[s[r].identifier]&&a.push(s[r]),e&(j|W)&&delete i[s[r].identifier],r++;return a.length?[L(o.concat(a),"identifier",!0),a]:void 0}E(wt,et,{handler:function(t){var e=Et[t.type],n=xt.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:U,srcEvent:t})}});var St=2500;function Ct(){et.apply(this,arguments);var t=b(this.handler,this);this.touch=new wt(this.manager,t),this.mouse=new ht(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function Tt(t,e){t&V?(this.primaryTouch=e.changedPointers[0].identifier,It.call(this,e)):t&(j|W)&&It.call(this,e)}function It(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout((function(){var t=i.indexOf(n);t>-1&&i.splice(t,1)}),St)}}function Rt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],o=Math.abs(e-r.x),s=Math.abs(n-r.y);if(o<=25&&s<=25)return!0}return!1}E(Ct,et,{handler:function(t,e,n){var i=n.pointerType==U,r=n.pointerType==G;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)Tt.call(this,e,n);else if(r&&Rt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Pt=N(l.style,"touchAction"),Mt=Pt!==a,Lt="compute",Nt="auto",Ot="manipulation",Dt="none",Ft="pan-x",kt="pan-y",Bt=function(){if(!Mt)return!1;var t={},e=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||r.CSS.supports("touch-action",n)})),t}();function Ut(t,e){this.manager=t,this.set(e)}Ut.prototype={set:function(t){t==Lt&&(t=this.compute()),Mt&&this.manager.element.style&&Bt[t]&&(this.manager.element.style[Pt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return _(this.manager.recognizers,(function(e){w(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(I(t,Dt))return Dt;var e=I(t,Ft),n=I(t,kt);if(e&&n)return Dt;if(e||n)return e?Ft:kt;if(I(t,Ot))return Ot;return Nt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var i=this.actions,r=I(i,Dt)&&!Bt[Dt],o=I(i,kt)&&!Bt[kt],s=I(i,Ft)&&!Bt[Ft];if(r){var a=1===t.pointers.length,A=t.distance<2,u=t.deltaTime<250;if(a&&A&&u)return}if(!s||!o)return r||o&&n&$||s&&n&K?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Gt=1,zt=32;function Vt(t){this.options=A({},this.defaults,t||{}),this.id=O++,this.manager=null,this.options.enable=x(this.options.enable,!0),this.state=Gt,this.simultaneous={},this.requireFail=[]}function jt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Wt(t){return t==Q?"down":t==q?"up":t==X?"left":t==Y?"right":""}function Ht(t,e){var n=e.manager;return n?n.get(t):t}function Xt(){Vt.apply(this,arguments)}function Yt(){Xt.apply(this,arguments),this.pX=null,this.pY=null}function qt(){Xt.apply(this,arguments)}function Qt(){Vt.apply(this,arguments),this._timer=null,this._input=null}function $t(){Xt.apply(this,arguments)}function Kt(){Xt.apply(this,arguments)}function Zt(){Vt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Jt(t,e){return(e=e||{}).recognizers=x(e.recognizers,Jt.defaults.preset),new te(t,e)}Vt.prototype={defaults:{},set:function(t){return A(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(g(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Ht(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return g(t,"dropRecognizeWith",this)||(t=Ht(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(g(t,"requireFailure",this))return this;var e=this.requireFail;return-1===P(e,t=Ht(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(g(t,"dropRequireFailure",this))return this;t=Ht(t,this);var e=P(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function i(n){e.manager.emit(n,t)}n<8&&i(e.options.event+jt(n)),i(e.options.event),t.additionalEvent&&i(t.additionalEvent),n>=8&&i(e.options.event+jt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=zt},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(zt|Gt)))return!1;t++}return!0},recognize:function(t){var e=A({},t);if(!w(this.options.enable,[this,e]))return this.reset(),void(this.state=zt);56&this.state&&(this.state=Gt),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},E(Xt,Vt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=6&e,r=this.attrTest(t);return i&&(n&W||!r)?16|e:i||r?n&j?8|e:2&e?4|e:2:zt}}),E(Yt,Xt,{defaults:{event:"pan",threshold:10,pointers:1,direction:Z},getTouchAction:function(){var t=this.options.direction,e=[];return t&$&&e.push(kt),t&K&&e.push(Ft),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,r=t.direction,o=t.deltaX,s=t.deltaY;return r&e.direction||(e.direction&$?(r=0===o?H:o<0?X:Y,n=o!=this.pX,i=Math.abs(t.deltaX)):(r=0===s?H:s<0?q:Q,n=s!=this.pY,i=Math.abs(t.deltaY))),t.direction=r,n&&i>e.threshold&&r&e.direction},attrTest:function(t){return Xt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Wt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),E(qt,Xt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Dt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),E(Qt,Vt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Nt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!i||!n||t.eventType&(j|W)&&!r)this.reset();else if(t.eventType&V)this.reset(),this._timer=d((function(){this.state=8,this.tryEmit()}),e.time,this);else if(t.eventType&j)return 8;return zt},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&t.eventType&j?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),E($t,Xt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Dt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),E(Kt,Xt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:$|K,pointers:1},getTouchAction:function(){return Yt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&($|K)?e=t.overallVelocity:n&$?e=t.overallVelocityX:n&K&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&f(e)>this.options.velocity&&t.eventType&j},emit:function(t){var e=Wt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),E(Zt,Vt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ot]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),t.eventType&V&&0===this.count)return this.failTimeout();if(i&&r&&n){if(t.eventType!=j)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||at(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=d((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return zt},failTimeout:function(){return this._timer=d((function(){this.state=zt}),this.options.interval,this),zt},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Jt.VERSION="2.0.7",Jt.defaults={domEvents:!1,touchAction:Lt,enable:!0,inputTarget:null,inputClass:null,preset:[[$t,{enable:!1}],[qt,{enable:!1},["rotate"]],[Kt,{direction:$}],[Yt,{direction:$},["swipe"]],[Zt],[Zt,{event:"doubletap",taps:2},["tap"]],[Qt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function te(t,e){var n;this.options=A({},Jt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(k?_t:B?wt:F?Ct:ht))(n,nt),this.touchAction=new Ut(this,this.options.touchAction),ee(this,!0),_(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function ee(t,e){var n,i=t.element;i.style&&(_(t.options.cssProps,(function(r,o){n=N(i.style,o),e?(t.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}te.prototype={set:function(t){return A(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var i=this.recognizers,r=e.curRecognizer;(!r||r&&8&r.state)&&(r=e.curRecognizer=null);for(var o=0;o<i.length;)n=i[o],2===e.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(t),!r&&14&n.state&&(r=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Vt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(g(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(g(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=P(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var n=this.handlers;return _(R(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==a){var n=this.handlers;return _(R(t),(function(t){e?n[t]&&n[t].splice(P(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](e),i++}},destroy:function(){this.element&&ee(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},A(Jt,{INPUT_START:V,INPUT_MOVE:2,INPUT_END:j,INPUT_CANCEL:W,STATE_POSSIBLE:Gt,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:zt,DIRECTION_NONE:H,DIRECTION_LEFT:X,DIRECTION_RIGHT:Y,DIRECTION_UP:q,DIRECTION_DOWN:Q,DIRECTION_HORIZONTAL:$,DIRECTION_VERTICAL:K,DIRECTION_ALL:Z,Manager:te,Input:et,TouchAction:Ut,TouchInput:wt,MouseInput:ht,PointerEventInput:_t,TouchMouseInput:Ct,SingleTouchInput:yt,Recognizer:Vt,AttrRecognizer:Xt,Tap:Zt,Pan:Yt,Swipe:Kt,Pinch:qt,Rotate:$t,Press:Qt,on:S,off:C,each:_,merge:v,extend:y,assign:A,inherit:E,bindFn:b,prefixed:N}),(void 0!==r?r:"undefined"!=typeof self?self:{}).Hammer=Jt,(i=function(){return Jt}.call(e,n,e,t))===a||(t.exports=i)}(window,document)},8550:(t,e,n)=>{var i="Expected a function",r=NaN,o="[object Symbol]",s=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,A=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,h="object"==typeof self&&self&&self.Object===Object&&self,f=c||h||Function("return this")(),p=Object.prototype.toString,d=Math.max,g=Math.min,_=function(){return f.Date.now()};function m(t,e,n){var r,o,s,a,A,u,l=0,c=!1,h=!1,f=!0;if("function"!=typeof t)throw new TypeError(i);function p(e){var n=r,i=o;return r=o=void 0,l=e,a=t.apply(i,n)}function m(t){var n=t-u;return void 0===u||n>=e||n<0||h&&t-l>=s}function E(){var t=_();if(m(t))return b(t);A=setTimeout(E,function(t){var n=e-(t-u);return h?g(n,s-(t-l)):n}(t))}function b(t){return A=void 0,f&&r?p(t):(r=o=void 0,a)}function w(){var t=_(),n=m(t);if(r=arguments,o=this,u=t,n){if(void 0===A)return function(t){return l=t,A=setTimeout(E,e),c?p(t):a}(u);if(h)return A=setTimeout(E,e),p(u)}return void 0===A&&(A=setTimeout(E,e)),a}return e=v(e)||0,y(n)&&(c=!!n.leading,s=(h="maxWait"in n)?d(v(n.maxWait)||0,e):s,f="trailing"in n?!!n.trailing:f),w.cancel=function(){void 0!==A&&clearTimeout(A),l=0,r=u=o=A=void 0},w.flush=function(){return void 0===A?a:b(_())},w}function y(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function v(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&p.call(t)==o}(t))return r;if(y(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=y(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var n=A.test(t);return n||u.test(t)?l(t.slice(2),n?2:8):a.test(t)?r:+t}t.exports=function(t,e,n){var r=!0,o=!0;if("function"!=typeof t)throw new TypeError(i);return y(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),m(t,e,{leading:r,maxWait:e,trailing:o})}},7531:(t,e,n)=>{"use strict";n.d(e,{Ay:()=>i.KH});var i=n(4697)},4383:(t,e,n)=>{"use strict";var i=n(8421);function r(t){var e=[1/0,1/0,-1/0,-1/0];return i.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}r.default=r,e.A=r},8967:(t,e)=>{"use strict";function n(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function i(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!f(t[0])||!f(t[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:t},e,i)}function r(t,e,i){void 0===i&&(i={});for(var r=0,o=t;r<o.length;r++){var s=o[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,i)}function o(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,i)}function s(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function a(t,e,i){return void 0===i&&(i={}),n({type:"MultiLineString",coordinates:t},e,i)}function A(t,e,i){return void 0===i&&(i={}),n({type:"MultiPoint",coordinates:t},e,i)}function u(t,e,i){return void 0===i&&(i={}),n({type:"MultiPolygon",coordinates:t},e,i)}function l(t,n){void 0===n&&(n="kilometers");var i=e.factors[n];if(!i)throw new Error(n+" units is invalid");return t*i}function c(t,n){void 0===n&&(n="kilometers");var i=e.factors[n];if(!i)throw new Error(n+" units is invalid");return t/i}function h(t){return 180*(t%(2*Math.PI))/Math.PI}function f(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return i(e).geometry;case"LineString":return o(e).geometry;case"Polygon":return r(e).geometry;case"MultiPoint":return A(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return u(e).geometry;default:throw new Error(t+" is invalid")}},e.point=i,e.points=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return i(t,e)})),n)},e.polygon=r,e.polygons=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return r(t,e)})),n)},e.lineString=o,e.lineStrings=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return o(t,e)})),n)},e.featureCollection=s,e.multiLineString=a,e.multiPoint=A,e.multiPolygon=u,e.geometryCollection=function(t,e,i){return void 0===i&&(i={}),n({type:"GeometryCollection",geometries:t},e,i)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},e.radiansToLength=l,e.lengthToRadians=c,e.lengthToDegrees=function(t,e){return h(c(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=h,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return l(c(t,e),n)},e.convertArea=function(t,n,i){if(void 0===n&&(n="meters"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("area must be a positive number");var r=e.areaFactors[n];if(!r)throw new Error("invalid original units");var o=e.areaFactors[i];if(!o)throw new Error("invalid final units");return t/r*o},e.isNumber=f,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!f(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},8421:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(8967);function r(t,e,n){if(null!==t)for(var i,o,s,a,A,u,l,c,h=0,f=0,p=t.type,d="FeatureCollection"===p,g="Feature"===p,_=d?t.features.length:1,m=0;m<_;m++){A=(c=!!(l=d?t.features[m].geometry:g?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var y=0;y<A;y++){var v=0,E=0;if(null!==(a=c?l.geometries[y]:l)){u=a.coordinates;var b=a.type;switch(h=!n||"Polygon"!==b&&"MultiPolygon"!==b?0:1,b){case null:break;case"Point":if(!1===e(u,f,m,v,E))return!1;f++,v++;break;case"LineString":case"MultiPoint":for(i=0;i<u.length;i++){if(!1===e(u[i],f,m,v,E))return!1;f++,"MultiPoint"===b&&v++}"LineString"===b&&v++;break;case"Polygon":case"MultiLineString":for(i=0;i<u.length;i++){for(o=0;o<u[i].length-h;o++){if(!1===e(u[i][o],f,m,v,E))return!1;f++}"MultiLineString"===b&&v++,"Polygon"===b&&E++}"Polygon"===b&&v++;break;case"MultiPolygon":for(i=0;i<u.length;i++){for(E=0,o=0;o<u[i].length;o++){for(s=0;s<u[i][o].length-h;s++){if(!1===e(u[i][o][s],f,m,v,E))return!1;f++}E++}v++}break;case"GeometryCollection":for(i=0;i<a.geometries.length;i++)if(!1===r(a.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function a(t,e){var n,i,r,o,s,a,A,u,l,c,h=0,f="FeatureCollection"===t.type,p="Feature"===t.type,d=f?t.features.length:1;for(n=0;n<d;n++){for(a=f?t.features[n].geometry:p?t.geometry:t,u=f?t.features[n].properties:p?t.properties:{},l=f?t.features[n].bbox:p?t.bbox:void 0,c=f?t.features[n].id:p?t.id:void 0,s=(A=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=A?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,h,u,l,c))return!1;break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===e(o.geometries[i],h,u,l,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,h,u,l,c))return!1;h++}}function A(t,e){a(t,(function(t,n,r,o,s){var a,A=null===t?null:t.type;switch(A){case null:case"Point":case"LineString":case"Polygon":return!1!==e(i.feature(t,r,{bbox:o,id:s}),n,0)&&void 0}switch(A){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var l={type:a,coordinates:t.coordinates[u]};if(!1===e(i.feature(l,r),n,u))return!1}}))}function u(t,e){A(t,(function(t,n,o){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var A,u=0,l=0,c=0;return!1!==r(t,(function(r,a,h,f,p){if(void 0===A||n>u||f>l||p>c)return A=r,u=n,l=f,c=p,void(s=0);var d=i.lineString([A,r],t.properties);if(!1===e(d,n,o,p,s))return!1;s++,A=r}))&&void 0}}}))}function l(t,e){if(!t)throw new Error("geojson is required");A(t,(function(t,n,r){if(null!==t.geometry){var o=t.geometry.type,s=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,n,r,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(i.lineString(s[a],t.properties),n,r,a))return!1}}}))}e.coordAll=function(t){var e=[];return r(t,(function(t){e.push(t)})),e},e.coordEach=r,e.coordReduce=function(t,e,n,i){var o=n;return r(t,(function(t,i,r,s,a){o=0===i&&void 0===n?t:e(o,t,i,r,s,a)}),i),o},e.featureEach=s,e.featureReduce=function(t,e,n){var i=n;return s(t,(function(t,r){i=0===r&&void 0===n?t:e(i,t,r)})),i},e.findPoint=function(t,e){if(e=e||{},!i.isObject(e))throw new Error("options is invalid");var n,r=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,A=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),A=A||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":A=A||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":return i.point(u,A,e);case"MultiPoint":return o<0&&(o=u.length+o),i.point(u[o],A,e);case"LineString":return a<0&&(a=u.length+a),i.point(u[a],A,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a),i.point(u[s][a],A,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),i.point(u[o][a],A,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a),i.point(u[o][s][a],A,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!i.isObject(e))throw new Error("options is invalid");var n,r=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,A=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),A=A||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":A=A||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=u.length+a-1),i.lineString([u[a],u[a+1]],A,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a-1),i.lineString([u[s][a],u[s][a+1]],A,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a-1),i.lineString([u[o][a],u[o][a+1]],A,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a-1),i.lineString([u[o][s][a],u[o][s][a+1]],A,e)}throw new Error("geojson is invalid")},e.flattenEach=A,e.flattenReduce=function(t,e,n){var i=n;return A(t,(function(t,r,o){i=0===r&&0===o&&void 0===n?t:e(i,t,r,o)})),i},e.geomEach=a,e.geomReduce=function(t,e,n){var i=n;return a(t,(function(t,r,o,s,a){i=0===r&&void 0===n?t:e(i,t,r,o,s,a)})),i},e.lineEach=l,e.lineReduce=function(t,e,n){var i=n;return l(t,(function(t,r,o,s){i=0===r&&void 0===n?t:e(i,t,r,o,s)})),i},e.propEach=o,e.propReduce=function(t,e,n){var i=n;return o(t,(function(t,r){i=0===r&&void 0===n?t:e(i,t,r)})),i},e.segmentEach=u,e.segmentReduce=function(t,e,n){var i=n,r=!1;return u(t,(function(t,o,s,a,A){i=!1===r&&void 0===n?t:e(i,t,o,s,a,A),r=!0})),i}},8478:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});n(6540);var i=n(2303),r=n(4848);function o(t){let{children:e,fallback:n}=t;return(0,i.A)()?(0,r.jsx)(r.Fragment,{children:null==e?void 0:e()}):null!=n?n:null}},6570:t=>{"use strict";function e(t,e,i){i=i||2;var o,s,a,A,c,h,p,d=e&&e.length,g=d?e[0]*i:t.length,_=n(t,0,g,i,!0),m=[];if(!_||_.next===_.prev)return m;if(d&&(_=function(t,e,i,r){var o,s,a,A=[];for(o=0,s=e.length;o<s;o++)(a=n(t,e[o]*r,o<s-1?e[o+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),A.push(f(a));for(A.sort(u),o=0;o<A.length;o++)i=l(A[o],i);return i}(t,e,_,i)),t.length>80*i){o=a=t[0],s=A=t[1];for(var y=i;y<g;y+=i)(c=t[y])<o&&(o=c),(h=t[y+1])<s&&(s=h),c>a&&(a=c),h>A&&(A=h);p=0!==(p=Math.max(a-o,A-s))?32767/p:0}return r(_,m,i,o,s,p,0),m}function n(t,e,n,i,r){var o,s;if(r===C(t,e,n,i)>0)for(o=e;o<n;o+=i)s=w(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=w(o,t[o],t[o+1],s);return s&&_(s,s.next)&&(x(s),s=s.next),s}function i(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!_(i,i.next)&&0!==g(i.prev,i,i.next))i=i.next;else{if(x(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function r(t,e,n,u,l,c,f){if(t){!f&&c&&function(t,e,n,i){var r=t;do{0===r.z&&(r.z=h(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,s,a,A,u=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<u&&(a++,i=i.nextZ);e++);for(A=u;a>0||A>0&&i;)0!==a&&(0===A||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,A--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(s>1)}(r)}(t,u,l,c);for(var p,d,g=t;t.prev!==t.next;)if(p=t.prev,d=t.next,c?s(t,u,l,c):o(t))e.push(p.i/n|0),e.push(t.i/n|0),e.push(d.i/n|0),x(t),t=d.next,g=d.next;else if((t=d)===g){f?1===f?r(t=a(i(t),e,n),e,n,u,l,c,2):2===f&&A(t,e,n,u,l,c):r(i(t),e,n,u,l,c,1);break}}}function o(t){var e=t.prev,n=t,i=t.next;if(g(e,n,i)>=0)return!1;for(var r=e.x,o=n.x,s=i.x,a=e.y,A=n.y,u=i.y,l=r<o?r<s?r:s:o<s?o:s,c=a<A?a<u?a:u:A<u?A:u,h=r>o?r>s?r:s:o>s?o:s,f=a>A?a>u?a:u:A>u?A:u,d=i.next;d!==e;){if(d.x>=l&&d.x<=h&&d.y>=c&&d.y<=f&&p(r,a,o,A,s,u,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function s(t,e,n,i){var r=t.prev,o=t,s=t.next;if(g(r,o,s)>=0)return!1;for(var a=r.x,A=o.x,u=s.x,l=r.y,c=o.y,f=s.y,d=a<A?a<u?a:u:A<u?A:u,_=l<c?l<f?l:f:c<f?c:f,m=a>A?a>u?a:u:A>u?A:u,y=l>c?l>f?l:f:c>f?c:f,v=h(d,_,e,n,i),E=h(m,y,e,n,i),b=t.prevZ,w=t.nextZ;b&&b.z>=v&&w&&w.z<=E;){if(b.x>=d&&b.x<=m&&b.y>=_&&b.y<=y&&b!==r&&b!==s&&p(a,l,A,c,u,f,b.x,b.y)&&g(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,w.x>=d&&w.x<=m&&w.y>=_&&w.y<=y&&w!==r&&w!==s&&p(a,l,A,c,u,f,w.x,w.y)&&g(w.prev,w,w.next)>=0)return!1;w=w.nextZ}for(;b&&b.z>=v;){if(b.x>=d&&b.x<=m&&b.y>=_&&b.y<=y&&b!==r&&b!==s&&p(a,l,A,c,u,f,b.x,b.y)&&g(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;w&&w.z<=E;){if(w.x>=d&&w.x<=m&&w.y>=_&&w.y<=y&&w!==r&&w!==s&&p(a,l,A,c,u,f,w.x,w.y)&&g(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function a(t,e,n){var r=t;do{var o=r.prev,s=r.next.next;!_(o,s)&&m(o,r,r.next,s)&&E(o,s)&&E(s,o)&&(e.push(o.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),x(r),x(r.next),r=t=s),r=r.next}while(r!==t);return i(r)}function A(t,e,n,o,s,a){var A=t;do{for(var u=A.next.next;u!==A.prev;){if(A.i!==u.i&&d(A,u)){var l=b(A,u);return A=i(A,A.next),l=i(l,l.next),r(A,e,n,o,s,a,0),void r(l,e,n,o,s,a,0)}u=u.next}A=A.next}while(A!==t)}function u(t,e){return t.x-e.x}function l(t,e){var n=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s&&(s=a,n=i.x<i.next.x?i:i.next,a===r))return n}i=i.next}while(i!==e);if(!n)return null;var A,u=n,l=n.x,h=n.y,f=1/0;i=n;do{r>=i.x&&i.x>=l&&r!==i.x&&p(o<h?r:s,o,l,h,o<h?s:r,o,i.x,i.y)&&(A=Math.abs(o-i.y)/(r-i.x),E(i,t)&&(A<f||A===f&&(i.x>n.x||i.x===n.x&&c(n,i)))&&(n=i,f=A)),i=i.next}while(i!==u);return n}(t,e);if(!n)return e;var r=b(n,t);return i(r,r.next),i(n,n.next)}function c(t,e){return g(t.prev,t,e.prev)<0&&g(e.next,t,t.next)<0}function h(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function f(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function p(t,e,n,i,r,o,s,a){return(r-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(i-a)>=(n-s)*(e-a)&&(n-s)*(o-a)>=(r-s)*(i-a)}function d(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&m(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(E(t,e)&&E(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(g(t.prev,t,e.prev)||g(t,e.prev,e))||_(t,e)&&g(t.prev,t,t.next)>0&&g(e.prev,e,e.next)>0)}function g(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function _(t,e){return t.x===e.x&&t.y===e.y}function m(t,e,n,i){var r=v(g(t,e,n)),o=v(g(t,e,i)),s=v(g(n,i,t)),a=v(g(n,i,e));return r!==o&&s!==a||(!(0!==r||!y(t,n,e))||(!(0!==o||!y(t,i,e))||(!(0!==s||!y(n,t,i))||!(0!==a||!y(n,e,i)))))}function y(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function v(t){return t>0?1:t<0?-1:0}function E(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function b(t,e){var n=new S(t.i,t.x,t.y),i=new S(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function w(t,e,n,i){var r=new S(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function x(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(C(t,0,o,n));if(r)for(var a=0,A=e.length;a<A;a++){var u=e[a]*n,l=a<A-1?e[a+1]*n:t.length;s-=Math.abs(C(t,u,l,n))}var c=0;for(a=0;a<i.length;a+=3){var h=i[a]*n,f=i[a+1]*n,p=i[a+2]*n;c+=Math.abs((t[h]-t[p])*(t[f+1]-t[h+1])-(t[h]-t[f])*(t[p+1]-t[h+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},228:t=>{"use strict";var e=Object.prototype.hasOwnProperty,n="~";function i(){}function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,i,o,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new r(i,o||t,s),A=n?n+e:e;return t._events[A]?t._events[A].fn?t._events[A]=[t._events[A],a]:t._events[A].push(a):(t._events[A]=a,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,i,r=[];if(0===this._eventsCount)return r;for(i in t=this._events)e.call(t,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},a.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,o=i.length,s=new Array(o);r<o;r++)s[r]=i[r].fn;return s},a.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},a.prototype.emit=function(t,e,i,r,o,s){var a=n?n+t:t;if(!this._events[a])return!1;var A,u,l=this._events[a],c=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,i),!0;case 4:return l.fn.call(l.context,e,i,r),!0;case 5:return l.fn.call(l.context,e,i,r,o),!0;case 6:return l.fn.call(l.context,e,i,r,o,s),!0}for(u=1,A=new Array(c-1);u<c;u++)A[u-1]=arguments[u];l.fn.apply(l.context,A)}else{var h,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,i);break;case 4:l[u].fn.call(l[u].context,e,i,r);break;default:if(!A)for(h=1,A=new Array(c-1);h<c;h++)A[h-1]=arguments[h];l[u].fn.apply(l[u].context,A)}}return!0},a.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,i,r){var o=n?n+t:t;if(!this._events[o])return this;if(!e)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==e||r&&!a.once||i&&a.context!==i||s(this,o);else{for(var A=0,u=[],l=a.length;A<l;A++)(a[A].fn!==e||r&&!a[A].once||i&&a[A].context!==i)&&u.push(a[A]);u.length?this._events[o]=1===u.length?u[0]:u:s(this,o)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&s(this,e)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a},4945:(t,e,n)=>{var i=n(2519),r=n(8967),o=n(8421),s=n(4383).A,a=o.featureEach,A=(o.coordEach,r.polygon,r.featureCollection);function u(t){var e=new i(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),i.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})):a(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})),i.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),i.prototype.remove.call(this,t,e)},e.clear=function(){return i.prototype.clear.call(this)},e.search=function(t){var e=i.prototype.search.call(this,this.toBBox(t));return A(e)},e.collides=function(t){return i.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=i.prototype.all.call(this);return A(t)},e.toJSON=function(){return i.prototype.toJSON.call(this)},e.fromJSON=function(t){return i.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=s(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=s(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=u,t.exports.default=u},9004:function(t){t.exports=function(){"use strict";function t(t,e){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return A([t,e])}}function A(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}var e=function(){function t(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null}return t}();function n(t,e){return t>e?1:t<e?-1:0}function i(t,n,i){for(var r=new e(null,null),o=r,s=r;;){var a=i(t,n.key);if(a<0){if(null===n.left)break;if(i(t,n.left.key)<0){var A=n.left;if(n.left=A.right,A.right=n,null===(n=A).left)break}s.left=n,s=n,n=n.left}else{if(!(a>0))break;if(null===n.right)break;if(i(t,n.right.key)>0&&(A=n.right,n.right=A.left,A.left=n,null===(n=A).right))break;o.right=n,o=n,n=n.right}}return o.right=n.left,s.left=n.right,n.left=r.right,n.right=r.left,n}function r(t,n,r,o){var s=new e(t,n);if(null===r)return s.left=s.right=null,s;var a=o(t,(r=i(t,r,o)).key);return a<0?(s.left=r.left,s.right=r,r.left=null):a>=0&&(s.right=r.right,s.left=r,r.right=null),s}function o(t,e,n){var r=null,o=null;if(e){var s=n((e=i(t,e,n)).key,t);0===s?(r=e.left,o=e.right):s<0?(o=e.right,e.right=null,r=e):(r=e.left,e.left=null,o=e)}return{left:r,right:o}}function s(t,e,n){return null===e?t:(null===t||((e=i(t.key,e,n)).left=t),e)}function a(t,e,n,i,r){if(t){i(e+(n?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+r(t)+"\n");var o=e+(n?"    ":"\u2502   ");t.left&&a(t.left,o,!1,i,r),t.right&&a(t.right,o,!0,i,r)}}var A=function(){function A(t){void 0===t&&(t=n),this._root=null,this._size=0,this._comparator=t}return A.prototype.insert=function(t,e){return this._size++,this._root=r(t,e,this._root,this._comparator)},A.prototype.add=function(t,n){var r=new e(t,n);null===this._root&&(r.left=r.right=null,this._size++,this._root=r);var o=this._comparator,s=i(t,this._root,o),a=o(t,s.key);return 0===a?this._root=s:(a<0?(r.left=s.left,r.right=s,s.left=null):a>0&&(r.right=s.right,r.left=s,s.right=null),this._size++,this._root=r),this._root},A.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},A.prototype._remove=function(t,e,n){var r;return null===e?null:0===n(t,(e=i(t,e,n)).key)?(null===e.left?r=e.right:(r=i(t,e.left,n)).right=e.right,this._size--,r):e},A.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=i(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},A.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var i=n(t,e.key);if(0===i)return e;e=i<0?e.left:e.right}return null},A.prototype.find=function(t){return this._root&&(this._root=i(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},A.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var i=n(t,e.key);if(0===i)return!0;e=i<0?e.left:e.right}return!1},A.prototype.forEach=function(t,e){for(var n=this._root,i=[],r=!1;!r;)null!==n?(i.push(n),n=n.left):0!==i.length?(n=i.pop(),t.call(e,n),n=n.right):r=!0;return this},A.prototype.range=function(t,e,n,i){for(var r=[],o=this._comparator,s=this._root;0!==r.length||s;)if(s)r.push(s),s=s.left;else{if(o((s=r.pop()).key,e)>0)break;if(o(s.key,t)>=0&&n.call(i,s))return this;s=s.right}return this},A.prototype.keys=function(){var t=[];return this.forEach((function(e){var n=e.key;return t.push(n)})),t},A.prototype.values=function(){var t=[];return this.forEach((function(e){var n=e.data;return t.push(n)})),t},A.prototype.min=function(){return this._root?this.minNode(this._root).key:null},A.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},A.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},A.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},A.prototype.at=function(t){for(var e=this._root,n=!1,i=0,r=[];!n;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),i===t)return e;i++,e=e.right}else n=!0;return null},A.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var i=this._comparator;e;){var r=i(t.key,e.key);if(0===r)break;r<0?(n=e,e=e.left):e=e.right}return n},A.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var i=this._comparator;e;){var r=i(t.key,e.key);if(0===r)break;r<0?e=e.left:(n=e,e=e.right)}return n},A.prototype.clear=function(){return this._root=null,this._size=0,this},A.prototype.toList=function(){return c(this._root)},A.prototype.load=function(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=!1);var i=t.length,r=this._comparator;if(n&&p(t,e,0,i-1,r),null===this._root)this._root=u(t,e,0,i),this._size=i;else{var o=f(this.toList(),l(t,e),r);i=this._size+i,this._root=h({head:o},0,i)}return this},A.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(A.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),A.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return a(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},A.prototype.update=function(t,e,n){var i=this._comparator,a=o(t,this._root,i),A=a.left,u=a.right;i(t,e)<0?u=r(e,n,u,i):A=r(e,n,A,i),this._root=s(A,u,i)},A.prototype.split=function(t){return o(t,this._root,this._comparator)},A.prototype[Symbol.iterator]=function(){var e,n,i;return t(this,(function(t){switch(t.label){case 0:e=this._root,n=[],i=!1,t.label=1;case 1:return i?[3,6]:null===e?[3,2]:(n.push(e),e=e.left,[3,5]);case 2:return 0===n.length?[3,4]:[4,e=n.pop()];case 3:return t.sent(),e=e.right,[3,5];case 4:i=!0,t.label=5;case 5:return[3,1];case 6:return[2]}}))},A}();function u(t,n,i,r){var o=r-i;if(o>0){var s=i+Math.floor(o/2),a=t[s],A=n[s],l=new e(a,A);return l.left=u(t,n,i,s),l.right=u(t,n,s+1,r),l}return null}function l(t,n){for(var i=new e(null,null),r=i,o=0;o<t.length;o++)r=r.next=new e(t[o],n[o]);return r.next=null,i.next}function c(t){for(var n=t,i=[],r=!1,o=new e(null,null),s=o;!r;)n?(i.push(n),n=n.left):i.length>0?n=(n=s=s.next=i.pop()).right:r=!0;return s.next=null,o.next}function h(t,e,n){var i=n-e;if(i>0){var r=e+Math.floor(i/2),o=h(t,e,r),s=t.head;return s.left=o,t.head=t.head.next,s.right=h(t,r+1,n),s}return null}function f(t,n,i){for(var r=new e(null,null),o=r,s=t,a=n;null!==s&&null!==a;)i(s.key,a.key)<0?(o.next=s,s=s.next):(o.next=a,a=a.next),o=o.next;return null!==s?o.next=s:null!==a&&(o.next=a),r.next}function p(t,e,n,i,r){if(!(n>=i)){for(var o=t[n+i>>1],s=n-1,a=i+1;;){do{s++}while(r(t[s],o)<0);do{a--}while(r(t[a],o)>0);if(s>=a)break;var A=t[s];t[s]=t[a],t[a]=A,A=e[s],e[s]=e[a],e[a]=A}p(t,e,n,a,r),p(t,e,a+1,i,r)}}const d=(t,e)=>t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y,g=(t,e)=>{if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;const n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,i=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:i,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}};let _=Number.EPSILON;void 0===_&&(_=Math.pow(2,-52));const m=_*_,y=(t,e)=>{if(-_<t&&t<_&&-_<e&&e<_)return 0;const n=t-e;return n*n<m*t*e?0:t<e?-1:1};class v{constructor(){this.reset()}reset(){this.xRounder=new E,this.yRounder=new E}round(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}class E{constructor(){this.tree=new A,this.round(0)}round(t){const e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===y(e.key,n.key))return this.tree.remove(t),n.key;const i=this.tree.next(e);return null!==i&&0===y(e.key,i.key)?(this.tree.remove(t),i.key):t}}const b=new v,w=11102230246251565e-32,x=134217729,S=(3+8*w)*w;function C(t,e,n,i,r){let o,s,a,A,u=e[0],l=i[0],c=0,h=0;l>u==l>-u?(o=u,u=e[++c]):(o=l,l=i[++h]);let f=0;if(c<t&&h<n)for(l>u==l>-u?(s=u+o,a=o-(s-u),u=e[++c]):(s=l+o,a=o-(s-l),l=i[++h]),o=s,0!==a&&(r[f++]=a);c<t&&h<n;)l>u==l>-u?(s=o+u,A=s-o,a=o-(s-A)+(u-A),u=e[++c]):(s=o+l,A=s-o,a=o-(s-A)+(l-A),l=i[++h]),o=s,0!==a&&(r[f++]=a);for(;c<t;)s=o+u,A=s-o,a=o-(s-A)+(u-A),u=e[++c],o=s,0!==a&&(r[f++]=a);for(;h<n;)s=o+l,A=s-o,a=o-(s-A)+(l-A),l=i[++h],o=s,0!==a&&(r[f++]=a);return 0===o&&0!==f||(r[f++]=o),f}function T(t,e){let n=e[0];for(let i=1;i<t;i++)n+=e[i];return n}function I(t){return new Float64Array(t)}const R=(3+16*w)*w,P=(2+12*w)*w,M=(9+64*w)*w*w,L=I(4),N=I(8),O=I(12),D=I(16),F=I(4);function k(t,e,n,i,r,o,s){let a,A,u,l,c,h,f,p,d,g,_,m,y,v,E,b,w,I;const R=t-r,k=n-r,B=e-o,U=i-o;v=R*U,h=x*R,f=h-(h-R),p=R-f,h=x*U,d=h-(h-U),g=U-d,E=p*g-(v-f*d-p*d-f*g),b=B*k,h=x*B,f=h-(h-B),p=B-f,h=x*k,d=h-(h-k),g=k-d,w=p*g-(b-f*d-p*d-f*g),_=E-w,c=E-_,L[0]=E-(_+c)+(c-w),m=v+_,c=m-v,y=v-(m-c)+(_-c),_=y-b,c=y-_,L[1]=y-(_+c)+(c-b),I=m+_,c=I-m,L[2]=m-(I-c)+(_-c),L[3]=I;let G=T(4,L),z=P*s;if(G>=z||-G>=z)return G;if(c=t-R,a=t-(R+c)+(c-r),c=n-k,u=n-(k+c)+(c-r),c=e-B,A=e-(B+c)+(c-o),c=i-U,l=i-(U+c)+(c-o),0===a&&0===A&&0===u&&0===l)return G;if(z=M*s+S*Math.abs(G),G+=R*l+U*a-(B*u+k*A),G>=z||-G>=z)return G;v=a*U,h=x*a,f=h-(h-a),p=a-f,h=x*U,d=h-(h-U),g=U-d,E=p*g-(v-f*d-p*d-f*g),b=A*k,h=x*A,f=h-(h-A),p=A-f,h=x*k,d=h-(h-k),g=k-d,w=p*g-(b-f*d-p*d-f*g),_=E-w,c=E-_,F[0]=E-(_+c)+(c-w),m=v+_,c=m-v,y=v-(m-c)+(_-c),_=y-b,c=y-_,F[1]=y-(_+c)+(c-b),I=m+_,c=I-m,F[2]=m-(I-c)+(_-c),F[3]=I;const V=C(4,L,4,F,N);v=R*l,h=x*R,f=h-(h-R),p=R-f,h=x*l,d=h-(h-l),g=l-d,E=p*g-(v-f*d-p*d-f*g),b=B*u,h=x*B,f=h-(h-B),p=B-f,h=x*u,d=h-(h-u),g=u-d,w=p*g-(b-f*d-p*d-f*g),_=E-w,c=E-_,F[0]=E-(_+c)+(c-w),m=v+_,c=m-v,y=v-(m-c)+(_-c),_=y-b,c=y-_,F[1]=y-(_+c)+(c-b),I=m+_,c=I-m,F[2]=m-(I-c)+(_-c),F[3]=I;const j=C(V,N,4,F,O);v=a*l,h=x*a,f=h-(h-a),p=a-f,h=x*l,d=h-(h-l),g=l-d,E=p*g-(v-f*d-p*d-f*g),b=A*u,h=x*A,f=h-(h-A),p=A-f,h=x*u,d=h-(h-u),g=u-d,w=p*g-(b-f*d-p*d-f*g),_=E-w,c=E-_,F[0]=E-(_+c)+(c-w),m=v+_,c=m-v,y=v-(m-c)+(_-c),_=y-b,c=y-_,F[1]=y-(_+c)+(c-b),I=m+_,c=I-m,F[2]=m-(I-c)+(_-c),F[3]=I;const W=C(j,O,4,F,D);return D[W-1]}function B(t,e,n,i,r,o){const s=(e-o)*(n-r),a=(t-r)*(i-o),A=s-a,u=Math.abs(s+a);return Math.abs(A)>=R*u?A:-k(t,e,n,i,r,o,u)}const U=(t,e)=>t.x*e.y-t.y*e.x,G=(t,e)=>t.x*e.x+t.y*e.y,z=(t,e,n)=>{const i=B(t.x,t.y,e.x,e.y,n.x,n.y);return i>0?-1:i<0?1:0},V=t=>Math.sqrt(G(t,t)),j=(t,e,n)=>{const i={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y};return U(r,i)/V(r)/V(i)},W=(t,e,n)=>{const i={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y};return G(r,i)/V(r)/V(i)},H=(t,e,n)=>0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n},X=(t,e,n)=>0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)},Y=(t,e,n,i)=>{if(0===e.x)return X(n,i,t.x);if(0===i.x)return X(t,e,n.x);if(0===e.y)return H(n,i,t.y);if(0===i.y)return H(t,e,n.y);const r=U(e,i);if(0==r)return null;const o={x:n.x-t.x,y:n.y-t.y},s=U(o,e)/r,a=U(o,i)/r;return{x:(t.x+a*e.x+(n.x+s*i.x))/2,y:(t.y+a*e.y+(n.y+s*i.y))/2}};class q{static compare(t,e){const n=q.comparePoints(t.point,e.point);return 0!==n?n:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft?t.isLeft?1:-1:$.compare(t.segment,e.segment))}static comparePoints(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}constructor(t,e){void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const e=t.point.events;for(let n=0,i=e.length;n<i;n++){const t=e[n];this.point.events.push(t),t.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let e=0;e<t;e++){const n=this.point.events[e];if(void 0===n.segment.consumedBy)for(let i=e+1;i<t;i++){const t=this.point.events[i];void 0===t.consumedBy&&n.otherSE.point.events===t.otherSE.point.events&&n.segment.consume(t.segment)}}}getAvailableLinkedEvents(){const t=[];for(let e=0,n=this.point.events.length;e<n;e++){const n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}getLeftmostComparator(t){const e=new Map,n=n=>{const i=n.otherSE;e.set(n,{sine:j(this.point,t.point,i.point),cosine:W(this.point,t.point,i.point)})};return(t,i)=>{e.has(t)||n(t),e.has(i)||n(i);const{sine:r,cosine:o}=e.get(t),{sine:s,cosine:a}=e.get(i);return r>=0&&s>=0?o<a?1:o>a?-1:0:r<0&&s<0?o<a?-1:o>a?1:0:s<r?-1:s>r?1:0}}}let Q=0;class ${static compare(t,e){const n=t.leftSE.point.x,i=e.leftSE.point.x,r=t.rightSE.point.x,o=e.rightSE.point.x;if(o<n)return 1;if(r<i)return-1;const s=t.leftSE.point.y,a=e.leftSE.point.y,A=t.rightSE.point.y,u=e.rightSE.point.y;if(n<i){if(a<s&&a<A)return 1;if(a>s&&a>A)return-1;const n=t.comparePoint(e.leftSE.point);if(n<0)return 1;if(n>0)return-1;const i=e.comparePoint(t.rightSE.point);return 0!==i?i:-1}if(n>i){if(s<a&&s<u)return-1;if(s>a&&s>u)return 1;const n=e.comparePoint(t.leftSE.point);if(0!==n)return n;const i=t.comparePoint(e.rightSE.point);return i<0?1:i>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(r<o){const n=e.comparePoint(t.rightSE.point);if(0!==n)return n}if(r>o){const n=t.comparePoint(e.rightSE.point);if(n<0)return 1;if(n>0)return-1}if(r!==o){const t=A-s,e=r-n,l=u-a,c=o-i;if(t>e&&l<c)return 1;if(t<e&&l>c)return-1}return r>o?1:r<o||A<u?-1:A>u?1:t.id<e.id?-1:t.id>e.id?1:0}constructor(t,e,n,i){this.id=++Q,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=n,this.windings=i}static fromRing(t,e,n){let i,r,o;const s=q.comparePoints(t,e);if(s<0)i=t,r=e,o=1;else{if(!(s>0))throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);i=e,r=t,o=-1}const a=new q(i,!0),A=new q(r,!1);return new $(a,A,[n],[o])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}comparePoint(t){if(this.isAnEndpoint(t))return 0;const e=this.leftSE.point,n=this.rightSE.point,i=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;const r=(t.y-e.y)/i.y,o=e.x+r*i.x;if(t.x===o)return 0;const s=(t.x-e.x)/i.x,a=e.y+s*i.y;return t.y===a?0:t.y<a?-1:1}getIntersection(t){const e=this.bbox(),n=t.bbox(),i=g(e,n);if(null===i)return null;const r=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,a=t.rightSE.point,A=d(e,s)&&0===this.comparePoint(s),u=d(n,r)&&0===t.comparePoint(r),l=d(e,a)&&0===this.comparePoint(a),c=d(n,o)&&0===t.comparePoint(o);if(u&&A)return c&&!l?o:!c&&l?a:null;if(u)return l&&r.x===a.x&&r.y===a.y?null:r;if(A)return c&&o.x===s.x&&o.y===s.y?null:s;if(c&&l)return null;if(c)return o;if(l)return a;const h=Y(r,this.vector(),s,t.vector());return null===h?null:d(i,h)?b.round(h.x,h.y):null}split(t){const e=[],n=void 0!==t.events,i=new q(t,!0),r=new q(t,!1),o=this.rightSE;this.replaceRightSE(r),e.push(r),e.push(i);const s=new $(i,o,this.rings.slice(),this.windings.slice());return q.comparePoints(s.leftSE.point,s.rightSE.point)>0&&s.swapEvents(),q.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(i.checkForConsuming(),r.checkForConsuming()),e}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}consume(t){let e=this,n=t;for(;e.consumedBy;)e=e.consumedBy;for(;n.consumedBy;)n=n.consumedBy;const i=$.compare(e,n);if(0!==i){if(i>0){const t=e;e=n,n=t}if(e.prev===n){const t=e;e=n,n=t}for(let t=0,i=n.rings.length;t<i;t++){const i=n.rings[t],r=n.windings[t],o=e.rings.indexOf(i);-1===o?(e.rings.push(i),e.windings.push(r)):e.windings[o]+=r}n.rings=null,n.windings=null,n.consumedBy=e,n.leftSE.consumedBy=e.leftSE,n.rightSE.consumedBy=e.rightSE}}prevInResult(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}beforeState(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}afterState(){if(void 0!==this._afterState)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const e=this._afterState.rings,n=this._afterState.windings,i=this._afterState.multiPolys;for(let s=0,a=this.rings.length;s<a;s++){const t=this.rings[s],i=this.windings[s],r=e.indexOf(t);-1===r?(e.push(t),n.push(i)):n[r]+=i}const r=[],o=[];for(let s=0,a=e.length;s<a;s++){if(0===n[s])continue;const t=e[s],i=t.poly;if(-1===o.indexOf(i))if(t.isExterior)r.push(i);else{-1===o.indexOf(i)&&o.push(i);const e=r.indexOf(t.poly);-1!==e&&r.splice(e,1)}}for(let s=0,a=r.length;s<a;s++){const t=r[s].multiPoly;-1===i.indexOf(t)&&i.push(t)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;const t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(at.type){case"union":{const n=0===t.length,i=0===e.length;this._isInResult=n!==i;break}case"intersection":{let n,i;t.length<e.length?(n=t.length,i=e.length):(n=e.length,i=t.length),this._isInResult=i===at.numMultiPolys&&n<i;break}case"xor":{const n=Math.abs(t.length-e.length);this._isInResult=n%2==1;break}case"difference":{const n=t=>1===t.length&&t[0].isSubject;this._isInResult=n(t)!==n(e);break}default:throw new Error(`Unrecognized operation type found ${at.type}`)}return this._isInResult}}class K{constructor(t,e,n){if(!Array.isArray(t)||0===t.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=n,this.segments=[],"number"!=typeof t[0][0]||"number"!=typeof t[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=b.round(t[0][0],t[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let r=i;for(let o=1,s=t.length;o<s;o++){if("number"!=typeof t[o][0]||"number"!=typeof t[o][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let e=b.round(t[o][0],t[o][1]);e.x===r.x&&e.y===r.y||(this.segments.push($.fromRing(r,e,this)),e.x<this.bbox.ll.x&&(this.bbox.ll.x=e.x),e.y<this.bbox.ll.y&&(this.bbox.ll.y=e.y),e.x>this.bbox.ur.x&&(this.bbox.ur.x=e.x),e.y>this.bbox.ur.y&&(this.bbox.ur.y=e.y),r=e)}i.x===r.x&&i.y===r.y||this.segments.push($.fromRing(r,i,this))}getSweepEvents(){const t=[];for(let e=0,n=this.segments.length;e<n;e++){const n=this.segments[e];t.push(n.leftSE),t.push(n.rightSE)}return t}}class Z{constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new K(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let n=1,i=t.length;n<i;n++){const e=new K(t[n],this,!1);e.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=e.bbox.ll.x),e.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=e.bbox.ll.y),e.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=e.bbox.ur.x),e.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=e.bbox.ur.y),this.interiorRings.push(e)}this.multiPoly=e}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let e=0,n=this.interiorRings.length;e<n;e++){const n=this.interiorRings[e].getSweepEvents();for(let e=0,i=n.length;e<i;e++)t.push(n[e])}return t}}class J{constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof t[0][0][0]&&(t=[t])}catch(n){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let i=0,r=t.length;i<r;i++){const e=new Z(t[i],this);e.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=e.bbox.ll.x),e.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=e.bbox.ll.y),e.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=e.bbox.ur.x),e.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=e.bbox.ur.y),this.polys.push(e)}this.isSubject=e}getSweepEvents(){const t=[];for(let e=0,n=this.polys.length;e<n;e++){const n=this.polys[e].getSweepEvents();for(let e=0,i=n.length;e<i;e++)t.push(n[e])}return t}}class tt{static factory(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];if(!i.isInResult()||i.ringOut)continue;let r=null,o=i.leftSE,s=i.rightSE;const a=[o],A=o.point,u=[];for(;r=o,o=s,a.push(o),o.point!==A;)for(;;){const t=o.getAvailableLinkedEvents();if(0===t.length){const t=a[0].point,e=a[a.length-1].point;throw new Error(`Unable to complete output ring starting at [${t.x}, ${t.y}]. Last matching segment found ends at [${e.x}, ${e.y}].`)}if(1===t.length){s=t[0].otherSE;break}let n=null;for(let e=0,r=u.length;e<r;e++)if(u[e].point===o.point){n=e;break}if(null!==n){const t=u.splice(n)[0],i=a.splice(t.index);i.unshift(i[0].otherSE),e.push(new tt(i.reverse()));continue}u.push({index:a.length,point:o.point});const i=o.getLeftmostComparator(r);s=t.sort(i)[0].otherSE;break}e.push(new tt(a))}return e}constructor(t){this.events=t;for(let e=0,n=t.length;e<n;e++)t[e].segment.ringOut=this;this.poly=null}getGeom(){let t=this.events[0].point;const e=[t];for(let A=1,u=this.events.length-1;A<u;A++){const n=this.events[A].point,i=this.events[A+1].point;0!==z(n,t,i)&&(e.push(n),t=n)}if(1===e.length)return null;const n=e[0],i=e[1];0===z(n,t,i)&&e.shift(),e.push(e[0]);const r=this.isExteriorRing()?1:-1,o=this.isExteriorRing()?0:e.length-1,s=this.isExteriorRing()?e.length:-1,a=[];for(let A=o;A!=s;A+=r)a.push([e[A].x,e[A].y]);return a}isExteriorRing(){if(void 0===this._isExteriorRing){const t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}enclosingRing(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let i=1,r=this.events.length;i<r;i++){const e=this.events[i];q.compare(t,e)>0&&(t=e)}let e=t.segment.prevInResult(),n=e?e.prevInResult():null;for(;;){if(!e)return null;if(!n)return e.ringOut;if(n.ringOut!==e.ringOut)return n.ringOut.enclosingRing()!==e.ringOut?e.ringOut:e.ringOut.enclosingRing();e=n.prevInResult(),n=e?e.prevInResult():null}}}class et{constructor(t){this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(let e=0,n=this.interiorRings.length;e<n;e++){const n=this.interiorRings[e].getGeom();null!==n&&t.push(n)}return t}}class nt{constructor(t){this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let e=0,n=this.polys.length;e<n;e++){const n=this.polys[e].getGeom();null!==n&&t.push(n)}return t}_composePolys(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];if(!i.poly)if(i.isExteriorRing())e.push(new et(i));else{const t=i.enclosingRing();t.poly||e.push(new et(t)),t.poly.addInterior(i)}}return e}}class it{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$.compare;this.queue=t,this.tree=new A(e),this.segments=[]}process(t){const e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;const i=t.isLeft?this.tree.add(e):this.tree.find(e);if(!i)throw new Error(`Unable to find segment #${e.id} [${e.leftSE.point.x}, ${e.leftSE.point.y}] -> [${e.rightSE.point.x}, ${e.rightSE.point.y}] in SweepLine tree.`);let r,o,s=i,a=i;for(;void 0===r;)s=this.tree.prev(s),null===s?r=null:void 0===s.key.consumedBy&&(r=s.key);for(;void 0===o;)a=this.tree.next(a),null===a?o=null:void 0===a.key.consumedBy&&(o=a.key);if(t.isLeft){let i=null;if(r){const t=r.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(i=t),!r.isAnEndpoint(t))){const e=this._splitSafely(r,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}}let s=null;if(o){const t=o.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(s=t),!o.isAnEndpoint(t))){const e=this._splitSafely(o,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}}if(null!==i||null!==s){let t=null;t=null===i?s:null===s||q.comparePoints(i,s)<=0?i:s,this.queue.remove(e.rightSE),n.push(e.rightSE);const r=e.split(t);for(let e=0,i=r.length;e<i;e++)n.push(r[e])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=r)}else{if(r&&o){const t=r.getIntersection(o);if(null!==t){if(!r.isAnEndpoint(t)){const e=this._splitSafely(r,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}if(!o.isAnEndpoint(t)){const e=this._splitSafely(o,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}}}this.tree.remove(e)}return n}_splitSafely(t,e){this.tree.remove(t);const n=t.rightSE;this.queue.remove(n);const i=t.split(e);return i.push(n),void 0===t.consumedBy&&this.tree.add(t),i}}const rt="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,ot="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class st{run(t,e,n){at.type=t,b.reset();const i=[new J(e,!0)];for(let A=0,l=n.length;A<l;A++)i.push(new J(n[A],!1));if(at.numMultiPolys=i.length,"difference"===at.type){const t=i[0];let e=1;for(;e<i.length;)null!==g(i[e].bbox,t.bbox)?e++:i.splice(e,1)}if("intersection"===at.type)for(let A=0,l=i.length;A<l;A++){const t=i[A];for(let e=A+1,n=i.length;e<n;e++)if(null===g(t.bbox,i[e].bbox))return[]}const r=new A(q.compare);for(let A=0,l=i.length;A<l;A++){const t=i[A].getSweepEvents();for(let e=0,n=t.length;e<n;e++)if(r.insert(t[e]),r.size>rt)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const o=new it(r);let s=r.size,a=r.pop();for(;a;){const t=a.key;if(r.size===s){const e=t.segment;throw new Error(`Unable to pop() ${t.isLeft?"left":"right"} SweepEvent [${t.point.x}, ${t.point.y}] from segment #${e.id} [${e.leftSE.point.x}, ${e.leftSE.point.y}] -> [${e.rightSE.point.x}, ${e.rightSE.point.y}] from queue.`)}if(r.size>rt)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(o.segments.length>ot)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const e=o.process(t);for(let n=0,i=e.length;n<i;n++){const t=e[n];void 0===t.consumedBy&&r.insert(t)}s=r.size,a=r.pop()}b.reset();const u=tt.factory(o.segments);return new nt(u).getGeom()}}const at=new st,At=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return at.run("union",t,n)},ut=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return at.run("intersection",t,n)},lt=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return at.run("xor",t,n)},ct=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return at.run("difference",t,n)};return{union:At,intersection:ut,xor:lt,difference:ct}}()},8924:(t,e,n)=>{"use strict";function i(t,e,n,i,o){r(t,e,n||0,i||t.length-1,o||s)}function r(t,e,n,i,s){for(;i>n;){if(i-n>600){var a=i-n+1,A=e-n+1,u=Math.log(a),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(a-l)/a)*(A-a/2<0?-1:1);r(t,e,Math.max(n,Math.floor(e-A*l/a+c)),Math.min(i,Math.floor(e+(a-A)*l/a+c)),s)}var h=t[e],f=n,p=i;for(o(t,n,e),s(t[i],h)>0&&o(t,n,i);f<p;){for(o(t,f,p),f++,p--;s(t[f],h)<0;)f++;for(;s(t[p],h)>0;)p--}0===s(t[n],h)?o(t,n,p):o(t,++p,i),p<=e&&(n=p+1),e<=p&&(i=p-1)}}function o(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function s(t,e){return t<e?-1:t>e?1:0}n.r(e),n.d(e,{default:()=>i})},2519:(t,e,n)=>{"use strict";t.exports=r,t.exports.default=r;var i=n(8924);function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,i,r){r||(r=d(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<n;s++)o=t.children[s],A(r,t.leaf?i(o):o);return r}function A(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(t,e,n,r,o){for(var s,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=r||(s=e+Math.ceil((n-e)/r/2)*r,i(t,s,e,n,o),a.push(e,s,s,n))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!p(t,e))return n;for(var r,o,s,a,A=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],p(t,a=e.leaf?i(s):s)&&(e.leaf?n.push(s):f(t,a)?this._all(s,n):A.push(s));e=A.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!p(t,e))return!1;for(var i,r,o,s,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],p(t,s=e.leaf?n(o):o)){if(e.leaf||f(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=d([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,s,a=this.data,A=this.toBBox(t),u=[],l=[];a||u.length;){if(a||(a=u.pop(),i=u[u.length-1],n=l.pop(),s=!0),a.leaf&&-1!==(r=o(t,a.children,e)))return a.children.splice(r,1),u.push(a),this._condense(u),this;s||a.leaf||!f(a,A)?i?(n++,a=i.children[n],s=!1):a=null:(u.push(a),l.push(n),n=0,i=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,a=this._maxEntries;if(o<=a)return s(r=d(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,i-1))),(r=d([])).leaf=!1,r.height=i;var A,u,l,c,h=Math.ceil(o/a),f=h*Math.ceil(Math.sqrt(a));for(g(t,e,n,f,this.compareMinX),A=e;A<=n;A+=f)for(g(t,A,l=Math.min(A+f-1,n),h,this.compareMinY),u=A;u<=l;u+=h)c=Math.min(u+h-1,l),r.children.push(this._build(t,u,c,i-1));return s(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,s,a,A,u,l,h,f,p;i.push(e),!e.leaf&&i.length-1!==n;){for(l=h=1/0,r=0,o=e.children.length;r<o;r++)A=c(s=e.children[r]),f=t,p=s,(u=(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-A)<h?(h=u,l=A<l?A:l,a=s):u===h&&A<l&&(l=A,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),A(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),a=d(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,s(n,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,s,A,u,l,h,f,p,d,g,_,m;for(u=l=1/0,i=e;i<=n-e;i++)r=a(t,0,i,this.toBBox),o=a(t,i,n,this.toBBox),f=r,p=o,d=void 0,g=void 0,_=void 0,m=void 0,d=Math.max(f.minX,p.minX),g=Math.max(f.minY,p.minY),_=Math.min(f.maxX,p.maxX),m=Math.min(f.maxY,p.maxY),s=Math.max(0,_-d)*Math.max(0,m-g),A=c(r)+c(o),s<u?(u=s,h=i,l=A<l?A:l):s===u&&A<l&&(l=A,h=i);return h},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,s=this.toBBox,u=a(t,0,e,s),l=a(t,n-e,n,s),c=h(u)+h(l);for(r=e;r<n-e;r++)o=t.children[r],A(u,t.leaf?s(o):o),c+=h(u);for(r=n-e-1;r>=e;r--)o=t.children[r],A(l,t.leaf?s(o):o),c+=h(l);return c},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)A(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():s(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},5605:(t,e,n)=>{"use strict";n.d(e,{Ay:()=>M});var i=n(6540);const r=i.createContext(null);function o(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!o(t[n],e[n]))return!1;return!0}if(Array.isArray(e))return!1;if("object"==typeof t&&"object"==typeof e){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const r of n){if(!e.hasOwnProperty(r))return!1;if(!o(t[r],e[r]))return!1}return!0}return!1}function s(t,e){if(!t.getProjection)return;const n=t.getProjection();o(n,e.getProjection())||e.setProjection(n)}function a(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function A(t,e){const n=e.viewState||e;let i=!1;if("longitude"in n&&"latitude"in n){const e=t.center;t.center=new e.constructor(n.longitude,n.latitude),i=i||e!==t.center}if("zoom"in n){const e=t.zoom;t.zoom=n.zoom,i=i||e!==t.zoom}if("bearing"in n){const e=t.bearing;t.bearing=n.bearing,i=i||e!==t.bearing}if("pitch"in n){const e=t.pitch;t.pitch=n.pitch,i=i||e!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(i=!0,t.padding=n.padding),i}const u=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function l(t){if(!t)return null;if("string"==typeof t)return t;if("toJS"in t&&(t=t.toJS()),!t.layers)return t;const e={};for(const i of t.layers)e[i.id]=i;const n=t.layers.map((t=>{let n=null;"interactive"in t&&(n=Object.assign({},t),delete n.interactive);const i=e[t.ref];if(i){n=n||Object.assign({},t),delete n.ref;for(const t of u)t in i&&(n[t]=i[t])}return n||t}));return{...t,layers:n}}const c={version:8,sources:{},layers:[]},h={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},f={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},p={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},d=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],g=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class _{constructor(t,e,n){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=t=>{const e=this.props[p[t.type]];e?e(t):"error"===t.type&&console.error(t.error)},this._onPointerEvent=t=>{"mousemove"!==t.type&&"mouseout"!==t.type||this._updateHover(t);const e=this.props[h[t.type]];e&&(this.props.interactiveLayerIds&&"mouseover"!==t.type&&"mouseout"!==t.type&&(t.features=this._hoveredFeatures||this._queryRenderedFeatures(t.point)),e(t),delete t.features)},this._onCameraEvent=t=>{if(!this._internalUpdate){const e=this.props[f[t.type]];e&&e(t)}t.type in this._deferredEvents&&(this._deferredEvents[t.type]=!1)},this._MapClass=t,this.props=e,this._initialize(n)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const e=this.props;this.props=t;const n=this._updateSettings(t,e);n&&this._createShadowTransform(this._map);const i=this._updateSize(t),r=this._updateViewState(t,!0);this._updateStyle(t,e),this._updateStyleComponents(t,e),this._updateHandlers(t,e),(n||i||r&&!this._map.isMoving())&&this.redraw()}static reuse(t,e){const n=_.savedMaps.pop();if(!n)return null;const i=n.map,r=i.getContainer();for(e.className=r.className;r.childNodes.length>0;)e.appendChild(r.childNodes[0]);i._container=e;const o=i._resizeObserver;o&&(o.disconnect(),o.observe(e)),n.setProps({...t,styleDiffing:!1}),i.resize();const{initialViewState:s}=t;return s&&(s.bounds?i.fitBounds(s.bounds,{...s.fitBoundsOptions,duration:0}):n._updateViewState(s,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",(()=>i.fire("load"))),i._update(),n}_initialize(t){const{props:e}=this,{mapStyle:n=c}=e,i={...e,...e.initialViewState,accessToken:e.mapboxAccessToken||m()||null,container:t,style:l(n)},r=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[r.longitude||0,r.latitude||0],zoom:r.zoom||0,pitch:r.pitch||0,bearing:r.bearing||0}),e.gl){const t=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=t,e.gl)}const o=new this._MapClass(i);r.padding&&o.setPadding(r.padding),e.cursor&&(o.getCanvas().style.cursor=e.cursor),this._createShadowTransform(o);const a=o._render;o._render=t=>{this._inRender=!0,a.call(o,t),this._inRender=!1};const A=o._renderTaskQueue.run;o._renderTaskQueue.run=t=>{A.call(o._renderTaskQueue,t),this._onBeforeRepaint()},o.on("render",(()=>this._onAfterRepaint()));const u=o.fire;o.fire=this._fireEvent.bind(this,u),o.on("resize",(()=>{this._renderTransform.resize(o.transform.width,o.transform.height)})),o.on("styledata",(()=>{this._updateStyleComponents(this.props,{}),s(o.transform,this._renderTransform)})),o.on("sourcedata",(()=>this._updateStyleComponents(this.props,{})));for(const s in h)o.on(s,this._onPointerEvent);for(const s in f)o.on(s,this._onCameraEvent);for(const s in p)o.on(s,this._onEvent);this._map=o}recycle(){const t=this.map.getContainer().querySelector("[mapboxgl-children]");null==t||t.remove(),_.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const e=function(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}(t.transform);t.painter.transform=e,this._renderTransform=e}_updateSize(t){const{viewState:e}=t;if(e){const t=this._map;if(e.width!==t.transform.width||e.height!==t.transform.height)return t.resize(),!0}return!1}_updateViewState(t,e){if(this._internalUpdate)return!1;const n=this._map,i=this._renderTransform,{zoom:r,pitch:o,bearing:s}=i,u=n.isMoving();u&&(i.cameraElevationReference="sea");const l=A(i,{...a(n.transform),...t});if(u&&(i.cameraElevationReference="ground"),l&&e){const t=this._deferredEvents;t.move=!0,t.zoom||(t.zoom=r!==i.zoom),t.rotate||(t.rotate=s!==i.bearing),t.pitch||(t.pitch=o!==i.pitch)}return u||A(n.transform,t),l}_updateSettings(t,e){const n=this._map;let i=!1;for(const r of d)if(r in t&&!o(t[r],e[r])){i=!0;const e=n[`set${r[0].toUpperCase()}${r.slice(1)}`];null==e||e.call(n,t[r])}return i}_updateStyle(t,e){if(t.cursor!==e.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==e.mapStyle){const{mapStyle:e=c,styleDiffing:n=!0}=t,i={diff:n};return"localIdeographFontFamily"in t&&(i.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(l(e),i),!0}return!1}_updateStyleComponents(t,e){const n=this._map;let i=!1;return n.isStyleLoaded()&&("light"in t&&n.setLight&&!o(t.light,e.light)&&(i=!0,n.setLight(t.light)),"fog"in t&&n.setFog&&!o(t.fog,e.fog)&&(i=!0,n.setFog(t.fog)),"terrain"in t&&n.setTerrain&&!o(t.terrain,e.terrain)&&(t.terrain&&!n.getSource(t.terrain.source)||(i=!0,n.setTerrain(t.terrain)))),i}_updateHandlers(t,e){var n,i;const r=this._map;let s=!1;for(const a of g){const A=null===(n=t[a])||void 0===n||n;o(A,null===(i=e[a])||void 0===i||i)||(s=!0,A?r[a].enable(A):r[a].disable())}return s}_queryRenderedFeatures(t){const e=this._map,n=e.transform,{interactiveLayerIds:i=[]}=this.props;try{return e.transform=this._renderTransform,e.queryRenderedFeatures(t,{layers:i.filter(e.getLayer.bind(e))})}catch(r){return[]}finally{e.transform=n}}_updateHover(t){var e;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const n=t.type,i=(null===(e=this._hoveredFeatures)||void 0===e?void 0:e.length)>0,r=this._queryRenderedFeatures(t.point),o=r.length>0;!o&&i&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=r,o&&!i&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=n}else this._hoveredFeatures=null}_fireEvent(t,e,n){const i=this._map,r=i.transform,o="string"==typeof e?e:e.type;return"move"===o&&this._updateViewState(this.props,!1),o in f&&("object"==typeof e&&(e.viewState=a(r)),this._map.isMoving())?(i.transform=this._renderTransform,t.call(i,e,n),i.transform=r,i):(t.call(i,e,n),i)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const n in this._deferredEvents)this._deferredEvents[n]&&t.fire(n);this._internalUpdate=!1;const e=this._map.transform;t.transform=this._renderTransform,this._onAfterRepaint=()=>{s(this._renderTransform,e),t.transform=e}}}function m(){let t=null;if("undefined"!=typeof location){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||process.env.MapboxAccessToken}catch(e){}try{t=t||process.env.REACT_APP_MAPBOX_ACCESS_TOKEN}catch(n){}return t}_.savedMaps=[];const y=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function v(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:n=>{const i=e.transform;e.transform=t.transform;const r=e.project(n);return e.transform=i,r},unproject:n=>{const i=e.transform;e.transform=t.transform;const r=e.unproject(n);return e.transform=i,r},queryTerrainElevation:(n,i)=>{const r=e.transform;e.transform=t.transform;const o=e.queryTerrainElevation(n,i);return e.transform=r,o},queryRenderedFeatures:(n,i)=>{const r=e.transform;e.transform=t.transform;const o=e.queryRenderedFeatures(n,i);return e.transform=r,o}};for(const i of function(t){const e=new Set;let n=t;for(;n;){for(const i of Object.getOwnPropertyNames(n))"_"!==i[0]&&"function"==typeof t[i]&&"fire"!==i&&"setEventedParent"!==i&&e.add(i);n=Object.getPrototypeOf(n)}return Array.from(e)}(e))i in n||y.includes(i)||(n[i]=e[i].bind(e));return n}const E="undefined"!=typeof document?i.useLayoutEffect:i.useEffect,b=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];const w=i.createContext(null);function x(t,e,n){const o=(0,i.useContext)(r),[s,a]=(0,i.useState)(null),A=(0,i.useRef)(),{current:u}=(0,i.useRef)({mapLib:null,map:null});(0,i.useEffect)((()=>{const e=t.mapLib;let i,r=!0;return Promise.resolve(e||n).then((e=>{if(!r)return;if(!e)throw new Error("Invalid mapLib");const n="Map"in e?e:e.default;if(!n.Map)throw new Error("Invalid mapLib");if(function(t,e){for(const i of b)i in e&&(t[i]=e[i]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&"unavailable"===t.getRTLTextPluginStatus()&&t.setRTLTextPlugin(n,(t=>{t&&console.error(t)}),!0)}(n,t),n.supported&&!n.supported(t))throw new Error("Map is not supported by this browser");t.reuseMaps&&(i=_.reuse(t,A.current)),i||(i=new _(n.Map,t,A.current)),u.map=v(i),u.mapLib=n,a(i),null==o||o.onMapMount(u.map,t.id)})).catch((e=>{const{onError:n}=t;n?n({type:"error",target:null,originalEvent:null,error:e}):console.error(e)})),()=>{r=!1,i&&(null==o||o.onMapUnmount(t.id),t.reuseMaps?i.recycle():i.destroy())}}),[]),E((()=>{s&&s.setProps(t)})),(0,i.useImperativeHandle)(e,(()=>u.map),[s]);const l=(0,i.useMemo)((()=>({position:"relative",width:"100%",height:"100%",...t.style})),[t.style]);return i.createElement("div",{id:t.id,ref:A,style:l},s&&i.createElement(w.Provider,{value:u},i.createElement("div",{"mapboxgl-children":"",style:{height:"100%"}},t.children)))}var S=n(961);const C=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function T(t,e){if(!t||!e)return;const n=t.style;for(const i in e){const t=e[i];Number.isFinite(t)&&!C.test(i)?n[i]=`${t}px`:n[i]=t}}(0,i.memo)((0,i.forwardRef)((function(t,e){const{map:n,mapLib:r}=(0,i.useContext)(w),o=(0,i.useRef)({props:t});o.current.props=t;const s=(0,i.useMemo)((()=>{let e=!1;i.Children.forEach(t.children,(t=>{t&&(e=!0)}));const n={...t,element:e?document.createElement("div"):null},a=new r.Marker(n);return a.setLngLat([t.longitude,t.latitude]),a.getElement().addEventListener("click",(t=>{var e,n;null===(n=(e=o.current.props).onClick)||void 0===n||n.call(e,{type:"click",target:a,originalEvent:t})})),a.on("dragstart",(t=>{var e,n;const i=t;i.lngLat=s.getLngLat(),null===(n=(e=o.current.props).onDragStart)||void 0===n||n.call(e,i)})),a.on("drag",(t=>{var e,n;const i=t;i.lngLat=s.getLngLat(),null===(n=(e=o.current.props).onDrag)||void 0===n||n.call(e,i)})),a.on("dragend",(t=>{var e,n;const i=t;i.lngLat=s.getLngLat(),null===(n=(e=o.current.props).onDragEnd)||void 0===n||n.call(e,i)})),a}),[]);(0,i.useEffect)((()=>(s.addTo(n.getMap()),()=>{s.remove()})),[]);const{longitude:a,latitude:A,offset:u,style:l,draggable:c=!1,popup:h=null,rotation:f=0,rotationAlignment:p="auto",pitchAlignment:d="auto"}=t;return(0,i.useEffect)((()=>{T(s.getElement(),l)}),[l]),(0,i.useImperativeHandle)(e,(()=>s),[]),s.getLngLat().lng===a&&s.getLngLat().lat===A||s.setLngLat([a,A]),u&&!function(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,i=Array.isArray(t)?t[1]:t?t.y:0,r=Array.isArray(e)?e[0]:e?e.x:0,o=Array.isArray(e)?e[1]:e?e.y:0;return n===r&&i===o}(s.getOffset(),u)&&s.setOffset(u),s.isDraggable()!==c&&s.setDraggable(c),s.getRotation()!==f&&s.setRotation(f),s.getRotationAlignment()!==p&&s.setRotationAlignment(p),s.getPitchAlignment()!==d&&s.setPitchAlignment(d),s.getPopup()!==h&&s.setPopup(h),(0,S.createPortal)(t.children,s.getElement())})));function I(t){return new Set(t?t.trim().split(/\s+/):[])}(0,i.memo)((0,i.forwardRef)((function(t,e){const{map:n,mapLib:r}=(0,i.useContext)(w),s=(0,i.useMemo)((()=>document.createElement("div")),[]),a=(0,i.useRef)({props:t});a.current.props=t;const A=(0,i.useMemo)((()=>{const e={...t},n=new r.Popup(e);return n.setLngLat([t.longitude,t.latitude]),n.once("open",(t=>{var e,n;null===(n=(e=a.current.props).onOpen)||void 0===n||n.call(e,t)})),n}),[]);if((0,i.useEffect)((()=>{const t=t=>{var e,n;null===(n=(e=a.current.props).onClose)||void 0===n||n.call(e,t)};return A.on("close",t),A.setDOMContent(s).addTo(n.getMap()),()=>{A.off("close",t),A.isOpen()&&A.remove()}}),[]),(0,i.useEffect)((()=>{T(A.getElement(),t.style)}),[t.style]),(0,i.useImperativeHandle)(e,(()=>A),[]),A.isOpen()&&(A.getLngLat().lng===t.longitude&&A.getLngLat().lat===t.latitude||A.setLngLat([t.longitude,t.latitude]),t.offset&&!o(A.options.offset,t.offset)&&A.setOffset(t.offset),A.options.anchor===t.anchor&&A.options.maxWidth===t.maxWidth||(A.options.anchor=t.anchor,A.setMaxWidth(t.maxWidth)),A.options.className!==t.className)){const e=I(A.options.className),n=I(t.className);for(const t of e)n.has(t)||A.removeClassName(t);for(const t of n)e.has(t)||A.addClassName(t);A.options.className=t.className}return(0,S.createPortal)(t.children,s)})));const R=function(t,e,n,r){const o=(0,i.useContext)(w),s=(0,i.useMemo)((()=>t(o)),[]);return(0,i.useEffect)((()=>{const t=r||n||e,i="function"==typeof e&&"function"==typeof n?e:null,a="function"==typeof n?n:"function"==typeof e?e:null,{map:A}=o;return A.hasControl(s)||(A.addControl(s,null==t?void 0:t.position),i&&i(o)),()=>{a&&a(o),A.hasControl(s)&&A.removeControl(s)}}),[]),s};(0,i.memo)((function(t){const e=R((({mapLib:e})=>new e.AttributionControl(t)),{position:t.position});return(0,i.useEffect)((()=>{T(e._container,t.style)}),[t.style]),null}));(0,i.memo)((function(t){const e=R((({mapLib:e})=>new e.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)})),{position:t.position});return(0,i.useEffect)((()=>{T(e._controlContainer,t.style)}),[t.style]),null}));(0,i.memo)((0,i.forwardRef)((function(t,e){const n=(0,i.useRef)({props:t}),r=R((({mapLib:e})=>{const i=new e.GeolocateControl(t),r=i._setupUI;return i._setupUI=t=>{i._container.hasChildNodes()||r(t)},i.on("geolocate",(t=>{var e,i;null===(i=(e=n.current.props).onGeolocate)||void 0===i||i.call(e,t)})),i.on("error",(t=>{var e,i;null===(i=(e=n.current.props).onError)||void 0===i||i.call(e,t)})),i.on("outofmaxbounds",(t=>{var e,i;null===(i=(e=n.current.props).onOutOfMaxBounds)||void 0===i||i.call(e,t)})),i.on("trackuserlocationstart",(t=>{var e,i;null===(i=(e=n.current.props).onTrackUserLocationStart)||void 0===i||i.call(e,t)})),i.on("trackuserlocationend",(t=>{var e,i;null===(i=(e=n.current.props).onTrackUserLocationEnd)||void 0===i||i.call(e,t)})),i}),{position:t.position});return n.current.props=t,(0,i.useImperativeHandle)(e,(()=>r),[]),(0,i.useEffect)((()=>{T(r._container,t.style)}),[t.style]),null})));(0,i.memo)((function(t){const e=R((({mapLib:e})=>new e.NavigationControl(t)),{position:t.position});return(0,i.useEffect)((()=>{T(e._container,t.style)}),[t.style]),null}));(0,i.memo)((function(t){const e=R((({mapLib:e})=>new e.ScaleControl(t)),{position:t.position}),n=(0,i.useRef)(t),r=n.current;n.current=t;const{style:o}=t;return void 0!==t.maxWidth&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),void 0!==t.unit&&t.unit!==r.unit&&e.setUnit(t.unit),(0,i.useEffect)((()=>{T(e._container,o)}),[o]),null}));const P=n.e(6443).then(n.t.bind(n,6443,23)),M=i.forwardRef((function(t,e){return x(t,e,P)}))},39:function(t,e){!function(t){"use strict";function e(){}function n(t){this.message=t||""}function i(t){this.message=t||""}function r(t){this.message=t||""}function o(){}function s(t){return null===t?Ot:t.color}function a(t){return null===t?null:t.parent}function A(t,e){null!==t&&(t.color=e)}function u(t){return null===t?null:t.left}function l(t){return null===t?null:t.right}function c(){this.root_=null,this.size_=0}function h(){}function f(){this.array_=[],arguments[0]instanceof vt&&this.addAll(arguments[0])}function p(){}function d(t){this.message=t||""}function g(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,i=1 in arguments&&parseInt(Number(arguments[1]),10)||0;i=i<0?Math.max(n+i,0):Math.min(i,n);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(r=r<0?Math.max(n+arguments[2],0):Math.min(r,n);i<r;)e[i]=t,++i;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var _=function(){};_.prototype.interfaces_=function(){return[]},_.prototype.getClass=function(){return _},_.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var m=function(t){function e(e){t.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),y=function(){},v={MAX_VALUE:{configurable:!0}};y.isNaN=function(t){return Number.isNaN(t)},y.doubleToLongBits=function(t){return t},y.longBitsToDouble=function(t){return t},y.isInfinite=function(t){return!Number.isFinite(t)},v.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(y,v);var E=function(){},b=function(){},w=function(){},x=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},S={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};x.prototype.setOrdinate=function(t,e){switch(t){case x.X:this.x=e;break;case x.Y:this.y=e;break;case x.Z:this.z=e;break;default:throw new m("Invalid ordinate index: "+t)}},x.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!_.equalsWithTolerance(this.x,e.x,n)&&!!_.equalsWithTolerance(this.y,e.y,n)}},x.prototype.getOrdinate=function(t){switch(t){case x.X:return this.x;case x.Y:return this.y;case x.Z:return this.z}throw new m("Invalid ordinate index: "+t)},x.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||y.isNaN(this.z))&&y.isNaN(t.z)},x.prototype.equals=function(t){return t instanceof x&&this.equals2D(t)},x.prototype.equalInZ=function(t,e){return _.equalsWithTolerance(this.z,t.z,e)},x.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},x.prototype.clone=function(){},x.prototype.copy=function(){return new x(this)},x.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},x.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},x.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},x.prototype.hashCode=function(){var t=17;return 37*(t=37*t+x.hashCode(this.x))+x.hashCode(this.y)},x.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},x.prototype.interfaces_=function(){return[E,b,e]},x.prototype.getClass=function(){return x},x.hashCode=function(){if(1===arguments.length){var t=arguments[0];return y.doubleToLongBits(t),Math.trunc(0)}},S.DimensionalComparator.get=function(){return C},S.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},S.NULL_ORDINATE.get=function(){return y.NaN},S.X.get=function(){return 0},S.Y.get=function(){return 1},S.Z.get=function(){return 2},Object.defineProperties(x,S);var C=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new m("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};C.prototype.compare=function(t,e){var n=t,i=e,r=C.compare(n.x,i.x);if(0!==r)return r;var o=C.compare(n.y,i.y);return 0!==o?o:this._dimensionsToTest<=2?0:C.compare(n.z,i.z)},C.prototype.interfaces_=function(){return[w]},C.prototype.getClass=function(){return C},C.compare=function(t,e){return t<e?-1:t>e?1:y.isNaN(t)?y.isNaN(e)?0:-1:y.isNaN(e)?1:0};var T=function(){};T.prototype.create=function(){},T.prototype.interfaces_=function(){return[]},T.prototype.getClass=function(){return T};var I=function(){},R={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};I.prototype.interfaces_=function(){return[]},I.prototype.getClass=function(){return I},I.toLocationSymbol=function(t){switch(t){case I.EXTERIOR:return"e";case I.BOUNDARY:return"b";case I.INTERIOR:return"i";case I.NONE:return"-"}throw new m("Unknown location value: "+t)},R.INTERIOR.get=function(){return 0},R.BOUNDARY.get=function(){return 1},R.EXTERIOR.get=function(){return 2},R.NONE.get=function(){return-1},Object.defineProperties(I,R);var P=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},M=function(){},L={LOG_10:{configurable:!0}};M.prototype.interfaces_=function(){return[]},M.prototype.getClass=function(){return M},M.log10=function(t){var e=Math.log(t);return y.isInfinite(e)||y.isNaN(e)?e:e/M.LOG_10},M.min=function(t,e,n,i){var r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r},M.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],o=arguments[2];return i<r?r:i>o?o:i}},M.wrap=function(t,e){return t<0?e- -t%e:t%e},M.max=function(){if(3===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[0];return t>n&&(n=t),e>n&&(n=e),n}if(4===arguments.length){var i=arguments[1],r=arguments[2],o=arguments[3],s=arguments[0];return i>s&&(s=i),r>s&&(s=r),o>s&&(s=o),s}},M.average=function(t,e){return(t+e)/2},L.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(M,L);var N=function(t){this.str=t};N.prototype.append=function(t){this.str+=t},N.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},N.prototype.toString=function(t){return this.str};var O=function(t){this.value=t};O.prototype.intValue=function(){return this.value},O.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},O.isNaN=function(t){return Number.isNaN(t)};var D=function(){};D.isWhitespace=function(t){return t<=32&&t>=0||127===t},D.toUpperCase=function(t){return t.toUpperCase()};var F=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length)if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else"string"==typeof arguments[0]&&t.call(this,t.parse(arguments[0]));else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i,r)}},k={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};F.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},F.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),i=F.magnitude(n._hi),r=F.TEN.pow(i);(n=n.divide(r)).gt(F.TEN)?(n=n.divide(F.TEN),i+=1):n.lt(F.ONE)&&(n=n.multiply(F.TEN),i-=1);for(var o=i+1,s=new N,a=F.MAX_PRINT_DIGITS-1,A=0;A<=a;A++){t&&A===o&&s.append(".");var u=Math.trunc(n._hi);if(u<0)break;var l=!1,c=0;u>9?(l=!0,c="9"):c="0"+u,s.append(c),n=n.subtract(F.valueOf(u)).multiply(F.TEN),l&&n.selfAdd(F.TEN);var h=!0,f=F.magnitude(n._hi);if(f<0&&Math.abs(f)>=a-A&&(h=!1),!h)break}return e[0]=i,s.toString()},F.prototype.sqr=function(){return this.multiply(this)},F.prototype.doubleValue=function(){return this._hi+this._lo},F.prototype.subtract=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},F.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},F.prototype.isZero=function(){return 0===this._hi&&0===this._lo},F.prototype.selfSubtract=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},F.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},F.prototype.min=function(t){return this.le(t)?this:t},F.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=null,o=null,s=null,a=null,A=null,u=null,l=null,c=null;return A=this._hi/n,c=(r=(u=F.SPLIT*A)-(r=u-A))*(s=(c=F.SPLIT*n)-(s=c-n))-(l=A*n)+r*(a=n-s)+(o=A-r)*s+o*a,c=A+(u=(this._hi-l-c+this._lo-A*i)/n),this._hi=c,this._lo=A-c+u,this}},F.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},F.prototype.divide=function(){if(arguments[0]instanceof F){var t=arguments[0],e=null,n=null,i=null,r=null,o=null,s=null,a=null,A=null;return n=(o=this._hi/t._hi)-(e=(s=F.SPLIT*o)-(e=s-o)),A=e*(i=(A=F.SPLIT*t._hi)-(i=A-t._hi))-(a=o*t._hi)+e*(r=t._hi-i)+n*i+n*r,s=(this._hi-a-A+this._lo-o*t._lo)/t._hi,new F(A=o+s,o-A+s)}if("number"==typeof arguments[0]){var u=arguments[0];return y.isNaN(u)?F.createNaN():F.copy(this).selfDivide(u,0)}},F.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},F.prototype.pow=function(t){if(0===t)return F.valueOf(1);var e=new F(this),n=F.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&n.selfMultiply(e),(i/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},F.prototype.ceil=function(){if(this.isNaN())return F.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new F(t,e)},F.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},F.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},F.prototype.setValue=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},F.prototype.max=function(t){return this.ge(t)?this:t},F.prototype.sqrt=function(){if(this.isZero())return F.valueOf(0);if(this.isNegative())return F.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=F.valueOf(e),i=this.subtract(n.sqr())._hi*(.5*t);return n.add(i)},F.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,i=null,r=null,o=null,s=null,a=null;return o=(r=this._hi+e)-(s=r-this._hi),i=(a=(o=e-s+(this._hi-o))+this._lo)+(r-(n=r+a)),this._hi=n+i,this._lo=i+(n-this._hi),this}}else if(2===arguments.length){var A=arguments[0],u=arguments[1],l=null,c=null,h=null,f=null,p=null,d=null,g=null;f=this._hi+A,c=this._lo+u,p=f-(d=f-this._hi),h=c-(g=c-this._lo);var _=(l=f+(d=(p=A-d+(this._hi-p))+c))+(d=(h=u-g+(this._lo-h))+(d+(f-l))),m=d+(l-_);return this._hi=_,this._lo=m,this}},F.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=null,o=null,s=null,a=null,A=null,u=null;r=(A=F.SPLIT*this._hi)-this._hi,u=F.SPLIT*n,r=A-r,o=this._hi-r,s=u-n;var l=(A=this._hi*n)+(u=r*(s=u-s)-A+r*(a=n-s)+o*s+o*a+(this._hi*i+this._lo*n)),c=u+(r=A-l);return this._hi=l,this._lo=c,this}},F.prototype.selfSqr=function(){return this.selfMultiply(this)},F.prototype.floor=function(){if(this.isNaN())return F.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new F(t,e)},F.prototype.negate=function(){return this.isNaN()?this:new F(-this._hi,-this._lo)},F.prototype.clone=function(){},F.prototype.multiply=function(){if(arguments[0]instanceof F){var t=arguments[0];return t.isNaN()?F.createNaN():F.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return y.isNaN(e)?F.createNaN():F.copy(this).selfMultiply(e,0)}},F.prototype.isNaN=function(){return y.isNaN(this._hi)},F.prototype.intValue=function(){return Math.trunc(this._hi)},F.prototype.toString=function(){var t=F.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},F.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(i<0)r="0."+F.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){var o=i-n.length;r=n+F.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+r:r},F.prototype.reciprocal=function(){var t=null,e=null,n=null,i=null,r=null,o=null,s=null,a=null;e=(r=1/this._hi)-(t=(o=F.SPLIT*r)-(t=o-r)),n=(a=F.SPLIT*this._hi)-this._hi;var A=r+(o=(1-(s=r*this._hi)-(a=t*(n=a-n)-s+t*(i=this._hi-n)+e*n+e*i)-r*this._lo)/this._hi);return new F(A,r-A+o)},F.prototype.toSciNotation=function(){if(this.isZero())return F.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=F.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var r="";n.length>1&&(r=n.substring(1));var o=n.charAt(0)+"."+r;return this.isNegative()?"-"+o+i:o+i},F.prototype.abs=function(){return this.isNaN()?F.NaN:this.isNegative()?this.negate():new F(this)},F.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},F.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},F.prototype.add=function(){if(arguments[0]instanceof F){var t=arguments[0];return F.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return F.copy(this).selfAdd(e)}},F.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof F){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._hi=n,this._lo=i}},F.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},F.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},F.prototype.trunc=function(){return this.isNaN()?F.NaN:this.isPositive()?this.floor():this.ceil()},F.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},F.prototype.interfaces_=function(){return[e,E,b]},F.prototype.getClass=function(){return F},F.sqr=function(t){return F.valueOf(t).selfMultiply(t)},F.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return F.parse(t)}if("number"==typeof arguments[0])return new F(arguments[0])},F.sqrt=function(t){return F.valueOf(t).sqrt()},F.parse=function(t){for(var e=0,n=t.length;D.isWhitespace(t.charAt(e));)e++;var i=!1;if(e<n){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(i=!0))}for(var o=new F,s=0,a=0,A=0;!(e>=n);){var u=t.charAt(e);if(e++,D.isDigit(u)){var l=u-"0";o.selfMultiply(F.TEN),o.selfAdd(l),s++}else{if("."!==u){if("e"===u||"E"===u){var c=t.substring(e);try{A=O.parseInt(c)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+c+" in string "+t):e}break}throw new Error("Unexpected character '"+u+"' at position "+e+" in string "+t)}a=s}}var h=o,f=s-a-A;if(0===f)h=o;else if(f>0){var p=F.TEN.pow(f);h=o.divide(p)}else if(f<0){var d=F.TEN.pow(-f);h=o.multiply(d)}return i?h.negate():h},F.createNaN=function(){return new F(y.NaN,y.NaN)},F.copy=function(t){return new F(t)},F.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i},F.stringOfChar=function(t,e){for(var n=new N,i=0;i<e;i++)n.append(t);return n.toString()},k.PI.get=function(){return new F(3.141592653589793,12246467991473532e-32)},k.TWO_PI.get=function(){return new F(6.283185307179586,24492935982947064e-32)},k.PI_2.get=function(){return new F(1.5707963267948966,6123233995736766e-32)},k.E.get=function(){return new F(2.718281828459045,14456468917292502e-32)},k.NaN.get=function(){return new F(y.NaN,y.NaN)},k.EPS.get=function(){return 123259516440783e-46},k.SPLIT.get=function(){return 134217729},k.MAX_PRINT_DIGITS.get=function(){return 32},k.TEN.get=function(){return F.valueOf(10)},k.ONE.get=function(){return F.valueOf(1)},k.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},k.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(F,k);var B=function(){},U={DP_SAFE_EPSILON:{configurable:!0}};B.prototype.interfaces_=function(){return[]},B.prototype.getClass=function(){return B},B.orientationIndex=function(t,e,n){var i=B.orientationIndexFilter(t,e,n);if(i<=1)return i;var r=F.valueOf(e.x).selfAdd(-t.x),o=F.valueOf(e.y).selfAdd(-t.y),s=F.valueOf(n.x).selfAdd(-e.x),a=F.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},B.signOfDet2x2=function(t,e,n,i){return t.multiply(i).selfSubtract(e.multiply(n)).signum()},B.intersection=function(t,e,n,i){var r=F.valueOf(i.y).selfSubtract(n.y).selfMultiply(F.valueOf(e.x).selfSubtract(t.x)),o=F.valueOf(i.x).selfSubtract(n.x).selfMultiply(F.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(o),a=F.valueOf(i.x).selfSubtract(n.x).selfMultiply(F.valueOf(t.y).selfSubtract(n.y)),A=F.valueOf(i.y).selfSubtract(n.y).selfMultiply(F.valueOf(t.x).selfSubtract(n.x)),u=a.subtract(A).selfDivide(s).doubleValue(),l=F.valueOf(t.x).selfAdd(F.valueOf(e.x).selfSubtract(t.x).selfMultiply(u)).doubleValue(),c=F.valueOf(e.x).selfSubtract(t.x).selfMultiply(F.valueOf(t.y).selfSubtract(n.y)),h=F.valueOf(e.y).selfSubtract(t.y).selfMultiply(F.valueOf(t.x).selfSubtract(n.x)),f=c.subtract(h).selfDivide(s).doubleValue(),p=F.valueOf(n.y).selfAdd(F.valueOf(i.y).selfSubtract(n.y).selfMultiply(f)).doubleValue();return new x(l,p)},B.orientationIndexFilter=function(t,e,n){var i=null,r=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),s=r-o;if(r>0){if(o<=0)return B.signum(s);i=r+o}else{if(!(r<0))return B.signum(s);if(o>=0)return B.signum(s);i=-r-o}var a=B.DP_SAFE_EPSILON*i;return s>=a||-s>=a?B.signum(s):2},B.signum=function(t){return t>0?1:t<0?-1:0},U.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(B,U);var G=function(){},z={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};z.X.get=function(){return 0},z.Y.get=function(){return 1},z.Z.get=function(){return 2},z.M.get=function(){return 3},G.prototype.setOrdinate=function(t,e,n){},G.prototype.size=function(){},G.prototype.getOrdinate=function(t,e){},G.prototype.getCoordinate=function(){},G.prototype.getCoordinateCopy=function(t){},G.prototype.getDimension=function(){},G.prototype.getX=function(t){},G.prototype.clone=function(){},G.prototype.expandEnvelope=function(t){},G.prototype.copy=function(){},G.prototype.getY=function(t){},G.prototype.toCoordinateArray=function(){},G.prototype.interfaces_=function(){return[b]},G.prototype.getClass=function(){return G},Object.defineProperties(G,z);var V=function(){},j=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(V),W=function(){};W.arraycopy=function(t,e,n,i,r){for(var o=0,s=e;s<e+r;s++)n[i+o]=t[s],o++},W.getProperty=function(t){return{"line.separator":"\n"}[t]};var H=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this.x=n,this.y=i,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var r=arguments[0],o=arguments[1];this.x=r.y*o.w-o.y*r.w,this.y=o.x*r.w-r.x*o.w,this.w=r.x*o.y-o.x*r.y}else if(arguments[0]instanceof x&&arguments[1]instanceof x){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var A=arguments[0],u=arguments[1],l=arguments[2];this.x=A,this.y=u,this.w=l}else if(4===arguments.length){var c=arguments[0],h=arguments[1],f=arguments[2],p=arguments[3],d=c.y-h.y,g=h.x-c.x,_=c.x*h.y-h.x*c.y,m=f.y-p.y,y=p.x-f.x,v=f.x*p.y-p.x*f.y;this.x=g*v-y*_,this.y=m*_-d*v,this.w=d*y-m*g}};H.prototype.getY=function(){var t=this.y/this.w;if(y.isNaN(t)||y.isInfinite(t))throw new j;return t},H.prototype.getX=function(){var t=this.x/this.w;if(y.isNaN(t)||y.isInfinite(t))throw new j;return t},H.prototype.getCoordinate=function(){var t=new x;return t.x=this.getX(),t.y=this.getY(),t},H.prototype.interfaces_=function(){return[]},H.prototype.getClass=function(){return H},H.intersection=function(t,e,n,i){var r=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-i.y,A=i.x-n.x,u=n.x*i.y-i.x*n.y,l=r*A-a*o,c=(o*u-A*s)/l,h=(a*s-r*u)/l;if(y.isNaN(c)||y.isInfinite(c)||y.isNaN(h)||y.isInfinite(h))throw new j;return new x(c,h)};var X=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof x){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],A=arguments[3];this.init(o,s,a,A)}},Y={serialVersionUID:{configurable:!0}};X.prototype.getArea=function(){return this.getWidth()*this.getHeight()},X.prototype.equals=function(t){if(!(t instanceof X))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},X.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new X;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,i=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new X(e,i,n,r)},X.prototype.isNull=function(){return this._maxx<this._minx},X.prototype.getMaxX=function(){return this._maxx},X.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof x){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof X){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&i>=this._miny&&i<=this._maxy}},X.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof X){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof x){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&!(n>this._maxx||n<this._minx||i>this._maxy||i<this._miny)}},X.prototype.getMinY=function(){return this._miny},X.prototype.getMinX=function(){return this._minx},X.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof x){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof X){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=i,this._maxy=i):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),i<this._miny&&(this._miny=i),i>this._maxy&&(this._maxy=i))}},X.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},X.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},X.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},X.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},X.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},X.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},X.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},X.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},X.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},X.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof X){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof x){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.covers(n,i)}},X.prototype.centre=function(){return this.isNull()?null:new x((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},X.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof x){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof X){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];r<o?(this._minx=r,this._maxx=o):(this._minx=o,this._maxx=r),s<a?(this._miny=s,this._maxy=a):(this._miny=a,this._maxy=s)}},X.prototype.getMaxY=function(){return this._maxy},X.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},X.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+x.hashCode(this._minx))+x.hashCode(this._maxx))+x.hashCode(this._miny))+x.hashCode(this._maxy)},X.prototype.interfaces_=function(){return[E,e]},X.prototype.getClass=function(){return X},X.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),A=Math.max(o.x,s.x),u=Math.min(i.x,r.x),l=Math.max(i.x,r.x);return!(u>A||l<a||(a=Math.min(o.y,s.y),A=Math.max(o.y,s.y),u=Math.min(i.y,r.y),l=Math.max(i.y,r.y),u>A||l<a))}},Y.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(X,Y);var q={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Q=function(t){this.geometryFactory=t||new _e};Q.prototype.read=function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=q.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=q.emptyTypeStr.exec(t))[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],K[n]&&(e=K[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},Q.prototype.write=function(t){return this.extractGeometry(t)},Q.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!$[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+$[e].apply(this,[t])+")"};var $={coordinate:function(t){return t.x+" "+t.y},point:function(t){return $.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+$.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push($.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push($.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+$.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+$.linestring.apply(this,[t._shell])+")");for(var n=0,i=t._holes.length;n<i;++n)e.push("("+$.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+$.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},K={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(q.spaces);return this.geometryFactory.createPoint(new x(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(q.trimParens,"$1"),i.push(K.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(q.spaces),i.push(new x(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(q.spaces),i.push(new x(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(q.parenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(q.trimParens,"$1"),i.push(K.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,i,r,o=t.trim().split(q.parenComma),s=[],a=0,A=o.length;a<A;++a)e=o[a].replace(q.trimParens,"$1"),n=K.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n._points),0===a?r=i:s.push(i);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(q.doubleParenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(q.trimParens,"$1"),i.push(K.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],i=0,r=e.length;i<r;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}},Z=function(t){this.parser=new Q(t)};Z.prototype.write=function(t){return this.parser.write(t)},Z.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var J=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),tt=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(J),et=function(){};et.prototype.interfaces_=function(){return[]},et.prototype.getClass=function(){return et},et.shouldNeverReachHere=function(){if(0===arguments.length)et.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new tt("Should never reach here"+(null!==t?": "+t:""))}},et.isTrue=function(){var t,e;if(1===arguments.length)t=arguments[0],et.isTrue(t,null);else if(2===arguments.length&&(e=arguments[1],!(t=arguments[0])))throw null===e?new tt:new tt(e)},et.equals=function(){var t,e,n;if(2===arguments.length)t=arguments[0],e=arguments[1],et.equals(t,e,null);else if(3===arguments.length&&(t=arguments[0],n=arguments[2],!(e=arguments[1]).equals(t)))throw new tt("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};var nt=function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new x,this._intPt[1]=new x,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},it={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};nt.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},nt.prototype.getTopologySummary=function(){var t=new N;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},nt.prototype.computeIntersection=function(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)},nt.prototype.getIntersectionNum=function(){return this._result},nt.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},nt.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},nt.prototype.setPrecisionModel=function(t){this._precisionModel=t},nt.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},nt.prototype.getIntersection=function(t){return this._intPt[t]},nt.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},nt.prototype.hasIntersection=function(){return this._result!==nt.NO_INTERSECTION},nt.prototype.getEdgeDistance=function(t,e){return nt.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},nt.prototype.isCollinear=function(){return this._result===nt.COLLINEAR_INTERSECTION},nt.prototype.toString=function(){return Z.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Z.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},nt.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},nt.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},nt.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},nt.prototype.interfaces_=function(){return[]},nt.prototype.getClass=function(){return nt},nt.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=i>r?i:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=i>r?s:a)||t.equals(e)||(o=Math.max(s,a))}return et.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},nt.nonRobustComputeEdgeDistance=function(t,e,n){var i=t.x-e.x,r=t.y-e.y,o=Math.sqrt(i*i+r*r);return et.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},it.DONT_INTERSECT.get=function(){return 0},it.DO_INTERSECT.get=function(){return 1},it.COLLINEAR.get=function(){return 2},it.NO_INTERSECTION.get=function(){return 0},it.POINT_INTERSECTION.get=function(){return 1},it.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(nt,it);var rt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new X(this._inputLines[0][0],this._inputLines[0][1]),n=new X(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],n=arguments[1],i=arguments[2];if(this._isProper=!1,X.intersects(n,i,e)&&0===at.orientationIndex(n,i,e)&&0===at.orientationIndex(i,n,e))return this._isProper=!0,(e.equals(n)||e.equals(i))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},e.prototype.safeHCoordinateIntersection=function(t,n,i,r){var o=null;try{o=H.intersection(t,n,i,r)}catch(s){if(!(s instanceof j))throw s;o=e.nearestEndpoint(t,n,i,r)}return o},e.prototype.intersection=function(t,n,i,r){var o=this.intersectionWithNormalization(t,n,i,r);return this.isInSegmentEnvelopes(o)||(o=new x(e.nearestEndpoint(t,n,i,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(o),o},e.prototype.smallestInAbsValue=function(t,e,n,i){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(n)<o&&(r=n,o=Math.abs(n)),Math.abs(i)<o&&(r=i),r},e.prototype.checkDD=function(t,e,n,i,r){var o=B.intersection(t,e,n,i),s=this.isInSegmentEnvelopes(o);W.out.println("DD in env = "+s+"  --------------------- "+o),r.distance(o)>1e-4&&W.out.println("Distance = "+r.distance(o))},e.prototype.intersectionWithNormalization=function(t,e,n,i){var r=new x(t),o=new x(e),s=new x(n),a=new x(i),A=new x;this.normalizeToEnvCentre(r,o,s,a,A);var u=this.safeHCoordinateIntersection(r,o,s,a);return u.x+=A.x,u.y+=A.y,u},e.prototype.computeCollinearIntersection=function(e,n,i,r){var o=X.intersects(e,n,i),s=X.intersects(e,n,r),a=X.intersects(i,r,e),A=X.intersects(i,r,n);return o&&s?(this._intPt[0]=i,this._intPt[1]=r,t.COLLINEAR_INTERSECTION):a&&A?(this._intPt[0]=e,this._intPt[1]=n,t.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||s||A?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&A?(this._intPt[0]=i,this._intPt[1]=n,!i.equals(n)||s||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||o||A?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&A?(this._intPt[0]=r,this._intPt[1]=n,!r.equals(n)||o||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,n,i,r){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,A=t.y>e.y?t.y:e.y,u=n.x<i.x?n.x:i.x,l=n.y<i.y?n.y:i.y,c=n.x>i.x?n.x:i.x,h=n.y>i.y?n.y:i.y,f=((o>u?o:u)+(a<c?a:c))/2,p=((s>l?s:l)+(A<h?A:h))/2;r.x=f,r.y=p,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},e.prototype.computeIntersect=function(e,n,i,r){if(this._isProper=!1,!X.intersects(e,n,i,r))return t.NO_INTERSECTION;var o=at.orientationIndex(e,n,i),s=at.orientationIndex(e,n,r);if(o>0&&s>0||o<0&&s<0)return t.NO_INTERSECTION;var a=at.orientationIndex(i,r,e),A=at.orientationIndex(i,r,n);return a>0&&A>0||a<0&&A<0?t.NO_INTERSECTION:0===o&&0===s&&0===a&&0===A?this.computeCollinearIntersection(e,n,i,r):(0===o||0===s||0===a||0===A?(this._isProper=!1,e.equals2D(i)||e.equals2D(r)?this._intPt[0]=e:n.equals2D(i)||n.equals2D(r)?this._intPt[0]=n:0===o?this._intPt[0]=new x(i):0===s?this._intPt[0]=new x(r):0===a?this._intPt[0]=new x(e):0===A&&(this._intPt[0]=new x(n))):(this._isProper=!0,this._intPt[0]=this.intersection(e,n,i,r)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,n,i){var r=t,o=at.distancePointLine(t,n,i),s=at.distancePointLine(e,n,i);return s<o&&(o=s,r=e),(s=at.distancePointLine(n,t,e))<o&&(o=s,r=n),(s=at.distancePointLine(i,t,e))<o&&(o=s,r=i),r},e}(nt),ot=function(){};ot.prototype.interfaces_=function(){return[]},ot.prototype.getClass=function(){return ot},ot.orientationIndex=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-e.x,s=n.y-e.y;return ot.signOfDet2x2(i,r,o,s)},ot.signOfDet2x2=function(t,e,n,i){var r=null,o=null,s=null;if(r=1,0===t||0===i)return 0===e||0===n?0:e>0?n>0?-r:r:n>0?r:-r;if(0===e||0===n)return i>0?t>0?r:-r:t>0?-r:r;if(e>0?i>0?e<=i||(r=-r,o=t,t=n,n=o,o=e,e=i,i=o):e<=-i?(r=-r,n=-n,i=-i):(o=t,t=-n,n=o,o=e,e=-i,i=o):i>0?-e<=i?(r=-r,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=i,i=o):e>=i?(t=-t,e=-e,n=-n,i=-i):(r=-r,o=-t,t=-n,n=o,o=-e,e=-i,i=o),t>0){if(!(n>0))return r;if(!(t<=n))return r}else{if(n>0)return-r;if(!(t>=n))return-r;r=-r,t=-t,n=-n}for(;;){if((i-=(s=Math.floor(n/t))*e)<0)return-r;if(i>e)return r;if(t>(n-=s*t)+n){if(e<i+i)return r}else{if(e>i+i)return-r;n=t-n,i=e-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if((e-=(s=Math.floor(t/n))*i)<0)return r;if(e>i)return-r;if(n>(t-=s*n)+t){if(i<e+e)return-r}else{if(i>e+e)return r;t=n-t,e=i-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};var st=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};st.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,o=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,A=ot.signOfDet2x2(r,o,s,a);if(0===A)return this._isPointOnSegment=!0,null;a<o&&(A=-A),A>0&&this._crossingCount++}},st.prototype.isPointInPolygon=function(){return this.getLocation()!==I.EXTERIOR},st.prototype.getLocation=function(){return this._isPointOnSegment?I.BOUNDARY:this._crossingCount%2==1?I.INTERIOR:I.EXTERIOR},st.prototype.isOnSegment=function(){return this._isPointOnSegment},st.prototype.interfaces_=function(){return[]},st.prototype.getClass=function(){return st},st.locatePointInRing=function(){if(arguments[0]instanceof x&&P(arguments[1],G)){for(var t=arguments[1],e=new st(arguments[0]),n=new x,i=new x,r=1;r<t.size();r++)if(t.getCoordinate(r,n),t.getCoordinate(r-1,i),e.countSegment(n,i),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof x&&arguments[1]instanceof Array){for(var o=arguments[1],s=new st(arguments[0]),a=1;a<o.length;a++){var A=o[a],u=o[a-1];if(s.countSegment(A,u),s.isOnSegment())return s.getLocation()}return s.getLocation()}};var at=function(){},At={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};at.prototype.interfaces_=function(){return[]},at.prototype.getClass=function(){return at},at.orientationIndex=function(t,e,n){return B.orientationIndex(t,e,n)},at.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var r=t[i].x-n,o=t[i+1].y;e+=r*(t[i-1].y-o)}return e/2}if(P(arguments[0],G)){var s=arguments[0],a=s.size();if(a<3)return 0;var A=new x,u=new x,l=new x;s.getCoordinate(0,u),s.getCoordinate(1,l);var c=u.x;l.x-=c;for(var h=0,f=1;f<a-1;f++)A.y=u.y,u.x=l.x,u.y=l.y,s.getCoordinate(f+1,l),l.x-=c,h+=u.x*(A.y-l.y);return h/2}},at.distanceLineLine=function(t,e,n,i){if(t.equals(e))return at.distancePointLine(t,n,i);if(n.equals(i))return at.distancePointLine(i,t,e);var r=!1;if(X.intersects(t,e,n,i)){var o=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===o)r=!0;else{var s=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,A=s/o;(A<0||A>1||a<0||a>1)&&(r=!0)}}else r=!0;return r?M.min(at.distancePointLine(t,n,i),at.distancePointLine(e,n,i),at.distancePointLine(n,t,e),at.distancePointLine(i,t,e)):0},at.isPointInRing=function(t,e){return at.locatePointInRing(t,e)!==I.EXTERIOR},at.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,i=new x;t.getCoordinate(0,i);for(var r=i.x,o=i.y,s=1;s<e;s++){t.getCoordinate(s,i);var a=i.x,A=i.y,u=a-r,l=A-o;n+=Math.sqrt(u*u+l*l),r=a,o=A}return n},at.isCCW=function(t){var e=t.length-1;if(e<3)throw new m("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],i=0,r=1;r<=e;r++){var o=t[r];o.y>n.y&&(n=o,i=r)}var s=i;do{(s-=1)<0&&(s=e)}while(t[s].equals2D(n)&&s!==i);var a=i;do{a=(a+1)%e}while(t[a].equals2D(n)&&a!==i);var A=t[s],u=t[a];if(A.equals2D(n)||u.equals2D(n)||A.equals2D(u))return!1;var l=at.computeOrientation(A,n,u);return 0===l?A.x>u.x:l>0},at.locatePointInRing=function(t,e){return st.locatePointInRing(t,e)},at.distancePointLinePerpendicular=function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)},at.computeOrientation=function(t,e,n){return at.orientationIndex(t,e,n)},at.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new m("Line array must contain at least one vertex");for(var n=t.distance(e[0]),i=0;i<e.length-1;i++){var r=at.distancePointLine(t,e[i],e[i+1]);r<n&&(n=r)}return n}if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return o.distance(s);var A=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),u=((o.x-s.x)*(a.x-s.x)+(o.y-s.y)*(a.y-s.y))/A;if(u<=0)return o.distance(s);if(u>=1)return o.distance(a);var l=((s.y-o.y)*(a.x-s.x)-(s.x-o.x)*(a.y-s.y))/A;return Math.abs(l)*Math.sqrt(A)}},at.isOnLine=function(t,e){for(var n=new rt,i=1;i<e.length;i++){var r=e[i-1],o=e[i];if(n.computeIntersection(t,r,o),n.hasIntersection())return!0}return!1},At.CLOCKWISE.get=function(){return-1},At.RIGHT.get=function(){return at.CLOCKWISE},At.COUNTERCLOCKWISE.get=function(){return 1},At.LEFT.get=function(){return at.COUNTERCLOCKWISE},At.COLLINEAR.get=function(){return 0},At.STRAIGHT.get=function(){return at.COLLINEAR},Object.defineProperties(at,At);var ut=function(){};ut.prototype.filter=function(t){},ut.prototype.interfaces_=function(){return[]},ut.prototype.getClass=function(){return ut};var lt=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},ct={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};lt.prototype.isGeometryCollection=function(){return this.getSortIndex()===lt.SORTINDEX_GEOMETRYCOLLECTION},lt.prototype.getFactory=function(){return this._factory},lt.prototype.getGeometryN=function(t){return this},lt.prototype.getArea=function(){return 0},lt.prototype.isRectangle=function(){return!1},lt.prototype.equals=function(){if(arguments[0]instanceof lt){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof lt))return!1;var n=e;return this.equalsExact(n)}},lt.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},lt.prototype.geometryChanged=function(){this.apply(lt.geometryChangedFilter)},lt.prototype.geometryChangedAction=function(){this._envelope=null},lt.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},lt.prototype.getLength=function(){return 0},lt.prototype.getNumGeometries=function(){return 1},lt.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,i)}},lt.prototype.getUserData=function(){return this._userData},lt.prototype.getSRID=function(){return this._SRID},lt.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},lt.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===lt.SORTINDEX_GEOMETRYCOLLECTION)throw new m("This method does not support GeometryCollection arguments")},lt.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},lt.prototype.norm=function(){var t=this.copy();return t.normalize(),t},lt.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},lt.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new X(this._envelope)},lt.prototype.setSRID=function(t){this._SRID=t},lt.prototype.setUserData=function(t){this._userData=t},lt.prototype.compare=function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),o=i.next(),s=r.compareTo(o);if(0!==s)return s}return n.hasNext()?1:i.hasNext()?-1:0},lt.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},lt.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===lt.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===lt.SORTINDEX_MULTIPOINT||this.getSortIndex()===lt.SORTINDEX_MULTILINESTRING||this.getSortIndex()===lt.SORTINDEX_MULTIPOLYGON},lt.prototype.interfaces_=function(){return[b,E,e]},lt.prototype.getClass=function(){return lt},lt.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},lt.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},ct.serialVersionUID.get=function(){return 0x799ea46522854c00},ct.SORTINDEX_POINT.get=function(){return 0},ct.SORTINDEX_MULTIPOINT.get=function(){return 1},ct.SORTINDEX_LINESTRING.get=function(){return 2},ct.SORTINDEX_LINEARRING.get=function(){return 3},ct.SORTINDEX_MULTILINESTRING.get=function(){return 4},ct.SORTINDEX_POLYGON.get=function(){return 5},ct.SORTINDEX_MULTIPOLYGON.get=function(){return 6},ct.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},ct.geometryChangedFilter.get=function(){return ht},Object.defineProperties(lt,ct);var ht=function(){};ht.interfaces_=function(){return[ut]},ht.filter=function(t){t.geometryChangedAction()};var ft=function(){};ft.prototype.filter=function(t){},ft.prototype.interfaces_=function(){return[]},ft.prototype.getClass=function(){return ft};var pt=function(){},dt={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};pt.prototype.isInBoundary=function(t){},pt.prototype.interfaces_=function(){return[]},pt.prototype.getClass=function(){return pt},dt.Mod2BoundaryNodeRule.get=function(){return gt},dt.EndPointBoundaryNodeRule.get=function(){return _t},dt.MultiValentEndPointBoundaryNodeRule.get=function(){return mt},dt.MonoValentEndPointBoundaryNodeRule.get=function(){return yt},dt.MOD2_BOUNDARY_RULE.get=function(){return new gt},dt.ENDPOINT_BOUNDARY_RULE.get=function(){return new _t},dt.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new mt},dt.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new yt},dt.OGC_SFS_BOUNDARY_RULE.get=function(){return pt.MOD2_BOUNDARY_RULE},Object.defineProperties(pt,dt);var gt=function(){};gt.prototype.isInBoundary=function(t){return t%2==1},gt.prototype.interfaces_=function(){return[pt]},gt.prototype.getClass=function(){return gt};var _t=function(){};_t.prototype.isInBoundary=function(t){return t>0},_t.prototype.interfaces_=function(){return[pt]},_t.prototype.getClass=function(){return _t};var mt=function(){};mt.prototype.isInBoundary=function(t){return t>1},mt.prototype.interfaces_=function(){return[pt]},mt.prototype.getClass=function(){return mt};var yt=function(){};yt.prototype.isInBoundary=function(t){return 1===t},yt.prototype.interfaces_=function(){return[pt]},yt.prototype.getClass=function(){return yt};var vt=function(){};vt.prototype.add=function(){},vt.prototype.addAll=function(){},vt.prototype.isEmpty=function(){},vt.prototype.iterator=function(){},vt.prototype.size=function(){},vt.prototype.toArray=function(){},vt.prototype.remove=function(){},(n.prototype=new Error).name="IndexOutOfBoundsException";var Et=function(){};Et.prototype.hasNext=function(){},Et.prototype.next=function(){},Et.prototype.remove=function(){};var bt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(vt);(i.prototype=new Error).name="NoSuchElementException";var wt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof vt&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,vt]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},e.prototype.iterator=function(){return new xt(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new n;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;n<i;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},e}(bt),xt=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new i;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(Et),St=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.ensureCapacity(n.length),this.add(n,i)}}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){if(2===arguments.length){for(var e=arguments[1],n=!1,i=arguments[0].iterator();i.hasNext();)this.add(i.next(),e),n=!0;return n}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),n=0;n<this.size();n++)e.add(n,this.get(n).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){if(1===arguments.length){var e=arguments[0];t.prototype.add.call(this,e)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var n=arguments[0],i=arguments[1];return this.add(n,i,!0),!0}if(arguments[0]instanceof x&&"boolean"==typeof arguments[1]){var r=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(r))return null;t.prototype.add.call(this,r)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1];return this.add(o,s),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var a=arguments[0],A=arguments[1];if(arguments[2])for(var u=0;u<a.length;u++)this.add(a[u],A);else for(var l=a.length-1;l>=0;l--)this.add(a[l],A);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof x){var c=arguments[0],h=arguments[1];if(!arguments[2]){var f=this.size();if(f>0){if(c>0&&this.get(c-1).equals2D(h))return null;if(c<f&&this.get(c).equals2D(h))return null}}t.prototype.add.call(this,c,h)}}else if(4===arguments.length){var p=arguments[0],d=arguments[1],g=arguments[2],_=arguments[3],m=1;g>_&&(m=-1);for(var y=g;y!==_;y+=m)this.add(p[y],d);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new x(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(wt),Ct=function(){},Tt={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Tt.ForwardComparator.get=function(){return It},Tt.BidirectionalComparator.get=function(){return Rt},Tt.coordArrayType.get=function(){return new Array(0).fill(null)},Ct.prototype.interfaces_=function(){return[]},Ct.prototype.getClass=function(){return Ct},Ct.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},Ct.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(Ct.indexOf(i,e)<0)return i}return null},Ct.scroll=function(t,e){var n=Ct.indexOf(e,t);if(n<0)return null;var i=new Array(t.length).fill(null);W.arraycopy(t,n,i,0,t.length-n),W.arraycopy(t,0,i,t.length-n,n),W.arraycopy(i,0,t,0,t.length)},Ct.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(var s=0;s<i.length;s++)if(0!==o.compare(i[s],r[s]))return!1;return!0}},Ct.intersection=function(t,e){for(var n=new St,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()},Ct.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Ct.removeRepeatedPoints=function(t){return Ct.hasRepeatedPoints(t)?new St(t,!1).toCoordinateArray():t},Ct.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;i<=n;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}},Ct.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;for(var r=0,o=0;o<t.length;o++)null!==t[o]&&(i[r++]=t[o]);return i},Ct.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new x(t[n]);return e}if(5===arguments.length)for(var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],A=0;A<a;A++)o[s+A]=new x(i[r+A])},Ct.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0},Ct.envelope=function(t){for(var e=new X,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Ct.toCoordinateArray=function(t){return t.toArray(Ct.coordArrayType)},Ct.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Ct.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Ct.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1},Ct.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0},Ct.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},Ct.extract=function(t,e,n){e=M.clamp(e,0,t.length);var i=(n=M.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var o=0,s=e;s<=n;s++)r[o++]=t[s];return r},Object.defineProperties(Ct,Tt);var It=function(){};It.prototype.compare=function(t,e){return Ct.compare(t,e)},It.prototype.interfaces_=function(){return[w]},It.prototype.getClass=function(){return It};var Rt=function(){};Rt.prototype.compare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=Ct.compare(n,i);return Ct.isEqualReversed(n,i)?0:r},Rt.prototype.OLDcompare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=Ct.increasingDirection(n),o=Ct.increasingDirection(i),s=r>0?0:n.length-1,a=o>0?0:n.length-1,A=0;A<n.length;A++){var u=n[s].compareTo(i[a]);if(0!==u)return u;s+=r,a+=o}return 0},Rt.prototype.interfaces_=function(){return[w]},Rt.prototype.getClass=function(){return Rt};var Pt=function(){};Pt.prototype.get=function(){},Pt.prototype.put=function(){},Pt.prototype.size=function(){},Pt.prototype.values=function(){},Pt.prototype.entrySet=function(){};var Mt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Pt);(r.prototype=new Error).name="OperationNotSupported",(o.prototype=new vt).contains=function(){};var Lt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof vt&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Nt(this)},e}(o),Nt=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new i;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new r},e}(Et),Ot=0;(c.prototype=new Mt).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},c.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Ot,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do{if(n=r,(i=t.compareTo(r.key))<0)r=r.left;else{if(!(i>0)){var o=r.value;return r.value=e,o}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:n,color:Ot,getValue:function(){return this.value},getKey:function(){return this.key}};return i<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},c.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(a(t)===u(a(a(t)))){var e=l(a(a(t)));1===s(e)?(A(a(t),Ot),A(e,Ot),A(a(a(t)),1),t=a(a(t))):(t===l(a(t))&&(t=a(t),this.rotateLeft(t)),A(a(t),Ot),A(a(a(t)),1),this.rotateRight(a(a(t))))}else{var n=u(a(a(t)));1===s(n)?(A(a(t),Ot),A(n,Ot),A(a(a(t)),1),t=a(a(t))):(t===u(a(t))&&(t=a(t),this.rotateRight(t)),A(a(t),Ot),A(a(a(t)),1),this.rotateLeft(a(a(t))))}this.root_.color=Ot},c.prototype.values=function(){var t=new wt,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=c.successor(e));)t.add(e.value);return t},c.prototype.entrySet=function(){var t=new Lt,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=c.successor(e));)t.add(e);return t},c.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},c.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},c.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},c.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,i=t;null!==n&&i===n.right;)i=n,n=n.parent;return n},c.prototype.size=function(){return this.size_};var Dt=function(){};Dt.prototype.interfaces_=function(){return[]},Dt.prototype.getClass=function(){return Dt},h.prototype=new o,(f.prototype=new h).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},f.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},f.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},f.prototype.remove=function(t){throw new r},f.prototype.size=function(){return this.array_.length},f.prototype.isEmpty=function(){return 0===this.array_.length},f.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},f.prototype.iterator=function(){return new Ft(this)};var Ft=function(t){this.treeSet_=t,this.position_=0};Ft.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new i;return this.treeSet_.array_[this.position_++]},Ft.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Ft.prototype.remove=function(){throw new r};var kt=function(){};kt.sort=function(){var t,e,n,i,r=arguments[0];if(1===arguments.length)i=function(t,e){return t.compareTo(e)},r.sort(i);else if(2===arguments.length)n=arguments[1],i=function(t,e){return n.compare(t,e)},r.sort(i);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],i=function(t,e){return n.compare(t,e)},e.sort(i),o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])},kt.asList=function(t){for(var e=new wt,n=0,i=t.length;n<i;n++)e.add(t[n]);return e};var Bt=function(){},Ut={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Ut.P.get=function(){return 0},Ut.L.get=function(){return 1},Ut.A.get=function(){return 2},Ut.FALSE.get=function(){return-1},Ut.TRUE.get=function(){return-2},Ut.DONTCARE.get=function(){return-3},Ut.SYM_FALSE.get=function(){return"F"},Ut.SYM_TRUE.get=function(){return"T"},Ut.SYM_DONTCARE.get=function(){return"*"},Ut.SYM_P.get=function(){return"0"},Ut.SYM_L.get=function(){return"1"},Ut.SYM_A.get=function(){return"2"},Bt.prototype.interfaces_=function(){return[]},Bt.prototype.getClass=function(){return Bt},Bt.toDimensionSymbol=function(t){switch(t){case Bt.FALSE:return Bt.SYM_FALSE;case Bt.TRUE:return Bt.SYM_TRUE;case Bt.DONTCARE:return Bt.SYM_DONTCARE;case Bt.P:return Bt.SYM_P;case Bt.L:return Bt.SYM_L;case Bt.A:return Bt.SYM_A}throw new m("Unknown dimension value: "+t)},Bt.toDimensionValue=function(t){switch(D.toUpperCase(t)){case Bt.SYM_FALSE:return Bt.FALSE;case Bt.SYM_TRUE:return Bt.TRUE;case Bt.SYM_DONTCARE:return Bt.DONTCARE;case Bt.SYM_P:return Bt.P;case Bt.SYM_L:return Bt.L;case Bt.SYM_A:return Bt.A}throw new m("Unknown dimension symbol: "+t)},Object.defineProperties(Bt,Ut);var Gt=function(){};Gt.prototype.filter=function(t){},Gt.prototype.interfaces_=function(){return[]},Gt.prototype.getClass=function(){return Gt};var zt=function(){};zt.prototype.filter=function(t,e){},zt.prototype.isDone=function(){},zt.prototype.isGeometryChanged=function(){},zt.prototype.interfaces_=function(){return[]},zt.prototype.getClass=function(){return zt};var Vt=function(t){function e(e,n){if(t.call(this,n),this._geometries=e||[],t.hasNullElements(this._geometries))throw new m("geometries must not contain null elements")}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new X,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var i=this._geometries[n].getCoordinates(),r=0;r<i.length;r++)t[++e]=i[r];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e;if(this._geometries.length!==i._geometries.length)return!1;for(var r=0;r<this._geometries.length;r++)if(!this._geometries[r].equalsExact(i._geometries[r],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();kt.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=Bt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=Bt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new f(kt.asList(this._geometries)),n=new f(kt.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var i=arguments[1],r=arguments[0],o=this.getNumGeometries(),s=r.getNumGeometries(),a=0;a<o&&a<s;){var A=this.getGeometryN(a),u=r.getGeometryN(a),l=A.compareToSameClass(u,i);if(0!==l)return l;a++}return a<o?1:a<s?-1:0}},e.prototype.apply=function(){if(P(arguments[0],ft))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(P(arguments[0],zt)){var n=arguments[0];if(0===this._geometries.length)return null;for(var i=0;i<this._geometries.length&&(this._geometries[i].apply(n),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(P(arguments[0],Gt)){var r=arguments[0];r.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(r)}else if(P(arguments[0],ut)){var s=arguments[0];s.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(s)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),et.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var n=0;n<this._geometries.length;n++)e._geometries[n]=this._geometries[n].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,n),e}(lt),jt=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return lt.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Bt.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new Wt(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Dt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,n),e}(Vt),Wt=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=pt.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=i}};Wt.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},Wt.prototype.getBoundary=function(){return this._geom instanceof Qt?this.boundaryLineString(this._geom):this._geom instanceof jt?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Wt.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},Wt.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Wt.prototype.computeBoundaryCoordinates=function(t){var e=new wt;this._endpointMap=new c;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var o=r.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return Ct.toCoordinateArray(e)},Wt.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new Ht,this._endpointMap.put(t,e)),e.count++},Wt.prototype.interfaces_=function(){return[]},Wt.prototype.getClass=function(){return Wt},Wt.getBoundary=function(){return 1===arguments.length?new Wt(arguments[0]).getBoundary():2===arguments.length?new Wt(arguments[0],arguments[1]).getBoundary():void 0};var Ht=function(){this.count=null};Ht.prototype.interfaces_=function(){return[]},Ht.prototype.getClass=function(){return Ht};var Xt=function(){},Yt={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Xt.prototype.interfaces_=function(){return[]},Xt.prototype.getClass=function(){return Xt},Xt.chars=function(t,e){for(var n=new Array(e).fill(null),i=0;i<e;i++)n[i]=t;return String(n)},Xt.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},n=new function(){}(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o="",s=new function(){}(new function(){}(Xt.getStackTrace(i))),a=0;a<r;a++)try{o+=s.readLine()+Xt.NEWLINE}catch(t){if(!(t instanceof p))throw t;et.shouldNeverReachHere()}return o}},Xt.split=function(t,e){for(var n=e.length,i=new wt,r=""+t,o=r.indexOf(e);o>=0;){var s=r.substring(0,o);i.add(s),o=(r=r.substring(o+n)).indexOf(e)}r.length>0&&i.add(r);for(var a=new Array(i.size()).fill(null),A=0;A<a.length;A++)a[A]=i.get(A);return a},Xt.toString=function(){if(1===arguments.length){var t=arguments[0];return Xt.SIMPLE_ORDINATE_FORMAT.format(t)}},Xt.spaces=function(t){return Xt.chars(" ",t)},Yt.NEWLINE.get=function(){return W.getProperty("line.separator")},Yt.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(Xt,Yt);var qt=function(){};qt.prototype.interfaces_=function(){return[]},qt.prototype.getClass=function(){return qt},qt.copyCoord=function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),o=0;o<r;o++)n.setOrdinate(i,o,t.getOrdinate(e,o))},qt.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,G.X)===t.getOrdinate(e-1,G.X)&&t.getOrdinate(0,G.Y)===t.getOrdinate(e-1,G.Y)},qt.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),r=0;r<n;r++)for(var o=0;o<i;o++){var s=t.getOrdinate(r,o),a=e.getOrdinate(r,o);if(!(t.getOrdinate(r,o)===e.getOrdinate(r,o)||y.isNaN(s)&&y.isNaN(a)))return!1}return!0},qt.extend=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();if(qt.copy(e,0,i,0,r),r>0)for(var o=r;o<n;o++)qt.copy(e,r-1,i,o,1);return i},qt.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;i<=n;i++)qt.swap(t,i,e-i)},qt.swap=function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}},qt.copy=function(t,e,n,i,r){for(var o=0;o<r;o++)qt.copyCoord(t,e+o,n,i+o)},qt.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),i=new N;i.append("(");for(var r=0;r<e;r++){r>0&&i.append(" ");for(var o=0;o<n;o++)o>0&&i.append(","),i.append(Xt.toString(t.getOrdinate(r,o)))}return i.append(")"),i.toString()}},qt.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?qt.createClosedRing(t,e,4):e.getOrdinate(0,G.X)===e.getOrdinate(n-1,G.X)&&e.getOrdinate(0,G.Y)===e.getOrdinate(n-1,G.Y)?e:qt.createClosedRing(t,e,n+1)},qt.createClosedRing=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();qt.copy(e,0,i,0,r);for(var o=r;o<n;o++)qt.copy(e,0,i,o,1);return i};var Qt=function(t){function e(e,n){t.call(this,n),this._points=null,this.init(e)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new X:this._points.expandEnvelope(new X)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e;if(this._points.size()!==i._points.size())return!1;for(var r=0;r<this._points.size();r++)if(!this.equal(this._points.getCoordinate(r),i._points.getCoordinate(r),n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0&&qt.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Bt.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return at.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return qt.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var i=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var r=arguments[0];return arguments[1].compare(this._points,r._points)}},e.prototype.apply=function(){if(P(arguments[0],ft))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(P(arguments[0],zt)){var n=arguments[0];if(0===this._points.size())return null;for(var i=0;i<this._points.size()&&(n.filter(this._points,i),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else(P(arguments[0],Gt)||P(arguments[0],ut))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new Wt(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new m("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Dt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(lt),$t=function(){};$t.prototype.interfaces_=function(){return[]},$t.prototype.getClass=function(){return $t};var Kt=function(t){function e(e,n){t.call(this,n),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new X;var t=new X;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),n))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return Bt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},e.prototype.apply=function(){if(P(arguments[0],ft)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(P(arguments[0],zt)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(P(arguments[0],Gt)||P(arguments[0],ut))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),et.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[$t]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,n),e}(lt),Zt=function(){};Zt.prototype.interfaces_=function(){return[]},Zt.prototype.getClass=function(){return Zt};var Jt=function(t){function e(e,n,i){if(t.call(this,i),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===n&&(n=[]),t.hasNullElements(n))throw new m("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(n))throw new m("shell is empty but holes are not");this._shell=e,this._holes=n}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];for(var r=0;r<this._holes.length;r++)for(var o=this._holes[r].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(at.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(at.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;var r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var A=t.getX(a),u=t.getY(a);if(A!==o==(u!==s))return!1;o=A,s=u}return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e,r=this._shell,o=i._shell;if(!r.equalsExact(o,n))return!1;if(this._holes.length!==i._holes.length)return!1;for(var s=0;s<this._holes.length;s++)if(!this._holes[s].equalsExact(i._holes[s],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);kt.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var i=new Array(e.getCoordinates().length-1).fill(null);W.arraycopy(e.getCoordinates(),0,i,0,i.length);var r=Ct.minCoordinate(e.getCoordinates());Ct.scroll(i,r),W.arraycopy(i,0,e.getCoordinates(),0,i.length),e.getCoordinates()[i.length]=i[0],at.isCCW(e.getCoordinates())===n&&Ct.reverse(e.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var i=arguments[1],r=arguments[0],o=this._shell,s=r._shell,a=o.compareToSameClass(s,i);if(0!==a)return a;for(var A=this.getNumInteriorRing(),u=r.getNumInteriorRing(),l=0;l<A&&l<u;){var c=this.getInteriorRingN(l),h=r.getInteriorRingN(l),f=c.compareToSameClass(h,i);if(0!==f)return f;l++}return l<A?1:l<u?-1:0}},e.prototype.apply=function(t){if(P(t,ft)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(P(t,zt)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(P(t,Gt))t.filter(this);else if(P(t,ut)){t.filter(this),this._shell.apply(t);for(var i=0;i<this._holes.length;i++)this._holes[i].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var n=0;n<this._holes.length;n++)e._holes[n]=this._holes[n].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),n=new Array(this._holes.length).fill(null),i=0;i<n.length;i++)n[i]=this._holes[i].copy();return new e(t,n,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[Zt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(lt),te=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return lt.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return Bt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[$t]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,n),e}(Vt),ee=function(t){function e(e,n){e instanceof x&&n instanceof _e&&(e=n.getCoordinateSequenceFactory().create(e)),t.call(this,e,n),this.validateConstruction()}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return lt.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return Bt.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return qt.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new m("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new m("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}(Qt),ne=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return lt.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new wt,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),i=0;i<n.getNumGeometries();i++)t.add(n.getGeometryN(i));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Zt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(Vt),ie=function(t){this._factory=t||null,this._isUserDataCopied=!1},re={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};ie.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},ie.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},ie.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof Vt?this.editGeometryCollection(t,e):t instanceof Jt?this.editPolygon(t,e):t instanceof Kt||t instanceof Qt?e.edit(t,this._factory):(et.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},ie.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),i=new wt,r=0;r<n.getNumGeometries();r++){var o=this.edit(n.getGeometryN(r),e);null===o||o.isEmpty()||i.add(o)}return n.getClass()===te?this._factory.createMultiPoint(i.toArray([])):n.getClass()===jt?this._factory.createMultiLineString(i.toArray([])):n.getClass()===ne?this._factory.createMultiPolygon(i.toArray([])):this._factory.createGeometryCollection(i.toArray([]))},ie.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this._factory.createPolygon();for(var r=new wt,o=0;o<n.getNumInteriorRing();o++){var s=this.edit(n.getInteriorRingN(o),e);null===s||s.isEmpty()||r.add(s)}return this._factory.createPolygon(i,r.toArray([]))},ie.prototype.interfaces_=function(){return[]},ie.prototype.getClass=function(){return ie},ie.GeometryEditorOperation=function(){},re.NoOpGeometryOperation.get=function(){return oe},re.CoordinateOperation.get=function(){return se},re.CoordinateSequenceOperation.get=function(){return ae},Object.defineProperties(ie,re);var oe=function(){};oe.prototype.edit=function(t,e){return t},oe.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},oe.prototype.getClass=function(){return oe};var se=function(){};se.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof ee?e.createLinearRing(n):t instanceof Qt?e.createLineString(n):t instanceof Kt?n.length>0?e.createPoint(n[0]):e.createPoint():t},se.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},se.prototype.getClass=function(){return se};var ae=function(){};ae.prototype.edit=function(t,e){return t instanceof ee?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Qt?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Kt?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},ae.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},ae.prototype.getClass=function(){return ae};var Ae=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new x}else if(P(arguments[0],G)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var i=0;i<this._coordinates.length;i++)this._coordinates[i]=n.getCoordinateCopy(i)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],o=arguments[1];this._coordinates=r,this._dimension=o,null===r&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],a=arguments[1];this._coordinates=new Array(s).fill(null),this._dimension=a;for(var A=0;A<s;A++)this._coordinates[A]=new x}},ue={serialVersionUID:{configurable:!0}};Ae.prototype.setOrdinate=function(t,e,n){switch(e){case G.X:this._coordinates[t].x=n;break;case G.Y:this._coordinates[t].y=n;break;case G.Z:this._coordinates[t].z=n;break;default:throw new m("invalid ordinateIndex")}},Ae.prototype.size=function(){return this._coordinates.length},Ae.prototype.getOrdinate=function(t,e){switch(e){case G.X:return this._coordinates[t].x;case G.Y:return this._coordinates[t].y;case G.Z:return this._coordinates[t].z}return y.NaN},Ae.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},Ae.prototype.getCoordinateCopy=function(t){return new x(this._coordinates[t])},Ae.prototype.getDimension=function(){return this._dimension},Ae.prototype.getX=function(t){return this._coordinates[t].x},Ae.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new Ae(t,this._dimension)},Ae.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},Ae.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new Ae(t,this._dimension)},Ae.prototype.toString=function(){if(this._coordinates.length>0){var t=new N(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},Ae.prototype.getY=function(t){return this._coordinates[t].y},Ae.prototype.toCoordinateArray=function(){return this._coordinates},Ae.prototype.interfaces_=function(){return[G,e]},Ae.prototype.getClass=function(){return Ae},ue.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Ae,ue);var le=function(){},ce={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};le.prototype.readResolve=function(){return le.instance()},le.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new Ae(arguments[0]);if(P(arguments[0],G))return new Ae(arguments[0])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];return e>3&&(e=3),e<2?new Ae(t):new Ae(t,e)}},le.prototype.interfaces_=function(){return[T,e]},le.prototype.getClass=function(){return le},le.instance=function(){return le.instanceObject},ce.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},ce.instanceObject.get=function(){return new le},Object.defineProperties(le,ce);var he=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new wt,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},e.prototype.entrySet=function(){var t=new Lt;return this.map_.entries().forEach((function(e){return t.add(e)})),t},e.prototype.size=function(){return this.map_.size()},e}(Pt),fe=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof de){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var i=arguments[0];this._modelType=i._modelType,this._scale=i._scale}},pe={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};fe.prototype.equals=function(t){if(!(t instanceof fe))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},fe.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new O(n).compareTo(new O(i))},fe.prototype.getScale=function(){return this._scale},fe.prototype.isFloating=function(){return this._modelType===fe.FLOATING||this._modelType===fe.FLOATING_SINGLE},fe.prototype.getType=function(){return this._modelType},fe.prototype.toString=function(){var t="UNKNOWN";return this._modelType===fe.FLOATING?t="Floating":this._modelType===fe.FLOATING_SINGLE?t="Floating-Single":this._modelType===fe.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},fe.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return y.isNaN(t)||this._modelType===fe.FLOATING_SINGLE?t:this._modelType===fe.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof x){var e=arguments[0];if(this._modelType===fe.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},fe.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===fe.FLOATING?t=16:this._modelType===fe.FLOATING_SINGLE?t=6:this._modelType===fe.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},fe.prototype.setScale=function(t){this._scale=Math.abs(t)},fe.prototype.interfaces_=function(){return[e,E]},fe.prototype.getClass=function(){return fe},fe.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},pe.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},pe.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(fe,pe);var de=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},ge={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};de.prototype.readResolve=function(){return de.nameToTypeMap.get(this._name)},de.prototype.toString=function(){return this._name},de.prototype.interfaces_=function(){return[e]},de.prototype.getClass=function(){return de},ge.serialVersionUID.get=function(){return-552860263173159e4},ge.nameToTypeMap.get=function(){return new he},Object.defineProperties(de,ge),fe.Type=de,fe.FIXED=new de("FIXED"),fe.FLOATING=new de("FLOATING"),fe.FLOATING_SINGLE=new de("FLOATING SINGLE");var _e=function t(){this._precisionModel=new fe,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?P(arguments[0],T)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof fe&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},me={serialVersionUID:{configurable:!0}};_e.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new x(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new x(t.getMinX(),t.getMinY()),new x(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new x(t.getMinX(),t.getMinY()),new x(t.getMinX(),t.getMaxY()),new x(t.getMaxX(),t.getMaxY()),new x(t.getMaxX(),t.getMinY()),new x(t.getMinX(),t.getMinY())]),null)},_e.prototype.createLineString=function(t){return t?t instanceof Array?new Qt(this.getCoordinateSequenceFactory().create(t),this):P(t,G)?new Qt(t,this):void 0:new Qt(this.getCoordinateSequenceFactory().create([]),this)},_e.prototype.createMultiLineString=function(){return 0===arguments.length?new jt(null,this):1===arguments.length?new jt(arguments[0],this):void 0},_e.prototype.buildGeometry=function(t){for(var e=null,n=!1,i=!1,r=t.iterator();r.hasNext();){var o=r.next(),s=o.getClass();null===e&&(e=s),s!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(_e.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof Jt)return this.createMultiPolygon(_e.toPolygonArray(t));if(a instanceof Qt)return this.createMultiLineString(_e.toLineStringArray(t));if(a instanceof Kt)return this.createMultiPoint(_e.toPointArray(t));et.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},_e.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},_e.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof x){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(P(arguments[0],G))return new Kt(arguments[0],this)}},_e.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},_e.prototype.createPolygon=function(){if(0===arguments.length)return new Jt(null,null,this);if(1===arguments.length){if(P(arguments[0],G)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof ee){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length)return new Jt(arguments[0],arguments[1],this)},_e.prototype.getSRID=function(){return this._SRID},_e.prototype.createGeometryCollection=function(){return 0===arguments.length?new Vt(null,this):1===arguments.length?new Vt(arguments[0],this):void 0},_e.prototype.createGeometry=function(t){return new ie(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},_e.prototype.getPrecisionModel=function(){return this._precisionModel},_e.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(P(arguments[0],G))return new ee(arguments[0],this)}},_e.prototype.createMultiPolygon=function(){return 0===arguments.length?new ne(null,this):1===arguments.length?new ne(arguments[0],this):void 0},_e.prototype.createMultiPoint=function(){if(0===arguments.length)return new te(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new te(arguments[0],this);if(arguments[0]instanceof Array){var t=arguments[0];return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(P(arguments[0],G)){var e=arguments[0];if(null===e)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(e.size()).fill(null),i=0;i<e.size();i++){var r=this.getCoordinateSequenceFactory().create(1,e.getDimension());qt.copy(e,i,r,0,1),n[i]=this.createPoint(r)}return this.createMultiPoint(n)}}},_e.prototype.interfaces_=function(){return[e]},_e.prototype.getClass=function(){return _e},_e.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.getDefaultCoordinateSequenceFactory=function(){return le.instance()},_e.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},me.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(_e,me);var ye=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],ve=function(t){this.geometryFactory=t||new _e};ve.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!Ee[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==ye.indexOf(n)?Ee[n].apply(this,[e.coordinates]):"GeometryCollection"===n?Ee[n].apply(this,[e.geometries]):Ee[n].apply(this,[e])},ve.prototype.write=function(t){var e=t.getGeometryType();if(!be[e])throw new Error("Geometry is not supported");return be[e].apply(this,[t])};var Ee={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!Ee[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=Ee.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new x(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new x(t[0],t[1]),new x(t[2],t[1]),new x(t[2],t[3]),new x(t[0],t[3]),new x(t[0],t[1])])},Point:function(t){var e=new x(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(Ee.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=Ee.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(Ee.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=Ee.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var o=t[r],s=Ee.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(Ee.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},be={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:be.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=be.Point.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(be.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=be.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=be.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var i=0;i<t._holes.length;++i){var r=t._holes[i],o=be.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=be.Polygon.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=i.getGeometryType();e.push(be[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}},we=function(t){this.geometryFactory=t||new _e,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new ve(this.geometryFactory)};we.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===fe.FIXED&&this.reducePrecision(e),e},we.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var xe=function(){this.parser=new ve(this.geometryFactory)};xe.prototype.write=function(t){return this.parser.write(t)};var Se=function(){},Ce={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Se.prototype.interfaces_=function(){return[]},Se.prototype.getClass=function(){return Se},Se.opposite=function(t){return t===Se.LEFT?Se.RIGHT:t===Se.RIGHT?Se.LEFT:t},Ce.ON.get=function(){return 0},Ce.LEFT.get=function(){return 1},Ce.RIGHT.get=function(){return 2},Object.defineProperties(Se,Ce),(d.prototype=new Error).name="EmptyStackException",(g.prototype=new bt).add=function(t){return this.array_.push(t),!0},g.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},g.prototype.push=function(t){return this.array_.push(t),t},g.prototype.pop=function(t){if(0===this.array_.length)throw new d;return this.array_.pop()},g.prototype.peek=function(){if(0===this.array_.length)throw new d;return this.array_[this.array_.length-1]},g.prototype.empty=function(){return 0===this.array_.length},g.prototype.isEmpty=function(){return this.empty()},g.prototype.search=function(t){return this.array_.indexOf(t)},g.prototype.size=function(){return this.array_.length},g.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var Te=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Te.prototype.getCoordinate=function(){return this._minCoord},Te.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},Te.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();et.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],i=at.computeOrientation(this._minCoord,n,e),r=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===at.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===at.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)},Te.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var i=Se.LEFT;return n[e].y<n[e+1].y&&(i=Se.RIGHT),i},Te.prototype.getEdge=function(){return this._orientedDe},Te.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},Te.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Te.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}et.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Se.LEFT&&(this._orientedDe=this._minDe.getSym())},Te.prototype.interfaces_=function(){return[]},Te.prototype.getClass=function(){return Te};var Ie=function(t){function e(n,i){t.call(this,e.msgWithCoord(n,i)),this.pt=i?new x(i):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}(J),Re=function(){this.array_=[]};Re.prototype.addLast=function(t){this.array_.push(t)},Re.prototype.removeFirst=function(){return this.array_.shift()},Re.prototype.isEmpty=function(){return 0===this.array_.length};var Pe=function(){this._finder=null,this._dirEdgeList=new wt,this._nodes=new wt,this._rightMostCoord=null,this._env=null,this._finder=new Te};Pe.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},Pe.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Pe.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(null===e)throw new Ie("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var o=r.next();o.setVisited(!0),this.copySymDepths(o)}},Pe.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(Se.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},Pe.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Pe.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Se.RIGHT)>=1&&e.getDepth(Se.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},Pe.prototype.computeDepths=function(t){var e=new Lt,n=new Re,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},Pe.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Pe.prototype.getEnvelope=function(){if(null===this._env){for(var t=new X,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this._env=t}return this._env},Pe.prototype.addReachable=function(t){var e=new g;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},Pe.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(Se.LEFT,t.getDepth(Se.RIGHT)),e.setDepth(Se.RIGHT,t.getDepth(Se.LEFT))},Pe.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this._dirEdgeList.add(i);var r=i.getSym().getNode();r.isVisited()||e.push(r)}},Pe.prototype.getNodes=function(){return this._nodes},Pe.prototype.getDirectedEdges=function(){return this._dirEdgeList},Pe.prototype.interfaces_=function(){return[E]},Pe.prototype.getClass=function(){return Pe};var Me=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[Se.ON]=n}else if(arguments[0]instanceof t){var i=arguments[0];if(this.init(i.location.length),null!==i)for(var r=0;r<this.location.length;r++)this.location[r]=i.location[r]}}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.init(3),this.location[Se.ON]=o,this.location[Se.LEFT]=s,this.location[Se.RIGHT]=a}};Me.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},Me.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==I.NONE)return!1;return!0},Me.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===I.NONE&&(this.location[e]=t)},Me.prototype.isLine=function(){return 1===this.location.length},Me.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Se.ON]=this.location[Se.ON],e[Se.LEFT]=I.NONE,e[Se.RIGHT]=I.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===I.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},Me.prototype.getLocations=function(){return this.location},Me.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Se.LEFT];this.location[Se.LEFT]=this.location[Se.RIGHT],this.location[Se.RIGHT]=t},Me.prototype.toString=function(){var t=new N;return this.location.length>1&&t.append(I.toLocationSymbol(this.location[Se.LEFT])),t.append(I.toLocationSymbol(this.location[Se.ON])),this.location.length>1&&t.append(I.toLocationSymbol(this.location[Se.RIGHT])),t.toString()},Me.prototype.setLocations=function(t,e,n){this.location[Se.ON]=t,this.location[Se.LEFT]=e,this.location[Se.RIGHT]=n},Me.prototype.get=function(t){return t<this.location.length?this.location[t]:I.NONE},Me.prototype.isArea=function(){return this.location.length>1},Me.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===I.NONE)return!0;return!1},Me.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Se.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},Me.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(I.NONE)},Me.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},Me.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},Me.prototype.interfaces_=function(){return[]},Me.prototype.getClass=function(){return Me};var Le=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Me(e),this.elt[1]=new Me(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new Me(n.elt[0]),this.elt[1]=new Me(n.elt[1])}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.elt[0]=new Me(I.NONE),this.elt[1]=new Me(I.NONE),this.elt[i].setLocation(r)}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new Me(o,s,a),this.elt[1]=new Me(o,s,a)}else if(4===arguments.length){var A=arguments[0],u=arguments[1],l=arguments[2],c=arguments[3];this.elt[0]=new Me(I.NONE,I.NONE,I.NONE),this.elt[1]=new Me(I.NONE,I.NONE,I.NONE),this.elt[A].setLocations(u,l,c)}};Le.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},Le.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},Le.prototype.isNull=function(t){return this.elt[t].isNull()},Le.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},Le.prototype.isLine=function(t){return this.elt[t].isLine()},Le.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Me(t.elt[e]):this.elt[e].merge(t.elt[e])},Le.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Le.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Se.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},Le.prototype.toString=function(){var t=new N;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},Le.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},Le.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},Le.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Se.ON,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}},Le.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},Le.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},Le.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Me(this.elt[t].location[0]))},Le.prototype.interfaces_=function(){return[]},Le.prototype.getClass=function(){return Le},Le.toLineLabel=function(t){for(var e=new Le(I.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var Ne=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new wt,this._pts=new wt,this._label=new Le(I.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new wt,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Ne.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=at.isCCW(this._ring.getCoordinates())},Ne.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Ne.prototype.computePoints=function(t){this._startDe=t;var e=t,n=!0;do{if(null===e)throw new Ie("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Ie("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var i=e.getLabel();et.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},Ne.prototype.getLinearRing=function(){return this._ring},Ne.prototype.getCoordinate=function(t){return this._pts.get(t)},Ne.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},Ne.prototype.addPoints=function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var o=r;o<i.length;o++)this._pts.add(i[o])}else{var s=i.length-2;n&&(s=i.length-1);for(var a=s;a>=0;a--)this._pts.add(i[a])}},Ne.prototype.isHole=function(){return this._isHole},Ne.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},Ne.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!at.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},Ne.prototype.addHole=function(t){this._holes.add(t)},Ne.prototype.isShell=function(){return null===this._shell},Ne.prototype.getLabel=function(){return this._label},Ne.prototype.getEdges=function(){return this._edges},Ne.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Ne.prototype.getShell=function(){return this._shell},Ne.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[1],n=arguments[0].getLocation(e,Se.RIGHT);if(n===I.NONE)return null;if(this._label.getLocation(e)===I.NONE)return this._label.setLocation(e,n),null}},Ne.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},Ne.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},Ne.prototype.interfaces_=function(){return[]},Ne.prototype.getClass=function(){return Ne};var Oe=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ne),De=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new wt,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new Oe(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ne),Fe=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};Fe.prototype.setVisited=function(t){this._isVisited=t},Fe.prototype.setInResult=function(t){this._isInResult=t},Fe.prototype.isCovered=function(){return this._isCovered},Fe.prototype.isCoveredSet=function(){return this._isCoveredSet},Fe.prototype.setLabel=function(t){this._label=t},Fe.prototype.getLabel=function(){return this._label},Fe.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},Fe.prototype.updateIM=function(t){et.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},Fe.prototype.isInResult=function(){return this._isInResult},Fe.prototype.isVisited=function(){return this._isVisited},Fe.prototype.interfaces_=function(){return[]},Fe.prototype.getClass=function(){return Fe};var ke=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],n=arguments[1];this._coord=e,this._edges=n,this._label=new Le(0,I.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var n=I.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==I.BOUNDARY&&(n=i)}return n},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],n=arguments[1];null===this._label?this._label=new Le(e,n):this._label.setLocation(e,n)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Le)for(var n=arguments[0],i=0;i<2;i++){var r=this.computeMergedLocation(n,i);this._label.getLocation(i)===I.NONE&&this._label.setLocation(i,r)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=I.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case I.BOUNDARY:n=I.INTERIOR;break;case I.INTERIOR:default:n=I.BOUNDARY}this._label.setLocation(t,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Fe),Be=function(){this.nodeMap=new c,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};Be.prototype.find=function(t){return this.nodeMap.get(t)},Be.prototype.addNode=function(){if(arguments[0]instanceof x){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof ke){var n=arguments[0],i=this.nodeMap.get(n.getCoordinate());return null===i?(this.nodeMap.put(n.getCoordinate(),n),n):(i.mergeLabel(n),i)}},Be.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},Be.prototype.iterator=function(){return this.nodeMap.values().iterator()},Be.prototype.values=function(){return this.nodeMap.values()},Be.prototype.getBoundaryNodes=function(t){for(var e=new wt,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===I.BOUNDARY&&e.add(i)}return e},Be.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},Be.prototype.interfaces_=function(){return[]},Be.prototype.getClass=function(){return Be};var Ue=function(){},Ge={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Ue.prototype.interfaces_=function(){return[]},Ue.prototype.getClass=function(){return Ue},Ue.isNorthern=function(t){return t===Ue.NE||t===Ue.NW},Ue.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},Ue.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n},Ue.isInHalfPlane=function(t,e){return e===Ue.SE?t===Ue.SE||t===Ue.SW:t===e||t===e+1},Ue.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new m("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?Ue.NE:Ue.SE:e>=0?Ue.NW:Ue.SW}if(arguments[0]instanceof x&&arguments[1]instanceof x){var n=arguments[0],i=arguments[1];if(i.x===n.x&&i.y===n.y)throw new m("Cannot compute the quadrant for two identical points "+n);return i.x>=n.x?i.y>=n.y?Ue.NE:Ue.SE:i.y>=n.y?Ue.NW:Ue.SW}},Ge.NE.get=function(){return 0},Ge.NW.get=function(){return 1},Ge.SW.get=function(){return 2},Ge.SE.get=function(){return 3},Object.defineProperties(Ue,Ge);var ze=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];this._edge=e,this.init(n,i),this._label=null}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this._edge=r,this.init(o,s),this._label=a}};ze.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:at.computeOrientation(t._p0,t._p1,this._p1)},ze.prototype.getDy=function(){return this._dy},ze.prototype.getCoordinate=function(){return this._p0},ze.prototype.setNode=function(t){this._node=t},ze.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},ze.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},ze.prototype.getDirectedCoordinate=function(){return this._p1},ze.prototype.getDx=function(){return this._dx},ze.prototype.getLabel=function(){return this._label},ze.prototype.getEdge=function(){return this._edge},ze.prototype.getQuadrant=function(){return this._quadrant},ze.prototype.getNode=function(){return this._node},ze.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},ze.prototype.computeLabel=function(t){},ze.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=Ue.quadrant(this._dx,this._dy),et.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},ze.prototype.interfaces_=function(){return[E]},ze.prototype.getClass=function(){return ze};var Ve=function(t){function e(){var e=arguments[0],n=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=n,n)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var i=e.getNumPoints()-1;this.init(e.getCoordinate(i),e.getCoordinate(i-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new Le(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Ie("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Se.LEFT)===I.INTERIOR&&this._label.getLocation(e,Se.RIGHT)===I.INTERIOR||(t=!1);return t},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[Se.LEFT]+"/"+this._depth[Se.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,I.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,I.EXTERIOR);return t&&e&&n},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===Se.LEFT&&(i=-1);var r=Se.opposite(t),o=e+n*i;this.setDepth(t,e),this.setDepth(r,o)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===I.EXTERIOR&&e===I.INTERIOR?1:t===I.INTERIOR&&e===I.EXTERIOR?-1:0},e}(ze),je=function(){};je.prototype.createNode=function(t){return new ke(t,null)},je.prototype.interfaces_=function(){return[]},je.prototype.getClass=function(){return je};var We=function(){if(this._edges=new wt,this._nodes=null,this._edgeEndList=new wt,0===arguments.length)this._nodes=new Be(new je);else if(1===arguments.length){var t=arguments[0];this._nodes=new Be(t)}};We.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},We.prototype.find=function(t){return this._nodes.find(t)},We.prototype.addNode=function(){if(arguments[0]instanceof ke){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof x){var e=arguments[0];return this._nodes.addNode(e)}},We.prototype.getNodeIterator=function(){return this._nodes.iterator()},We.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},We.prototype.debugPrintln=function(t){W.out.println(t)},We.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===I.BOUNDARY},We.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},We.prototype.matchInSameDirection=function(t,e,n,i){return!!t.equals(n)&&at.computeOrientation(t,e,i)===at.COLLINEAR&&Ue.quadrant(t,e)===Ue.quadrant(n,i)},We.prototype.getEdgeEnds=function(){return this._edgeEndList},We.prototype.debugPrint=function(t){W.out.print(t)},We.prototype.getEdgeIterator=function(){return this._edges.iterator()},We.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null},We.prototype.insertEdge=function(t){this._edges.add(t)},We.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},We.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var i=new Ve(n,!0),r=new Ve(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}},We.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},We.prototype.getNodes=function(){return this._nodes.values()},We.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null},We.prototype.interfaces_=function(){return[]},We.prototype.getClass=function(){return We},We.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var He=function(){this._geometryFactory=null,this._shellList=new wt;var t=arguments[0];this._geometryFactory=t};He.prototype.sortShellsAndHoles=function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}},He.prototype.computePolygons=function(t){for(var e=new wt,n=t.iterator();n.hasNext();){var i=n.next().toPolygon(this._geometryFactory);e.add(i)}return e},He.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new Ie("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}},He.prototype.buildMinimalEdgeRings=function(t,e,n){for(var i=new wt,r=t.iterator();r.hasNext();){var o=r.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else i.add(o)}return i},He.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},He.prototype.buildMaximalEdgeRings=function(t){for(var e=new wt,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new De(i,this._geometryFactory);e.add(r),r.setInResult()}}return e},He.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}},He.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},He.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var A=a.next(),u=A.getLinearRing(),l=u.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var c=!1;l.contains(i)&&at.isPointInRing(r,u.getCoordinates())&&(c=!0),c&&(null===o||s.contains(l))&&(o=A)}return o},He.prototype.findShell=function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return et.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},He.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];We.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(e),r=new wt,o=this.buildMinimalEdgeRings(i,this._shellList,r);this.sortShellsAndHoles(o,this._shellList,r),this.placeFreeHoles(this._shellList,r)}},He.prototype.interfaces_=function(){return[]},He.prototype.getClass=function(){return He};var Xe=function(){};Xe.prototype.getBounds=function(){},Xe.prototype.interfaces_=function(){return[]},Xe.prototype.getClass=function(){return Xe};var Ye=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};Ye.prototype.getItem=function(){return this._item},Ye.prototype.getBounds=function(){return this._bounds},Ye.prototype.interfaces_=function(){return[Xe,e]},Ye.prototype.getClass=function(){return Ye};var qe=function(){this._size=null,this._items=null,this._size=0,this._items=new wt,this._items.add(null)};qe.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},qe.prototype.size=function(){return this._size},qe.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},qe.prototype.clear=function(){this._size=0,this._items.clear()},qe.prototype.isEmpty=function(){return 0===this._size},qe.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},qe.prototype.interfaces_=function(){return[]},qe.prototype.getClass=function(){return qe};var Qe=function(){};Qe.prototype.visitItem=function(t){},Qe.prototype.interfaces_=function(){return[]},Qe.prototype.getClass=function(){return Qe};var $e=function(){};$e.prototype.insert=function(t,e){},$e.prototype.remove=function(t,e){},$e.prototype.query=function(){},$e.prototype.interfaces_=function(){return[]},$e.prototype.getClass=function(){return $e};var Ke=function(){if(this._childBoundables=new wt,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Ze={serialVersionUID:{configurable:!0}};Ke.prototype.getLevel=function(){return this._level},Ke.prototype.size=function(){return this._childBoundables.size()},Ke.prototype.getChildBoundables=function(){return this._childBoundables},Ke.prototype.addChildBoundable=function(t){et.isTrue(null===this._bounds),this._childBoundables.add(t)},Ke.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Ke.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Ke.prototype.interfaces_=function(){return[Xe,e]},Ke.prototype.getClass=function(){return Ke},Ze.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Ke,Ze);var Je=function(){};Je.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},Je.min=function(t){return Je.sort(t),t.get(0)},Je.sort=function(t,e){var n=t.toArray();e?kt.sort(n,e):kt.sort(n);for(var i=t.iterator(),r=0,o=n.length;r<o;r++)i.next(),i.set(n[r])},Je.singletonList=function(t){var e=new wt;return e.add(t),e};var tn=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};tn.prototype.expandToQueue=function(t,e){var n=tn.isComposite(this._boundable1),i=tn.isComposite(this._boundable2);if(n&&i)return tn.area(this._boundable1)>tn.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(i)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new m("neither boundable is composite")},tn.prototype.isLeaves=function(){return!(tn.isComposite(this._boundable1)||tn.isComposite(this._boundable2))},tn.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},tn.prototype.expand=function(t,e,n,i){for(var r=t.getChildBoundables().iterator();r.hasNext();){var o=r.next(),s=new tn(o,e,this._itemDistance);s.getDistance()<i&&n.add(s)}},tn.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},tn.prototype.getDistance=function(){return this._distance},tn.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},tn.prototype.interfaces_=function(){return[E]},tn.prototype.getClass=function(){return tn},tn.area=function(t){return t.getBounds().getArea()},tn.isComposite=function(t){return t instanceof Ke};var en=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new wt,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var n=arguments[0];et.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},nn={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};en.prototype.getNodeCapacity=function(){return this._nodeCapacity},en.prototype.lastNode=function(t){return t.get(t.size()-1)},en.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Ke?t+=this.size(n):n instanceof Ye&&(t+=1)}return t}},en.prototype.removeItem=function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof Ye&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},en.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new wt:t}if(1===arguments.length){for(var e=arguments[0],n=new wt,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof Ke){var o=this.itemsTree(r);null!==o&&n.add(o)}else r instanceof Ye?n.add(r.getItem()):et.shouldNeverReachHere()}return n.size()<=0?null:n}},en.prototype.insert=function(t,e){et.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Ye(t,e))},en.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new wt;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(et.isTrue(n>-2),i.getLevel()===n)return r.add(i),null;for(var o=i.getChildBoundables().iterator();o.hasNext();){var s=o.next();s instanceof Ke?this.boundablesAtLevel(n,s,r):(et.isTrue(s instanceof Ye),-1===n&&r.add(s))}return null}},en.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new wt;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,i)}else if(3===arguments.length)if(P(arguments[2],Qe)&&arguments[0]instanceof Object&&arguments[1]instanceof Ke)for(var r=arguments[0],o=arguments[2],s=arguments[1].getChildBoundables(),a=0;a<s.size();a++){var A=s.get(a);this.getIntersectsOp().intersects(A.getBounds(),r)&&(A instanceof Ke?this.query(r,A,o):A instanceof Ye?o.visitItem(A.getItem()):et.shouldNeverReachHere())}else if(P(arguments[2],bt)&&arguments[0]instanceof Object&&arguments[1]instanceof Ke)for(var u=arguments[0],l=arguments[2],c=arguments[1].getChildBoundables(),h=0;h<c.size();h++){var f=c.get(h);this.getIntersectsOp().intersects(f.getBounds(),u)&&(f instanceof Ke?this.query(u,f,l):f instanceof Ye?l.add(f.getItem()):et.shouldNeverReachHere())}},en.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},en.prototype.getRoot=function(){return this.build(),this._root},en.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=this.removeItem(i,r);if(o)return!0;for(var s=null,a=i.getChildBoundables().iterator();a.hasNext();){var A=a.next();if(this.getIntersectsOp().intersects(A.getBounds(),n)&&A instanceof Ke&&(o=this.remove(n,A,r))){s=A;break}}return null!==s&&s.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(s),o}},en.prototype.createHigherLevels=function(t,e){et.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},en.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Ke){var i=this.depth(n);i>t&&(t=i)}}return t+1}},en.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var n=new wt;n.add(this.createNode(e));var i=new wt(t);Je.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var o=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},en.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},en.prototype.interfaces_=function(){return[e]},en.prototype.getClass=function(){return en},en.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},nn.IntersectsOp.get=function(){return rn},nn.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},nn.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(en,nn);var rn=function(){},on=function(){};on.prototype.distance=function(t,e){},on.prototype.interfaces_=function(){return[]},on.prototype.getClass=function(){return on};var sn=function(t){function n(e){e=e||n.DEFAULT_NODE_CAPACITY,t.call(this,e)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var i={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return n.prototype.createParentBoundablesFromVerticalSlices=function(t,e){et.isTrue(t.length>0);for(var n=new wt,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},n.prototype.createNode=function(t){return new an(t)},n.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},n.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],n=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,n)},n.prototype.getIntersectsOp=function(){return n.intersectsOp},n.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),o=0;o<e;o++){i[o]=new wt;for(var s=0;r.hasNext()&&s<n;){var a=r.next();i[o].add(a),s++}}return i},n.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var n=arguments[0],i=arguments[1];t.prototype.query.call(this,n,i)}else if(3===arguments.length)if(P(arguments[2],Qe)&&arguments[0]instanceof Object&&arguments[1]instanceof Ke){var r=arguments[0],o=arguments[1],s=arguments[2];t.prototype.query.call(this,r,o,s)}else if(P(arguments[2],bt)&&arguments[0]instanceof Object&&arguments[1]instanceof Ke){var a=arguments[0],A=arguments[1],u=arguments[2];t.prototype.query.call(this,a,A,u)}},n.prototype.getComparator=function(){return n.yComparator},n.prototype.createParentBoundablesFromVerticalSlice=function(e,n){return t.prototype.createParentBoundables.call(this,e,n)},n.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return t.prototype.remove.call(this,e,n)}return t.prototype.remove.apply(this,arguments)},n.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},n.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var i=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new wt(t);Je.sort(r,n.xComparator);var o=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(i))));return this.createParentBoundablesFromVerticalSlices(o,e)},n.prototype.nearestNeighbour=function(){if(1===arguments.length){if(P(arguments[0],on)){var t=arguments[0],e=new tn(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof tn){var i=arguments[0];return this.nearestNeighbour(i,y.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof n&&P(arguments[1],on)){var r=arguments[0],o=arguments[1],s=new tn(this.getRoot(),r.getRoot(),o);return this.nearestNeighbour(s)}if(arguments[0]instanceof tn&&"number"==typeof arguments[1]){var a=arguments[0],A=arguments[1],u=null,l=new qe;for(l.add(a);!l.isEmpty()&&A>0;){var c=l.poll(),h=c.getDistance();if(h>=A)break;c.isLeaves()?(A=h,u=c):c.expandToQueue(l,A)}return[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else if(3===arguments.length){var f=arguments[2],p=new Ye(arguments[0],arguments[1]),d=new tn(this.getRoot(),p,f);return this.nearestNeighbour(d)[0]}},n.prototype.interfaces_=function(){return[$e,e]},n.prototype.getClass=function(){return n},n.centreX=function(t){return n.avg(t.getMinX(),t.getMaxX())},n.avg=function(t,e){return(t+e)/2},n.centreY=function(t){return n.avg(t.getMinY(),t.getMaxY())},i.STRtreeNode.get=function(){return an},i.serialVersionUID.get=function(){return 0x39920f7d5f261e0},i.xComparator.get=function(){return{interfaces_:function(){return[w]},compare:function(e,i){return t.compareDoubles(n.centreX(e.getBounds()),n.centreX(i.getBounds()))}}},i.yComparator.get=function(){return{interfaces_:function(){return[w]},compare:function(e,i){return t.compareDoubles(n.centreY(e.getBounds()),n.centreY(i.getBounds()))}}},i.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},i.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(n,i),n}(en),an=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new X(n.getBounds()):t.expandToInclude(n.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ke),An=function(){};An.prototype.interfaces_=function(){return[]},An.prototype.getClass=function(){return An},An.relativeSign=function(t,e){return t<e?-1:t>e?1:0},An.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=An.relativeSign(e.x,n.x),r=An.relativeSign(e.y,n.y);switch(t){case 0:return An.compareValue(i,r);case 1:return An.compareValue(r,i);case 2:return An.compareValue(r,-i);case 3:return An.compareValue(-i,r);case 4:return An.compareValue(-i,-r);case 5:return An.compareValue(-r,-i);case 6:return An.compareValue(-r,i);case 7:return An.compareValue(i,-r)}return et.shouldNeverReachHere("invalid octant value"),0},An.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var un=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._segString=t,this.coord=new x(e),this.segmentIndex=n,this._segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))};un.prototype.getCoordinate=function(){return this.coord},un.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},un.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:An.compare(this._segmentOctant,this.coord,e.coord)},un.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},un.prototype.isInterior=function(){return this._isInterior},un.prototype.interfaces_=function(){return[E]},un.prototype.getClass=function(){return un};var ln=function(){this._nodeMap=new c,this._edge=null;var t=arguments[0];this._edge=t};ln.prototype.getSplitCoordinates=function(){var t=new St;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()},ln.prototype.addCollapsedNodes=function(){var t=new wt;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},ln.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},ln.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),i=this._edge.getCoordinate(e+2);n.equals2D(i)&&t.add(new O(e+1))}},ln.prototype.addEdgeCoordinates=function(t,e,n){var i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);n.add(new x(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this._edge.getCoordinate(o));r&&n.add(new x(e.coord))},ln.prototype.iterator=function(){return this._nodeMap.values().iterator()},ln.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},ln.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},ln.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new O(e[0])),i=r}},ln.prototype.getEdge=function(){return this._edge},ln.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},ln.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new x(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return r&&(o[s]=new x(e.coord)),new pn(o,this._edge.getData())},ln.prototype.add=function(t,e){var n=new un(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return null!==i?(et.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)},ln.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new J("bad split edge start point at "+n);var i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new J("bad split edge end point at "+r)},ln.prototype.interfaces_=function(){return[]},ln.prototype.getClass=function(){return ln};var cn=function(){};cn.prototype.interfaces_=function(){return[]},cn.prototype.getClass=function(){return cn},cn.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new m("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),i=Math.abs(e);return t>=0?e>=0?n>=i?0:1:n>=i?7:6:e>=0?n>=i?3:2:n>=i?4:5}if(arguments[0]instanceof x&&arguments[1]instanceof x){var r=arguments[0],o=arguments[1],s=o.x-r.x,a=o.y-r.y;if(0===s&&0===a)throw new m("Cannot compute the octant for two identical points "+r);return cn.octant(s,a)}};var hn=function(){};hn.prototype.getCoordinates=function(){},hn.prototype.size=function(){},hn.prototype.getCoordinate=function(t){},hn.prototype.isClosed=function(){},hn.prototype.setData=function(t){},hn.prototype.getData=function(){},hn.prototype.interfaces_=function(){return[]},hn.prototype.getClass=function(){return hn};var fn=function(){};fn.prototype.addIntersection=function(t,e){},fn.prototype.interfaces_=function(){return[hn]},fn.prototype.getClass=function(){return fn};var pn=function(){this._nodeList=new ln(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};pn.prototype.getCoordinates=function(){return this._pts},pn.prototype.size=function(){return this._pts.length},pn.prototype.getCoordinate=function(t){return this._pts[t]},pn.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},pn.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},pn.prototype.setData=function(t){this._data=t},pn.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:cn.octant(t,e)},pn.prototype.getData=function(){return this._data},pn.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[1],i=arguments[3],r=new x(arguments[0].getIntersection(i));this.addIntersection(r,n)}},pn.prototype.toString=function(){return Z.toLineString(new Ae(this._pts))},pn.prototype.getNodeList=function(){return this._nodeList},pn.prototype.addIntersectionNode=function(t,e){var n=e,i=n+1;if(i<this._pts.length){var r=this._pts[i];t.equals2D(r)&&(n=i)}return this._nodeList.add(t,n)},pn.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},pn.prototype.interfaces_=function(){return[fn]},pn.prototype.getClass=function(){return pn},pn.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new wt;return pn.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[1],i=arguments[0].iterator();i.hasNext();)i.next().getNodeList().addSplitEdges(n)};var dn=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new x,this.p1=new x;else if(1===arguments.length){var t=arguments[0];this.p0=new x(t.p0),this.p1=new x(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3];this.p0=new x(e,n),this.p1=new x(i,r)}},gn={serialVersionUID:{configurable:!0}};dn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},dn.prototype.orientationIndex=function(){if(arguments[0]instanceof dn){var t=arguments[0],e=at.orientationIndex(this.p0,this.p1,t.p0),n=at.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof x){var i=arguments[0];return at.orientationIndex(this.p0,this.p1,i)}},dn.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},dn.prototype.isVertical=function(){return this.p0.x===this.p1.x},dn.prototype.equals=function(t){if(!(t instanceof dn))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},dn.prototype.intersection=function(t){var e=new rt;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},dn.prototype.project=function(){if(arguments[0]instanceof x){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new x(t);var e=this.projectionFactor(t),n=new x;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof dn){var i=arguments[0],r=this.projectionFactor(i.p0),o=this.projectionFactor(i.p1);if(r>=1&&o>=1)return null;if(r<=0&&o<=0)return null;var s=this.project(i.p0);r<0&&(s=this.p0),r>1&&(s=this.p1);var a=this.project(i.p1);return o<0&&(a=this.p0),o>1&&(a=this.p1),new dn(s,a)}},dn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},dn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},dn.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},dn.prototype.distancePerpendicular=function(t){return at.distancePointLinePerpendicular(t,this.p0,this.p1)},dn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},dn.prototype.midPoint=function(){return dn.midPoint(this.p0,this.p1)},dn.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return i<=0?y.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i},dn.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),i=y.MAX_VALUE,r=null,o=this.closestPoint(t.p0);i=o.distance(t.p0),n[0]=o,n[1]=t.p0;var s=this.closestPoint(t.p1);(r=s.distance(t.p1))<i&&(i=r,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(r=a.distance(this.p0))<i&&(i=r,n[0]=this.p0,n[1]=a);var A=t.closestPoint(this.p1);return(r=A.distance(this.p1))<i&&(i=r,n[0]=this.p1,n[1]=A),n},dn.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},dn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},dn.prototype.getLength=function(){return this.p0.distance(this.p1)},dn.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},dn.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},dn.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},dn.prototype.lineIntersection=function(t){try{return H.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof j))throw t}return null},dn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},dn.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o),a=0,A=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*r/s,A=e*o/s}return new x(n-A,i+a)},dn.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},dn.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||y.isNaN(e))&&(e=1),e},dn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},dn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},dn.prototype.distance=function(){if(arguments[0]instanceof dn){var t=arguments[0];return at.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof x){var e=arguments[0];return at.distancePointLine(e,this.p0,this.p1)}},dn.prototype.pointAlong=function(t){var e=new x;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},dn.prototype.hashCode=function(){var t=y.doubleToLongBits(this.p0.x);t^=31*y.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=y.doubleToLongBits(this.p1.x);return n^=31*y.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},dn.prototype.interfaces_=function(){return[E,e]},dn.prototype.getClass=function(){return dn},dn.midPoint=function(t,e){return new x((t.x+e.x)/2,(t.y+e.y)/2)},gn.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(dn,gn);var _n=function(){this.tempEnv1=new X,this.tempEnv2=new X,this._overlapSeg1=new dn,this._overlapSeg2=new dn};_n.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n};var mn=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=i};mn.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},mn.prototype.computeSelect=function(t,e,n,i){var r=this._pts[e],o=this._pts[n];if(i.tempEnv1.init(r,o),n-e==1)return i.select(this,e),null;if(!t.intersects(i.tempEnv1))return null;var s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,i),s<n&&this.computeSelect(t,s,n,i)},mn.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},mn.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},mn.prototype.setId=function(t){this._id=t},mn.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},mn.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new X(t,e)}return this._env},mn.prototype.getEndIndex=function(){return this._end},mn.prototype.getStartIndex=function(){return this._start},mn.prototype.getContext=function(){return this._context},mn.prototype.getId=function(){return this._id},mn.prototype.computeOverlapsInternal=function(t,e,n,i,r,o){var s=this._pts[t],a=this._pts[e],A=n._pts[i],u=n._pts[r];if(e-t==1&&r-i==1)return o.overlap(this,t,n,i),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(A,u),!o.tempEnv1.intersects(o.tempEnv2))return null;var l=Math.trunc((t+e)/2),c=Math.trunc((i+r)/2);t<l&&(i<c&&this.computeOverlapsInternal(t,l,n,i,c,o),c<r&&this.computeOverlapsInternal(t,l,n,c,r,o)),l<e&&(i<c&&this.computeOverlapsInternal(l,e,n,i,c,o),c<r&&this.computeOverlapsInternal(l,e,n,c,r,o))},mn.prototype.interfaces_=function(){return[]},mn.prototype.getClass=function(){return mn};var yn=function(){};yn.prototype.interfaces_=function(){return[]},yn.prototype.getClass=function(){return yn},yn.getChainStartIndices=function(t){var e=0,n=new wt;n.add(new O(e));do{var i=yn.findChainEnd(t,e);n.add(new O(i)),e=i}while(e<t.length-1);return yn.toIntArray(n)},yn.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=Ue.quadrant(t[n],t[n+1]),r=e+1;r<t.length&&(t[r-1].equals2D(t[r])||Ue.quadrant(t[r-1],t[r])===i);)r++;return r-1},yn.getChains=function(){if(1===arguments.length){var t=arguments[0];return yn.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new wt,r=yn.getChainStartIndices(e),o=0;o<r.length-1;o++){var s=new mn(e,r[o],r[o+1],n);i.add(s)}return i}},yn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var vn=function(){};vn.prototype.computeNodes=function(t){},vn.prototype.getNodedSubstrings=function(){},vn.prototype.interfaces_=function(){return[]},vn.prototype.getClass=function(){return vn};var En=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};En.prototype.setSegmentIntersector=function(t){this._segInt=t},En.prototype.interfaces_=function(){return[vn]},En.prototype.getClass=function(){return En};var bn=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new wt,this._index=new sn,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return pn.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=yn.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=new wn(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this._index.query(n.getEnvelope()).iterator();i.hasNext();){var r=i.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,t),this._nOverlaps++),this._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return wn},Object.defineProperties(e,n),e}(En),wn=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[0].getContext(),o=n.getContext();this._si.processIntersections(r,e,o,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(_n),xn=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(i)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(o),this.setJoinStyle(s),this.setMitreLimit(a)}},Sn={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};xn.prototype.getEndCapStyle=function(){return this._endCapStyle},xn.prototype.isSingleSided=function(){return this._isSingleSided},xn.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=xn.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=xn.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==xn.JOIN_ROUND&&(this._quadrantSegments=xn.DEFAULT_QUADRANT_SEGMENTS)},xn.prototype.getJoinStyle=function(){return this._joinStyle},xn.prototype.setJoinStyle=function(t){this._joinStyle=t},xn.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},xn.prototype.getSimplifyFactor=function(){return this._simplifyFactor},xn.prototype.getQuadrantSegments=function(){return this._quadrantSegments},xn.prototype.setEndCapStyle=function(t){this._endCapStyle=t},xn.prototype.getMitreLimit=function(){return this._mitreLimit},xn.prototype.setMitreLimit=function(t){this._mitreLimit=t},xn.prototype.setSingleSided=function(t){this._isSingleSided=t},xn.prototype.interfaces_=function(){return[]},xn.prototype.getClass=function(){return xn},xn.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Sn.CAP_ROUND.get=function(){return 1},Sn.CAP_FLAT.get=function(){return 2},Sn.CAP_SQUARE.get=function(){return 3},Sn.JOIN_ROUND.get=function(){return 1},Sn.JOIN_MITRE.get=function(){return 2},Sn.JOIN_BEVEL.get=function(){return 3},Sn.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Sn.DEFAULT_MITRE_LIMIT.get=function(){return 5},Sn.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(xn,Sn);var Cn=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=at.COUNTERCLOCKWISE,this._inputLine=t||null},Tn={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Cn.prototype.isDeletable=function(t,e,n,i){var r=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(r,o,s)&&!!this.isShallow(r,o,s,i)&&this.isShallowSampled(r,o,t,n,i)},Cn.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),i=!1;n<this._inputLine.length;){var r=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=Cn.DELETE,r=!0,i=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},Cn.prototype.isShallowConcavity=function(t,e,n,i){return at.computeOrientation(t,e,n)===this._angleOrientation&&at.distancePointLine(e,t,n)<i},Cn.prototype.isShallowSampled=function(t,e,n,i,r){var o=Math.trunc((i-n)/Cn.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=n;s<i;s+=o)if(!this.isShallow(t,e,this._inputLine[s],r))return!1;return!0},Cn.prototype.isConcave=function(t,e,n){return at.computeOrientation(t,e,n)===this._angleOrientation},Cn.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=at.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},Cn.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Cn.DELETE;)e++;return e},Cn.prototype.isShallow=function(t,e,n,i){return at.distancePointLine(e,t,n)<i},Cn.prototype.collapseLine=function(){for(var t=new St,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Cn.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Cn.prototype.interfaces_=function(){return[]},Cn.prototype.getClass=function(){return Cn},Cn.simplify=function(t,e){return new Cn(t).simplify(e)},Tn.INIT.get=function(){return 0},Tn.DELETE.get=function(){return 1},Tn.KEEP.get=function(){return 1},Tn.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Cn,Tn);var In=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new wt},Rn={COORDINATE_ARRAY_TYPE:{configurable:!0}};In.prototype.getCoordinates=function(){return this._ptList.toArray(In.COORDINATE_ARRAY_TYPE)},In.prototype.setPrecisionModel=function(t){this._precisionModel=t},In.prototype.addPt=function(t){var e=new x(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},In.prototype.revere=function(){},In.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var i=t.length-1;i>=0;i--)this.addPt(t[i])},In.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},In.prototype.toString=function(){return(new _e).createLineString(this.getCoordinates()).toString()},In.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new x(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},In.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},In.prototype.interfaces_=function(){return[]},In.prototype.getClass=function(){return In},Rn.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(In,Rn);var Pn=function(){},Mn={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Pn.prototype.interfaces_=function(){return[]},Pn.prototype.getClass=function(){return Pn},Pn.toDegrees=function(t){return 180*t/Math.PI},Pn.normalize=function(t){for(;t>Math.PI;)t-=Pn.PI_TIMES_2;for(;t<=-Math.PI;)t+=Pn.PI_TIMES_2;return t},Pn.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=n.x-e.x,r=n.y-e.y;return Math.atan2(r,i)}},Pn.isAcute=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)>0},Pn.isObtuse=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0},Pn.interiorAngle=function(t,e,n){var i=Pn.angle(e,t),r=Pn.angle(e,n);return Math.abs(r-i)},Pn.normalizePositive=function(t){if(t<0){for(;t<0;)t+=Pn.PI_TIMES_2;t>=Pn.PI_TIMES_2&&(t=0)}else{for(;t>=Pn.PI_TIMES_2;)t-=Pn.PI_TIMES_2;t<0&&(t=0)}return t},Pn.angleBetween=function(t,e,n){var i=Pn.angle(e,t),r=Pn.angle(e,n);return Pn.diff(i,r)},Pn.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},Pn.toRadians=function(t){return t*Math.PI/180},Pn.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?Pn.COUNTERCLOCKWISE:n<0?Pn.CLOCKWISE:Pn.NONE},Pn.angleBetweenOriented=function(t,e,n){var i=Pn.angle(e,t),r=Pn.angle(e,n)-i;return r<=-Math.PI?r+Pn.PI_TIMES_2:r>Math.PI?r-Pn.PI_TIMES_2:r},Mn.PI_TIMES_2.get=function(){return 2*Math.PI},Mn.PI_OVER_2.get=function(){return Math.PI/2},Mn.PI_OVER_4.get=function(){return Math.PI/4},Mn.COUNTERCLOCKWISE.get=function(){return at.COUNTERCLOCKWISE},Mn.CLOCKWISE.get=function(){return at.CLOCKWISE},Mn.NONE.get=function(){return at.COLLINEAR},Object.defineProperties(Pn,Mn);var Ln=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new dn,this._seg1=new dn,this._offset0=new dn,this._offset1=new dn,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],i=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new rt,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===xn.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(i)},Nn={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Ln.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=at.computeOrientation(this._s0,this._s1,this._s2),i=n===at.CLOCKWISE&&this._side===Se.LEFT||n===at.COUNTERCLOCKWISE&&this._side===Se.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},Ln.prototype.addLineEndCap=function(t,e){var n=new dn(t,e),i=new dn;this.computeOffsetSegment(n,Se.LEFT,this._distance,i);var r=new dn;this.computeOffsetSegment(n,Se.RIGHT,this._distance,r);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case xn.CAP_ROUND:this._segList.addPt(i.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,at.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case xn.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case xn.CAP_SQUARE:var A=new x;A.x=Math.abs(this._distance)*Math.cos(a),A.y=Math.abs(this._distance)*Math.sin(a);var u=new x(i.p1.x+A.x,i.p1.y+A.y),l=new x(r.p1.x+A.x,r.p1.y+A.y);this._segList.addPt(u),this._segList.addPt(l)}},Ln.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Ln.prototype.addMitreJoin=function(t,e,n,i){var r=!0,o=null;try{o=H.intersection(e.p0,e.p1,n.p0,n.p1),(i<=0?1:o.distance(t)/Math.abs(i))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof j))throw t;o=new x(0,0),r=!1}r?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())},Ln.prototype.addFilletCorner=function(t,e,n,i,r){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),A=n.x-t.x,u=n.y-t.y,l=Math.atan2(u,A);i===at.CLOCKWISE?a<=l&&(a+=2*Math.PI):a>=l&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,l,i,r),this._segList.addPt(n)},Ln.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Ln.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===xn.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===xn.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},Ln.prototype.createSquare=function(t){this._segList.addPt(new x(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new x(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new x(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new x(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},Ln.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},Ln.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Ln.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Ln.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},Ln.prototype.addLimitedMitreJoin=function(t,e,n,i){var r=this._seg0.p1,o=Pn.angle(r,this._seg0.p0),s=Pn.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=Pn.normalize(o+s),A=Pn.normalize(a+Math.PI),u=i*n,l=n-u*Math.abs(Math.sin(s)),c=r.x+u*Math.cos(A),h=r.y+u*Math.sin(A),f=new x(c,h),p=new dn(r,f),d=p.pointAlongOffset(1,l),g=p.pointAlongOffset(1,-l);this._side===Se.LEFT?(this._segList.addPt(d),this._segList.addPt(g)):(this._segList.addPt(g),this._segList.addPt(d))},Ln.prototype.computeOffsetSegment=function(t,e,n,i){var r=e===Se.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),A=r*n*o/a,u=r*n*s/a;i.p0.x=t.p0.x-u,i.p0.y=t.p0.y+A,i.p1.x=t.p1.x-u,i.p1.y=t.p1.y+A},Ln.prototype.addFilletArc=function(t,e,n,i,r){var o=i===at.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var A=s/a,u=0,l=new x;u<s;){var c=e+o*u;l.x=t.x+r*Math.cos(c),l.y=t.y+r*Math.sin(c),this._segList.addPt(l),u+=A}},Ln.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Ln.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new x((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var i=new x((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Ln.prototype.createCircle=function(t){var e=new x(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Ln.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},Ln.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new In,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Ln.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Ln.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===xn.JOIN_BEVEL||this._bufParams.getJoinStyle()===xn.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,at.CLOCKWISE,this._distance))},Ln.prototype.closeRing=function(){this._segList.closeRing()},Ln.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Ln.prototype.interfaces_=function(){return[]},Ln.prototype.getClass=function(){return Ln},Nn.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Nn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Nn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Nn.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Ln,Nn);var On=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};On.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var o=r.getCoordinates();return n&&Ct.reverse(o),o},On.prototype.computeSingleSidedBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var r=Cn.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Se.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{n.addSegments(t,!1);var a=Cn.simplify(t,i),A=a.length-1;n.initSideSegments(a[0],a[1],Se.LEFT),n.addFirstSegment();for(var u=2;u<=A;u++)n.addNextSegment(a[u],!0)}n.addLastSegment(),n.closeRing()},On.prototype.computeRingBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);e===Se.RIGHT&&(i=-i);var r=Cn.simplify(t,i),o=r.length-1;n.initSideSegments(r[o-1],r[0],e);for(var s=1;s<=o;s++){var a=1!==s;n.addNextSegment(r[s],a)}n.closeRing()},On.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),i=Cn.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],Se.LEFT);for(var o=2;o<=r;o++)e.addNextSegment(i[o],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var s=Cn.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],Se.LEFT);for(var A=a-2;A>=0;A--)e.addNextSegment(s[A],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},On.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case xn.CAP_ROUND:e.createCircle(t);break;case xn.CAP_SQUARE:e.createSquare(t)}},On.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()},On.prototype.getBufferParameters=function(){return this._bufParams},On.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},On.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return On.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},On.prototype.computeOffsetCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){var r=Cn.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Se.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{var a=Cn.simplify(t,i),A=a.length-1;n.initSideSegments(a[0],a[1],Se.LEFT),n.addFirstSegment();for(var u=2;u<=A;u++)n.addNextSegment(a[u],!0)}n.addLastSegment()},On.prototype.getSegGen=function(t){return new Ln(this._precisionModel,this._bufParams,t)},On.prototype.interfaces_=function(){return[]},On.prototype.getClass=function(){return On},On.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new x(t[n]);return e};var Dn=function(){this._subgraphs=null,this._seg=new dn,this._cga=new at;var t=arguments[0];this._subgraphs=t},Fn={DepthSegment:{configurable:!0}};Dn.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new wt,n=this._subgraphs.iterator();n.hasNext();){var i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(P(arguments[2],bt)&&arguments[0]instanceof x&&arguments[1]instanceof Ve){for(var o=arguments[0],s=arguments[1],a=arguments[2],A=s.getEdge().getCoordinates(),u=0;u<A.length-1;u++)if(this._seg.p0=A[u],this._seg.p1=A[u+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<o.x||this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||at.computeOrientation(this._seg.p0,this._seg.p1,o)===at.RIGHT)){var l=s.getDepth(Se.LEFT);this._seg.p0.equals(A[u])||(l=s.getDepth(Se.RIGHT));var c=new kn(this._seg,l);a.add(c)}}else if(P(arguments[2],bt)&&arguments[0]instanceof x&&P(arguments[1],bt))for(var h=arguments[0],f=arguments[2],p=arguments[1].iterator();p.hasNext();){var d=p.next();d.isForward()&&this.findStabbedSegments(h,d,f)}},Dn.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Je.min(e)._leftDepth},Dn.prototype.interfaces_=function(){return[]},Dn.prototype.getClass=function(){return Dn},Fn.DepthSegment.get=function(){return kn},Object.defineProperties(Dn,Fn);var kn=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new dn(t),this._leftDepth=e};kn.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n||0!=(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},kn.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},kn.prototype.toString=function(){return this._upwardSeg.toString()},kn.prototype.interfaces_=function(){return[E]},kn.prototype.getClass=function(){return kn};var Bn=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};Bn.prototype.area=function(){return Bn.area(this.p0,this.p1,this.p2)},Bn.prototype.signedArea=function(){return Bn.signedArea(this.p0,this.p1,this.p2)},Bn.prototype.interpolateZ=function(t){if(null===t)throw new m("Supplied point is null.");return Bn.interpolateZ(t,this.p0,this.p1,this.p2)},Bn.prototype.longestSideLength=function(){return Bn.longestSideLength(this.p0,this.p1,this.p2)},Bn.prototype.isAcute=function(){return Bn.isAcute(this.p0,this.p1,this.p2)},Bn.prototype.circumcentre=function(){return Bn.circumcentre(this.p0,this.p1,this.p2)},Bn.prototype.area3D=function(){return Bn.area3D(this.p0,this.p1,this.p2)},Bn.prototype.centroid=function(){return Bn.centroid(this.p0,this.p1,this.p2)},Bn.prototype.inCentre=function(){return Bn.inCentre(this.p0,this.p1,this.p2)},Bn.prototype.interfaces_=function(){return[]},Bn.prototype.getClass=function(){return Bn},Bn.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},Bn.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},Bn.det=function(t,e,n,i){return t*i-e*n},Bn.interpolateZ=function(t,e,n,i){var r=e.x,o=e.y,s=n.x-r,a=i.x-r,A=n.y-o,u=i.y-o,l=s*u-a*A,c=t.x-r,h=t.y-o,f=(u*c-a*h)/l,p=(-A*c+s*h)/l;return e.z+f*(n.z-e.z)+p*(i.z-e.z)},Bn.longestSideLength=function(t,e,n){var i=t.distance(e),r=e.distance(n),o=n.distance(t),s=i;return r>s&&(s=r),o>s&&(s=o),s},Bn.isAcute=function(t,e,n){return!!Pn.isAcute(t,e,n)&&!!Pn.isAcute(e,n,t)&&!!Pn.isAcute(n,t,e)},Bn.circumcentre=function(t,e,n){var i=n.x,r=n.y,o=t.x-i,s=t.y-r,a=e.x-i,A=e.y-r,u=2*Bn.det(o,s,a,A),l=Bn.det(s,o*o+s*s,A,a*a+A*A),c=Bn.det(o,o*o+s*s,a,a*a+A*A);return new x(i-l/u,r+c/u)},Bn.perpendicularBisector=function(t,e){var n=e.x-t.x,i=e.y-t.y,r=new H(t.x+n/2,t.y+i/2,1),o=new H(t.x-i+n/2,t.y+n+i/2,1);return new H(r,o)},Bn.angleBisector=function(t,e,n){var i=e.distance(t),r=i/(i+e.distance(n)),o=n.x-t.x,s=n.y-t.y;return new x(t.x+r*o,t.y+r*s)},Bn.area3D=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=e.z-t.z,s=n.x-t.x,a=n.y-t.y,A=n.z-t.z,u=r*A-o*a,l=o*s-i*A,c=i*a-r*s,h=u*u+l*l+c*c;return Math.sqrt(h)/2},Bn.centroid=function(t,e,n){var i=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new x(i,r)},Bn.inCentre=function(t,e,n){var i=e.distance(n),r=t.distance(n),o=t.distance(e),s=i+r+o,a=(i*t.x+r*e.x+o*n.x)/s,A=(i*t.y+r*e.y+o*n.y)/s;return new x(a,A)};var Un=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new wt;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};Un.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,I.EXTERIOR,I.INTERIOR)},Un.prototype.addPolygon=function(t){var e=this._distance,n=Se.LEFT;this._distance<0&&(e=-this._distance,n=Se.RIGHT);var i=t.getExteriorRing(),r=Ct.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,I.EXTERIOR,I.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=Ct.removeRepeatedPoints(s.getCoordinates());this._distance>0&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,Se.opposite(n),I.INTERIOR,I.EXTERIOR)}},Un.prototype.isTriangleErodedCompletely=function(t,e){var n=new Bn(t[0],t[1],t[2]),i=n.inCentre();return at.distancePointLine(i,n.p0,n.p1)<Math.abs(e)},Un.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Ct.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,I.EXTERIOR,I.INTERIOR)},Un.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var i=new pn(t,new Le(0,I.BOUNDARY,e,n));this._curveList.add(i)},Un.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Un.prototype.addPolygonRing=function(t,e,n,i,r){if(0===e&&t.length<ee.MINIMUM_VALID_SIZE)return null;var o=i,s=r;t.length>=ee.MINIMUM_VALID_SIZE&&at.isCCW(t)&&(o=r,s=i,n=Se.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)},Un.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Jt?this.addPolygon(t):t instanceof Qt?this.addLineString(t):t instanceof Kt?this.addPoint(t):(t instanceof te||t instanceof jt||t instanceof ne||t instanceof Vt)&&this.addCollection(t)},Un.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r},Un.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},Un.prototype.interfaces_=function(){return[]},Un.prototype.getClass=function(){return Un};var Gn=function(){};Gn.prototype.locate=function(t){},Gn.prototype.interfaces_=function(){return[]},Gn.prototype.getClass=function(){return Gn};var zn=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};zn.prototype.next=function(){if(this._atStart)return this._atStart=!1,zn.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new i;var t=this._parent.getGeometryN(this._index++);return t instanceof Vt?(this._subcollectionIterator=new zn(t),this._subcollectionIterator.next()):t},zn.prototype.remove=function(){throw new Error(this.getClass().getName())},zn.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},zn.prototype.interfaces_=function(){return[Et]},zn.prototype.getClass=function(){return zn},zn.isAtomic=function(t){return!(t instanceof Vt)};var Vn=function(){this._geom=null;var t=arguments[0];this._geom=t};Vn.prototype.locate=function(t){return Vn.locate(t,this._geom)},Vn.prototype.interfaces_=function(){return[Gn]},Vn.prototype.getClass=function(){return Vn},Vn.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&at.isPointInRing(t,e.getCoordinates())},Vn.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!Vn.isPointInRing(t,n))return!1;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i);if(Vn.isPointInRing(t,r))return!1}return!0},Vn.containsPoint=function(t,e){if(e instanceof Jt)return Vn.containsPointInPolygon(t,e);if(e instanceof Vt)for(var n=new zn(e);n.hasNext();){var i=n.next();if(i!==e&&Vn.containsPoint(t,i))return!0}return!1},Vn.locate=function(t,e){return e.isEmpty()?I.EXTERIOR:Vn.containsPoint(t,e)?I.INTERIOR:I.EXTERIOR};var jn=function(){this._edgeMap=new c,this._edgeList=null,this._ptInAreaLocation=[I.NONE,I.NONE]};jn.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},jn.prototype.propagateSideLabels=function(t){for(var e=I.NONE,n=this.iterator();n.hasNext();){var i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,Se.LEFT)!==I.NONE&&(e=i.getLocation(t,Se.LEFT))}if(e===I.NONE)return null;for(var r=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,Se.ON)===I.NONE&&a.setLocation(t,Se.ON,r),a.isArea(t)){var A=a.getLocation(t,Se.LEFT),u=a.getLocation(t,Se.RIGHT);if(u!==I.NONE){if(u!==r)throw new Ie("side location conflict",s.getCoordinate());A===I.NONE&&et.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),r=A}else et.isTrue(a.getLocation(t,Se.LEFT)===I.NONE,"found single null side"),a.setLocation(t,Se.RIGHT,r),a.setLocation(t,Se.LEFT,r)}}},jn.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},jn.prototype.print=function(t){W.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},jn.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},jn.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel().getLocation(t,Se.LEFT);et.isTrue(i!==I.NONE,"Found unlabelled area edge");for(var r=i,o=this.iterator();o.hasNext();){var s=o.next().getLabel();et.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,Se.LEFT),A=s.getLocation(t,Se.RIGHT);if(a===A)return!1;if(A!==r)return!1;r=a}return!0},jn.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},jn.prototype.iterator=function(){return this.getEdges().iterator()},jn.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new wt(this._edgeMap.values())),this._edgeList},jn.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===I.NONE&&(this._ptInAreaLocation[t]=Vn.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},jn.prototype.toString=function(){var t=new N;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},jn.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},jn.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next().getLabel(),r=0;r<2;r++)i.isLine(r)&&i.getLocation(r)===I.BOUNDARY&&(e[r]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),A=0;A<2;A++)if(a.isAnyNull(A)){var u=I.NONE;if(e[A])u=I.EXTERIOR;else{var l=s.getCoordinate();u=this.getLocation(A,l,t)}a.setAllLocationsIfNull(A,u)}},jn.prototype.getDegree=function(){return this._edgeMap.size()},jn.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},jn.prototype.interfaces_=function(){return[]},jn.prototype.getClass=function(){return jn};var Wn=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,i=0;i<this._resultAreaEdgeList.size();i++){var r=this._resultAreaEdgeList.get(i),o=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new Ie("no outgoing dirEdge found",this.getCoordinate());et.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),o=i.getQuadrant();return Ue.isNorthern(r)&&Ue.isNorthern(o)?n:Ue.isNorthern(r)||Ue.isNorthern(o)?0!==n.getDy()?n:0!==i.getDy()?i:(et.shouldNeverReachHere("found two horizontal edges incident on node"),null):i},e.prototype.print=function(t){W.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new wt;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;n>=0;n--){var i=this._edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)},e.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(Se.LEFT),i=t.getDepth(Se.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new Ie("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[1],s=arguments[2],a=arguments[0];a<o;a++){var A=this._edgeList.get(a);A.setEdgeDepths(Se.RIGHT,s),s=A.getDepth(Se.LEFT)}return s}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,i=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;r>=0;r--){var o=this._resultAreaEdgeList.get(r),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),i){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),i=this._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&(et.isTrue(null!==e,"found null for first outgoing dirEdge"),et.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],i=0,r=this.iterator();r.hasNext();)r.next().getEdgeRing()===n&&i++;return i}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=I.NONE,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=I.INTERIOR;break}if(i.isInResult()){t=I.EXTERIOR;break}}}if(t===I.NONE)return null;for(var r=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(r===I.INTERIOR):(s.isInResult()&&(r=I.EXTERIOR),a.isInResult()&&(r=I.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new Le(I.NONE);for(var n=this.iterator();n.hasNext();)for(var i=n.next().getEdge().getLabel(),r=0;r<2;r++){var o=i.getLocation(r);o!==I.INTERIOR&&o!==I.BOUNDARY||this._label.setLocation(r,I.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(jn),Hn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new ke(t,new Wn)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(je),Xn=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};Xn.prototype.compareTo=function(t){var e=t;return Xn.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},Xn.prototype.interfaces_=function(){return[E]},Xn.prototype.getClass=function(){return Xn},Xn.orientation=function(t){return 1===Ct.increasingDirection(t)},Xn.compareOriented=function(t,e,n,i){for(var r=e?1:-1,o=i?1:-1,s=e?t.length:-1,a=i?n.length:-1,A=e?0:t.length-1,u=i?0:n.length-1;;){var l=t[A].compareTo(n[u]);if(0!==l)return l;var c=(A+=r)===s,h=(u+=o)===a;if(c&&!h)return-1;if(!c&&h)return 1;if(c&&h)return 0}};var Yn=function(){this._edges=new wt,this._ocaMap=new c};Yn.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)r>0&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")},Yn.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Yn.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Yn.prototype.iterator=function(){return this._edges.iterator()},Yn.prototype.getEdges=function(){return this._edges},Yn.prototype.get=function(t){return this._edges.get(t)},Yn.prototype.findEqualEdge=function(t){var e=new Xn(t.getCoordinates());return this._ocaMap.get(e)},Yn.prototype.add=function(t){this._edges.add(t);var e=new Xn(t.getCoordinates());this._ocaMap.put(e,t)},Yn.prototype.interfaces_=function(){return[]},Yn.prototype.getClass=function(){return Yn};var qn=function(){};qn.prototype.processIntersections=function(t,e,n,i){},qn.prototype.isDone=function(){},qn.prototype.interfaces_=function(){return[]},qn.prototype.getClass=function(){return qn};var Qn=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};Qn.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(Qn.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},Qn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Qn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Qn.prototype.getLineIntersector=function(){return this._li},Qn.prototype.hasProperIntersection=function(){return this._hasProper},Qn.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Qn.prototype.hasIntersection=function(){return this._hasIntersection},Qn.prototype.isDone=function(){return!1},Qn.prototype.hasInteriorIntersection=function(){return this._hasInterior},Qn.prototype.interfaces_=function(){return[qn]},Qn.prototype.getClass=function(){return Qn},Qn.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var $n=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new x(t),this.segmentIndex=e,this.dist=n};$n.prototype.getSegmentIndex=function(){return this.segmentIndex},$n.prototype.getCoordinate=function(){return this.coord},$n.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},$n.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},$n.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},$n.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},$n.prototype.getDistance=function(){return this.dist},$n.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},$n.prototype.interfaces_=function(){return[E]},$n.prototype.getClass=function(){return $n};var Kn=function(){this._nodeMap=new c,this.edge=null;var t=arguments[0];this.edge=t};Kn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Kn.prototype.iterator=function(){return this._nodeMap.values().iterator()},Kn.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},Kn.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Kn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new x(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return r&&(o[s]=e.coord),new ni(o,new Le(this.edge._label))},Kn.prototype.add=function(t,e,n){var i=new $n(t,e,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)},Kn.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Kn.prototype.interfaces_=function(){return[]},Kn.prototype.getClass=function(){return Kn};var Zn=function(){};Zn.prototype.getChainStartIndices=function(t){var e=0,n=new wt;n.add(new O(e));do{var i=this.findChainEnd(t,e);n.add(new O(i)),e=i}while(e<t.length-1);return Zn.toIntArray(n)},Zn.prototype.findChainEnd=function(t,e){for(var n=Ue.quadrant(t[e],t[e+1]),i=e+1;i<t.length&&Ue.quadrant(t[i-1],t[i])===n;)i++;return i-1},Zn.prototype.interfaces_=function(){return[]},Zn.prototype.getClass=function(){return Zn},Zn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var Jn=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new X,this.env2=new X;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Zn;this.startIndex=e.getChainStartIndices(this.pts)};Jn.prototype.getCoordinates=function(){return this.pts},Jn.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},Jn.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},Jn.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],A=arguments[4],u=arguments[5],l=this.pts[r],c=this.pts[o],h=s.pts[a],f=s.pts[A];if(o-r==1&&A-a==1)return u.addIntersections(this.e,r,s.e,a),null;if(this.env1.init(l,c),this.env2.init(h,f),!this.env1.intersects(this.env2))return null;var p=Math.trunc((r+o)/2),d=Math.trunc((a+A)/2);r<p&&(a<d&&this.computeIntersectsForChain(r,p,s,a,d,u),d<A&&this.computeIntersectsForChain(r,p,s,d,A,u)),p<o&&(a<d&&this.computeIntersectsForChain(p,o,s,a,d,u),d<A&&this.computeIntersectsForChain(p,o,s,d,A,u))}},Jn.prototype.getStartIndexes=function(){return this.startIndex},Jn.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},Jn.prototype.interfaces_=function(){return[]},Jn.prototype.getClass=function(){return Jn};var ti=function t(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var e=0;e<2;e++)for(var n=0;n<3;n++)this._depth[e][n]=t.NULL_VALUE},ei={NULL_VALUE:{configurable:!0}};ti.prototype.getDepth=function(t,e){return this._depth[t][e]},ti.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},ti.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==ti.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===ti.NULL_VALUE}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._depth[i][r]===ti.NULL_VALUE}},ti.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}},ti.prototype.getDelta=function(t){return this._depth[t][Se.RIGHT]-this._depth[t][Se.LEFT]},ti.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?I.EXTERIOR:I.INTERIOR},ti.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},ti.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var i=t.getLocation(e,n);i!==I.EXTERIOR&&i!==I.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=ti.depthAtLocation(i):this._depth[e][n]+=ti.depthAtLocation(i))}else if(3===arguments.length){var r=arguments[0],o=arguments[1];arguments[2]===I.INTERIOR&&this._depth[r][o]++}},ti.prototype.interfaces_=function(){return[]},ti.prototype.getClass=function(){return ti},ti.depthAtLocation=function(t){return t===I.EXTERIOR?0:t===I.INTERIOR?1:ti.NULL_VALUE},ei.NULL_VALUE.get=function(){return-1},Object.defineProperties(ti,ei);var ni=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new Kn(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new ti,this._depthDelta=0,1===arguments.length){var n=arguments[0];e.call(this,n,null)}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.pts=i,this._label=r}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,Le.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var i=!0,r=!0,o=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(n.pts[s])||(i=!1),this.pts[s].equals2D(n.pts[--o])||(r=!1),!i&&!r)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Jn(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new X;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,n,i){var r=new x(t.getIntersection(i)),o=e,s=t.getEdgeDistance(n,i),a=o+1;if(a<this.pts.length){var A=this.pts[a];r.equals2D(A)&&(o=a,s=0)}this.eiList.add(r,o,s)},e.prototype.toString=function(){var t=new N;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],n=arguments[1];n.setAtLeastIfValid(e.getLocation(0,Se.ON),e.getLocation(1,Se.ON),1),e.isArea()&&(n.setAtLeastIfValid(e.getLocation(0,Se.LEFT),e.getLocation(1,Se.LEFT),2),n.setAtLeastIfValid(e.getLocation(0,Se.RIGHT),e.getLocation(1,Se.RIGHT),2))},e}(Fe),ii=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Yn,this._bufParams=t||null};ii.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},ii.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Le(t.getLabel())).flip(),n.merge(i);var r=ii.depthDelta(i),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(ii.depthDelta(t.getLabel()))},ii.prototype.buildSubgraphs=function(t,e){for(var n=new wt,i=t.iterator();i.hasNext();){var r=i.next(),o=r.getRightmostCoordinate(),s=new Dn(n).getDepth(o);r.computeDepth(s),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},ii.prototype.createSubgraphs=function(t){for(var e=new wt,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new Pe;r.create(i),e.add(r)}}return Je.sort(e,Je.reverseOrder()),e},ii.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},ii.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new bn,n=new rt;return n.setPrecisionModel(t),e.setSegmentIntersector(new Qn(n)),e},ii.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var i=new On(n,this._bufParams),r=new Un(t,e,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new We(new Hn),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new He(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},ii.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var r=i.next(),o=r.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=r.getData(),a=new ni(r.getCoordinates(),new Le(s));this.insertUniqueEdge(a)}}},ii.prototype.setNoder=function(t){this._workingNoder=t},ii.prototype.interfaces_=function(){return[]},ii.prototype.getClass=function(){return ii},ii.depthDelta=function(t){var e=t.getLocation(0,Se.LEFT),n=t.getLocation(0,Se.RIGHT);return e===I.INTERIOR&&n===I.EXTERIOR?1:e===I.EXTERIOR&&n===I.INTERIOR?-1:0},ii.convertSegStrings=function(t){for(var e=new _e,n=new wt;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)};var ri=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=arguments[3];this._noder=n,this._scaleFactor=i,this._offsetX=r,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};ri.prototype.rescale=function(){if(P(arguments[0],vt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],i=0;i<n.length;i++)n[i].x=n[i].x/this._scaleFactor+this._offsetX,n[i].y=n[i].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&W.out.println(n)}},ri.prototype.scale=function(){if(P(arguments[0],vt)){for(var t=arguments[0],e=new wt,n=t.iterator();n.hasNext();){var i=n.next();e.add(new pn(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],o=new Array(r.length).fill(null),s=0;s<r.length;s++)o[s]=new x(Math.round((r[s].x-this._offsetX)*this._scaleFactor),Math.round((r[s].y-this._offsetY)*this._scaleFactor),r[s].z);return Ct.removeRepeatedPoints(o)}},ri.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},ri.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},ri.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},ri.prototype.interfaces_=function(){return[vn]},ri.prototype.getClass=function(){return ri};var oi=function(){this._li=new rt,this._segStrings=null;var t=arguments[0];this._segStrings=t},si={fact:{configurable:!0}};oi.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1].iterator();i.hasNext();)for(var r=i.next().getCoordinates(),o=1;o<r.length-1;o++)if(r[o].equals(n))throw new J("found endpt/interior pt intersection at index "+o+" :pt "+n)},oi.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(2===arguments.length)for(var r=arguments[0],o=arguments[1],s=r.getCoordinates(),a=o.getCoordinates(),A=0;A<s.length-1;A++)for(var u=0;u<a.length-1;u++)this.checkInteriorIntersections(r,A,o,u);else if(4===arguments.length){var l=arguments[0],c=arguments[1],h=arguments[2],f=arguments[3];if(l===h&&c===f)return null;var p=l.getCoordinates()[c],d=l.getCoordinates()[c+1],g=h.getCoordinates()[f],_=h.getCoordinates()[f+1];if(this._li.computeIntersection(p,d,g,_),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,p,d)||this.hasInteriorIntersection(this._li,g,_)))throw new J("found non-noded intersection at "+p+"-"+d+" and "+g+"-"+_)}},oi.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},oi.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),i=0;i<n.length-2;i++)this.checkCollapse(n[i],n[i+1],n[i+2])},oi.prototype.hasInteriorIntersection=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1},oi.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new J("found non-noded collapse at "+oi.fact.createLineString([t,e,n]))},oi.prototype.interfaces_=function(){return[]},oi.prototype.getClass=function(){return oi},si.fact.get=function(){return new _e},Object.defineProperties(oi,si);var ai=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new m("Scale factor must be non-zero");1!==e&&(this._pt=new x(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new x,this._p1Scaled=new x),this.initCorners(this._pt)},Ai={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};ai.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<n||this._minx>i||this._maxy<r||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return et.isTrue(!(s&&a),"Found bad envelope test"),a},ai.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new x(this._maxx,this._maxy),this._corner[1]=new x(this._minx,this._maxy),this._corner[2]=new x(this._minx,this._miny),this._corner[3]=new x(this._maxx,this._miny)},ai.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},ai.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},ai.prototype.getCoordinate=function(){return this._originalPt},ai.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},ai.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=ai.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new X(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},ai.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},ai.prototype.intersectsToleranceSquare=function(t,e){var n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&i||t.equals(this._pt)||e.equals(this._pt)))))},ai.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},ai.prototype.interfaces_=function(){return[]},ai.prototype.getClass=function(){return ai},Ai.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(ai,Ai);var ui=function(){this.tempEnv1=new X,this.selectedSegment=new dn};ui.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}},ui.prototype.interfaces_=function(){return[]},ui.prototype.getClass=function(){return ui};var li=function(){this._index=null;var t=arguments[0];this._index=t},ci={HotPixelSnapAction:{configurable:!0}};li.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=e.getSafeEnvelope(),o=new hi(e,n,i);return this._index.query(r,{interfaces_:function(){return[Qe]},visitItem:function(t){t.select(r,o)}}),o.isNodeAdded()}},li.prototype.interfaces_=function(){return[]},li.prototype.getClass=function(){return li},ci.HotPixelSnapAction.get=function(){return hi},Object.defineProperties(li,ci);var hi=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],n=arguments[1],i=arguments[2];this._hotPixel=e,this._parentEdge=n,this._hotPixelVertexIndex=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[1],n=arguments[0].getContext();if(null!==this._parentEdge&&n===this._parentEdge&&e===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(n,e)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ui),fi=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new wt};fi.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var A=0;A<this._li.getIntersectionNum();A++)this._interiorIntersections.add(this._li.getIntersection(A));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}},fi.prototype.isDone=function(){return!1},fi.prototype.getInteriorIntersections=function(){return this._interiorIntersections},fi.prototype.interfaces_=function(){return[qn]},fi.prototype.getClass=function(){return fi};var pi=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new rt,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};pi.prototype.checkCorrectness=function(t){var e=pn.getNodedSubstrings(t),n=new oi(e);try{n.checkValid()}catch(t){if(!(t instanceof V))throw t;t.printStackTrace()}},pi.prototype.getNodedSubstrings=function(){return pn.getNodedSubstrings(this._nodedSegStrings)},pi.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},pi.prototype.findInteriorIntersections=function(t,e){var n=new fi(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},pi.prototype.computeVertexSnaps=function(){if(P(arguments[0],vt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof pn)for(var n=arguments[0],i=n.getCoordinates(),r=0;r<i.length;r++){var o=new ai(i[r],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,r)&&n.addIntersection(i[r],r)}},pi.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new bn,this._pointSnapper=new li(this._noder.getIndex()),this.snapRound(t,this._li)},pi.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new ai(n,this._scaleFactor,this._li);this._pointSnapper.snap(i)}},pi.prototype.interfaces_=function(){return[vn]},pi.prototype.getClass=function(){return pi};var di=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new xn,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},gi={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};di.prototype.bufferFixedPrecision=function(t){var e=new ri(new pi(new fe(1)),t.getScale()),n=new ii(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},di.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=di.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof Ie))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],i=di.precisionScaleFactor(this._argGeom,this._distance,n),r=new fe(i);this.bufferFixedPrecision(r)}},di.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===fe.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},di.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},di.prototype.bufferOriginalPrecision=function(){try{var t=new ii(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof J))throw t;this._saveException=t}},di.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},di.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},di.prototype.interfaces_=function(){return[]},di.prototype.getClass=function(){return di},di.bufferOp=function(){if(2===arguments.length){var t=arguments[1];return new di(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof lt&&"number"==typeof arguments[1]){var e=arguments[1],n=arguments[2],i=new di(arguments[0]);return i.setQuadrantSegments(n),i.getResultGeometry(e)}if(arguments[2]instanceof xn&&arguments[0]instanceof lt&&"number"==typeof arguments[1]){var r=arguments[1];return new di(arguments[0],arguments[2]).getResultGeometry(r)}}else if(4===arguments.length){var o=arguments[1],s=arguments[2],a=arguments[3],A=new di(arguments[0]);return A.setQuadrantSegments(s),A.setEndCapStyle(a),A.getResultGeometry(o)}},di.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),r=M.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(e>0?e:0),o=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)},gi.CAP_ROUND.get=function(){return xn.CAP_ROUND},gi.CAP_BUTT.get=function(){return xn.CAP_FLAT},gi.CAP_FLAT.get=function(){return xn.CAP_FLAT},gi.CAP_SQUARE.get=function(){return xn.CAP_SQUARE},gi.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(di,gi);var _i=function(){this._pt=[new x,new x],this._distance=y.NaN,this._isNull=!0};_i.prototype.getCoordinates=function(){return this._pt},_i.prototype.getCoordinate=function(t){return this._pt[t]},_i.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},_i.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},_i.prototype.getDistance=function(){return this._distance},_i.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},_i.prototype.interfaces_=function(){return[]},_i.prototype.getClass=function(){return _i};var mi=function(){};mi.prototype.interfaces_=function(){return[]},mi.prototype.getClass=function(){return mi},mi.computeDistance=function(){if(arguments[2]instanceof _i&&arguments[0]instanceof Qt&&arguments[1]instanceof x)for(var t=arguments[1],e=arguments[2],n=arguments[0].getCoordinates(),i=new dn,r=0;r<n.length-1;r++){i.setCoordinates(n[r],n[r+1]);var o=i.closestPoint(t);e.setMinimum(o,t)}else if(arguments[2]instanceof _i&&arguments[0]instanceof Jt&&arguments[1]instanceof x){var s=arguments[0],a=arguments[1],A=arguments[2];mi.computeDistance(s.getExteriorRing(),a,A);for(var u=0;u<s.getNumInteriorRing();u++)mi.computeDistance(s.getInteriorRingN(u),a,A)}else if(arguments[2]instanceof _i&&arguments[0]instanceof lt&&arguments[1]instanceof x){var l=arguments[0],c=arguments[1],h=arguments[2];if(l instanceof Qt)mi.computeDistance(l,c,h);else if(l instanceof Jt)mi.computeDistance(l,c,h);else if(l instanceof Vt)for(var f=l,p=0;p<f.getNumGeometries();p++){var d=f.getGeometryN(p);mi.computeDistance(d,c,h)}else h.setMinimum(l.getCoordinate(),c)}else if(arguments[2]instanceof _i&&arguments[0]instanceof dn&&arguments[1]instanceof x){var g=arguments[1],_=arguments[2],m=arguments[0].closestPoint(g);_.setMinimum(m,g)}};var yi=function(t){this._maxPtDist=new _i,this._inputGeom=t||null},vi={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};yi.prototype.computeMaxMidpointDistance=function(t){var e=new bi(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},yi.prototype.computeMaxVertexDistance=function(t){var e=new Ei(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},yi.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},yi.prototype.getDistancePoints=function(){return this._maxPtDist},yi.prototype.interfaces_=function(){return[]},yi.prototype.getClass=function(){return yi},vi.MaxPointDistanceFilter.get=function(){return Ei},vi.MaxMidpointDistanceFilter.get=function(){return bi},Object.defineProperties(yi,vi);var Ei=function(t){this._maxPtDist=new _i,this._minPtDist=new _i,this._geom=t||null};Ei.prototype.filter=function(t){this._minPtDist.initialize(),mi.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Ei.prototype.getMaxPointDistance=function(){return this._maxPtDist},Ei.prototype.interfaces_=function(){return[ft]},Ei.prototype.getClass=function(){return Ei};var bi=function(t){this._maxPtDist=new _i,this._minPtDist=new _i,this._geom=t||null};bi.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=new x((n.x+i.x)/2,(n.y+i.y)/2);this._minPtDist.initialize(),mi.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},bi.prototype.isDone=function(){return!1},bi.prototype.isGeometryChanged=function(){return!1},bi.prototype.getMaxPointDistance=function(){return this._maxPtDist},bi.prototype.interfaces_=function(){return[zt]},bi.prototype.getClass=function(){return bi};var wi=function(t){this._comps=t||null};wi.prototype.filter=function(t){t instanceof Jt&&this._comps.add(t)},wi.prototype.interfaces_=function(){return[Gt]},wi.prototype.getClass=function(){return wi},wi.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return wi.getPolygons(t,new wt)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Jt?n.add(e):e instanceof Vt&&e.apply(new wi(n)),n}};var xi=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};xi.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof ee){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Qt&&this._lines.add(t)},xi.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},xi.prototype.interfaces_=function(){return[ut]},xi.prototype.getClass=function(){return xi},xi.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(xi.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(xi.getLines(e,n))}},xi.getLines=function(){if(1===arguments.length){var t=arguments[0];return xi.getLines(t,!1)}if(2===arguments.length){if(P(arguments[0],vt)&&P(arguments[1],vt)){for(var e=arguments[1],n=arguments[0].iterator();n.hasNext();){var i=n.next();xi.getLines(i,e)}return e}if(arguments[0]instanceof lt&&"boolean"==typeof arguments[1]){var r=arguments[0],o=arguments[1],s=new wt;return r.apply(new xi(s,o)),s}if(arguments[0]instanceof lt&&P(arguments[1],vt)){var a=arguments[0],A=arguments[1];return a instanceof Qt?A.add(a):a.apply(new xi(A)),A}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&P(arguments[0],vt)&&P(arguments[1],vt)){for(var u=arguments[1],l=arguments[2],c=arguments[0].iterator();c.hasNext();){var h=c.next();xi.getLines(h,u,l)}return u}if("boolean"==typeof arguments[2]&&arguments[0]instanceof lt&&P(arguments[1],vt)){var f=arguments[1],p=arguments[2];return arguments[0].apply(new xi(f,p)),f}}};var Si=function(){if(this._boundaryRule=pt.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new m("Rule must be non-null");this._boundaryRule=t}};Si.prototype.locateInternal=function(){if(arguments[0]instanceof x&&arguments[1]instanceof Jt){var t=arguments[0],e=arguments[1];if(e.isEmpty())return I.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===I.EXTERIOR)return I.EXTERIOR;if(i===I.BOUNDARY)return I.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var o=e.getInteriorRingN(r),s=this.locateInPolygonRing(t,o);if(s===I.INTERIOR)return I.EXTERIOR;if(s===I.BOUNDARY)return I.BOUNDARY}return I.INTERIOR}if(arguments[0]instanceof x&&arguments[1]instanceof Qt){var a=arguments[0],A=arguments[1];if(!A.getEnvelopeInternal().intersects(a))return I.EXTERIOR;var u=A.getCoordinates();return A.isClosed()||!a.equals(u[0])&&!a.equals(u[u.length-1])?at.isOnLine(a,u)?I.INTERIOR:I.EXTERIOR:I.BOUNDARY}if(arguments[0]instanceof x&&arguments[1]instanceof Kt){var l=arguments[0];return arguments[1].getCoordinate().equals2D(l)?I.INTERIOR:I.EXTERIOR}},Si.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?at.locatePointInRing(t,e.getCoordinates()):I.EXTERIOR},Si.prototype.intersects=function(t,e){return this.locate(t,e)!==I.EXTERIOR},Si.prototype.updateLocationInfo=function(t){t===I.INTERIOR&&(this._isIn=!0),t===I.BOUNDARY&&this._numBoundaries++},Si.prototype.computeLocation=function(t,e){if(e instanceof Kt&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Qt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Jt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof jt)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof ne)for(var o=e,s=0;s<o.getNumGeometries();s++){var a=o.getGeometryN(s);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof Vt)for(var A=new zn(e);A.hasNext();){var u=A.next();u!==e&&this.computeLocation(t,u)}},Si.prototype.locate=function(t,e){return e.isEmpty()?I.EXTERIOR:e instanceof Qt||e instanceof Jt?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?I.BOUNDARY:this._numBoundaries>0||this._isIn?I.INTERIOR:I.EXTERIOR)},Si.prototype.interfaces_=function(){return[]},Si.prototype.getClass=function(){return Si};var Ci=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)t.call(this,arguments[0],t.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];this._component=e,this._segIndex=n,this._pt=i}},Ti={INSIDE_AREA:{configurable:!0}};Ci.prototype.isInsideArea=function(){return this._segIndex===Ci.INSIDE_AREA},Ci.prototype.getCoordinate=function(){return this._pt},Ci.prototype.getGeometryComponent=function(){return this._component},Ci.prototype.getSegmentIndex=function(){return this._segIndex},Ci.prototype.interfaces_=function(){return[]},Ci.prototype.getClass=function(){return Ci},Ti.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Ci,Ti);var Ii=function(t){this._pts=t||null};Ii.prototype.filter=function(t){t instanceof Kt&&this._pts.add(t)},Ii.prototype.interfaces_=function(){return[Gt]},Ii.prototype.getClass=function(){return Ii},Ii.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Kt?Je.singletonList(t):Ii.getPoints(t,new wt)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Kt?n.add(e):e instanceof Vt&&e.apply(new Ii(n)),n}};var Ri=function(){this._locations=null;var t=arguments[0];this._locations=t};Ri.prototype.filter=function(t){(t instanceof Kt||t instanceof Qt||t instanceof Jt)&&this._locations.add(new Ci(t,0,t.getCoordinate()))},Ri.prototype.interfaces_=function(){return[Gt]},Ri.prototype.getClass=function(){return Ri},Ri.getLocations=function(t){var e=new wt;return t.apply(new Ri(e)),e};var Pi=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Si,this._minDistanceLocation=null,this._minDistance=y.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=i,this._terminateDistance=r}};Pi.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=1-e,r=wi.getPolygons(this._geom[e]);if(r.size()>0){var o=Ri.getLocations(this._geom[i]);if(this.computeContainmentDistance(o,r,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[i]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&P(arguments[0],bt)&&P(arguments[1],bt)){for(var s=arguments[0],a=arguments[1],A=arguments[2],u=0;u<s.size();u++)for(var l=s.get(u),c=0;c<a.size();c++)if(this.computeContainmentDistance(l,a.get(c),A),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Ci&&arguments[1]instanceof Jt){var h=arguments[0],f=arguments[1],p=arguments[2],d=h.getCoordinate();if(I.EXTERIOR!==this._ptLocator.locate(d,f))return this._minDistance=0,p[0]=h,p[1]=new Ci(f,d),null}},Pi.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Pi.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=xi.getLines(this._geom[0]),n=xi.getLines(this._geom[1]),i=Ii.getPoints(this._geom[0]),r=Ii.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))},Pi.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Pi.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},Pi.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Pi.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Qt&&arguments[1]instanceof Kt){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var i=t.getCoordinates(),r=e.getCoordinate(),o=0;o<i.length-1;o++){var s=at.distancePointLine(r,i[o],i[o+1]);if(s<this._minDistance){this._minDistance=s;var a=new dn(i[o],i[o+1]).closestPoint(r);n[0]=new Ci(t,o,a),n[1]=new Ci(e,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Qt&&arguments[1]instanceof Qt){var A=arguments[0],u=arguments[1],l=arguments[2];if(A.getEnvelopeInternal().distance(u.getEnvelopeInternal())>this._minDistance)return null;for(var c=A.getCoordinates(),h=u.getCoordinates(),f=0;f<c.length-1;f++)for(var p=0;p<h.length-1;p++){var d=at.distanceLineLine(c[f],c[f+1],h[p],h[p+1]);if(d<this._minDistance){this._minDistance=d;var g=new dn(c[f],c[f+1]),_=new dn(h[p],h[p+1]),m=g.closestPoints(_);l[0]=new Ci(A,f,m[0]),l[1]=new Ci(u,p,m[1])}if(this._minDistance<=this._terminateDistance)return null}}},Pi.prototype.computeMinDistancePoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o),a=r.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new Ci(r,0,r.getCoordinate()),n[1]=new Ci(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Pi.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new m("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Pi.prototype.computeMinDistanceLines=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Pi.prototype.interfaces_=function(){return[]},Pi.prototype.getClass=function(){return Pi},Pi.distance=function(t,e){return new Pi(t,e).distance()},Pi.isWithinDistance=function(t,e,n){return new Pi(t,e,n).distance()<=n},Pi.nearestPoints=function(t,e){return new Pi(t,e).nearestPoints()};var Mi=function(){this._pt=[new x,new x],this._distance=y.NaN,this._isNull=!0};Mi.prototype.getCoordinates=function(){return this._pt},Mi.prototype.getCoordinate=function(t){return this._pt[t]},Mi.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},Mi.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},Mi.prototype.toString=function(){return Z.toLineString(this._pt[0],this._pt[1])},Mi.prototype.getDistance=function(){return this._distance},Mi.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},Mi.prototype.interfaces_=function(){return[]},Mi.prototype.getClass=function(){return Mi};var Li=function(){};Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li},Li.computeDistance=function(){if(arguments[2]instanceof Mi&&arguments[0]instanceof Qt&&arguments[1]instanceof x)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=new dn,r=t.getCoordinates(),o=0;o<r.length-1;o++){i.setCoordinates(r[o],r[o+1]);var s=i.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof Mi&&arguments[0]instanceof Jt&&arguments[1]instanceof x){var a=arguments[0],A=arguments[1],u=arguments[2];Li.computeDistance(a.getExteriorRing(),A,u);for(var l=0;l<a.getNumInteriorRing();l++)Li.computeDistance(a.getInteriorRingN(l),A,u)}else if(arguments[2]instanceof Mi&&arguments[0]instanceof lt&&arguments[1]instanceof x){var c=arguments[0],h=arguments[1],f=arguments[2];if(c instanceof Qt)Li.computeDistance(c,h,f);else if(c instanceof Jt)Li.computeDistance(c,h,f);else if(c instanceof Vt)for(var p=c,d=0;d<p.getNumGeometries();d++){var g=p.getGeometryN(d);Li.computeDistance(g,h,f)}else f.setMinimum(c.getCoordinate(),h)}else if(arguments[2]instanceof Mi&&arguments[0]instanceof dn&&arguments[1]instanceof x){var _=arguments[1],m=arguments[2],y=arguments[0].closestPoint(_);m.setMinimum(y,_)}};var Ni=function(){this._g0=null,this._g1=null,this._ptDist=new Mi,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},Oi={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Ni.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Ni.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new m("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Ni.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Ni.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Ni.prototype.computeOrientedDistance=function(t,e,n){var i=new Di(e);if(t.apply(i),n.setMaximum(i.getMaxPointDistance()),this._densifyFrac>0){var r=new Fi(e,this._densifyFrac);t.apply(r),n.setMaximum(r.getMaxPointDistance())}},Ni.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Ni.prototype.interfaces_=function(){return[]},Ni.prototype.getClass=function(){return Ni},Ni.distance=function(){if(2===arguments.length)return new Ni(arguments[0],arguments[1]).distance();if(3===arguments.length){var t=arguments[2],e=new Ni(arguments[0],arguments[1]);return e.setDensifyFraction(t),e.distance()}},Oi.MaxPointDistanceFilter.get=function(){return Di},Oi.MaxDensifiedByFractionDistanceFilter.get=function(){return Fi},Object.defineProperties(Ni,Oi);var Di=function(){this._maxPtDist=new Mi,this._minPtDist=new Mi,this._euclideanDist=new Li,this._geom=null;var t=arguments[0];this._geom=t};Di.prototype.filter=function(t){this._minPtDist.initialize(),Li.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Di.prototype.getMaxPointDistance=function(){return this._maxPtDist},Di.prototype.interfaces_=function(){return[ft]},Di.prototype.getClass=function(){return Di};var Fi=function(){this._maxPtDist=new Mi,this._minPtDist=new Mi,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};Fi.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=(i.x-n.x)/this._numSubSegs,o=(i.y-n.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var a=n.x+s*r,A=n.y+s*o,u=new x(a,A);this._minPtDist.initialize(),Li.computeDistance(this._geom,u,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Fi.prototype.isDone=function(){return!1},Fi.prototype.isGeometryChanged=function(){return!1},Fi.prototype.getMaxPointDistance=function(){return this._maxPtDist},Fi.prototype.interfaces_=function(){return[zt]},Fi.prototype.getClass=function(){return Fi};var ki=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},Bi={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};ki.prototype.checkMaximumDistance=function(t,e,n){var i=new Ni(e,t);if(i.setDensifyFraction(.25),this._maxDistanceFound=i.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var r=i.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Z.toLineString(r[0],r[1])+")"}},ki.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=ki.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),ki.VERBOSE&&W.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},ki.prototype.checkNegativeValid=function(){if(!(this._input instanceof Jt||this._input instanceof ne||this._input instanceof Vt))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},ki.prototype.getErrorIndicator=function(){return this._errorIndicator},ki.prototype.checkMinimumDistance=function(t,e,n){var i=new Pi(t,e,n);if(this._minDistanceFound=i.distance(),this._minDistanceFound<n){this._isValid=!1;var r=i.nearestPoints();this._errorLocation=i.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Z.toLineString(r[0],r[1])+" )"}},ki.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},ki.prototype.getErrorLocation=function(){return this._errorLocation},ki.prototype.getPolygonLines=function(t){for(var e=new wt,n=new xi(e),i=wi.getPolygons(t).iterator();i.hasNext();)i.next().apply(n);return t.getFactory().buildGeometry(e)},ki.prototype.getErrorMessage=function(){return this._errMsg},ki.prototype.interfaces_=function(){return[]},ki.prototype.getClass=function(){return ki},Bi.VERBOSE.get=function(){return!1},Bi.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(ki,Bi);var Ui=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},Gi={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Ui.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},Ui.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*Ui.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new X(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new X(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},Ui.prototype.checkDistance=function(){var t=new ki(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},Ui.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Ui.prototype.checkPolygonal=function(){this._result instanceof Jt||this._result instanceof ne||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Ui.prototype.getErrorIndicator=function(){return this._errorIndicator},Ui.prototype.getErrorLocation=function(){return this._errorLocation},Ui.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Ui.prototype.report=function(t){if(!Ui.VERBOSE)return null;W.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},Ui.prototype.getErrorMessage=function(){return this._errorMsg},Ui.prototype.interfaces_=function(){return[]},Ui.prototype.getClass=function(){return Ui},Ui.isValidMsg=function(t,e,n){var i=new Ui(t,e,n);return i.isValid()?null:i.getErrorMessage()},Ui.isValid=function(t,e,n){return!!new Ui(t,e,n).isValid()},Gi.VERBOSE.get=function(){return!1},Gi.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Ui,Gi);var zi=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};zi.prototype.getCoordinates=function(){return this._pts},zi.prototype.size=function(){return this._pts.length},zi.prototype.getCoordinate=function(t){return this._pts[t]},zi.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},zi.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:cn.octant(this.getCoordinate(t),this.getCoordinate(t+1))},zi.prototype.setData=function(t){this._data=t},zi.prototype.getData=function(){return this._data},zi.prototype.toString=function(){return Z.toLineString(new Ae(this._pts))},zi.prototype.interfaces_=function(){return[hn]},zi.prototype.getClass=function(){return zi};var Vi=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new wt,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};Vi.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Vi.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},Vi.prototype.getIntersectionSegments=function(){return this._intSegments},Vi.prototype.count=function(){return this._intersectionCount},Vi.prototype.getIntersections=function(){return this._intersections},Vi.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Vi.prototype.setKeepIntersections=function(t){this._keepIntersections=t},Vi.prototype.processIntersections=function(t,e,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,i))return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Vi.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},Vi.prototype.hasIntersection=function(){return null!==this._interiorIntersection},Vi.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},Vi.prototype.interfaces_=function(){return[qn]},Vi.prototype.getClass=function(){return Vi},Vi.createAllIntersectionsFinder=function(t){var e=new Vi(t);return e.setFindAllIntersections(!0),e},Vi.createAnyIntersectionFinder=function(t){return new Vi(t)},Vi.createIntersectionCounter=function(t){var e=new Vi(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var ji=function(){this._li=new rt,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};ji.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},ji.prototype.getIntersections=function(){return this._segInt.getIntersections()},ji.prototype.isValid=function(){return this.execute(),this._isValid},ji.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},ji.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Vi(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new bn;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},ji.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Ie(this.getErrorMessage(),this._segInt.getInteriorIntersection())},ji.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Z.toLineString(t[0],t[1])+" and "+Z.toLineString(t[2],t[3])},ji.prototype.interfaces_=function(){return[]},ji.prototype.getClass=function(){return ji},ji.computeIntersections=function(t){var e=new ji(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var Wi=function t(){this._nv=null;var e=arguments[0];this._nv=new ji(t.toSegmentStrings(e))};Wi.prototype.checkValid=function(){this._nv.checkValid()},Wi.prototype.interfaces_=function(){return[]},Wi.prototype.getClass=function(){return Wi},Wi.toSegmentStrings=function(t){for(var e=new wt,n=t.iterator();n.hasNext();){var i=n.next();e.add(new zi(i.getCoordinates(),i))}return e},Wi.checkValid=function(t){new Wi(t).checkValid()};var Hi=function(t){this._mapOp=t};Hi.prototype.map=function(t){for(var e=new wt,n=0;n<t.getNumGeometries();n++){var i=this._mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(_e.toGeometryArray(e))},Hi.prototype.interfaces_=function(){return[]},Hi.prototype.getClass=function(){return Hi},Hi.map=function(t,e){return new Hi(e).map(t)};var Xi=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new wt,this._resultLineList=new wt;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};Xi.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},Xi.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},Xi.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},Xi.prototype.collectLineEdge=function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Cr.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},Xi.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this._op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}},Xi.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},Xi.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(i),n.setInResult(!0)}},Xi.prototype.collectBoundaryTouchEdge=function(t,e,n){var i=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(et.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Cr.isResultOfOp(i,e)&&e===Cr.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},Xi.prototype.interfaces_=function(){return[]},Xi.prototype.getClass=function(){return Xi};var Yi=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new wt;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Yi.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},Yi.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==Cr.INTERSECTION)){var i=n.getLabel();Cr.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},Yi.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Yi.prototype.interfaces_=function(){return[]},Yi.prototype.getClass=function(){return Yi};var qi=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};qi.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},qi.prototype.transformPolygon=function(t,e){var n=!0,i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof ee&&!i.isEmpty()||(n=!1);for(var r=new wt,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof ee||(n=!1),r.add(s))}if(n)return this._factory.createPolygon(i,r.toArray([]));var a=new wt;return null!==i&&a.add(i),a.addAll(r),this._factory.buildGeometry(a)},qi.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},qi.prototype.getInputGeometry=function(){return this._inputGeom},qi.prototype.transformMultiLineString=function(t,e){for(var n=new wt,i=0;i<t.getNumGeometries();i++){var r=this.transformLineString(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},qi.prototype.transformCoordinates=function(t,e){return this.copy(t)},qi.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},qi.prototype.transformMultiPoint=function(t,e){for(var n=new wt,i=0;i<t.getNumGeometries();i++){var r=this.transformPoint(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},qi.prototype.transformMultiPolygon=function(t,e){for(var n=new wt,i=0;i<t.getNumGeometries();i++){var r=this.transformPolygon(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},qi.prototype.copy=function(t){return t.copy()},qi.prototype.transformGeometryCollection=function(t,e){for(var n=new wt,i=0;i<t.getNumGeometries();i++){var r=this.transform(t.getGeometryN(i));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(_e.toGeometryArray(n)):this._factory.buildGeometry(n)},qi.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Kt)return this.transformPoint(t,null);if(t instanceof te)return this.transformMultiPoint(t,null);if(t instanceof ee)return this.transformLinearRing(t,null);if(t instanceof Qt)return this.transformLineString(t,null);if(t instanceof jt)return this.transformMultiLineString(t,null);if(t instanceof Jt)return this.transformPolygon(t,null);if(t instanceof ne)return this.transformMultiPolygon(t,null);if(t instanceof Vt)return this.transformGeometryCollection(t,null);throw new m("Unknown Geometry subtype: "+t.getClass().getName())},qi.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var i=n.size();return i>0&&i<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},qi.prototype.interfaces_=function(){return[]},qi.prototype.getClass=function(){return qi};var Qi=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new dn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Qt&&"number"==typeof arguments[1]){var e=arguments[1];t.call(this,arguments[0].getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this._srcPts=n,this._isClosed=t.isClosed(n),this._snapTolerance=i}};Qi.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;i<n;i++){var r=t.get(i),o=this.findSnapForVertex(r,e);null!==o&&(t.set(i,new x(o)),0===i&&this._isClosed&&t.set(t.size()-1,new x(o)))}},Qi.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},Qi.prototype.snapTo=function(t){var e=new St(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},Qi.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;i<n;i++){var r=e[i],o=this.findSegmentIndexToSnap(r,t);o>=0&&t.add(o+1,new x(r),!1)}},Qi.prototype.findSegmentIndexToSnap=function(t,e){for(var n=y.MAX_VALUE,i=-1,r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,i=r)}return i},Qi.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},Qi.prototype.interfaces_=function(){return[]},Qi.prototype.getClass=function(){return Qi},Qi.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var $i=function(t){this._srcGeom=t||null},Ki={SNAP_PRECISION_FACTOR:{configurable:!0}};$i.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new Zi(e,n).transform(this._srcGeom)},$i.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),i=new Zi(t,n,!0).transform(this._srcGeom),r=i;return e&&P(r,Zt)&&(r=i.buffer(0)),r},$i.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},$i.prototype.extractTargetCoordinates=function(t){for(var e=new f,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))},$i.prototype.computeMinimumSegmentLength=function(t){for(var e=y.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);i<e&&(e=i)}return e},$i.prototype.interfaces_=function(){return[]},$i.prototype.getClass=function(){return $i},$i.snap=function(t,e,n){var i=new Array(2).fill(null),r=new $i(t);i[0]=r.snapTo(e,n);var o=new $i(e);return i[1]=o.snapTo(i[0],n),i},$i.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=$i.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===fe.FIXED){var i=1/n.getScale()*2/1.415;i>e&&(e=i)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1];return Math.min($i.computeOverlaySnapTolerance(r),$i.computeOverlaySnapTolerance(o))}},$i.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*$i.SNAP_PRECISION_FACTOR},$i.snapToSelf=function(t,e,n){return new $i(t).snapToSelf(e,n)},Ki.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties($i,Ki);var Zi=function(t){function e(e,n,i){t.call(this),this._snapTolerance=e||null,this._snapPts=n||null,this._isSelfSnap=void 0!==i&&i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var n=new Qi(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),i=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(qi),Ji=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Ji.prototype.getCommon=function(){return y.longBitsToDouble(this._commonBits)},Ji.prototype.add=function(t){var e=y.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=Ji.signExpBits(this._commonBits),this._isFirst=!1,null):Ji.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Ji.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=Ji.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},Ji.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=y.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+y.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}},Ji.prototype.interfaces_=function(){return[]},Ji.prototype.getClass=function(){return Ji},Ji.getBit=function(t,e){return t&1<<e?1:0},Ji.signExpBits=function(t){return t>>52},Ji.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},Ji.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;i>=0;i--){if(Ji.getBit(t,i)!==Ji.getBit(e,i))return n;n++}return 52};var tr=function(){this._commonCoord=null,this._ccFilter=new nr},er={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};tr.prototype.addCommonBits=function(t){var e=new ir(this._commonCoord);t.apply(e),t.geometryChanged()},tr.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new x(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new ir(e);return t.apply(n),t.geometryChanged(),t},tr.prototype.getCommonCoordinate=function(){return this._commonCoord},tr.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},tr.prototype.interfaces_=function(){return[]},tr.prototype.getClass=function(){return tr},er.CommonCoordinateFilter.get=function(){return nr},er.Translater.get=function(){return ir},Object.defineProperties(tr,er);var nr=function(){this._commonBitsX=new Ji,this._commonBitsY=new Ji};nr.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},nr.prototype.getCommonCoordinate=function(){return new x(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},nr.prototype.interfaces_=function(){return[ft]},nr.prototype.getClass=function(){return nr};var ir=function(){this.trans=null;var t=arguments[0];this.trans=t};ir.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)},ir.prototype.isDone=function(){return!1},ir.prototype.isGeometryChanged=function(){return!0},ir.prototype.interfaces_=function(){return[zt]},ir.prototype.getClass=function(){return ir};var rr=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};rr.prototype.selfSnap=function(t){return new $i(t).snapTo(t,this._snapTolerance)},rr.prototype.removeCommonBits=function(t){this._cbr=new tr,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},rr.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},rr.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=Cr.overlayOp(e[0],e[1],t);return this.prepareResult(n)},rr.prototype.checkValid=function(t){t.isValid()||W.out.println("Snapped geometry is invalid")},rr.prototype.computeSnapTolerance=function(){this._snapTolerance=$i.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},rr.prototype.snap=function(t){var e=this.removeCommonBits(t);return $i.snap(e[0],e[1],this._snapTolerance)},rr.prototype.interfaces_=function(){return[]},rr.prototype.getClass=function(){return rr},rr.overlayOp=function(t,e,n){return new rr(t,e).getResultGeometry(n)},rr.union=function(t,e){return rr.overlayOp(t,e,Cr.UNION)},rr.intersection=function(t,e){return rr.overlayOp(t,e,Cr.INTERSECTION)},rr.symDifference=function(t,e){return rr.overlayOp(t,e,Cr.SYMDIFFERENCE)},rr.difference=function(t,e){return rr.overlayOp(t,e,Cr.DIFFERENCE)};var or=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};or.prototype.getResultGeometry=function(t){var e=null,n=!1,i=null;try{e=Cr.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof J))throw t;i=t}if(!n)try{e=rr.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof J?i:t}return e},or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or},or.overlayOp=function(t,e,n){return new or(t,e).getResultGeometry(n)},or.union=function(t,e){return or.overlayOp(t,e,Cr.UNION)},or.intersection=function(t,e){return or.overlayOp(t,e,Cr.INTERSECTION)},or.symDifference=function(t,e){return or.overlayOp(t,e,Cr.SYMDIFFERENCE)},or.difference=function(t,e){return or.overlayOp(t,e,Cr.DIFFERENCE)};var sr=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};sr.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},sr.prototype.interfaces_=function(){return[]},sr.prototype.getClass=function(){return sr};var ar=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=i,this._xValue=r,this._obj=o}},Ar={INSERT:{configurable:!0},DELETE:{configurable:!0}};ar.prototype.isDelete=function(){return this._eventType===ar.DELETE},ar.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},ar.prototype.getObject=function(){return this._obj},ar.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},ar.prototype.getInsertEvent=function(){return this._insertEvent},ar.prototype.isInsert=function(){return this._eventType===ar.INSERT},ar.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},ar.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},ar.prototype.interfaces_=function(){return[E]},ar.prototype.getClass=function(){return ar},Ar.INSERT.get=function(){return 1},Ar.DELETE.get=function(){return 2},Object.defineProperties(ar,Ar);var ur=function(){};ur.prototype.interfaces_=function(){return[]},ur.prototype.getClass=function(){return ur};var lr=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};lr.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(lr.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},lr.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},lr.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},lr.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},lr.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next().getCoordinate();if(t.isIntersection(i))return!0}return!1},lr.prototype.hasProperIntersection=function(){return this._hasProper},lr.prototype.hasIntersection=function(){return this._hasIntersection},lr.prototype.isDone=function(){return this._isDone},lr.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},lr.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},lr.prototype.addIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},lr.prototype.interfaces_=function(){return[]},lr.prototype.getClass=function(){return lr},lr.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var cr=function(t){function e(){t.call(this),this.events=new wt,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){Je.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof lr&&P(arguments[0],bt)&&P(arguments[1],bt)){var i=arguments[0],r=arguments[1],o=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&P(arguments[0],bt)&&arguments[1]instanceof lr){var s=arguments[0],a=arguments[1];arguments[2]?this.addEdges(s,null):this.addEdges(s),this.computeIntersections(a)}},e.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var o=new sr(n,r),s=new ar(e,n.getMinX(r),o);this.events.add(s),this.events.add(new ar(n.getMaxX(r),s))}},e.prototype.processOverlaps=function(t,e,n,i){for(var r=n.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(r.computeIntersections(a,i),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[1],i=arguments[0].iterator();i.hasNext();){var r=i.next();this.addEdge(r,n)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ur),hr=function(){this._min=y.POSITIVE_INFINITY,this._max=y.NEGATIVE_INFINITY},fr={NodeComparator:{configurable:!0}};hr.prototype.getMin=function(){return this._min},hr.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},hr.prototype.getMax=function(){return this._max},hr.prototype.toString=function(){return Z.toLineString(new x(this._min,0),new x(this._max,0))},hr.prototype.interfaces_=function(){return[]},hr.prototype.getClass=function(){return hr},fr.NodeComparator.get=function(){return pr},Object.defineProperties(hr,fr);var pr=function(){};pr.prototype.compare=function(t,e){var n=t,i=e,r=(n._min+n._max)/2,o=(i._min+i._max)/2;return r<o?-1:r>o?1:0},pr.prototype.interfaces_=function(){return[w]},pr.prototype.getClass=function(){return pr};var dr=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],n=arguments[1],i=arguments[2];this._min=e,this._max=n,this._item=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(hr),gr=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],n=arguments[1];this._node1=e,this._node2=n,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(hr),_r=function(){this._leaves=new wt,this._root=null,this._level=0};_r.prototype.buildTree=function(){Je.sort(this._leaves,new hr.NodeComparator);for(var t=this._leaves,e=null,n=new wt;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},_r.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new dr(t,e,n))},_r.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},_r.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},_r.prototype.printNode=function(t){W.out.println(Z.toLineString(new x(t._min,this._level),new x(t._max,this._level)))},_r.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},_r.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new gr(t.get(n),t.get(n+1));e.add(r)}}},_r.prototype.interfaces_=function(){return[]},_r.prototype.getClass=function(){return _r};var mr=function(){this._items=new wt};mr.prototype.visitItem=function(t){this._items.add(t)},mr.prototype.getItems=function(){return this._items},mr.prototype.interfaces_=function(){return[Qe]},mr.prototype.getClass=function(){return mr};var yr=function(){this._index=null;var t=arguments[0];if(!P(t,Zt))throw new m("Argument must be Polygonal");this._index=new br(t)},vr={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};yr.prototype.locate=function(t){var e=new st(t),n=new Er(e);return this._index.query(t.y,t.y,n),e.getLocation()},yr.prototype.interfaces_=function(){return[Gn]},yr.prototype.getClass=function(){return yr},vr.SegmentVisitor.get=function(){return Er},vr.IntervalIndexedGeometry.get=function(){return br},Object.defineProperties(yr,vr);var Er=function(){this._counter=null;var t=arguments[0];this._counter=t};Er.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},Er.prototype.interfaces_=function(){return[Qe]},Er.prototype.getClass=function(){return Er};var br=function(){this._index=new _r;var t=arguments[0];this.init(t)};br.prototype.init=function(t){for(var e=xi.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},br.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new dn(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}},br.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new mr;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._index.query(i,r,o)}},br.prototype.interfaces_=function(){return[]},br.prototype.getClass=function(){return br};var wr=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new he,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Si,2===arguments.length){var e=arguments[0],n=arguments[1],i=pt.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=n,this._boundaryNodeRule=i,null!==n&&this.add(n)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this._argIndex=r,this._parentGeom=o,this._boundaryNodeRule=s,null!==o&&this.add(o)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,n){var i=this._nodes.addNode(n).getLabel(),r=1;I.NONE,i.getLocation(t,Se.ON)===I.BOUNDARY&&r++;var o=e.determineBoundary(this._boundaryNodeRule,r);i.setLocation(t,o)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[1],i=arguments[2],r=new lr(arguments[0],!0,!1);r.setIsDoneIfProperInt(i);var o=this.createEdgeSetIntersector(),s=this._parentGeom instanceof ee||this._parentGeom instanceof Jt||this._parentGeom instanceof ne,a=n||!s;return o.computeIntersections(this._edges,r,a),this.addSelfIntersectionNodes(this._argIndex),r}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,n){var i=new lr(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,i),i},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Kt){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,I.INTERIOR)}else if(arguments[0]instanceof x){var e=arguments[0];this.insertPoint(this._argIndex,e,I.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),I.EXTERIOR,I.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,I.INTERIOR,I.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],I.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],I.BOUNDARY)},e.prototype.addLineString=function(t){var e=Ct.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new ni(e,new Le(this._argIndex,I.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),et.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===I.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},e.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var i=Ct.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;var r=e,o=n;at.isCCW(i)&&(r=n,o=e);var s=new ni(i,new Le(this._argIndex,I.BOUNDARY,r,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,i[0],I.BOUNDARY)},e.prototype.insertPoint=function(t,e,n){var i=this._nodes.addNode(e),r=i.getLabel();null===r?i._label=new Le(t,n):r.setLocation(t,n)},e.prototype.createEdgeSetIntersector=function(){return new cr},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,i)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof ne&&(this._useBoundaryDeterminationRule=!1),e instanceof Jt)this.addPolygon(e);else if(e instanceof Qt)this.addLineString(e);else if(e instanceof Kt)this.addPoint(e);else if(e instanceof te)this.addCollection(e);else if(e instanceof jt)this.addCollection(e);else if(e instanceof ne)this.addCollection(e);else{if(!(e instanceof Vt))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},e.prototype.locate=function(t){return P(this._parentGeom,Zt)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new yr(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?I.BOUNDARY:I.INTERIOR},e}(We),xr=function(){if(this._li=new rt,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new wr(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=pt.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(n.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new wr(0,e,i),this._arg[1]=new wr(1,n,i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];r.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new wr(0,r,s),this._arg[1]=new wr(1,o,s)}};xr.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},xr.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},xr.prototype.interfaces_=function(){return[]},xr.prototype.getClass=function(){return xr};var Sr=function(){};Sr.prototype.interfaces_=function(){return[]},Sr.prototype.getClass=function(){return Sr},Sr.map=function(){if(arguments[0]instanceof lt&&P(arguments[1],Sr.MapOp)){for(var t=arguments[0],e=arguments[1],n=new wt,i=0;i<t.getNumGeometries();i++){var r=e.map(t.getGeometryN(i));null!==r&&n.add(r)}return t.getFactory().buildGeometry(n)}if(P(arguments[0],vt)&&P(arguments[1],Sr.MapOp)){for(var o=arguments[0],s=arguments[1],a=new wt,A=o.iterator();A.hasNext();){var u=A.next(),l=s.map(u);null!==l&&a.add(l)}return a}},Sr.MapOp=function(){};var Cr=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n),this._ptLocator=new Si,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Yn,this._resultPolyList=new wt,this._resultLineList=new wt,this._resultPointList=new wt,this._graph=new We(new Hn),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Le(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,n,i,r){var o=new wt;return o.addAll(t),o.addAll(n),o.addAll(i),o.isEmpty()?e.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this._ptLocator.locate(t,i)!==I.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new wt,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new wt;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Wi.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new He(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var i=new Xi(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(t);var r=new Yi(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var n=this._graph.getEdgeEnds().iterator();n.hasNext();){var i=n.next(),r=i.getLabel();r.isArea()&&!i.isInteriorAreaEdge()&&e.isResultOfOp(r.getLocation(0,Se.RIGHT),r.getLocation(1,Se.RIGHT),t)&&i.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;r<2;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(et.isTrue(!i.isNull(r,Se.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,Se.LEFT,i.getLocation(r,Se.LEFT)),et.isTrue(!i.isNull(r,Se.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,Se.RIGHT,i.getLocation(r,Se.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(xr);Cr.overlayOp=function(t,e,n){return new Cr(t,e).getResultGeometry(n)},Cr.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Cr.createEmptyResult(Cr.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return Hi.map(t,{interfaces_:function(){return[Sr.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Cr.INTERSECTION)},Cr.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Cr.createEmptyResult(Cr.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Cr.SYMDIFFERENCE)},Cr.resultDimension=function(t,e,n){var i=e.getDimension(),r=n.getDimension(),o=-1;switch(t){case Cr.INTERSECTION:o=Math.min(i,r);break;case Cr.UNION:o=Math.max(i,r);break;case Cr.DIFFERENCE:o=i;break;case Cr.SYMDIFFERENCE:o=Math.max(i,r)}return o},Cr.createEmptyResult=function(t,e,n,i){var r=null;switch(Cr.resultDimension(t,e,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon()}return r},Cr.difference=function(t,e){return t.isEmpty()?Cr.createEmptyResult(Cr.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Cr.DIFFERENCE))},Cr.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return Cr.isResultOfOp(n,i,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];switch(r===I.BOUNDARY&&(r=I.INTERIOR),o===I.BOUNDARY&&(o=I.INTERIOR),s){case Cr.INTERSECTION:return r===I.INTERIOR&&o===I.INTERIOR;case Cr.UNION:return r===I.INTERIOR||o===I.INTERIOR;case Cr.DIFFERENCE:return r===I.INTERIOR&&o!==I.INTERIOR;case Cr.SYMDIFFERENCE:return r===I.INTERIOR&&o!==I.INTERIOR||r!==I.INTERIOR&&o===I.INTERIOR}return!1}},Cr.INTERSECTION=1,Cr.UNION=2,Cr.DIFFERENCE=3,Cr.SYMDIFFERENCE=4;var Tr=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Si,this._seg=new dn;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Tr.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),i=0;i<n.size()-1;i++)if(n.getCoordinate(i,this._seg.p0),n.getCoordinate(i+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},Tr.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?I.BOUNDARY:this._ptLocator.locate(t,this._g)},Tr.prototype.extractLinework=function(t){var e=new Ir;t.apply(e);var n=e.getLinework(),i=_e.toLineStringArray(n);return t.getFactory().createMultiLineString(i)},Tr.prototype.interfaces_=function(){return[]},Tr.prototype.getClass=function(){return Tr};var Ir=function(){this._linework=null,this._linework=new wt};Ir.prototype.getLinework=function(){return this._linework},Ir.prototype.filter=function(t){if(t instanceof Jt){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},Ir.prototype.interfaces_=function(){return[Gt]},Ir.prototype.getClass=function(){return Ir};var Rr=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Rr.prototype.extractPoints=function(t,e,n){for(var i=t.getCoordinates(),r=0;r<i.length-1;r++)this.computeOffsetPoints(i[r],i[r+1],e,n)},Rr.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Rr.prototype.getPoints=function(t){for(var e=new wt,n=xi.getLines(this._g).iterator();n.hasNext();){var i=n.next();this.extractPoints(i,t,e)}return e},Rr.prototype.computeOffsetPoints=function(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,s=Math.sqrt(r*r+o*o),a=n*r/s,A=n*o/s,u=(e.x+t.x)/2,l=(e.y+t.y)/2;if(this._doLeft){var c=new x(u-A,l+a);i.add(c)}if(this._doRight){var h=new x(u+A,l-a);i.add(h)}},Rr.prototype.interfaces_=function(){return[]},Rr.prototype.getClass=function(){return Rr};var Pr=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new wt;var e=arguments[0],n=arguments[1],i=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,i],this._locFinder=[new Tr(this._geom[0],this._boundaryDistanceTolerance),new Tr(this._geom[1],this._boundaryDistanceTolerance),new Tr(this._geom[2],this._boundaryDistanceTolerance)]},Mr={TOLERANCE:{configurable:!0}};Pr.prototype.reportResult=function(t,e,n){W.out.println("Overlay result invalid - A:"+I.toLocationSymbol(e[0])+" B:"+I.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+I.toLocationSymbol(e[2]))},Pr.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},Pr.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._location[0]=this._locFinder[0].getLocation(r),this._location[1]=this._locFinder[1].getLocation(r),this._location[2]=this._locFinder[2].getLocation(r),!!Pr.hasLocation(this._location,I.BOUNDARY)||this.isValidResult(i,this._location)}},Pr.prototype.addTestPts=function(t){var e=new Rr(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Pr.prototype.isValidResult=function(t,e){var n=Cr.isResultOfOp(e[0],e[1],t),i=!(n^e[2]===I.INTERIOR);return i||this.reportResult(t,e,n),i},Pr.prototype.getInvalidLocation=function(){return this._invalidLocation},Pr.prototype.interfaces_=function(){return[]},Pr.prototype.getClass=function(){return Pr},Pr.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},Pr.computeBoundaryDistanceTolerance=function(t,e){return Math.min($i.computeSizeBasedSnapTolerance(t),$i.computeSizeBasedSnapTolerance(e))},Pr.isValid=function(t,e,n,i){return new Pr(t,e,i).isValid(n)},Mr.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Pr,Mr);var Lr=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};Lr.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this._skipEmpty&&i.isEmpty()||e.add(i)}},Lr.prototype.combine=function(){for(var t=new wt,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},Lr.prototype.interfaces_=function(){return[]},Lr.prototype.getClass=function(){return Lr},Lr.combine=function(){if(1===arguments.length)return new Lr(arguments[0]).combine();if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Lr(Lr.createList(t,e)).combine()}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];return new Lr(Lr.createList(n,i,r)).combine()}},Lr.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Lr.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new wt;return n.add(t),n.add(e),n}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=new wt;return s.add(i),s.add(r),s.add(o),s}};var Nr=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new wt)},Or={STRTREE_NODE_CAPACITY:{configurable:!0}};Nr.prototype.reduceToGeometries=function(t){for(var e=new wt,n=t.iterator();n.hasNext();){var i=n.next(),r=null;P(i,bt)?r=this.unionTree(i):i instanceof lt&&(r=i),e.add(r)}return e},Nr.prototype.extractByEnvelope=function(t,e,n){for(var i=new wt,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?i.add(o):n.add(o)}return this._geomFactory.buildGeometry(i)},Nr.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i))return Lr.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},Nr.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new sn(Nr.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var i=t.itemsTree();return this.unionTree(i)},Nr.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];if(i-n<=1){var r=Nr.getGeometry(e,n);return this.unionSafe(r,null)}if(i-n==2)return this.unionSafe(Nr.getGeometry(e,n),Nr.getGeometry(e,n+1));var o=Math.trunc((i+n)/2),s=this.binaryUnion(e,n,o),a=this.binaryUnion(e,o,i);return this.unionSafe(s,a)}},Nr.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e},Nr.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Nr.prototype.unionActual=function(t,e){return Nr.restrictToPolygons(t.union(e))},Nr.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Nr.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var i=new wt,r=this.extractByEnvelope(n,t,i),o=this.extractByEnvelope(n,e,i),s=this.unionActual(r,o);return i.add(s),Lr.combine(i)},Nr.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},Nr.prototype.interfaces_=function(){return[]},Nr.prototype.getClass=function(){return Nr},Nr.restrictToPolygons=function(t){if(P(t,Zt))return t;var e=wi.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(_e.toPolygonArray(e))},Nr.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Nr.union=function(t){return new Nr(t).union()},Or.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Nr,Or);var Dr=function(){};Dr.prototype.interfaces_=function(){return[]},Dr.prototype.getClass=function(){return Dr},Dr.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Cr.createEmptyResult(Cr.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Cr.UNION)},t.GeoJSONReader=we,t.GeoJSONWriter=xe,t.OverlayOp=Cr,t.UnionOp=Dr,t.BufferOp=di,Object.defineProperty(t,"__esModule",{value:!0})}(e)},4526:(t,e,n)=>{"use strict";var i;n.d(e,{A:()=>c});var r=new Uint8Array(16);function o(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(r)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const a=function(t){return"string"==typeof t&&s.test(t)};for(var A=[],u=0;u<256;++u)A.push((u+256).toString(16).substr(1));const l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(A[t[e+0]]+A[t[e+1]]+A[t[e+2]]+A[t[e+3]]+"-"+A[t[e+4]]+A[t[e+5]]+"-"+A[t[e+6]]+A[t[e+7]]+"-"+A[t[e+8]]+A[t[e+9]]+"-"+A[t[e+10]]+A[t[e+11]]+A[t[e+12]]+A[t[e+13]]+A[t[e+14]]+A[t[e+15]]).toLowerCase();if(!a(n))throw TypeError("Stringified UUID is invalid");return n};const c=function(t,e,n){var i=(t=t||{}).random||(t.rng||o)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){n=n||0;for(var r=0;r<16;++r)e[n+r]=i[r];return e}return l(i)}},586:(t,e,n)=>{"use strict";n.d(e,{A:()=>R});var i=n(4901),r=n(2357);const o=()=>{},s=2,a=3,A=t=>t,u=1;class l{constructor(t){this._onTransitionUpdate=t=>{const{time:e,settings:{interpolator:n,startProps:i,endProps:r,duration:o,easing:s}}=t,a=s(e/o),A=n.interpolateProps(i,r,a);this.propsInTransition=this.getControllerState({...this.props,...A}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new r.A(t.timeline),this.onViewStateChange=t.onViewStateChange||o,this.onStateChange=t.onStateChange||o}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(this.props=t,!n||this._shouldIgnoreViewportChange(n,t))return!1;if(this._isTransitionEnabled(t)){let i=n;if(this.transition.inProgress){const{interruption:t,endProps:e}=this.transition.settings;i={...n,...t===s?e:this.propsInTransition||n}}this._triggerTransition(i,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){if(this.transition.inProgress){return this.transition.settings.interruption===a||this._isUpdateDueToCurrentTransition(e)}return!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const n=this.getControllerState(t),i=this.getControllerState(e).shortestPathFrom(n),r=e.transitionInterpolator,o=r.getDuration?r.getDuration(t,e):e.transitionDuration;if(0===o)return;const s=r.initializeProps(t,i);this.propsInTransition={};const a={duration:o,easing:e.transitionEasing||A,interpolator:r,interruption:e.transitionInterruption||u,startProps:s.start,endProps:s.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)};this.transition.start(a),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t?.(e)}}}var c=n(4067);class h{constructor(t){const{compare:e,extract:n,required:i}=t;this._propsToCompare=e,this._propsToExtract=n||e,this._requiredProps=i}arePropsEqual(t,e){for(const n of this._propsToCompare)if(!(n in t)||!(n in e)||!(0,i.aI)(t[n],e[n]))return!1;return!0}initializeProps(t,e){const n={},i={};for(const r of this._propsToExtract)(r in t||r in e)&&(n[r]=t[r],i[r]=e[r]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach((e=>{const n=t[e];(0,c.A)(Number.isFinite(n)||Array.isArray(n),`${e} is required for transition`)}))}}const f=["longitude","latitude","zoom","bearing","pitch"],p=["longitude","latitude","zoom"];class d extends h{constructor(t={}){const e=Array.isArray(t)?t:t.transitionProps,n=Array.isArray(t)?{}:t;n.transitionProps=Array.isArray(e)?{compare:e,required:e}:e||{compare:f,required:p},super(n.transitionProps),this.opts=n}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:i,around:r}=this.opts;if(i&&r){const o=i(t),s=i(e),a=o.unproject(r);n.start.around=r,Object.assign(n.end,{around:s.project(a),aroundPosition:a,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const r={};for(const o of this._propsToExtract)r[o]=(0,i.Cc)(t[o]||0,e[o]||0,n);if(e.aroundPosition&&this.opts.makeViewport){const o=this.opts.makeViewport({...e,...r});Object.assign(r,o.panByPosition(e.aroundPosition,(0,i.Cc)(t.around,e.around,n)))}return r}}const g={transitionDuration:0},_=t=>1-(1-t)*(1-t),m=["wheel"],y=["panstart","panmove","panend"],v=["pinchstart","pinchmove","pinchend"],E=["tripanstart","tripanmove","tripanend"],b=["doubletap"],w=["keydown"],x={};class S{constructor(t){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new l({...t,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(const t in this._events)this._events[t]&&this.eventManager?.off(t,this.handleEvent);this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;const e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){const{x:e,y:n}=this.props,{offsetCenter:i}=t;return[i.x-e,i.y-n]}isPointInBounds(t,e){const{width:n,height:i}=this.props;if(e&&e.handled)return!1;const r=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=i;return r&&e&&e.stopPropagation(),r}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){const e=setTimeout((()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)}),t);this._eventStartBlocked=e}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);const{inertia:e}=t;this.inertia=Number.isFinite(e)?e:!0===e?300:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:r=!0,doubleClickZoom:o=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:A=!0}=t,u=Boolean(this.onViewStateChange);this.toggleEvents(m,u&&n),this.toggleEvents(y,u),this.toggleEvents(v,u&&(s||a)),this.toggleEvents(E,u&&a),this.toggleEvents(b,u&&o),this.toggleEvents(w,u&&A),this.scrollZoom=n,this.dragPan=i,this.dragRotate=r,this.doubleClickZoom=o,this.touchZoom=s,this.touchRotate=a,this.keyboard=A}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach((t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))}))}updateViewport(t,e=null,n={}){const i={...t.getViewportProps(),...e},r=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(n),r){const t=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:t,viewId:this.props.id})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(i,g,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,g,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],r=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:_},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,g,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],r=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:_},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;t.srcEvent.preventDefault();const{speed:n=.01,smooth:i=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:r}=t;let o=2/(1+Math.exp(-Math.abs(r*n)));r<0&&0!==o&&(o=1/o);const s=this.controllerState.zoom({pos:e,scale:o});return this.updateViewport(s,{...this._getTransitionProps({around:e}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,g,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,g,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),i=[n[0],n[1]+=t.velocityY*e/2],r=this.controllerState.rotate({pos:i});this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:_},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return x._startPinchRotation=t.rotation,x._lastPinchEvent=t,this.updateViewport(n,g,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,i=this.getCenter(t);e=e.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:x._startPinchRotation-n})}return this.updateViewport(e,g,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),x._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this,{_lastPinchEvent:n}=x;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const i=this.getCenter(t);let r=this.controllerState.rotateEnd();const o=Math.log2(t.scale),s=(o-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),a=Math.pow(2,o+s*e/2);r=r.zoom({pos:i,scale:a}).zoomEnd(),this.updateViewport(r,{...this._getTransitionProps({around:i}),transitionDuration:e,transitionEasing:_},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return x._startPinchRotation=null,x._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),i=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:r,rotateSpeedY:o}=!0===this.keyboard?{}:this.keyboard,{controllerState:s}=this;let a;const A={};switch(t.srcEvent.code){case"Minus":a=e?s.zoomOut(n).zoomOut(n):s.zoomOut(n),A.isZooming=!0;break;case"Equal":a=e?s.zoomIn(n).zoomIn(n):s.zoomIn(n),A.isZooming=!0;break;case"ArrowLeft":e?(a=s.rotateLeft(r),A.isRotating=!0):(a=s.moveLeft(i),A.isPanning=!0);break;case"ArrowRight":e?(a=s.rotateRight(r),A.isRotating=!0):(a=s.moveRight(i),A.isPanning=!0);break;case"ArrowUp":e?(a=s.rotateUp(o),A.isRotating=!0):(a=s.moveUp(i),A.isPanning=!0);break;case"ArrowDown":e?(a=s.rotateDown(o),A.isRotating=!0):(a=s.moveDown(i),A.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),A),!0}_getTransitionProps(t){const{transition:e}=this;return e&&e.transitionInterpolator?t?{...e,transitionInterpolator:new d({...t,...e.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:e:g}}class C{constructor(t,e){this._viewportProps=this.applyConstraints(t),this._state=e}getViewportProps(){return this._viewportProps}getState(){return this._state}}var T=n(4697);class I extends C{constructor(t){const{width:e,height:n,latitude:i,longitude:r,zoom:o,bearing:s=0,pitch:a=0,altitude:A=1.5,position:u=[0,0,0],maxZoom:l=20,minZoom:h=0,maxPitch:f=60,minPitch:p=0,startPanLngLat:d,startZoomLngLat:g,startRotatePos:_,startBearing:m,startPitch:y,startZoom:v,normalize:E=!0}=t;(0,c.A)(Number.isFinite(r)),(0,c.A)(Number.isFinite(i)),(0,c.A)(Number.isFinite(o)),super({width:e,height:n,latitude:i,longitude:r,zoom:o,bearing:s,pitch:a,altitude:A,maxZoom:l,minZoom:h,maxPitch:f,minPitch:p,normalize:E,position:u},{startPanLngLat:d,startZoomLngLat:g,startRotatePos:_,startBearing:m,startPitch:y,startZoom:v}),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const n=this.getState().startPanLngLat||this._unproject(e);if(!n)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(n,t);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:i,startBearing:r,startPitch:o}=this.getState();if(!i||void 0===r||void 0===o)return this;let s;return s=t?this._getNewRotation(t,i,o,r):{bearing:r+e,pitch:o+n},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:r,startZoomLngLat:o}=this.getState();if(o||(r=this.getViewportProps().zoom,o=this._unproject(e)||this._unproject(t)),!o)return this;const{maxZoom:s,minZoom:a}=this.getViewportProps();let A=r+Math.log2(n);A=(0,i.qE)(A,a,s);const u=this.makeViewport({...this.getViewportProps(),zoom:A});return this._getUpdatedState({zoom:A,...u.panByPosition(o,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:r}=n;return Math.abs(i-e.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(r-e.longitude)>180&&(n.longitude=r<0?r+360:r-360),n}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r}=t;t.zoom=(0,i.qE)(r,n,e);const{maxPitch:o,minPitch:s,pitch:a}=t;t.pitch=(0,i.qE)(a,s,o);const{normalize:A=!0}=t;return A&&Object.assign(t,(0,T.CK)(t)),t}_zoomFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_getNewRotation(t,e,n,r){const o=t[0]-e[0],s=t[1]-e[1],a=t[1],A=e[1],{width:u,height:l}=this.getViewportProps(),c=o/u;let h=0;s>0?Math.abs(l-A)>5&&(h=s/(A-l)*1.2):s<0&&A>5&&(h=1-a/A),h=(0,i.qE)(h,-1,1);const{minPitch:f,maxPitch:p}=this.getViewportProps();let d=n;return h>0?d=n+h*(p-n):h<0&&(d=n-h*(f-n)),{pitch:d,bearing:r+180*c}}}class R extends S{constructor(){super(...arguments),this.ControllerState=I,this.transition={transitionDuration:300,transitionInterpolator:new d({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(t){t.position=t.position||[0,0,0];const e=this.props;super.setProps(t);(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}}},3411:(t,e,n)=>{"use strict";n.d(e,{A:()=>s,k:()=>o});var i=n(3459);let r={};function o(t){r=t}function s(t,e,n,o){i.A.level>0&&r[t]&&r[t].call(null,e,n,o)}},9452:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var i=n(688),r=n(3411),o=n(8055),s=n(2897);class a extends i.A{static{this.layerName="CompositeLayer"}get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every((t=>t.isLoaded))}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(t){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:e}=t;return e&&e.__source&&e.__source.parent&&e.__source.parent.id===this.id?(t.object=e.__source.object,t.index=e.__source.index,t):t}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if("function"==typeof t){const e={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,i)}return t}getSubLayerProps(t={}){const{opacity:e,pickable:n,visible:i,parameters:r,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:A,highlightColor:u,coordinateSystem:l,coordinateOrigin:c,wrapLongitude:h,positionFormat:f,modelMatrix:p,extensions:d,fetch:g,operation:_,_subLayerProps:m}=this.props,y={id:"",updateTriggers:{},opacity:e,pickable:n,visible:i,parameters:r,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:A,highlightColor:u,coordinateSystem:l,coordinateOrigin:c,wrapLongitude:h,positionFormat:f,modelMatrix:p,extensions:d,fetch:g,operation:_},v=m&&t.id&&m[t.id],E=v&&v.updateTriggers,b=t.id||"sublayer";if(v){const e=this.props[s.fW],n=t.type?t.type._propTypes:{};for(const t in v){const i=n[t]||e[t];i&&"accessor"===i.type&&(v[t]=this.getSubLayerAccessor(v[t]))}}Object.assign(y,t,v),y.id=`${this.props.id}-${b}`,y.updateTriggers={all:this.props.updateTriggers?.all,...t.updateTriggers,...E};for(const s of d){const t=s.getSubLayerProps.call(this,s);t&&Object.assign(y,t,{updateTriggers:Object.assign(y.updateTriggers,t.updateTriggers)})}return y}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_postUpdate(t,e){let n=this.internalState.subLayers;const i=!n||this.needsUpdate();if(i){const t=this.renderLayers();n=(0,o.B)(t,Boolean),this.internalState.subLayers=n}(0,r.A)("compositeLayer.renderLayers",this,i,n);for(const r of n)r.parent=this}}},9350:(t,e,n)=>{"use strict";n.d(e,{Kx:()=>o,p5:()=>s,qY:()=>a,rf:()=>r});var i=n(3459);const r={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(r,"IDENTITY",{get:()=>(i.A.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const o={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},s={common:0,meters:1,pixels:2},a={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}}},688:(t,e,n)=>{"use strict";n.d(e,{A:()=>Yt});var i=n(6839),r=n(9350),o=n(3678);const s=o.UE;function a(t,e){return{attribute:t,format:e.size>1?`${e.type}x${e.size}`:e.type,byteOffset:e.offset||0}}function A(t){return t.stride||t.size*t.bytesPerElement}var u=n(5840),l=n(5667),c=n(3459);function h(t,e){e.offset&&c.A.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=A(t),i=(void 0!==e.vertexOffset?e.vertexOffset:t.vertexOffset||0)*n+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:i,stride:n}}class f{constructor(t,e,n){this._buffer=null,this.device=t,this.id=e.id||"",this.size=e.size||1;const i=e.logicalType||e.type,r="float64"===i;let s,{defaultValue:a}=e;a=Number.isFinite(a)?[a]:a||new Array(this.size).fill(0),s=r?"float32":!i&&e.isIndexed?"uint32":i||"float32";let A=function(t){switch(t){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return(0,o.Y0)(t)}}(i||s);this.doublePrecision=r,r&&!1===e.fp64&&(A=Float32Array),this.value=null,this.settings={...e,defaultType:A,defaultValue:a,logicalType:i,type:s,normalized:s.includes("norm"),size:this.size,bytesPerElement:A.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*A(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),u.A.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(t=this.id,e=null){const n={};if(this.state.constant){const i=this.value;if(e){const r=h(this.getAccessor(),e),o=r.offset/i.BYTES_PER_ELEMENT,s=r.size||this.size;n[t]=i.subarray(o,o+s)}else n[t]=i}else n[t]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?n[`${t}64Low`]=n[t]:n[`${t}64Low`]=new Float32Array(this.size)),n}getBufferLayout(t=this.id,e=null){const n=this.getAccessor(),i=[],r={name:this.id,byteStride:A(n),attributes:i};if(this.doublePrecision){const r=function(t,e){const n=h(t,e);return{high:n,low:{...n,offset:n.offset+4*t.size}}}(n,e||{});i.push(a(t,{...n,...r.high}),a(`${t}64Low`,{...n,...r.low}))}else if(e){const r=h(n,e);i.push(a(t,{...n,...r}))}else i.push(a(t,n));return r}setAccessor(t){this.state.bufferAccessor=t}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){const e=Array.from(this.value);t=[e,e]}else{const{value:e,numInstances:n,size:i}=this,r=n*i;if(e&&r&&e.length>=r){const n=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let t=0;t<r;)for(let r=0;r<i;r++){const i=e[t++];i<n[r]&&(n[r]=i),i>o[r]&&(o[r]=i)}t=[n,o]}}return this.state.bounds=t,t}setData(t){const{state:e}=this;let n;n=ArrayBuffer.isView(t)?{value:t}:t instanceof i.h?{buffer:t}:t;const r={...this.settings,...n};if(ArrayBuffer.isView(n.value)){if(!n.type){if(this.doublePrecision&&n.value instanceof Float64Array)r.type="float32";else{const t=s(n.value);r.type=r.normalized?t.replace("int","norm"):t}}r.bytesPerElement=n.value.BYTES_PER_ELEMENT,r.stride=A(r)}if(e.bounds=null,n.constant){let t=n.value;t=this._normalizeValue(t,[],0),this.settings.normalized&&(t=this.normalizeConstant(t));if(!(!e.constant||!this._areValuesEqual(t,this.value)))return!1;e.externalBuffer=null,e.constant=!0,this.value=ArrayBuffer.isView(t)?t:new Float32Array(t)}else if(n.buffer){const t=n.buffer;e.externalBuffer=t,e.constant=!1,this.value=n.value||null}else if(n.value){this._checkExternalBuffer(n);let t=n.value;e.externalBuffer=null,e.constant=!1,this.value=t;let{buffer:i}=this;const o=A(r),s=(r.vertexOffset||0)*o;if(this.doublePrecision&&t instanceof Float64Array&&(t=(0,l.cT)(t,r)),this.settings.isIndexed){const e=this.settings.defaultType;t.constructor!==e&&(t=new e(t))}const a=t.byteLength+s+2*o;(!i||i.byteLength<a)&&(i=this._createBuffer(a)),i.write(t,s)}return this.setAccessor(r),!0}updateSubBuffer(t={}){this.state.bounds=null;const e=this.value,{startOffset:n=0,endOffset:i}=t;this.buffer.write(this.doublePrecision&&e instanceof Float64Array?(0,l.cT)(e,{size:this.size,startIndex:n,endIndex:i}):e.subarray(n,i),n*e.BYTES_PER_ELEMENT+this.byteOffset)}allocate(t,e=!1){const{state:n}=this,i=n.allocatedValue,r=u.A.allocate(i,t+1,{size:this.size,type:this.settings.defaultType,copy:e});this.value=r;const{byteOffset:o}=this;let{buffer:s}=this;return(!s||s.byteLength<r.byteLength+o)&&(s=this._createBuffer(r.byteLength+o),e&&i&&s.write(i instanceof Float64Array?(0,l.cT)(i,this):i,o)),n.allocatedValue=r,n.constant=!1,n.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(t){const{value:e}=t;if(!ArrayBuffer.isView(e))throw new Error(`Attribute ${this.id} value is not TypedArray`);const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=e.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${e.constructor.name}`);e instanceof n||!this.settings.normalized||"normalized"in t||c.A.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(t){switch(this.settings.type){case"snorm8":return new Float32Array(t).map((t=>(t+128)/255*2-1));case"snorm16":return new Float32Array(t).map((t=>(t+32768)/65535*2-1));case"unorm8":return new Float32Array(t).map((t=>t/255));case"unorm16":return new Float32Array(t).map((t=>t/65535));default:return t}}_normalizeValue(t,e,n){const{defaultValue:i,size:r}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t){let t=r;for(;--t>=0;)e[n+t]=i[t];return e}switch(r){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:i[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:i[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:i[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:i[0];break;default:let o=r;for(;--o>=0;)e[n+o]=Number.isFinite(t[o])?t[o]:i[o]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}_createBuffer(t){this._buffer&&this._buffer.destroy();const{isIndexed:e,type:n}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:e?i.h.INDEX:i.h.VERTEX,indexType:e?n:void 0,byteLength:t}),this._buffer}}var p=n(4067),d=n(3439),g=n(8055);const _=[],m=[[0,1/0]];const y={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function v(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...y[n],...e,...t,type:n}}class E extends f{constructor(t,e){super(t,e,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:m}),this.constant=!1,this.settings.update=e.update||(e.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}layoutChanged(){return this.state.layoutChanged}setAccessor(t){var e,n;this.state.layoutChanged||=(e=t,n=this.getAccessor(),!(e.type===n.type&&e.size===n.size&&A(e)===A(n)&&(e.offset||0)===(n.offset||0))),super.setAccessor(t)}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!=typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition;return v(Array.isArray(e)?t[e.find((e=>t[e]))]:t[e],n)}setNeedsUpdate(t=this.id,e){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:n=1/0}=e;this.state.updateRanges=function(t,e){if(t===m)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const n=[],i=t.length;let r=0;for(let o=0;o<i;o++){const i=t[o];i[1]<e[0]?(n.push(i),r=o+1):i[0]>e[1]?n.push(i):e=[Math.min(i[0],e[0]),Math.max(i[1],e[1])]}return n.splice(r,0,e),n}(this.state.updateRanges,[t,n])}else this.state.updateRanges=m}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=_}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){const{state:e,settings:n}=this;return!n.noAlloc&&(!!n.update&&(super.allocate(t,e.updateRanges!==m),!0))}updateBuffer({numInstances:t,data:e,props:n,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:r},settings:{update:o,noAlloc:s}}=this;let a=!0;if(o){for(const[s,a]of r)o.call(i,this,{data:e,startRow:s,endRow:a,props:n,numInstances:t});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,n]of r){const i=Number.isFinite(e)?this.getVertexOffset(e):0,r=Number.isFinite(n)?this.getVertexOffset(n):s||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:i,endOffset:r})}else;this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(t){if(void 0===t||"function"==typeof t)return!1;return this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t,e=null){const{state:n,settings:i}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;n.binaryValue=t,this.setNeedsRedraw();if(i.transform||e!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});const r=t;(0,p.A)(ArrayBuffer.isView(r.value),`invalid ${i.accessor}`);const o=Boolean(r.size)&&r.size!==this.size;return n.binaryAccessor=(0,d.I)(r.value,{size:r.size||this.size,stride:r.stride,offset:r.offset,startIndices:e,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?t<e.length?e[t]:this.numInstances:t)*this.size}getValue(){const t=this.settings.shaderAttributes,e=super.getValue();if(!t)return e;for(const n in t)Object.assign(e,super.getValue(n,t[n]));return e}getBufferLayout(){this.state.layoutChanged=!1;const t=this.settings.shaderAttributes,e=super.getBufferLayout();if(!t)return e;for(const n in t){const i=super.getBufferLayout(n,t[n]);e.attributes.push(...i.attributes)}return e}_autoUpdater(t,{data:e,startRow:n,endRow:i,props:r,numInstances:o}){if(t.constant)return;const{settings:s,state:a,value:A,size:u,startIndices:l}=t,{accessor:c,transform:h}=s,f=a.binaryAccessor||("function"==typeof c?c:r[c]);(0,p.A)("function"==typeof f,`accessor "${c}" is not a function`);let _=t.getVertexOffset(n);const{iterable:m,objectInfo:y}=(0,d.X)(e,n,i);for(const p of m){y.index++;let e=f(p,y);if(h&&(e=h.call(this,e)),l){const n=(y.index<l.length-1?l[y.index+1]:o)-l[y.index];if(e&&Array.isArray(e[0])){let n=_;for(const i of e)t._normalizeValue(i,A,n),n+=u}else e&&e.length>u?A.set(e,_):(t._normalizeValue(e,y.target,0),(0,g.R)({target:A,source:y.target,start:_,count:n}));_+=n*u}else t._normalizeValue(e,A,_),_+=u}}_validateAttributeUpdaters(){const{settings:t}=this;if(!(t.noAlloc||"function"==typeof t.update))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error(`Illegal attribute generated for ${this.id}`)}}}var b=n(2417),w=n(3411),x=n(979);function S(t){const{input:e,inputChannels:n,output:i}=t||{};if(!e)return"#version 300 es\nout vec4 transform_output;\nvoid main() {\ntransform_output = vec4(0);\n}";if(!n)throw new Error("inputChannels");return`#version 300 es\nin ${function(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${t}`)}}(n)} ${e};\nout vec4 ${i};\nvoid main() {\n  ${i} = ${function(t,e){switch(e){case 1:return`vec4(${t}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${t}, 0.0, 1.0)`;case 3:return`vec4(${t}, 1.0)`;case 4:return t;default:throw new Error(`invalid channels: ${e}`)}}(e,n)};\n}`}var C=n(9067);class T{device;model;transformFeedback;static isSupported(t){return"webgl"===t?.info?.type}constructor(t,e=C.K.defaultProps){(0,x.v)(T.isSupported(t),"BufferTransform not yet implemented on WebGPU"),this.device=t,this.model=new C.K(this.device,{id:e.id||"buffer-transform-model",fs:e.fs||S(),topology:e.topology||"point-list",...e}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:e.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(t){const e=this.device.beginRenderPass(t);this.model.draw(e),e.end()}update(...t){console.warn("TextureTransform#update() not implemented")}getBuffer(t){return this.transformFeedback.getBuffer(t)}readAsync(t){const e=this.getBuffer(t);if(e instanceof i.h)return e.readAsync();const{buffer:n,byteOffset:r=0,byteLength:o=n.byteLength}=e;return n.readAsync(r,o)}}function I(t,e=[],n=0){const i=Math.fround(t),r=t-i;return e[n]=i,e[n+1]=r,e}function R(t){return t-Math.fround(t)}function P(t){const e=new Float32Array(32);for(let n=0;n<4;++n)for(let i=0;i<4;++i){const r=4*n+i;I(t[4*i+n],e,2*r)}return e}const M={ONE:1};const L={name:"fp64-arithmetic",vs:"uniform float ONE;\nvec2 split(float a) {\nconst float SPLIT = 4097.0;\nfloat t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\nfloat a_hi = t * ONE - (t - a);\nfloat a_lo = a * ONE - a_hi;\n#else\nfloat a_hi = t - (t - a);\nfloat a_lo = a - a_hi;\n#endif\nreturn vec2(a_hi, a_lo);\n}\nvec2 split2(vec2 a) {\nvec2 b = split(a.x);\nb.y += a.y;\nreturn b;\n}\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\nfloat sum = (a + b) * ONE;\nfloat err = b - (sum - a) * ONE;\n#else\nfloat sum = a + b;\nfloat err = b - (sum - a);\n#endif\nreturn vec2(sum, err);\n}\nvec2 twoSum(float a, float b) {\nfloat s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\nfloat v = (s * ONE - a) * ONE;\nfloat err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\nfloat v = s - a;\nfloat err = (a - (s - v)) + (b - v);\n#endif\nreturn vec2(s, err);\n}\nvec2 twoSub(float a, float b) {\nfloat s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\nfloat v = (s * ONE - a) * ONE;\nfloat err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\nfloat v = s - a;\nfloat err = (a - (s - v)) - (b + v);\n#endif\nreturn vec2(s, err);\n}\nvec2 twoSqr(float a) {\nfloat prod = a * a;\nvec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\nfloat err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\na_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\nfloat err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\nreturn vec2(prod, err);\n}\nvec2 twoProd(float a, float b) {\nfloat prod = a * b;\nvec2 a_fp64 = split(a);\nvec2 b_fp64 = split(b);\nfloat err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\na_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\nreturn vec2(prod, err);\n}\nvec2 sum_fp64(vec2 a, vec2 b) {\nvec2 s, t;\ns = twoSum(a.x, b.x);\nt = twoSum(a.y, b.y);\ns.y += t.x;\ns = quickTwoSum(s.x, s.y);\ns.y += t.y;\ns = quickTwoSum(s.x, s.y);\nreturn s;\n}\nvec2 sub_fp64(vec2 a, vec2 b) {\nvec2 s, t;\ns = twoSub(a.x, b.x);\nt = twoSub(a.y, b.y);\ns.y += t.x;\ns = quickTwoSum(s.x, s.y);\ns.y += t.y;\ns = quickTwoSum(s.x, s.y);\nreturn s;\n}\nvec2 mul_fp64(vec2 a, vec2 b) {\nvec2 prod = twoProd(a.x, b.x);\nprod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\nprod = split2(prod);\n#endif\nprod = quickTwoSum(prod.x, prod.y);\nprod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\nprod = split2(prod);\n#endif\nprod = quickTwoSum(prod.x, prod.y);\nreturn prod;\n}\nvec2 div_fp64(vec2 a, vec2 b) {\nfloat xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\nvec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\nvec2 yn = a * xn;\n#endif\nfloat diff = (sub_fp64(a, mul_fp64(b, yn))).x;\nvec2 prod = twoProd(xn, diff);\nreturn sum_fp64(yn, prod);\n}\nvec2 sqrt_fp64(vec2 a) {\nif (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\nif (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\nfloat x = 1.0 / sqrt(a.x);\nfloat yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\nvec2 yn_sqr = twoSqr(yn) * ONE;\n#else\nvec2 yn_sqr = twoSqr(yn);\n#endif\nfloat diff = sub_fp64(a, yn_sqr).x;\nvec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\nreturn sum_fp64(split(yn), prod);\n#else\nreturn sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",getUniforms:function(){return M},fp64ify:I,fp64LowPart:R,fp64ifyMatrix4:P};function N(t){const{source:e,target:n,start:i=0,size:r,getData:o}=t,s=t.end||n.length,a=e.length,A=s-i;if(a>A)return void n.set(e.subarray(0,A),i);if(n.set(e,i),!o)return;let u=a;for(;u<A;){const t=o(u,e);for(let e=0;e<r;e++)n[i+u]=t[e]||0,u++}}function O(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${t}"`)}}function D(t){switch(t){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function F(t){t.push(t.shift())}function k({device:t,source:e,target:n}){return(!n||n.byteLength<e.byteLength)&&(n?.destroy(),n=t.createBuffer({byteLength:e.byteLength,usage:e.usage})),n}function B({device:t,buffer:e,attribute:n,fromLength:i,toLength:r,fromStartIndices:o,getData:s=(t=>t)}){const a=n.doublePrecision&&n.value instanceof Float64Array?2:1,A=n.size*a,u=n.byteOffset,l=n.settings.bytesPerElement<4?u/n.settings.bytesPerElement*4:u,c=n.startIndices,h=o&&c,f=n.isConstant;if(!h&&e&&i>=r)return e;const p=n.value instanceof Float64Array?Float32Array:n.value.constructor,d=f?n.value:new p(n.getBuffer().readSyncWebGL(u,r*p.BYTES_PER_ELEMENT).buffer);if(n.settings.normalized&&!f){const t=s;s=(e,i)=>n.normalizeConstant(t(e,i))}const g=f?(t,e)=>s(d,e):(t,e)=>s(d.subarray(t+u,t+u+A),e),_=e?new Float32Array(e.readSyncWebGL(l,4*i).buffer):new Float32Array(0),m=new Float32Array(r);return function({source:t,target:e,size:n,getData:i,sourceStartIndices:r,targetStartIndices:o}){if(!r||!o)return N({source:t,target:e,size:n,getData:i}),e;let s=0,a=0;const A=i&&((t,e)=>i(t+a,e)),u=Math.min(r.length,o.length);for(let l=1;l<u;l++){const i=r[l]*n,u=o[l]*n;N({source:t.subarray(s,i),target:e,start:a,end:u,size:n,getData:A}),s=i,a=u}a<e.length&&N({source:[],target:e,start:a,size:n,getData:A})}({source:_,target:m,sourceStartIndices:o,targetStartIndices:c,size:A,getData:g}),(!e||e.byteLength<m.byteLength+l)&&(e?.destroy(),e=t.createBuffer({byteLength:m.byteLength+l,usage:35050})),e.write(m,l),e}var U=n(2357);class G{constructor({device:t,attribute:e,timeline:n}){this.buffers=[],this.currentLength=0,this.device=t,this.transition=new U.A(n),this.attribute=e,this.attributeInTransition=function(t){const{device:e,settings:n,value:i}=t,r=new E(e,n);return r.setData({value:i instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:n.normalized}),r}(e),this.currentStartIndices=e.startIndices}get inProgress(){return this.transition.inProgress}start(t,e,n=1/0){this.settings=t,this.currentStartIndices=this.attribute.startIndices,this.currentLength=function(t,e){const{doublePrecision:n,settings:i,value:r,size:o}=t,s=n&&r instanceof Float64Array?2:1;let a=0;const{shaderAttributes:A}=t.settings;if(A)for(const u of Object.values(A))a=Math.max(a,u.vertexOffset??0);return(i.noAlloc?r.length:(e+a)*o)*s}(this.attribute,e),this.transition.start({...t,duration:n})}update(){const t=this.transition.update();return t&&this.onUpdate(),t}setBuffer(t){this.attributeInTransition.setData({buffer:t,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const t of this.buffers)t.destroy();this.buffers.length=0}}const z="#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",V="#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aFrom64Low;\nin ATTRIBUTE_TYPE aTo;\nin ATTRIBUTE_TYPE aTo64Low;\nout ATTRIBUTE_TYPE vCurrent;\nout ATTRIBUTE_TYPE vCurrent64Low;\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\nvoid main(void) {\n  for (int i=0; i<ATTRIBUTE_SIZE; i++) {\n    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), time);\n    vCurrent[i] = value.x;\n    vCurrent64Low[i] = value.y;\n  }\n  gl_Position = vec4(0.0);\n}\n";function j(t){return t.doublePrecision&&t.value instanceof Float64Array}const W="#version 300 es\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nin ATTRIBUTE_TYPE aPrev;\nin ATTRIBUTE_TYPE aCur;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vNext;\nout float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",H="#version 300 es\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nin float vIsTransitioningFlag;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  fragColor = vec4(1.0);\n}";const X={interpolation:class extends G{constructor({device:t,attribute:e,timeline:n}){super({device:t,attribute:e,timeline:n}),this.type="interpolation",this.transform=function(t,e){const n=e.size,i=O(n),r=D(n),o=e.getBufferLayout();if(j(e))return new T(t,{vs:V,bufferLayout:[{name:"aFrom",byteStride:8*n,attributes:[{attribute:"aFrom",format:r,byteOffset:0},{attribute:"aFrom64Low",format:r,byteOffset:4*n}]},{name:"aTo",byteStride:8*n,attributes:[{attribute:"aTo",format:r,byteOffset:0},{attribute:"aTo64Low",format:r,byteOffset:4*n}]}],modules:[L],defines:{ATTRIBUTE_TYPE:i,ATTRIBUTE_SIZE:n},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0});return new T(t,{vs:z,bufferLayout:[{name:"aFrom",format:r},{name:"aTo",format:o.attributes[0].format}],defines:{ATTRIBUTE_TYPE:i},varyings:["vCurrent"],disableWarnings:!0})}(t,e)}start(t,e){const n=this.currentLength,i=this.currentStartIndices;if(super.start(t,e,t.duration),t.duration<=0)return void this.transition.cancel();const{buffers:r,attribute:o}=this;F(r),r[0]=B({device:this.device,buffer:r[0],attribute:o,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:t.enter}),r[1]=k({device:this.device,source:r[0],target:r[1]}),this.setBuffer(r[1]);const{transform:s}=this,a=s.model;let A=Math.floor(this.currentLength/o.size);j(o)&&(A/=2),a.setVertexCount(A),o.isConstant?(a.setAttributes({aFrom:r[0]}),a.setConstantAttributes({aTo:o.value})):a.setAttributes({aFrom:r[0],aTo:o.getBuffer()}),s.transformFeedback.setBuffers({vCurrent:r[1]})}onUpdate(){const{duration:t,easing:e}=this.settings,{time:n}=this.transition;let i=n/t;e&&(i=e(i));const{model:r}=this.transform;r.setUniforms({time:i});r.device.gl.bindBuffer(34962,null),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}},spring:class extends G{constructor({device:t,attribute:e,timeline:n}){super({device:t,attribute:e,timeline:n}),this.type="spring",this.texture=function(t){return t.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}(t),this.framebuffer=function(t,e){return t.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}(t,this.texture),this.transform=function(t,e){const n=O(e.size),i=D(e.size);return new T(t,{vs:W,fs:H,bufferLayout:[{name:"aPrev",format:i},{name:"aCur",format:i},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],defines:{ATTRIBUTE_TYPE:n},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}(t,e)}start(t,e){const n=this.currentLength,i=this.currentStartIndices;super.start(t,e);const{buffers:r,attribute:o}=this;for(let a=0;a<2;a++)r[a]=B({device:this.device,buffer:r[a],attribute:o,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:t.enter});r[2]=k({device:this.device,source:r[0],target:r[2]}),this.setBuffer(r[1]);const{model:s}=this.transform;s.setVertexCount(Math.floor(this.currentLength/o.size)),o.isConstant?s.setConstantAttributes({aTo:o.value}):s.setAttributes({aTo:o.getBuffer()})}onUpdate(){const{buffers:t,transform:e,framebuffer:n,transition:i}=this,r=this.settings;e.model.setAttributes({aPrev:t[0],aCur:t[1]}),e.transformFeedback.setBuffers({vNext:t[2]}),e.model.setUniforms({stiffness:r.stiffness,damping:r.damping}),e.run({framebuffer:n,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),F(t),this.setBuffer(t[1]);this.device.readPixelsToArrayWebGL(n)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}};class Y{constructor(t,{id:e,timeline:n}){if(!t)throw new Error("AttributeTransitionManager is constructed without device");this.id=e,this.device=t,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:e,numInstances:n}){this.numInstances=n||1;for(const i in t){const n=t[i],r=n.getTransitionSetting(e);r&&this._updateAttribute(i,n,r)}for(const i in this.transitions){const n=t[i];n&&n.getTransitionSetting(e)||this._removeTransition(i)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(0===this.numInstances)return!1;for(const e in this.transitions){this.transitions[e].update()&&(this.needsRedraw=!0)}const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].delete(),delete this.transitions[t]}_updateAttribute(t,e,n){const i=this.transitions[t];let r=!i||i.type!==n.type;if(r){i&&this._removeTransition(t);const o=X[n.type];o?this.transitions[t]=new o({attribute:e,timeline:this.timeline,device:this.device}):(c.A.error(`unsupported transition type '${n.type}'`)(),r=!1)}(r||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const q="attributeManager.invalidate";class Q{constructor(t,{id:e="attribute-manager",stats:n,timeline:i}={}){this.mergeBoundsMemoized=(0,b.A)(l._Z),this.id=e,this.device=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new Y(t,{id:`${e}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{instanced:1})}remove(t){for(const e of t)void 0!==this.attributes[e]&&(this.attributes[e].delete(),delete this.attributes[e])}invalidate(t,e){const n=this._invalidateTrigger(t,e);(0,w.A)(q,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);(0,w.A)(q,this,"all")}update({data:t,numInstances:e,startIndices:n=null,transitions:i,props:r={},buffers:o={},context:s={}}){let a=!1;(0,w.A)("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const A in this.attributes){const i=this.attributes[A],u=i.settings.accessor;i.startIndices=n,i.numInstances=e,r[A]&&c.A.removed(`props.${A}`,`data.attributes.${A}`)(),i.setExternalBuffer(o[A])||i.setBinaryValue("string"==typeof u?o[u]:void 0,t.startIndices)||"string"==typeof u&&!o[u]&&i.setConstantValue(r[u])||i.needsUpdate()&&(a=!0,this._updateAttribute({attribute:i,numInstances:e,data:t,props:r,context:s})),this.needsRedraw=this.needsRedraw||i.needsRedraw()}a&&(0,w.A)("attributeManager.updateEnd",this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:i})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(t){const e=t.map((t=>this.attributes[t]?.getBounds()));return this.mergeBoundsMemoized(e)}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:e,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const r in e){const o=e[r];o.needsRedraw(t)&&!n.hasAttribute(r)&&(i[r]=o)}return i}getBufferLayouts(t,e={}){t||(t=this.getAttributes());const n=[];for(const i in t)e[i]||n.push(t[i].getBufferLayout());return n}_add(t,e={}){for(const n in t){const i=t[n];this.attributes[n]=this._createAttribute(n,i,e)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const i={...e,id:t,size:(e.isIndexed?1:e.size)||1,divisor:n.instanced?1:e.divisor||0};return new E(this.device,i)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes){this.attributes[e].getUpdateTriggers().forEach((n=>{t[n]||(t[n]=[]),t[n].push(e)}))}this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:i}=this,r=i[t];return r&&r.forEach((t=>{const i=n[t];i&&i.setNeedsUpdate(i.id,e)})),r}_updateAttribute(t){const{attribute:e,numInstances:n}=t;if((0,w.A)("attribute.updateStart",e),e.constant)return void e.setConstantValue(e.value);e.allocate(n)&&(0,w.A)("attribute.allocate",e,n);e.updateBuffer(t)&&(this.needsRedraw=!0,(0,w.A)("attribute.updateEnd",e,n))}}var $=n(4901);class K extends U.A{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:i,easing:r}}=this,o=r(t/i);this._value=(0,$.Cc)(e,n,o)}}const Z=1e-5;function J(t,e,n,i,r){const o=e-t;return(n-e)*r+-o*i+o+e}function tt(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}class et extends U.A{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:i}=this.settings,{_prevValue:r=t,_currValue:o=t}=this;let s=function(t,e,n,i,r){if(Array.isArray(n)){const o=[];for(let s=0;s<n.length;s++)o[s]=J(t[s],e[s],n[s],i,r);return o}return J(t,e,n,i,r)}(r,o,e,n,i);const a=tt(s,e),A=tt(s,o);a<Z&&A<Z&&(s=e,this.end()),this._prevValue=o,this._currValue=s}}const nt={interpolation:K,spring:et};class it{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,i){const{transitions:r}=this;if(r.has(t)){const n=r.get(t),{value:i=n.settings.fromValue}=n;e=i,this.remove(t)}if(!(i=v(i)))return;const o=nt[i.type];if(!o)return void c.A.error(`unsupported transition type '${i.type}'`)();const s=new o(this.timeline);s.start({...i,fromValue:e,toValue:n}),r.set(t,s)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}var rt=n(2897);function ot(t,e){const n=at({newProps:t,oldProps:e,propTypes:t[rt.fW],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(t,e){if(null===e)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=t;i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied");n&&r&&(n=r(t.data,e.data)||n);return n}(t,e);let r=!1;return i||(r=function(t,e){if(null===e)return{all:!0};if("all"in t.updateTriggers){if(lt(t,e,"all"))return{all:!0}}const n={};let i=!1;for(const r in t.updateTriggers)if("all"!==r){lt(t,e,r)&&(n[r]=!0,i=!0)}return!!i&&n}(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:ut(t,e),transitionsChanged:st(t,e)}}function st(t,e){if(!t.transitions)return!1;const n={},i=t[rt.fW];let r=!1;for(const o in t.transitions){const s=i[o],a=s&&s.type;("number"===a||"color"===a||"array"===a)&&At(t[o],e[o],s)&&(n[o]=!0,r=!0)}return!!r&&n}function at({newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:r="props"}){if(e===t)return!1;if("object"!=typeof t||null===t)return`${r} changed shallowly`;if("object"!=typeof e||null===e)return`${r} changed shallowly`;for(const o of Object.keys(t))if(!(o in n)){if(!(o in e))return`${r}.${o} added`;const n=At(t[o],e[o],i[o]);if(n)return`${r}.${o} ${n}`}for(const o of Object.keys(e))if(!(o in n)){if(!(o in t))return`${r}.${o} dropped`;if(!Object.hasOwnProperty.call(t,o)){const n=At(t[o],e[o],i[o]);if(n)return`${r}.${o} ${n}`}}return!1}function At(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)?"changed deeply":i||(i=t&&e&&t.equals,!i||i.call(t,e))?i||e===t?null:"changed shallowly":"changed deeply"}function ut(t,e){if(null===e)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i)return!0;if(i.length!==n.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(n[r]))return!0;return!1}function lt(t,e,n){let i=t.updateTriggers[n];i=null==i?{}:i;let r=e.updateTriggers[n];r=null==r?{}:r;return at({oldProps:r,newProps:i,triggerName:n})}function ct(t){if(null===(e=t)||"object"!=typeof e)throw new Error("count(): argument not an object");var e;if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"==typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error("count(): argument not a container")}function ht(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some((t=>"project64"===t.name)))){const t=n.modules.findIndex((t=>"project32"===t.name));t>=0&&n.modules.splice(t,1)}if("inject"in e)if(t.inject){const i={...t.inject};for(const t in e.inject)i[t]=(i[t]||"")+e.inject[t];n.inject=i}else n.inject=e.inject;return n}var ft=n(4334),pt=n(9502),dt=n(9426),gt=n(2859),_t=n(4697);const mt=[0,0,0];function yt(t,e,n=!1){const i=e.projectPosition(t);if(n&&e instanceof pt.A){const[n,r,o=0]=t,s=e.getDistanceScales([n,r]);i[2]=o*s.unitsPerMeter[2]}return i}function vt(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:o,offsetMode:s}){let[a,A,u=0]=t;switch(n&&([a,A,u]=dt.Z0([],[a,A,u,1],n)),i){case r.rf.LNGLAT:return yt([a,A,u],e,s);case r.rf.LNGLAT_OFFSETS:return yt([a+o[0],A+o[1],u+(o[2]||0)],e,s);case r.rf.METER_OFFSETS:return yt((0,_t.dT)(o,[a,A,u]),e,s);case r.rf.CARTESIAN:default:return e.isGeospatial?[a+o[0],A+o[1],u+o[2]]:e.projectPosition([a,A,u])}}function Et(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:o,modelMatrix:s,fromCoordinateSystem:a,fromCoordinateOrigin:A}=function(t){const{viewport:e,modelMatrix:n,coordinateOrigin:i}=t;let{coordinateSystem:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=t;return o===r.rf.DEFAULT&&(o=e.isGeospatial?r.rf.LNGLAT:r.rf.CARTESIAN),void 0===s&&(s=o),void 0===a&&(a=i),{viewport:e,coordinateSystem:o,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:a}}(e),{autoOffset:u=!0}=e,{geospatialOrigin:l=mt,shaderCoordinateOrigin:c=mt,offsetMode:h=!1}=u?(0,ft.o)(n,i,o):{},f=vt(t,{viewport:n,modelMatrix:s,coordinateSystem:a,coordinateOrigin:A,offsetMode:h});if(h){const t=n.projectPosition(l||c);gt.jb(f,f,t)}return f}var bt=n(698);const wt={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},xt={};var St=n(7914);const Ct={boolean:{validate:(t,e)=>!0,equal:(t,e,n)=>Boolean(t)===Boolean(e)},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||Rt(t)&&(3===t.length||4===t.length),equal:(t,e,n)=>(0,St.b)(t,e,1)},accessor:{validate(t,e){const n=Pt(t);return"function"===n||n===Pt(e.value)},equal:(t,e,n)=>"function"==typeof e||(0,St.b)(t,e,1)},array:{validate:(t,e)=>e.optional&&!t||Rt(t),equal(t,e,n){const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?(0,St.b)(t,e,r):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?(0,St.b)(t,e,r):t===e}},function:{validate:(t,e)=>e.optional&&!t||"function"==typeof t,equal:(t,e,n)=>!n.compare&&!1!==n.ignore||t===e},data:{transform:(t,e,n)=>{if(!t)return t;const{dataTransform:i}=n.props;return i?i(t):"string"==typeof t.shape&&t.shape.endsWith("-table")&&Array.isArray(t.data)?t.data:t}},image:{transform:(t,e,n)=>{const i=n.context;return i&&i.device?function(t,e,n,i){if(n instanceof bt.g)return n;n.constructor&&"Object"!==n.constructor.name&&(n={data:n});let r=null;n.compressed&&(r={minFilter:"linear",mipmapFilter:n.data.length>1?"nearest":"linear"});const o=e.createTexture({...n,sampler:{...wt,...r,...i}});return xt[o.id]=t,o}(n.id,i.device,t,{...e.parameters,...n.props.textureParameters}):null},release:(t,e,n)=>{var i,r;i=n.id,(r=t)&&r instanceof bt.g&&xt[r.id]===i&&(r.delete(),delete xt[r.id])}}};function Tt(t,e){switch(Pt(e)){case"object":return It(t,e);case"array":return It(t,{type:"array",value:e,compare:!1});case"boolean":return It(t,{type:"boolean",value:e});case"number":return It(t,{type:"number",value:e});case"function":return It(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function It(t,e){return"type"in e?{name:t,...Ct[e.type],...e}:"value"in e?{name:t,type:Pt(e.value),...e}:{name:t,type:"object",value:e}}function Rt(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Pt(t){return Rt(t)?"array":null===t?"null":typeof t}const Mt="_mergedDefaultProps";function Lt(t,e){let n=Mt;if(e)for(const r of e){const t=r.constructor;t&&(n+=`:${t.extensionName||t.name}`)}const i=Dt(t,n);return i||(t[n]=function(t,e){const n=t.prototype;if(!n)return null;const i=Object.getPrototypeOf(t),r=Lt(i),o=Dt(t,"defaultProps")||{},s=function(t){const e={},n={},i={};for(const[r,o]of Object.entries(t)){const t=o?.deprecatedFor;if(t)i[r]=Array.isArray(t)?t:[t];else{const t=Tt(r,o);e[r]=t,n[r]=t.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}(o),a=Object.assign(Object.create(null),r,s.defaultProps),A=Object.assign(Object.create(null),r?.[rt.fW],s.propTypes),u=Object.assign(Object.create(null),r?.[rt.uH],s.deprecatedProps);for(const l of e){const t=Lt(l.constructor);t&&(Object.assign(a,t),Object.assign(A,t[rt.fW]),Object.assign(u,t[rt.uH]))}(function(t,e){const n=function(t){const e=t.componentName;e||c.A.warn(`${t.name}.componentName not specified`)();return e||t.name}(e);Object.defineProperties(t,{id:{writable:!0,value:n}})})(a,t),function(t,e){const n={},i={};for(const r in e){const t=e[r],{name:o,value:s}=t;t.async&&(n[o]=s,i[o]=Nt(o))}t[rt.jA]=n,t[rt.YN]={},Object.defineProperties(t,i)}(a,A),function(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(t){const i=`${this.id}: ${n}`;for(const r of e[n])Ot(this,r)||(this[r]=t);c.A.deprecated(i,e[n].join("/"))()}})}(a,u),a[rt.fW]=A,a[rt.uH]=u,0!==e.length||Ot(t,"_propTypes")||(t._propTypes=A);return a}(t,e||[]))}function Nt(t){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||(0,d.Td)(e)?this[rt.YN][t]=e:this[rt.vf][t]=e},get(){if(this[rt.vf]){if(t in this[rt.vf]){return this[rt.vf][t]||this[rt.jA][t]}if(t in this[rt.YN]){const e=this[rt.r3]&&this[rt.r3].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[rt.jA][t]}}return this[rt.jA][t]}}}function Ot(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Dt(t,e){return Ot(t,e)&&t[e]}let Ft=0;class kt{static{this.componentName="Component"}static{this.defaultProps={}}constructor(...t){this.props=function(t,e){let n;for(let o=e.length-1;o>=0;o--){const t=e[o];"extensions"in t&&(n=t.extensions)}const i=Lt(t.constructor,n),r=Object.create(i);r[rt.r3]=t,r[rt.YN]={},r[rt.vf]={};for(let o=0;o<e.length;++o){const t=e[o];for(const e in t)r[e]=t[e]}return Object.freeze(r),r}(this,t),this.id=this.props.id,this.count=Ft++}clone(t){const{props:e}=this,n={};for(const i in e[rt.jA])i in e[rt.vf]?n[i]=e[rt.vf][i]:i in e[rt.YN]&&(n[i]=e[rt.YN][i]);return new this.constructor({...e,...n,...t})}}const Bt=Object.freeze({});class Ut{constructor(t){this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e&&e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||Bt}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const e in this.asyncProps)if(this.isAsyncPropLoading(e))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){this.component=t[rt.r3]||this.component;const e=t[rt.vf]||{},n=t[rt.YN]||t,i=t[rt.jA]||{};for(const r in e){const t=e[r];this._createAsyncPropData(r,i[r]),this._updateAsyncProp(r,t),e[r]=this.getAsyncProp(r)}for(const r in n){const t=n[r];this._createAsyncPropData(r,i[r]),this._updateAsyncProp(r,t)}}_fetch(t,e){return null}_onResolve(t,e){}_onError(t,e){}_updateAsyncProp(t,e){this._didAsyncInputValueChange(t,e)&&("string"==typeof e&&(e=this._fetch(t,e)),e instanceof Promise?this._watchPromise(t,e):(0,d.Td)(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}_setPropValue(t,e){this._freezeAsyncOldProps();const n=this.asyncProps[t];n&&(e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(t,e,n){const i=this.asyncProps[t];i&&n>=i.resolvedLoadCount&&void 0!==e&&(this._freezeAsyncOldProps(),i.resolvedValue=e,i.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;e.then((e=>{this.component&&(e=this._postProcessValue(n,e),this._setAsyncPropValue(t,e,i),this._onResolve(t,e))})).catch((e=>{this._onError(t,e)}))}}async _resolveAsyncIterable(t,e){if("data"!==t)return void this._setPropValue(t,e);const n=this.asyncProps[t];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let r=[],o=0;for await(const s of e){if(!this.component)return;const{dataTransform:e}=this.component.props;r=e?e(s,r):r.concat(s),Object.defineProperty(r,"__diff",{enumerable:!1,value:[{startRow:o,endRow:r.length}]}),o=r.length,this._setAsyncPropValue(t,r,i)}this._onResolve(t,r)}_postProcessValue(t,e){const n=t.type;return n&&this.component&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const n=this.component&&this.component.props[rt.fW];this.asyncProps[t]={type:n&&n[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}class Gt extends Ut{constructor({attributeManager:t,layer:e}){super(e),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(t,e){const n=this.layer,i=n?.props.fetch;return i?i(e,{propName:t,layer:n}):super._fetch(t,e)}_onResolve(t,e){const n=this.layer;if(n){const i=n.props.onDataLoad;"data"===t&&i&&i(e,{propName:t,layer:n})}}_onError(t,e){const n=this.layer;n&&n.raiseError(e,`loading ${t} of ${this.layer}`)}}var zt=n(3022);const Vt=2**24-1,jt=Object.freeze([]),Wt=(0,b.A)((({oldViewport:t,viewport:e})=>t.equals(e)));let Ht=new Uint8ClampedArray(0);const Xt={data:{type:"data",value:jt,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:i,loadOptions:r,signal:o})=>{const{resourceManager:s}=n.context;r=r||n.getLoadOptions(),i=i||n.props.loaders,o&&(r={...r,fetch:{...r?.fetch,signal:o}});let a=s.contains(t);return a||r||(s.add({resourceId:t,data:(0,zt.H)(t,i),persistent:!1}),a=!0),a?s.subscribe({resourceId:t,onChange:t=>n.internalState?.reloadAsyncProp(e,t),consumerId:n.id,requestId:e}):(0,zt.H)(t,i,r)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:r.rf.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,100*-t]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Yt extends kt{constructor(){super(...arguments),this.internalState=null,this.lifecycle=rt.VD.NO_STATE,this.parent=null}static{this.defaultProps=Xt}static{this.layerName="Layer"}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(t){(0,p.A)(this.internalState);const e=this.internalState.viewport||this.context.viewport,n=vt(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,r,o]=(0,_t.VJ)(n,e.pixelProjectionMatrix);return 2===t.length?[i,r]:[i,r,o]}unproject(t){(0,p.A)(this.internalState);return(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,e){(0,p.A)(this.internalState);return Et(t,{viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...e})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const t=this.state;return t&&(t.models||t.model&&[t.model])||[]}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}setShaderModuleProps(...t){for(const e of this.getModels())e.shaderInputs.setProps(...t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===r.rf.DEFAULT||t===r.rf.LNGLAT||t===r.rf.CARTESIAN}onHover(t,e){return this.props.onHover&&this.props.onHover(t,e)||!1}onClick(t,e){return this.props.onClick&&this.props.onClick(t,e)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t,e=[]){return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){(0,p.A)(t instanceof Uint8Array);const[e,n,i]=t;return e+256*n+65536*i-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:ct(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(t){t=ht(t,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const e of this.props.extensions)t=ht(t,e.getShaders.call(this,e));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){const e=this.getAttributeManager(),{dataChanged:n}=t.changeFlags;if(n&&e)if(Array.isArray(n))for(const i of n)e.invalidateAll(i);else e.invalidateAll();if(e){const{props:n}=t,i=this.internalState.hasPickingBuffer,r=Number.isInteger(n.highlightedObjectIndex)||n.pickable||n.extensions.some((t=>t.getNeedsPickingBuffer.call(this,t)));if(i!==r){this.internalState.hasPickingBuffer=r;const{pickingColors:t,instancePickingColors:n}=e.attributes,i=t||n;i&&(r&&i.constant&&(i.constant=!1,e.invalidate(i.id)),i.value||r||(i.constant=!0,i.value=[0,0,0]))}}}finalizeState(t){for(const n of this.getModels())n.destroy();const e=this.getAttributeManager();e&&e.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo({info:t,mode:e,sourceLayer:n}){const{index:i}=t;return i>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[i]),t}raiseError(t,e){e&&(t=new Error(`${e}: ${t.message}`,{cause:t})),this.props.onError?.(t)||this.context?.onError?.(t,this)}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(t){if(!this.internalState)return;const e=this.internalState.viewport;this.internalState.viewport=t,e&&Wt({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all"){const e=this.getAttributeManager();e&&("all"===t?e.invalidateAll():e.invalidate(t))}updateAttributes(t){let e=!1;for(const n in t)t[n].layoutChanged()&&(e=!0);for(const n of this.getModels())this._setModelAttributes(n,t,e)}_updateAttributes(){const t=this.getAttributeManager();if(!t)return;const e=this.props,n=this.getNumInstances(),i=this.getStartIndices();t.update({data:e.data,numInstances:n,startIndices:i,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this});const r=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(r)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const t in e)Object.defineProperty(n,t,{value:e[t]});return n}return this.props}calculateInstancePickingColors(t,{numInstances:e}){if(t.constant)return;const n=Math.floor(Ht.length/4);if(this.internalState.usesPickingColorCache=!0,n<e){e>Vt&&c.A.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Ht=u.A.allocate(Ht,e,{size:4,copy:!0,maxCount:Math.max(e,Vt)});const t=Math.floor(Ht.length/4),i=[];for(let e=n;e<t;e++)this.encodePickingColor(e,i),Ht[4*e+0]=i[0],Ht[4*e+1]=i[1],Ht[4*e+2]=i[2]}t.value=Ht.subarray(0,4*e)}_setModelAttributes(t,e,n=!1){if(!Object.keys(e).length)return;if(n){const n=this.getAttributeManager();t.setBufferLayout(n.getBufferLayouts()),e=n.getAttributes()}const r=t.userData?.excludeAttributes||{},o={},s={};for(const a in e){if(r[a])continue;const n=e[a].getValue();for(const r in n){const A=n[r];A instanceof i.h?e[a].settings.isIndexed?t.setIndexBuffer(A):o[r]=A:A&&(s[r]=A)}}t.setAttributes(o),t.setConstantAttributes(s)}disablePickingIndex(t){const e=this.props.data;if(!("attributes"in e))return void this._disablePickingIndex(t);const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,r=n||i,o=r&&e.attributes&&e.attributes[r.id];if(o&&o.value){const n=o.value,i=this.encodePickingColor(t);for(let t=0;t<e.length;t++){const e=r.getVertexOffset(t);n[e]===i[0]&&n[e+1]===i[1]&&n[e+2]===i[2]&&this._disablePickingIndex(t)}}else this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;if(!i)return;const r=i.getVertexOffset(t),o=i.getVertexOffset(t+1);i.buffer.write(new Uint8Array(o-r),r)}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==Ht.buffer&&(n.value=Ht.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){(0,p.A)(!this.internalState),(0,p.A)(Number.isFinite(this.props.coordinateSystem)),(0,w.A)("layer.initialize",this);const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Gt({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(c.A.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.uniformTransitions=new it(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const e of this.props.extensions)e.initializeState.call(this,this.context,e);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){(0,w.A)("layer.matched",this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.state=e,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const t=this.needsUpdate();if((0,w.A)("layer.update",this,t),!t)return;const e=this.props,n=this.context,i=this.internalState,r=n.viewport,o=this._updateUniformTransition();i.propsInTransition=o,n.viewport=i.viewport||r,this.props=o;try{const t=this._getUpdateParams(),e=this.getModels();if(n.device)this.updateState(t);else try{this.updateState(t)}catch(s){}for(const n of this.props.extensions)n.updateState.call(this,t,n);const i=this.getModels()[0]!==e[0];this._postUpdate(t,i)}finally{n.viewport=r,this.props=e,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){(0,w.A)("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,this.context,t)}_drawLayer({renderPass:t,moduleParameters:e=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const r=this.props,o=this.context;this.props=this.internalState.propsInTransition||r;const s=this.props.opacity;n.opacity=Math.pow(s,1/2.2);try{if(e){const{isActive:t,isAttribute:n}=e.picking;this.setModuleParameters(e),this.setShaderModuleProps({picking:{isActive:t,isAttribute:n}})}const{getPolygonOffset:r}=this.props,s=r&&r(n)||[0,0];o.device.setParametersWebGL({polygonOffset:s});for(const t of this.getModels())t.setParameters(i);o.device.withParametersWebGL(i,(()=>{const r={renderPass:t,moduleParameters:e,uniforms:n,parameters:i,context:o};for(const t of this.props.extensions)t.draw.call(this,r,t);this.draw(r)}))}finally{this.props=r}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(t){if(!this.internalState)return;const{changeFlags:e}=this.internalState;for(const i in t)if(t[i]){let n=!1;if("dataChanged"===i){const r=t[i],o=e[i];r&&Array.isArray(o)&&(e.dataChanged=Array.isArray(r)?o.concat(r):r,n=!0)}e[i]||(e[i]=t[i],n=!0),n&&(0,w.A)("layer.changeFlag",this,i,t)}const n=Boolean(e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged);e.propsOrDataChanged=n,e.somethingChanged=n||e.viewportChanged||e.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,e){const n=ot(t,e);if(n.updateTriggersChanged)for(const i in n.updateTriggersChanged)n.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(n.transitionsChanged)for(const i in n.transitionsChanged)this.internalState.uniformTransitions.add(i,e[i],t[i],t.transitions?.[i]);return this.setChangeFlags(n)}validateProps(){!function(t){const e=t[rt.fW];for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error(`Invalid prop ${n}: ${t[n]}`)}}(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={highlightedObjectColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&"function"==typeof n&&(e.highlightColor=n(t)),this.setShaderModuleProps({picking:e}),this.setNeedsRedraw()}_getAttributeManager(){const t=this.context;return new Q(t.device,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,e){const{props:n,oldProps:i}=t;this.setNeedsRedraw(),this._updateAttributes();const r=this.state.model;r?.isInstanced&&r.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:s,highlightColor:a}=n;if(e||i.autoHighlight!==o||i.highlightedObjectIndex!==s||i.highlightColor!==a){const t={};o||(t.highlightedObjectColor=null),Array.isArray(a)&&(t.highlightColor=a),(e||s!==i.highlightedObjectIndex)&&(t.highlightedObjectColor=Number.isFinite(s)&&s>=0?this.encodePickingColor(s):null),this.setShaderModuleProps({picking:t})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=!!n&&n.getNeedsRedraw(t);if(e=e||i,e)for(const r of this.props.extensions)r.onNeedsRedraw.call(this,r);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags,e}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}},2897:(t,e,n)=>{"use strict";n.d(e,{VD:()=>i,YN:()=>A,fW:()=>o,jA:()=>a,r3:()=>r,uH:()=>s,vf:()=>u});const i={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},r=Symbol.for("component"),o=Symbol.for("propTypes"),s=Symbol.for("deprecatedProps"),a=Symbol.for("asyncPropDefaults"),A=Symbol.for("asyncPropOriginal"),u=Symbol.for("asyncPropResolved")},3349:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});const i=new Float32Array([0,1,1,1]),r={name:"picking",vs:"uniform pickingUniforms {\nfloat isActive;\nfloat isAttribute;\nfloat isHighlightActive;\nfloat useFloatColors;\nvec3 highlightedObjectColor;\nvec4 highlightColor;\n} picking;\nout vec4 picking_vRGBcolor_Avalid;\nvec3 picking_normalizeColor(vec3 color) {\nreturn picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\nvec4 picking_normalizeColor(vec4 color) {\nreturn picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\nbool picking_isColorZero(vec3 color) {\nreturn dot(color, vec3(1.0)) < 0.00001;\n}\nbool picking_isColorValid(vec3 color) {\nreturn dot(color, vec3(1.0)) > 0.00001;\n}\nbool isVertexHighlighted(vec3 vertexColor) {\nvec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);\nreturn\nbool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));\n}\nvoid picking_setPickingColor(vec3 pickingColor) {\npickingColor = picking_normalizeColor(pickingColor);\nif (bool(picking.isActive)) {\npicking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\nif (!bool(picking.isAttribute)) {\npicking_vRGBcolor_Avalid.rgb = pickingColor;\n}\n} else {\npicking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));\n}\n}\nvoid picking_setPickingAttribute(float value) {\nif (bool(picking.isAttribute)) {\npicking_vRGBcolor_Avalid.r = value;\n}\n}\nvoid picking_setPickingAttribute(vec2 value) {\nif (bool(picking.isAttribute)) {\npicking_vRGBcolor_Avalid.rg = value;\n}\n}\nvoid picking_setPickingAttribute(vec3 value) {\nif (bool(picking.isAttribute)) {\npicking_vRGBcolor_Avalid.rgb = value;\n}\n}\n",fs:"uniform pickingUniforms {\nfloat isActive;\nfloat isAttribute;\nfloat isHighlightActive;\nfloat useFloatColors;\nvec3 highlightedObjectColor;\nvec4 highlightColor;\n} picking;\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\nif (picking.isActive > 0.5) {\nreturn color;\n}\nbool selected = bool(picking_vRGBcolor_Avalid.a);\nif (selected) {\nfloat highLightAlpha = picking.highlightColor.a;\nfloat blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\nfloat highLightRatio = highLightAlpha / blendedAlpha;\nvec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);\nreturn vec4(blendedRGB, blendedAlpha);\n} else {\nreturn color;\n}\n}\nvec4 picking_filterPickingColor(vec4 color) {\nif (bool(picking.isActive)) {\nif (picking_vRGBcolor_Avalid.a == 0.0) {\ndiscard;\n}\nreturn picking_vRGBcolor_Avalid;\n}\nreturn color;\n}\nvec4 picking_filterColor(vec4 color) {\nvec4 highlightColor = picking_filterHighlightColor(color);\nreturn picking_filterPickingColor(highlightColor);\n}\n",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:new Float32Array([0,0,0]),highlightColor:i},getUniforms:function(t={},e){const n={};if(void 0===t.highlightedObjectColor);else if(null===t.highlightedObjectColor)n.isHighlightActive=!1;else{n.isHighlightActive=!0;const e=t.highlightedObjectColor.slice(0,3);n.highlightedObjectColor=e}if(t.highlightColor){const e=Array.from(t.highlightColor,(t=>t/255));Number.isFinite(e[3])||(e[3]=1),n.highlightColor=e}void 0!==t.isActive&&(n.isActive=Boolean(t.isActive),n.isAttribute=Boolean(t.isAttribute));void 0!==t.useFloatColors&&(n.useFloatColors=Boolean(t.useFloatColors));return n}};const o={...r,defaultUniforms:{...r.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}}},3756:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});const i={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\nfloat sin_taylor_fp32(float a) {\nfloat r, s, t, x;\nif (a == 0.0) {\nreturn 0.0;\n}\nx = -a * a;\ns = a;\nr = a;\nr = r * x;\nt = r * INVERSE_FACTORIAL_3;\ns = s + t;\nr = r * x;\nt = r * INVERSE_FACTORIAL_5;\ns = s + t;\nr = r * x;\nt = r * INVERSE_FACTORIAL_7;\ns = s + t;\nr = r * x;\nt = r * INVERSE_FACTORIAL_9;\ns = s + t;\nreturn s;\n}\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\nif (a == 0.0) {\nsin_t = 0.0;\ncos_t = 1.0;\n}\nsin_t = sin_taylor_fp32(a);\ncos_t = sqrt(1.0 - sin_t * sin_t);\n}\nfloat tan_taylor_fp32(float a) {\nfloat sin_a;\nfloat cos_a;\nif (a == 0.0) {\nreturn 0.0;\n}\nfloat z = floor(a / TWO_PI);\nfloat r = a - TWO_PI * z;\nfloat t;\nfloat q = floor(r / PI_2 + 0.5);\nint j = int(q);\nif (j < -2 || j > 2) {\nreturn 1.0 / 0.0;\n}\nt = r - PI_2 * q;\nq = floor(t / PI_16 + 0.5);\nint k = int(q);\nint abs_k = int(abs(float(k)));\nif (abs_k > 4) {\nreturn 1.0 / 0.0;\n} else {\nt = t - PI_16 * q;\n}\nfloat u = 0.0;\nfloat v = 0.0;\nfloat sin_t, cos_t;\nfloat s, c;\nsincos_taylor_fp32(t, sin_t, cos_t);\nif (k == 0) {\ns = sin_t;\nc = cos_t;\n} else {\nif (abs(float(abs_k) - 1.0) < 0.5) {\nu = COS_TABLE_0;\nv = SIN_TABLE_0;\n} else if (abs(float(abs_k) - 2.0) < 0.5) {\nu = COS_TABLE_1;\nv = SIN_TABLE_1;\n} else if (abs(float(abs_k) - 3.0) < 0.5) {\nu = COS_TABLE_2;\nv = SIN_TABLE_2;\n} else if (abs(float(abs_k) - 4.0) < 0.5) {\nu = COS_TABLE_3;\nv = SIN_TABLE_3;\n}\nif (k > 0) {\ns = u * sin_t + v * cos_t;\nc = u * cos_t - v * sin_t;\n} else {\ns = u * sin_t - v * cos_t;\nc = u * cos_t + v * sin_t;\n}\n}\nif (j == 0) {\nsin_a = s;\ncos_a = c;\n} else if (j == 1) {\nsin_a = c;\ncos_a = -s;\n} else if (j == -1) {\nsin_a = -c;\ncos_a = s;\n} else {\nsin_a = -s;\ncos_a = -c;\n}\nreturn sin_a / cos_a;\n}\n#endif\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nreturn tan_taylor_fp32(a);\n#else\nreturn tan(a);\n#endif\n}\n"},r="#define SMOOTH_EDGE_RADIUS 0.5",o={name:"geometry",vs:`\n${r}\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n`,fs:`\n${r}\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n`};var s=n(9350);const a=`${Object.keys(s.rf).map((t=>`const int COORDINATE_SYSTEM_${t} = ${s.rf[t]};`)).join("")}\n${Object.keys(s.Kx).map((t=>`const int PROJECTION_MODE_${t} = ${s.Kx[t]};`)).join("")}\n${Object.keys(s.p5).map((t=>`const int UNIT_${t.toUpperCase()} = ${s.p5[t]};`)).join("")}\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\nfloat y = clamp(lat, -89.9, 89.9);\nreturn 1.0 / cos(radians(y));\n}\nfloat project_size() {\nif (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\nproject_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\nproject_uPseudoMeters == false) {\nif (geometry.position.w == 0.0) {\nreturn project_size_at_latitude(geometry.worldPosition.y);\n}\nfloat y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\nfloat y2 = y * y;\nfloat y4 = y2 * y2;\nfloat y6 = y4 * y2;\nreturn 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n}\nreturn 1.0;\n}\nfloat project_size_at_latitude(float meters, float lat) {\nreturn meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\nreturn meters * project_uCommonUnitsPerMeter.z * project_size();\n}\nvec2 project_size(vec2 meters) {\nreturn meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\nvec3 project_size(vec3 meters) {\nreturn meters * project_uCommonUnitsPerMeter * project_size();\n}\nvec4 project_size(vec4 meters) {\nreturn vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\nvec3 uz = normalize(up);\nvec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\nvec3 uy = cross(uz, ux);\nreturn mat3(ux, uy, uz);\n}\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\nif (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\ntransform = project_get_orientation_matrix(commonPosition);\nreturn true;\n}\nreturn false;\n}\nvec3 project_normal(vec3 vector) {\nvec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\nvec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\nmat3 rotation;\nif (project_needs_rotation(geometry.position.xyz, rotation)) {\nn = rotation * n;\n}\nreturn n;\n}\nvec4 project_offset_(vec4 offset) {\nfloat dy = offset.y;\nvec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\nreturn vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\nfloat x = lnglat.x;\nif (project_uWrapLongitude) {\nx = mod(x + 180., 360.0) - 180.;\n}\nfloat y = clamp(lnglat.y, -89.9, 89.9);\nreturn vec2(\nradians(x) + PI,\nPI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n) * WORLD_SCALE;\n}\nvec3 project_globe_(vec3 lnglatz) {\nfloat lambda = radians(lnglatz.x);\nfloat phi = radians(lnglatz.y);\nfloat cosPhi = cos(phi);\nfloat D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\nreturn vec3(\nsin(lambda) * cosPhi,\n-cos(lambda) * cosPhi,\nsin(phi)\n) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\nvec4 position_world = project_uModelMatrix * position;\nif (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\nif (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_mercator_(position_world.xy),\nproject_size_at_latitude(position_world.z, position_world.y),\nposition_world.w\n);\n}\nif (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\nposition_world.xyz += project_uCoordinateOrigin;\n}\n}\nif (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\nif (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_globe_(position_world.xyz),\nposition_world.w\n);\n}\n}\nif (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\nif (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nif (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\nreturn vec4(\nproject_mercator_(position_world.xy) - project_uCommonOrigin.xy,\nproject_size(position_world.z),\nposition_world.w\n);\n}\n}\n}\nif (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n(project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n(project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\nproject_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\nposition_world.xyz -= project_uCoordinateOrigin;\n}\nreturn project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));\n}\nvec4 project_position(vec4 position) {\nreturn project_position(position, ZERO_64_LOW);\n}\nvec3 project_position(vec3 position, vec3 position64Low) {\nvec4 projected_position = project_position(vec4(position, 1.0), position64Low);\nreturn projected_position.xyz;\n}\nvec3 project_position(vec3 position) {\nvec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\nreturn projected_position.xyz;\n}\nvec2 project_position(vec2 position) {\nvec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\nreturn projected_position.xy;\n}\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\nreturn viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\nreturn project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\nvec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\nreturn offset * project_uFocalDistance;\n}\nfloat project_size_to_pixel(float meters) {\nreturn project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\nif (unit == UNIT_METERS) return project_size_to_pixel(size);\nif (unit == UNIT_COMMON) return size * project_uScale;\nreturn size;\n}\nfloat project_pixel_size(float pixels) {\nreturn pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\nreturn pixels / project_uScale;\n}\n`;var A=n(4334);const u={};const l={name:"project",dependencies:[i,o],vs:a,getUniforms:function(t=u){return"viewport"in t?(0,A.a)(t):{}}}},4334:(t,e,n)=>{"use strict";n.d(e,{a:()=>p,o:()=>f});var i=n(9426),r=n(218),o=n(9350),s=n(2417);const a=[0,0,0,0],A=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l=[0,0,0],c=[0,0,0],h=(0,s.A)((function({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:s}){const{projectionCenter:c,viewProjectionMatrix:h,originCommon:p,cameraPosCommon:d,shaderCoordinateOrigin:g,geospatialOrigin:_}=function(t,e,n){const{viewMatrixUncentered:o,projectionMatrix:s}=t;let{viewMatrix:u,viewProjectionMatrix:l}=t,c=a,h=a,p=t.cameraPosition;const{geospatialOrigin:d,shaderCoordinateOrigin:g,offsetMode:_}=f(t,e,n);_&&(h=t.projectPosition(d||g),p=[p[0]-h[0],p[1]-h[1],p[2]-h[2]],h[3]=1,c=i.Z0([],h,l),u=o||u,l=r.lw([],s,u),l=r.lw([],l,A));return{viewMatrix:u,viewProjectionMatrix:l,projectionCenter:c,originCommon:h,cameraPosCommon:p,shaderCoordinateOrigin:g,geospatialOrigin:d}}(t,n,s),m=t.getDistanceScales(),y=[t.width*e,t.height*e],v=i.Z0([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,E={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:g,project_uCommonOrigin:p.slice(0,3),project_uCenter:c,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:y,project_uDevicePixelRatio:e,project_uFocalDistance:v,project_uCommonUnitsPerMeter:m.unitsPerMeter,project_uCommonUnitsPerWorldUnit:m.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:l,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:h,project_uModelMatrix:u,project_uCameraPosition:d};if(_){const e=t.getDistanceScales(_);switch(n){case o.rf.METER_OFFSETS:E.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,E.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case o.rf.LNGLAT:case o.rf.LNGLAT_OFFSETS:t._pseudoMeters||(E.project_uCommonUnitsPerMeter=e.unitsPerMeter),E.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,E.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case o.rf.CARTESIAN:E.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],E.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return E}));function f(t,e,n=c){n.length<3&&(n=[n[0],n[1],0]);let i,r=n,s=!0;switch(i=e===o.rf.LNGLAT_OFFSETS||e===o.rf.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case o.Kx.WEB_MERCATOR:e!==o.rf.LNGLAT&&e!==o.rf.CARTESIAN||(i=[0,0,0],s=!1);break;case o.Kx.WEB_MERCATOR_AUTO_OFFSET:e===o.rf.LNGLAT?r=i:e===o.rf.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case o.Kx.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case o.Kx.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function p({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=o.rf.DEFAULT,coordinateOrigin:r=c,autoWrapLongitude:s=!1}){i===o.rf.DEFAULT&&(i=t.isGeospatial?o.rf.LNGLAT:o.rf.CARTESIAN);const a=h({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return a.project_uWrapLongitude=s,a.project_uModelMatrix=n||u,a}},4175:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});const i={name:"project32",dependencies:[n(3756).A],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"}},2357:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});class i{constructor(t){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=t}get inProgress(){return this._inProgress}start(t){this.cancel(),this.settings=t,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}},4067:(t,e,n)=>{"use strict";function i(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}n.d(e,{A:()=>i})},7914:(t,e,n)=>{"use strict";function i(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!i(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if("object"==typeof t&&"object"==typeof e){const r=Object.keys(t),o=Object.keys(e);if(r.length!==o.length)return!1;for(const s of r){if(!e.hasOwnProperty(s))return!1;if(!i(t[s],e[s],n-1))return!1}return!0}return!1}n.d(e,{b:()=>i})},8055:(t,e,n)=>{"use strict";function i(t,e=(()=>!0)){return Array.isArray(t)?r(t,e,[]):e(t)?[t]:[]}function r(t,e,n){let i=-1;for(;++i<t.length;){const o=t[i];Array.isArray(o)?r(o,e,n):e(o)&&n.push(o)}return n}function o({target:t,source:e,start:n=0,count:i=1}){const r=e.length,o=i*r;let s=0;for(let a=n;s<r;s++)t[a++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o);return t}n.d(e,{B:()=>i,R:()=>o})},3439:(t,e,n)=>{"use strict";n.d(e,{I:()=>a,Td:()=>s,X:()=>o});const i=[],r=[];function o(t,e=0,n=1/0){let o=i;const s={index:-1,data:t,target:[]};return t?"function"==typeof t[Symbol.iterator]?o=t:t.length>0&&(r.length=t.length,o=r):o=i,(e>0||Number.isFinite(n))&&(o=(Array.isArray(o)?o:Array.from(o)).slice(e,n),s.index=e-1),{iterable:o,objectInfo:s}}function s(t){return t&&t[Symbol.asyncIterator]}function a(t,e){const{size:n,stride:i,offset:r,startIndices:o,nested:s}=e,a=t.BYTES_PER_ELEMENT,A=i?i/a:n,u=r?r/a:0,l=Math.floor((t.length-u)/A);return(e,{index:i,target:r})=>{if(!o){const e=i*A+u;for(let i=0;i<n;i++)r[i]=t[e+i];return r}const a=o[i],c=o[i+1]||l;let h;if(s){h=new Array(c-a);for(let e=a;e<c;e++){const i=e*A+u;r=new Array(n);for(let e=0;e<n;e++)r[e]=t[i+e];h[e-a]=r}}else if(A===n)h=t.subarray(a*n+u,c*n+u);else{h=new t.constructor((c-a)*n);let e=0;for(let i=a;i<c;i++){const r=i*A+u;for(let i=0;i<n;i++)h[e++]=t[r+i]}}return h}}},3459:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});const i=new(n(1369).t)({id:"deck"})},5667:(t,e,n)=>{"use strict";n.d(e,{$M:()=>o,Vl:()=>s,_Z:()=>h,cT:()=>c,on:()=>a});var i=n(5840),r=n(7597);function o(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function s(t){return[t[12],t[13],t[14]]}function a(t){return{left:u(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:u(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:u(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:u(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:u(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:u(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const A=new r.P;function u(t,e,n,i){A.set(t,e,n);const o=A.len();return{distance:i/o,normal:new r.P(-t/o,-e/o,-n/o)}}let l;function c(t,e){const{size:n=1,startIndex:r=0}=e,o=void 0!==e.endIndex?e.endIndex:t.length,s=(o-r)/n;l=i.A.allocate(l,s,{type:Float32Array,size:2*n});let a=r,A=0;for(;a<o;){for(let e=0;e<n;e++){const i=t[a++];l[A+e]=i,l[A+e+n]=(u=i)-Math.fround(u)}A+=2*n}var u;return l.subarray(0,s*n*2)}function h(t){let e=null,n=!1;for(const i of t)i&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],i[0][0]),e[0][1]=Math.min(e[0][1],i[0][1]),e[1][0]=Math.max(e[1][0],i[1][0]),e[1][1]=Math.max(e[1][1],i[1][1])):e=i);return e}},2417:(t,e,n)=>{"use strict";function i(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function r(t){let e,n={};return r=>{for(const o in r)if(!i(r[o],n[o])){e=t(r),n=r;break}return e}}n.d(e,{A:()=>r})},4941:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var i=n(3439),r=n(5840),o=n(4067),s=n(6839);class a{constructor(t){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;const{attributes:e={}}=t;this.typedArrayManager=r.A,this.attributes={},this._attributeDefs=e,this.opts=t,this.updateGeometry(t)}updateGeometry(t){Object.assign(this.opts,t);const{data:e,buffers:n={},getGeometry:i,geometryBuffer:r,positionFormat:s,dataChanged:a,normalize:A=!0}=this.opts;if(this.data=e,this.getGeometry=i,this.positionSize=r&&r.size||("XY"===s?2:3),this.buffers=n,this.normalize=A,r&&((0,o.A)(e.startIndices),this.getGeometry=this.getGeometryFromBuffer(r),A||(n.vertexPositions=r)),this.geometryBuffer=n.vertexPositions,Array.isArray(a))for(const o of a)this._rebuildGeometry(o);else this._rebuildGeometry()}updatePartialGeometry({startRow:t,endRow:e}){this._rebuildGeometry({startRow:t,endRow:e})}getGeometryFromBuffer(t){const e=t.value||t;return ArrayBuffer.isView(e)?(0,i.I)(e,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices}):null}_allocate(t,e){const{attributes:n,buffers:i,_attributeDefs:r,typedArrayManager:o}=this;for(const s in r)if(s in i)o.release(n[s]),n[s]=null;else{const i=r[s];i.copy=e,n[s]=o.allocate(n[s],t,i)}}_forEachGeometry(t,e,n){const{data:r,getGeometry:o}=this,{iterable:s,objectInfo:a}=(0,i.X)(r,e,n);for(const i of s){a.index++;t(o?o(i,a):null,a.index)}}_rebuildGeometry(t){if(!this.data)return;let{indexStarts:e,vertexStarts:n,instanceCount:i}=this;const{data:r,geometryBuffer:o}=this,{startRow:a=0,endRow:A=1/0}=t||{},u={};if(t||(e=[0],n=[0]),this.normalize||!o)this._forEachGeometry(((t,e)=>{const i=t&&this.normalizeGeometry(t);u[e]=i,n[e+1]=n[e]+(i?this.getGeometrySize(i):0)}),a,A),i=n[n.length-1];else if(n=r.startIndices,i=n[r.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof s.h){const t=4*this.positionSize;i=i||o.byteLength/t}else if(o.buffer){const t=o.stride||4*this.positionSize;i=i||o.buffer.byteLength/t}else if(o.value){const t=o.value,e=o.stride/t.BYTES_PER_ELEMENT||this.positionSize;i=i||t.length/e}this._allocate(i,Boolean(t)),this.indexStarts=e,this.vertexStarts=n,this.instanceCount=i;const l={};this._forEachGeometry(((t,r)=>{const o=u[r]||t;l.vertexStart=n[r],l.indexStart=e[r];const s=r<n.length-1?n[r+1]:i;l.geometrySize=s-n[r],l.geometryIndex=r,this.updateGeometryAttributes(o,l)}),a,A),this.vertexCount=e[e.length-1]}}},5840:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});const i=new class{constructor(t={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,e,{size:n=1,type:i,padding:r=0,copy:o=!1,initialize:s=!1,maxCount:a}){const A=i||t&&t.constructor||Float32Array,u=e*n+r;if(ArrayBuffer.isView(t)){if(u<=t.length)return t;if(u*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new A(t.buffer,0,u)}let l=1/0;a&&(l=a*n+r);const c=this._allocate(A,u,s,l);return t&&o?c.set(t):s||c.fill(0,0,4),this._release(t),c}release(t){this._release(t)}_allocate(t,e,n,i){let r=Math.max(Math.ceil(e*this.opts.overAlloc),1);r>i&&(r=i);const o=this._pool,s=t.BYTES_PER_ELEMENT*r,a=o.findIndex((t=>t.byteLength>=s));if(a>=0){const e=new t(o.splice(a,1)[0],0,r);return n&&e.fill(0),e}return new t(r)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:i}=n,r=e.findIndex((t=>t.byteLength>=i));r<0?e.push(n):(r>0||e.length<this.opts.poolSize)&&e.splice(r,0,n),e.length>this.opts.poolSize&&e.shift()}}},7345:(t,e,n)=>{"use strict";n.d(e,{A:()=>d});var i=n(3459),r=n(5667),o=n(5077),s=n(4901),a=n(7597),A=n(218),u=n(4697),l=n(9350);const c=Math.PI/180,h=(0,r.$M)(),f=[0,0,0],p={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class d{static{this.displayName="Viewport"}constructor(t={}){this._frustumPlanes={},this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.padding=t.padding,this.distanceScales=t.distanceScales||p,this.focalDistance=t.focalDistance||1,this.position=t.position||f,this.modelMatrix=t.modelMatrix||null;const{longitude:e,latitude:n}=t;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(e),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?l.Kx.WEB_MERCATOR:l.Kx.WEB_MERCATOR_AUTO_OFFSET:l.Kx.IDENTITY}equals(t){return t instanceof d&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&(0,s.aI)(t.projectionMatrix,this.projectionMatrix)&&(0,s.aI)(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=this.projectPosition(t),i=(0,u.VJ)(n,this.pixelProjectionMatrix),[r,o]=i,s=e?o:this.height-o;return 2===t.length?[r,s]:[r,s,i[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[i,r,o]=t,s=e?r:this.height-r,a=n&&n*this.distanceScales.unitsPerMeter[2],A=(0,u.xJ)([i,s,o],this.pixelUnprojectionMatrix,a),[l,c,h]=this.unprojectPosition(A);return Number.isFinite(o)?[l,c,h]:Number.isFinite(n)?[l,c,n]:[l,c]}projectPosition(t){const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){if(this.isGeospatial){const e=(0,u.Gw)(t);return e[1]=(0,s.qE)(e[1],-318,830),e}return t}unprojectFlat(t){return this.isGeospatial?(0,u.iV)(t):t}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,0],e),i=this.unproject([this.width,0],e),r=this.unproject([0,this.height],e),o=this.unproject([this.width,this.height],e);return[Math.min(n[0],i[0],r[0],o[0]),Math.min(n[1],i[1],r[1],o[1]),Math.max(n[0],i[0],r[0],o[0]),Math.max(n[1],i[1],r[1],o[1])]}getDistanceScales(t){return t?(0,u.nI)({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:e,width:n=1,height:i=1}){return t<this.x+this.width&&this.x<t+n&&e<this.y+this.height&&this.y<e+i}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,(0,r.on)(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,e){return null}_initProps(t){const e=t.longitude,n=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=(0,u.fO)({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||(0,u.nI)({latitude:n,longitude:e}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:r,modelMatrix:s}=t;let A=f;if(r&&(A=s?new o.k(s).transformAsVector(r,[]):r),this.isGeospatial){const t=this.projectPosition([e,n,0]);this.center=new a.P(A).scale(this.distanceScales.unitsPerMeter).add(t)}else this.center=this.projectPosition(A)}_initMatrices(t){const{viewMatrix:e=h,projectionMatrix:n=null,orthographic:u=!1,fovyRadians:l,fovy:f=75,near:p=.1,far:d=1e3,padding:g=null,focalDistance:_=1}=t;this.viewMatrixUncentered=e,this.viewMatrix=(new o.k).multiplyRight(e).translate(new a.P(this.center).negate()),this.projectionMatrix=n||function({width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:r,padding:a,near:A,far:u}){const l=t/e,c=n?(new o.k).orthographic({fovy:i,aspect:l,focalDistance:r,near:A,far:u}):(new o.k).perspective({fovy:i,aspect:l,near:A,far:u});if(a){const{left:n=0,right:i=0,top:r=0,bottom:o=0}=a,A=(0,s.qE)((n+t-i)/2,0,t)-t/2,u=(0,s.qE)((r+e-o)/2,0,e)-e/2;c[8]-=2*A/t,c[9]+=2*u/e}return c}({width:this.width,height:this.height,orthographic:u,fovyRadians:l||f*c,focalDistance:_,padding:g,near:p,far:d});const m=(0,r.$M)();A.lw(m,m,this.projectionMatrix),A.lw(m,m,this.viewMatrix),this.viewProjectionMatrix=m,this.viewMatrixInverse=A.B8([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=(0,r.Vl)(this.viewMatrixInverse);const y=(0,r.$M)(),v=(0,r.$M)();A.hs(y,y,[this.width/2,-this.height/2,1]),A.Tl(y,y,[1,-1,0]),A.lw(v,y,this.viewProjectionMatrix),this.pixelProjectionMatrix=v,this.pixelUnprojectionMatrix=A.B8((0,r.$M)(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||i.A.warn("Pixel project matrix not invertible")()}}},9502:(t,e,n)=>{"use strict";n.d(e,{A:()=>A});var i=n(7345),r=n(4697),o=n(4901),s=n(5077),a=n(3588);class A extends i.A{static{this.displayName="WebMercatorViewport"}constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:i=0,pitch:a=0,bearing:A=0,nearZMultiplier:u=.1,farZMultiplier:l=1.01,nearZ:c,farZ:h,orthographic:f=!1,projectionMatrix:p,repeat:d=!1,worldOffset:g=0,position:_,padding:m,legacyMeterSizes:y=!1}=t;let{width:v,height:E,altitude:b=1.5}=t;const w=Math.pow(2,i);let x;v=v||1,E=E||1;let S=null;if(p)b=p[5]/2,x=(0,r.Os)(b);else{let n;if(t.fovy?(x=t.fovy,b=(0,r.wZ)(x)):x=(0,r.Os)(b),m){const{top:t=0,bottom:e=0}=m;n=[0,(0,o.qE)((t+E-e)/2,0,E)-E/2]}S=(0,r.om)({width:v,height:E,scale:w,center:_&&[0,0,_[2]*(0,r.mY)(e)],offset:n,pitch:a,fovy:x,nearZMultiplier:u,farZMultiplier:l}),Number.isFinite(c)&&(S.near=c),Number.isFinite(h)&&(S.far=h)}let C=(0,r.rY)({height:E,pitch:a,bearing:A,scale:w,altitude:b});if(g){C=(new s.k).translate([512*g,0,0]).multiplyLeft(C)}super({...t,width:v,height:E,viewMatrix:C,longitude:n,latitude:e,zoom:i,...S,fovy:x,focalDistance:b}),this.latitude=e,this.longitude=n,this.zoom=i,this.pitch=a,this.bearing=A,this.altitude=b,this.fovy=x,this.orthographic=f,this._subViewports=d?[]:null,this._pseudoMeters=y,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let i=e;i<=n;i++){const t=i?new A({...this,worldOffset:i}):this;this._subViewports.push(t)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*(0,r.mY)(t[1])]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)/(0,r.mY)(n)]}addMetersToLngLat(t,e){return(0,r.dT)(t,e)}panByPosition(t,e){const n=(0,r.xJ)(e,this.pixelUnprojectionMatrix),i=this.projectFlat(t),o=a.WQ([],i,a.ze([],n)),s=a.WQ([],this.center,o),[A,u]=this.unprojectFlat(s);return{longitude:A,latitude:u}}getBounds(t={}){const e=(0,r.gW)(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t,e={}){const{width:n,height:i}=this,{longitude:o,latitude:s,zoom:a}=(0,r.Fe)({width:n,height:i,bounds:t,...e});return new A({width:n,height:i,longitude:o,latitude:s,zoom:a})}}},5800:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1152),r=n(9502),o=n(586);class s extends i.A{static{this.displayName="MapView"}constructor(t={}){super(t)}get ViewportType(){return r.A}get ControllerType(){return o.A}}},1152:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});const i=/([0-9]+\.?[0-9]*)(%|px)/;function r(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=i.exec(t);if(e&&e.length>=3){const t="%"===e[2],n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error(`Could not parse position string ${t}`)}}function o(t,e){return t.relative?Math.round(t.position*e):t.position}var s=n(7914);class a{constructor(t){const{id:e,x:n=0,y:i=0,width:o="100%",height:s="100%",padding:a=null}=t;this.id=e||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=r(n),this._y=r(i),this._width=r(o),this._height=r(s),this._padding=a&&{left:r(a.left||0),right:r(a.right||0),top:r(a.top||0),bottom:r(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t||this.ViewportType===t.ViewportType&&(0,s.b)(this.props,t.props,2)}makeViewport({width:t,height:e,viewState:n}){n=this.filterViewState(n);const i=this.getDimensions({width:t,height:e});return i.height&&i.width?new this.ViewportType({...n,...this.props,...i}):null}getViewStateId(){const{viewState:t}=this.props;return"string"==typeof t?t:t?.id||this.id}filterViewState(t){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const t in this.props.viewState)"id"!==t&&(e[t]=this.props.viewState[t]);return e}return t}getDimensions({width:t,height:e}){const n={x:o(this._x,t),y:o(this._y,e),width:o(this._width,t),height:o(this._height,e)};return this._padding&&(n.padding={left:o(this._padding.left,t),top:o(this._padding.top,e),right:o(this._padding.right,t),bottom:o(this._padding.bottom,e)}),n}get controller(){const t=this.props.controller;return t?!0===t?{type:this.ControllerType}:"function"==typeof t?{type:t}:{type:this.ControllerType,...t}:null}}},2448:(t,e,n)=>{"use strict";n.d(e,{A:()=>Et});var i=function(t){var e,n=void 0!==(t=t||{})?t:{},i={};for(e in n)n.hasOwnProperty(e)&&(i[e]=n[e]);var r,o=[],s="";"undefined"!=typeof document&&document.currentScript&&(s=document.currentScript.src),s=0!==s.indexOf("blob:")?s.substr(0,s.lastIndexOf("/")+1):"",r=function(t,e,n){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){if(200==i.status||0==i.status&&i.response)e(i.response);else{var r=q(t);r?e(r.buffer):n()}},i.onerror=n,i.send(null)};var a=n.print||console.log.bind(console),A=n.printErr||console.warn.bind(console);for(e in i)i.hasOwnProperty(e)&&(n[e]=i[e]);i=null,n.arguments&&(o=n.arguments);var u=0;var l=!1;function c(t){var e,i=n["_"+t];return e="Cannot call unknown function "+t+", make sure it is exported",i||at("Assertion failed: "+e),i}function h(t,e,n,i,r){var o={string:function(t){var e=0;if(null!=t&&0!==t){var n=1+(t.length<<2);(function(t,e,n){(function(t,e,n,i){if(!(i>0))return 0;for(var r=n,o=n+i-1,s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a>=55296&&a<=57343)a=65536+((1023&a)<<10)|1023&t.charCodeAt(++s);if(a<=127){if(n>=o)break;e[n++]=a}else if(a<=2047){if(n+1>=o)break;e[n++]=192|a>>6,e[n++]=128|63&a}else if(a<=65535){if(n+2>=o)break;e[n++]=224|a>>12,e[n++]=128|a>>6&63,e[n++]=128|63&a}else{if(n+3>=o)break;e[n++]=240|a>>18,e[n++]=128|a>>12&63,e[n++]=128|a>>6&63,e[n++]=128|63&a}}e[n]=0})(t,_,e,n)})(t,e=J(n),n)}return e},array:function(t){var e=J(t.length);return function(t,e){g.set(t,e)}(t,e),e}};var s=c(t),a=[],A=0;if(i)for(var u=0;u<i.length;u++){var l=o[n[u]];l?(0===A&&(A=et()),a[u]=l(i[u])):a[u]=i[u]}var h=s.apply(null,a);return h=function(t){return"string"===e?p(t):"boolean"===e?Boolean(t):t}(h),0!==A&&tt(A),h}var f="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function p(t,e){return t?function(t,e,n){for(var i=e+n,r=e;t[r]&&!(r>=i);)++r;if(r-e>16&&t.subarray&&f)return f.decode(t.subarray(e,r));for(var o="";e<r;){var s=t[e++];if(128&s){var a=63&t[e++];if(192!=(224&s)){var A=63&t[e++];if((s=224==(240&s)?(15&s)<<12|a<<6|A:(7&s)<<18|a<<12|A<<6|63&t[e++])<65536)o+=String.fromCharCode(s);else{var u=s-65536;o+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else o+=String.fromCharCode((31&s)<<6|a)}else o+=String.fromCharCode(s)}return o}(_,t,e):""}var d,g,_,m,y,v,E;"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");function b(t,e){return t%e>0&&(t+=e-t%e),t}function w(t){d=t,n.HEAP8=g=new Int8Array(t),n.HEAP16=m=new Int16Array(t),n.HEAP32=y=new Int32Array(t),n.HEAPU8=_=new Uint8Array(t),n.HEAPU16=new Uint16Array(t),n.HEAPU32=new Uint32Array(t),n.HEAPF32=v=new Float32Array(t),n.HEAPF64=E=new Float64Array(t)}var x=n.TOTAL_MEMORY||33554432;function S(t){for(;t.length>0;){var e=t.shift();if("function"!=typeof e){var i=e.func;"number"==typeof i?void 0===e.arg?n.dynCall_v(i):n.dynCall_vi(i,e.arg):i(void 0===e.arg?null:e.arg)}else e()}}x=(d=n.buffer?n.buffer:new ArrayBuffer(x)).byteLength,w(d),y[6032]=5267040;var C=[],T=[],I=[],R=[];var P=Math.abs,M=Math.ceil,L=Math.floor,N=Math.min,O=0,D=null,F=null;n.preloadedImages={},n.preloadedAudios={};var k,B,U=null,G="data:application/octet-stream;base64,";function z(t){return String.prototype.startsWith?t.startsWith(G):0===t.indexOf(G)}U="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";function V(t){return t}function j(t){return t.replace(/\b__Z[\w\d_]+/g,(function(t){return t===t?t:t+" ["+t+"]"}))}function W(){var t=new Error;if(!t.stack){try{throw new Error(0)}catch(e){t=e}if(!t.stack)return"(no stack trace available)"}return t.stack.toString()}function H(){return g.length}function X(t){try{var e=new ArrayBuffer(t);if(e.byteLength!=t)return;return new Int8Array(e).set(g),Z(e),w(e),1}catch(n){}}var Y="function"==typeof atob?atob:function(t){var e,n,i,r,o,s,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",A="",u=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{e=a.indexOf(t.charAt(u++))<<2|(r=a.indexOf(t.charAt(u++)))>>4,n=(15&r)<<4|(o=a.indexOf(t.charAt(u++)))>>2,i=(3&o)<<6|(s=a.indexOf(t.charAt(u++))),A+=String.fromCharCode(e),64!==o&&(A+=String.fromCharCode(n)),64!==s&&(A+=String.fromCharCode(i))}while(u<t.length);return A};function q(t){if(z(t))return function(t){try{for(var e=Y(t),n=new Uint8Array(e.length),i=0;i<e.length;++i)n[i]=e.charCodeAt(i);return n}catch(r){throw new Error("Converting base64 string to bytes failed.")}}(t.slice(G.length))}var Q,$,K=function(t,e,n){var i=new t.Int8Array(n),r=new t.Int32Array(n),o=(new t.Uint8Array(n),new t.Float32Array(n),new t.Float64Array(n)),s=0|e.o,a=0|e.p,A=t.Math.floor,u=t.Math.abs,l=t.Math.sqrt,c=t.Math.pow,h=t.Math.cos,f=t.Math.sin,p=t.Math.tan,d=t.Math.acos,g=t.Math.asin,_=t.Math.atan,m=t.Math.atan2,y=t.Math.ceil,v=t.Math.imul,E=t.Math.min,b=t.Math.max,w=t.Math.clz32,x=e.b,S=e.c,C=e.d,T=e.e,I=e.f,R=e.g,P=e.h,M=e.i,L=24160;function N(t,e,n,i){return 0|O(t|=0,e|=0,n|=0,i|=0,0)}function O(t,e,n,i,o){var s,a=0,A=0,u=0,l=0;if(s=L,L=L+16|0,A=s,!(0|D(t|=0,e|=0,n|=0,i|=0,o|=0)))return L=s,0|(i=0);do{if((0|n)>=0){if((0|n)>13780509){if(0|(a=0|ee(15,A)))break;A=0|r[(u=A)>>2],u=0|r[u+4>>2]}else l=0|ke(0|n,0|(a=((0|n)<0)<<31>>31),3,0),u=0|S(),a=0|Le(0|n,0|a,1,0),a=0|Le(0|(a=0|ke(0|l,0|u,0|a,0|S())),0|S(),1,0),u=0|S(),r[A>>2]=a,r[A+4>>2]=u,A=a;if(Ye(0|i,0,A<<3),0|o){Ye(0|o,0,A<<2),a=0|F(t,e,n,i,o,A,u,0);break}(a=0|Me(A,4))?(l=0|F(t,e,n,i,a,A,u,0),Pe(a),a=l):a=13}else a=2}while(0);return L=s,0|(l=a)}function D(t,e,n,i,o){t|=0,e|=0,n|=0,i|=0,o|=0;var s,a,A=0,u=0,l=0,c=0,h=0,f=0,p=0,d=0,g=0;if(a=L,L=L+16|0,g=a+8|0,r[(d=s=a)>>2]=t,r[d+4>>2]=e,(0|n)<0)return L=a,0|(g=2);if(r[(A=i)>>2]=t,r[A+4>>2]=e,(A=!!(0|o))&&(r[o>>2]=0),0|kt(t,e))return L=a,0|(g=9);r[g>>2]=0;t:do{if((0|n)>=1)if(A)for(f=1,h=0,p=0,d=1,A=t;;){if(!(h|p)){if(0|(A=0|k(A,e,4,g,s)))break t;if(0|kt(A=0|r[(e=s)>>2],e=0|r[e+4>>2])){A=9;break t}}if(0|(A=0|k(A,e,0|r[22384+(p<<2)>>2],g,s)))break t;if(A=0|r[(e=s)>>2],e=0|r[e+4>>2],r[(t=i+(f<<3)|0)>>2]=A,r[t+4>>2]=e,r[o+(f<<2)>>2]=d,u=(0|(t=h+1|0))==(0|d),c=6==(0|(l=p+1|0)),0|kt(A,e)){A=9;break t}if((0|(d=d+(c&u&1)|0))>(0|n)){A=0;break}f=f+1|0,h=u?0:t,p=u?c?0:l:p}else for(f=1,h=0,p=0,d=1,A=t;;){if(!(h|p)){if(0|(A=0|k(A,e,4,g,s)))break t;if(0|kt(A=0|r[(e=s)>>2],e=0|r[e+4>>2])){A=9;break t}}if(0|(A=0|k(A,e,0|r[22384+(p<<2)>>2],g,s)))break t;if(A=0|r[(e=s)>>2],e=0|r[e+4>>2],r[(t=i+(f<<3)|0)>>2]=A,r[t+4>>2]=e,u=(0|(t=h+1|0))==(0|d),c=6==(0|(l=p+1|0)),0|kt(A,e)){A=9;break t}if((0|(d=d+(c&u&1)|0))>(0|n)){A=0;break}f=f+1|0,h=u?0:t,p=u?c?0:l:p}else A=0}while(0);return L=a,0|(g=A)}function F(t,e,n,i,o,s,a,A){n|=0,i|=0,o|=0,A|=0;var u,l,c,h=0,f=0,p=0,d=0,g=0,_=0,m=0;if(c=L,L=L+16|0,u=c+8|0,l=c,h=0|Ue(0|(t|=0),0|(e|=0),0|(s|=0),0|(a|=0)),p=0|S(),!(!(0|(m=0|r[(_=d=i+(h<<3)|0)>>2]))&!(0|(_=0|r[_+4>>2]))|(f=(0|m)==(0|t)&(0|_)==(0|e))))do{h=0|Be(0|(h=0|Le(0|h,0|p,1,0)),0|S(),0|s,0|a),p=0|S(),f=(0|(_=0|r[(m=d=i+(h<<3)|0)>>2]))==(0|t)&(0|(m=0|r[m+4>>2]))==(0|e)}while(!(!(0|_)&!(0|m)|f));if(h=o+(h<<2)|0,f&&(0|r[h>>2])<=(0|A))return L=c,0|(m=0);if(r[(m=d)>>2]=t,r[m+4>>2]=e,r[h>>2]=A,(0|A)>=(0|n))return L=c,0|(m=0);switch(f=A+1|0,r[u>>2]=0,0|(h=0|k(t,e,2,u,l))){case 9:g=9;break;case 0:(h=0|F(0|r[(h=l)>>2],0|r[h+4>>2],n,i,o,s,a,f))||(g=9)}t:do{if(9==(0|g)){switch(r[u>>2]=0,0|(h=0|k(t,e,3,u,l))){case 9:break;case 0:if(0|(h=0|F(0|r[(h=l)>>2],0|r[h+4>>2],n,i,o,s,a,f)))break t;break;default:break t}switch(r[u>>2]=0,0|(h=0|k(t,e,1,u,l))){case 9:break;case 0:if(0|(h=0|F(0|r[(h=l)>>2],0|r[h+4>>2],n,i,o,s,a,f)))break t;break;default:break t}switch(r[u>>2]=0,0|(h=0|k(t,e,5,u,l))){case 9:break;case 0:if(0|(h=0|F(0|r[(h=l)>>2],0|r[h+4>>2],n,i,o,s,a,f)))break t;break;default:break t}switch(r[u>>2]=0,0|(h=0|k(t,e,4,u,l))){case 9:break;case 0:if(0|(h=0|F(0|r[(h=l)>>2],0|r[h+4>>2],n,i,o,s,a,f)))break t;break;default:break t}switch(r[u>>2]=0,0|(h=0|k(t,e,6,u,l))){case 9:break;case 0:if(0|(h=0|F(0|r[(h=l)>>2],0|r[h+4>>2],n,i,o,s,a,f)))break t;break;default:break t}return L=c,0|(m=0)}}while(0);return L=c,0|(m=h)}function k(t,e,n,i,o){t|=0,e|=0,o|=0;var s,a,A=0,u=0,l=0,c=0,h=0,f=0,p=0;if((n|=0)>>>0>6)return 0|(o=1);if(h=(0|r[(i|=0)>>2])%6|0,r[i>>2]=h,(0|h)>0){A=0;do{n=0|pt(n),A=A+1|0}while((0|A)<(0|r[i>>2]))}if(h=0|ze(0|t,0|e,45),S(),(a=127&h)>>>0>121)return 0|(o=5);s=0|Bt(t,e),A=0|ze(0|t,0|e,52),S(),A&=15;t:do{if(A){for(;;){if(l=0|ze(0|t,0|e,0|(u=3*(15-A|0)|0)),S(),7==(0|(l&=7))){e=5;break}if(p=!(0|jt(A)),A=A+-1|0,f=0|Ve(7,0,0|u),e&=~S(),t=0|Ve(0|r[(p?432:16)+(28*l|0)+(n<<2)>>2],0,0|u)|t&~f,e|=u=0|S(),!(n=0|r[(p?640:224)+(28*l|0)+(n<<2)>>2])){n=0;break t}if(!A){c=8;break t}}return 0|e}c=8}while(0);8==(0|c)&&(t|=0|Ve(0|(p=0|r[848+(28*a|0)+(n<<2)>>2]),0,45),e=S()|-1040385&e,n=0|r[4272+(28*a|0)+(n<<2)>>2],127&~p||(p=0|Ve(0|r[848+(28*a|0)+20>>2],0,45),e=S()|-1040385&e,n=0|r[4272+(28*a|0)+20>>2],t=0|Gt(p|t,e),e=0|S(),r[i>>2]=1+(0|r[i>>2]))),l=0|ze(0|t,0|e,45),S(),l&=127;t:do{if(0|G(l)){e:do{if(1==(0|Bt(t,e))){if((0|a)!=(0|l)){if(0|W(l,0|r[7696+(28*a|0)>>2])){t=0|Vt(t,e),u=1,e=0|S();break}C(23313,22416,436,22424)}switch(0|s){case 3:t=0|Gt(t,e),e=0|S(),r[i>>2]=1+(0|r[i>>2]),u=0;break e;case 5:t=0|Vt(t,e),e=0|S(),r[i>>2]=5+(0|r[i>>2]),u=0;break e;case 0:return 0|(p=9);default:return 0|(p=1)}}else u=0}while(0);if((0|n)>0){A=0;do{t=0|Ut(t,e),e=0|S(),A=A+1|0}while((0|A)!=(0|n))}if((0|a)!=(0|l)){if(!(0|z(l))){if(!!(0|u)|5!=(0|Bt(t,e)))break;r[i>>2]=1+(0|r[i>>2]);break}switch(127&h){case 8:case 118:break t}3!=(0|Bt(t,e))&&(r[i>>2]=1+(0|r[i>>2]))}}else if((0|n)>0){A=0;do{t=0|Gt(t,e),e=0|S(),A=A+1|0}while((0|A)!=(0|n))}}while(0);return r[i>>2]=((0|r[i>>2])+n|0)%6|0,r[(p=o)>>2]=t,r[p+4>>2]=e,0|(p=0)}function B(t,e,n,i){n|=0,i|=0;var o,s,a,A=0,u=0;for(a=L,L=L+16|0,o=a,s=a+8|0,A=(A=!(0|kt(t|=0,e|=0)))?1:2;;){if(r[s>>2]=0,!(0|k(t,e,A,s,o))&((0|r[(u=o)>>2])==(0|n)?(0|r[u+4>>2])==(0|i):0)){t=4;break}if((A=A+1|0)>>>0>=7){A=7,t=4;break}}return 4==(0|t)?(L=a,0|A):0}function U(t,e,n,i,s,a,A){e|=0,n|=0,i|=0,s|=0,a|=0,A|=0;var u,l,c,h,f,p,d,g,_,m,y=0,v=0,E=0,b=0,w=0,x=0,C=0,T=0,I=0,R=0,P=0,M=0,N=0,O=0,D=0,F=0,k=0,B=0,U=0;if(m=L,L=L+64|0,d=m+48|0,g=m+32|0,_=m+24|0,u=m+8|0,l=m,(0|(v=0|r[(t|=0)>>2]))<=0)return L=m,0|(D=0);for(c=t+4|0,h=d+8|0,f=g+8|0,p=u+8|0,y=0,N=0;;){M=(E=0|r[c>>2])+(N<<4)|0,r[d>>2]=r[M>>2],r[d+4>>2]=r[M+4>>2],r[d+8>>2]=r[M+8>>2],r[d+12>>2]=r[M+12>>2],(0|N)==(v+-1|0)?(r[g>>2]=r[E>>2],r[g+4>>2]=r[E+4>>2],r[g+8>>2]=r[E+8>>2],r[g+12>>2]=r[E+12>>2]):(M=E+(N+1<<4)|0,r[g>>2]=r[M>>2],r[g+4>>2]=r[M+4>>2],r[g+8>>2]=r[M+8>>2],r[g+12>>2]=r[M+12>>2]),v=0|$(d,g,i,_);t:do{if(v)E=0,y=v;else if(v=0|r[(E=_)>>2],(0|(E=0|r[E+4>>2]))>0|!(0|E)&v>>>0>0){P=0,M=0;e:for(;;){if(U=+o[d>>3],B=+((R=0|Ne(0|v,0|E,0|P,0|M))>>>0)+4294967296*+(0|S()),F=+(v>>>0)+4294967296*+(0|E),k=+(P>>>0)+4294967296*+(0|M),o[u>>3]=U*B/F+ +o[g>>3]*k/F,o[p>>3]=+o[h>>3]*B/F+ +o[f>>3]*k/F,0|(v=0|Wt(u,i,l))){y=v;break}x=0|Ue(0|(I=0|r[(R=l)>>2]),0|(R=0|r[R+4>>2]),0|e,0|n),b=0|S(),E=0|r[(w=v=A+(x<<3)|0)>>2],w=0|r[w+4>>2];n:do{if(!(0|E)&!(0|w))O=v,D=16;else for(C=0,T=0;;){if((0|C)>(0|n)|(0|C)==(0|n)&T>>>0>e>>>0){y=1;break e}if((0|E)==(0|I)&(0|w)==(0|R))break n;if(x=0|Be(0|(v=0|Le(0|x,0|b,1,0)),0|S(),0|e,0|n),b=0|S(),T=0|Le(0|T,0|C,1,0),C=0|S(),!(0|(E=0|r[(w=v=A+(x<<3)|0)>>2]))&!(0|(w=0|r[w+4>>2]))){O=v,D=16;break}}}while(0);if(16!=(0|D)||(D=0,!(0|I)&!(0|R))||(r[(T=O)>>2]=I,r[T+4>>2]=R,T=a+(r[s>>2]<<3)|0,r[T>>2]=I,r[T+4>>2]=R,T=0|Le(0|r[(T=s)>>2],0|r[T+4>>2],1,0),I=0|S(),r[(R=s)>>2]=T,r[R+4>>2]=I),P=0|Le(0|P,0|M,1,0),M=0|S(),v=0|r[(E=_)>>2],!((0|(E=0|r[E+4>>2]))>(0|M)|(0|E)==(0|M)&v>>>0>P>>>0)){E=1;break t}}E=0}else E=1}while(0);if(N=N+1|0,!E){D=21;break}if((0|N)>=(0|(v=0|r[t>>2]))){y=0,D=21;break}}return 21==(0|D)?(L=m,0|y):0}function G(t){return(t|=0)>>>0>121?0|(t=0):0|(t=0|r[7696+(28*t|0)+16>>2])}function z(t){return 4==(0|(t|=0))|117==(0|t)}function V(t){return 0|r[11120+(216*(0|r[(t|=0)>>2])|0)+(72*(0|r[t+4>>2])|0)+(24*(0|r[t+8>>2])|0)+(r[t+12>>2]<<3)>>2]}function j(t){return 0|r[11120+(216*(0|r[(t|=0)>>2])|0)+(72*(0|r[t+4>>2])|0)+(24*(0|r[t+8>>2])|0)+(r[t+12>>2]<<3)+4>>2]}function W(t,e){return e|=0,(0|r[7696+(28*(t|=0)|0)+20>>2])==(0|e)?0|(e=1):0|(e=(0|r[7696+(28*t|0)+24>>2])==(0|e))}function H(t,e){return 0|r[848+(28*(t|=0)|0)+((e|=0)<<2)>>2]}function X(t,e){return e|=0,(0|r[848+(28*(t|=0)|0)>>2])==(0|e)?0|(e=0):(0|r[848+(28*t|0)+4>>2])==(0|e)?0|(e=1):(0|r[848+(28*t|0)+8>>2])==(0|e)?0|(e=2):(0|r[848+(28*t|0)+12>>2])==(0|e)?0|(e=3):(0|r[848+(28*t|0)+16>>2])==(0|e)?0|(e=4):(0|r[848+(28*t|0)+20>>2])==(0|e)?0|(e=5):0|((0|r[848+(28*t|0)+24>>2])==(0|e)?6:7)}function Y(t){return+o[(t|=0)+16>>3]<+o[t+24>>3]|0}function q(t,e){t|=0;var n,i,r=0;return(r=+o[(e|=0)>>3])>=+o[t+8>>3]&&r<=+o[t>>3]?(n=+o[t+16>>3],r=+o[t+24>>3],e=(i=+o[e+8>>3])>=r,t=i<=n&1,n<r?e&&(t=1):e||(t=0),0|(e=!!(0|t))):0|(e=0)}function Q(t,e,n){t|=0,e|=0,n|=0;var i,a,l,c,h,f,p,d=0,g=0,_=0,m=0,v=0,b=0,w=0;f=L,L=L+288|0,h=f+264|0,m=f+96|0,g=(d=_=f)+96|0;do{r[d>>2]=0,d=d+4|0}while((0|d)<(0|g));return 0|(e=0|Qt(e,_))?(L=f,0|(b=e)):(Yt(_=0|r[(g=_)>>2],g=0|r[g+4>>2],h),qt(_,g,m),c=+te(h,m+8|0),o[h>>3]=+o[t>>3],o[(g=h+8|0)>>3]=+o[t+16>>3],o[m>>3]=+o[t+8>>3],o[(_=m+8|0)>>3]=+o[t+24>>3],a=+te(h,m),w=+o[g>>3]-+o[_>>3],l=+u(+w),p=+o[h>>3]-+o[m>>3],i=+u(+p),!(0==w|0==p)&&(w=+je(+l,+i),w=+y(+a*a/+We(+w/+We(+l,+i),3)/(c*(2.59807621135*c)*.8)),o[s>>3]=w,v=~~w>>>0,b=+u(w)>=1?w>0?~~+E(+A(w/4294967296),4294967295)>>>0:~~+y((w-+(~~w>>>0))/4294967296)>>>0:0,2146435072&~r[s+4>>2])?(m=!(0|v)&!(0|b),r[(e=n)>>2]=m?1:v,r[e+4>>2]=m?0:b,e=0):e=1,L=f,0|(b=e))}function $(t,e,n,i){t|=0,e|=0,n|=0,i|=0;var a,l,c,h,f=0,p=0,d=0;h=L,L=L+288|0,l=h+264|0,c=h+96|0,a=(f=p=h)+96|0;do{r[f>>2]=0,f=f+4|0}while((0|f)<(0|a));return 0|(n=0|Qt(n,p))?(L=h,0|(i=n)):(Yt(f=0|r[(n=p)>>2],n=0|r[n+4>>2],l),qt(f,n,c),d=+te(l,c+8|0),d=+y(+ +te(t,e)/(2*d)),o[s>>3]=d,n=~~d>>>0,f=+u(d)>=1?d>0?~~+E(+A(d/4294967296),4294967295)>>>0:~~+y((d-+(~~d>>>0))/4294967296)>>>0:0,2146435072&~r[s+4>>2]?(p=!(0|n)&!(0|f),r[i>>2]=p?1:n,r[i+4>>2]=p?0:f,L=h,0|(i=0)):(L=h,0|(i=1)))}function K(t,e,n,i){e|=0,n|=0,i|=0,r[(t|=0)>>2]=e,r[t+4>>2]=n,r[t+8>>2]=i}function Z(t,e){t|=0;var n,i,s,a,A=0,l=0,c=0,h=0,f=0,p=0,d=0;r[(a=(e|=0)+8|0)>>2]=0,i=+o[t>>3],h=+u(+i),s=+o[t+8>>3],h+=.5*(f=+u(+s)/.8660254037844386),h-=+(0|(A=~~h)),f-=+(0|(t=~~f));do{if(h<.5){if(h<.3333333333333333){if(r[e>>2]=A,f<.5*(h+1)){r[e+4>>2]=t;break}t=t+1|0,r[e+4>>2]=t;break}if(t=(1&!(f<(d=1-h)))+t|0,r[e+4>>2]=t,d<=f&f<2*h){A=A+1|0,r[e>>2]=A;break}r[e>>2]=A;break}if(!(h<.6666666666666666)){if(A=A+1|0,r[e>>2]=A,f<.5*h){r[e+4>>2]=t;break}t=t+1|0,r[e+4>>2]=t;break}if(f<1-h){if(r[e+4>>2]=t,2*h-1<f){r[e>>2]=A;break}}else t=t+1|0,r[e+4>>2]=t;A=A+1|0,r[e>>2]=A}while(0);do{if(i<0){if(1&t){A=~~(+(0|A)-(2*(+((p=0|Ne(0|A,((0|A)<0)<<31>>31,0|(p=(t+1|0)/2|0),((0|p)<0)<<31>>31))>>>0)+4294967296*+(0|S()))+1)),r[e>>2]=A;break}A=~~(+(0|A)-2*(+((p=0|Ne(0|A,((0|A)<0)<<31>>31,0|(p=(0|t)/2|0),((0|p)<0)<<31>>31))>>>0)+4294967296*+(0|S()))),r[e>>2]=A;break}}while(0);p=e+4|0,s<0&&(A=A-((1|t<<1)/2|0)|0,r[e>>2]=A,t=0-t|0,r[p>>2]=t),l=t-A|0,(0|A)<0?(c=0-A|0,r[p>>2]=l,r[a>>2]=c,r[e>>2]=0,t=l,A=0):c=0,(0|t)<0&&(A=A-t|0,r[e>>2]=A,c=c-t|0,r[a>>2]=c,r[p>>2]=0,t=0),n=A-c|0,l=t-c|0,(0|c)<0&&(r[e>>2]=n,r[p>>2]=l,r[a>>2]=0,t=l,A=n,c=0),(0|(l=(0|c)<(0|(l=(0|t)<(0|A)?t:A))?c:l))<=0||(r[e>>2]=A-l,r[p>>2]=t-l,r[a>>2]=c-l)}function J(t){var e,n=0,i=0,o=0,s=0,a=0;n=0|r[(t|=0)>>2],i=0|r[(e=t+4|0)>>2],(0|n)<0&&(i=i-n|0,r[e>>2]=i,r[(a=t+8|0)>>2]=(0|r[a>>2])-n,r[t>>2]=0,n=0),(0|i)<0?(n=n-i|0,r[t>>2]=n,s=(0|r[(a=t+8|0)>>2])-i|0,r[a>>2]=s,r[e>>2]=0,i=0):(a=s=t+8|0,s=0|r[s>>2]),(0|s)<0&&(n=n-s|0,r[t>>2]=n,i=i-s|0,r[e>>2]=i,r[a>>2]=0,s=0),(0|(o=(0|s)<(0|(o=(0|i)<(0|n)?i:n))?s:o))<=0||(r[t>>2]=n-o,r[e>>2]=i-o,r[a>>2]=s-o)}function tt(t,e){e|=0;var n,i;i=0|r[(t|=0)+8>>2],n=+((0|r[t+4>>2])-i|0),o[e>>3]=+((0|r[t>>2])-i|0)-.5*n,o[e+8>>3]=.8660254037844386*n}function et(t,e,n){t|=0,e|=0,r[(n|=0)>>2]=(0|r[e>>2])+(0|r[t>>2]),r[n+4>>2]=(0|r[e+4>>2])+(0|r[t+4>>2]),r[n+8>>2]=(0|r[e+8>>2])+(0|r[t+8>>2])}function nt(t,e,n){t|=0,e|=0,r[(n|=0)>>2]=(0|r[t>>2])-(0|r[e>>2]),r[n+4>>2]=(0|r[t+4>>2])-(0|r[e+4>>2]),r[n+8>>2]=(0|r[t+8>>2])-(0|r[e+8>>2])}function it(t,e){e|=0;var n,i=0;i=0|v(0|r[(t|=0)>>2],e),r[t>>2]=i,n=0|v(0|r[(i=t+4|0)>>2],e),r[i>>2]=n,e=0|v(0|r[(t=t+8|0)>>2],e),r[t>>2]=e}function rt(t){var e,n,i=0,o=0,s=0,a=0,A=0;A=(0|(n=0|r[(t|=0)>>2]))<0,t=(t=(o=(0|(a=((e=(0|(s=(0|r[t+4>>2])-(A?n:0)|0))<0)?0-s|0:0)+((0|r[t+8>>2])-(A?n:0))|0))<0)?0:a)-((s=(0|(o=(0|t)<(0|(o=(0|(i=(e?0:s)-(o?a:0)|0))<(0|(a=(A?0:n)-(e?s:0)-(o?a:0)|0))?i:a))?t:o))>0)?o:0)|0,i=i-(s?o:0)|0;t:do{switch(a-(s?o:0)|0){case 0:switch(0|i){case 0:return 0|(A=0|t?1==(0|t)?1:7:0);case 1:return 0|(A=0|t?1==(0|t)?3:7:2);default:break t}case 1:switch(0|i){case 0:return 0|(A=0|t?1==(0|t)?5:7:4);case 1:if(t)break t;return 0|(t=6);default:break t}}}while(0);return 0|(A=7)}function ot(t){var e,n=0,i=0,o=0,s=0,a=0,A=0;s=0|r[(e=(t|=0)+8|0)>>2],a=(0|r[t>>2])-s|0,s=(0|r[(A=t+4|0)>>2])-s|0;do{if(a>>>0>715827881|s>>>0>715827881){if(i=(0|a)>0){if((2147483647-a|0)<(0|a))return 0|(A=1);if((2147483647-(a<<1)|0)<(0|a))return 0|(A=1)}else{if((-2147483648-a|0)>(0|a))return 0|(A=1);if((-2147483648-(a<<1)|0)>(0|a))return 0|(A=1)}if(n=3*a|0,(0|s)>0){if((2147483647-s|0)<(0|s))return 0|(A=1)}else if((-2147483648-s|0)>(0|s))return 0|(A=1);if(o=s<<1,(0|a)>-1){if((-2147483648|n)>=(0|s))return 0|(A=1)}else if((-2147483648^n)<(0|s))return 0|(A=1);if(i){if(!((2147483647-a|0)<(0|o))){i=o;break}return 0|(n=1)}if(!((-2147483648-a|0)>(0|o))){i=o;break}return 0|(n=1)}i=s<<1,n=3*a|0}while(0);o=0|Ie(+(n-s|0)/7),r[t>>2]=o,s=0|Ie(+(i+a|0)/7),r[A>>2]=s,r[e>>2]=0,n=(i=(0|s)<(0|o))?o:s,i=i?s:o;do{if((0|i)<0){if((0|n)>0){if((-2147483648|n)<(0|i)&-2147483648!=(0|i)&(2147483647-n|0)>=(0|i))break;C(23313,22444,355,22455)}if(-2147483648==(0|i)|(-2147483648-n|0)>(0|i)&&C(23313,22444,355,22455),(0|n)>-1){if((-2147483648|n)<(0|i))break;C(23313,22444,355,22455)}else{if((-2147483648^n)>=(0|i))break;C(23313,22444,355,22455)}}}while(0);return n=s-o|0,(0|o)<0?(i=0-o|0,r[A>>2]=n,r[e>>2]=i,r[t>>2]=0,o=0):(n=s,i=0),(0|n)<0&&(o=o-n|0,r[t>>2]=o,i=i-n|0,r[e>>2]=i,r[A>>2]=0,n=0),a=o-i|0,s=n-i|0,(0|i)<0?(r[t>>2]=a,r[A>>2]=s,r[e>>2]=0,n=s,s=a,i=0):s=o,(0|(o=(0|i)<(0|(o=(0|n)<(0|s)?n:s))?i:o))<=0||(r[t>>2]=s-o,r[A>>2]=n-o,r[e>>2]=i-o),0|(A=0)}function st(t){var e,n=0,i=0,o=0,s=0,a=0,A=0;s=0|r[(e=(t|=0)+8|0)>>2],a=(0|r[t>>2])-s|0,s=(0|r[(A=t+4|0)>>2])-s|0;do{if(a>>>0>715827881|s>>>0>715827881){if(i=(0|a)>0){if((2147483647-a|0)<(0|a))return 0|(A=1)}else if((-2147483648-a|0)>(0|a))return 0|(A=1);if(n=a<<1,(0|s)>0){if((2147483647-s|0)<(0|s))return 0|(A=1);if((2147483647-(s<<1)|0)<(0|s))return 0|(A=1)}else{if((-2147483648-s|0)>(0|s))return 0|(A=1);if((-2147483648-(s<<1)|0)>(0|s))return 0|(A=1)}if(o=3*s|0,i){if((2147483647-n|0)<(0|s))return 0|(A=1)}else if((-2147483648-n|0)>(0|s))return 0|(A=1);if((0|s)>-1){if((-2147483648|o)<(0|a)){i=o;break}return 0|(n=1)}if(!((-2147483648^o)<(0|a))){i=o;break}return 0|(n=1)}i=3*s|0,n=a<<1}while(0);o=0|Ie(+(n+s|0)/7),r[t>>2]=o,s=0|Ie(+(i-a|0)/7),r[A>>2]=s,r[e>>2]=0,n=(i=(0|s)<(0|o))?o:s,i=i?s:o;do{if((0|i)<0){if((0|n)>0){if((-2147483648|n)<(0|i)&-2147483648!=(0|i)&(2147483647-n|0)>=(0|i))break;C(23313,22444,404,22469)}if(-2147483648==(0|i)|(-2147483648-n|0)>(0|i)&&C(23313,22444,404,22469),(0|n)>-1){if((-2147483648|n)<(0|i))break;C(23313,22444,404,22469)}else{if((-2147483648^n)>=(0|i))break;C(23313,22444,404,22469)}}}while(0);return n=s-o|0,(0|o)<0?(i=0-o|0,r[A>>2]=n,r[e>>2]=i,r[t>>2]=0,o=0):(n=s,i=0),(0|n)<0&&(o=o-n|0,r[t>>2]=o,i=i-n|0,r[e>>2]=i,r[A>>2]=0,n=0),a=o-i|0,s=n-i|0,(0|i)<0?(r[t>>2]=a,r[A>>2]=s,r[e>>2]=0,n=s,s=a,i=0):s=o,(0|(o=(0|i)<(0|(o=(0|n)<(0|s)?n:s))?i:o))<=0||(r[t>>2]=s-o,r[A>>2]=n-o,r[e>>2]=i-o),0|(A=0)}function at(t){var e,n,i=0,o=0,s=0,a=0,A=0;o=0|r[(e=(t|=0)+8|0)>>2],s=0|Ie(+((3*(i=(0|r[t>>2])-o|0)|0)-(o=(0|r[(n=t+4|0)>>2])-o|0)|0)/7),r[t>>2]=s,i=0|Ie(+((o<<1)+i|0)/7),r[n>>2]=i,r[e>>2]=0,o=i-s|0,(0|s)<0?(A=0-s|0,r[n>>2]=o,r[e>>2]=A,r[t>>2]=0,i=o,s=0,o=A):o=0,(0|i)<0&&(s=s-i|0,r[t>>2]=s,o=o-i|0,r[e>>2]=o,r[n>>2]=0,i=0),A=s-o|0,a=i-o|0,(0|o)<0?(r[t>>2]=A,r[n>>2]=a,r[e>>2]=0,i=a,a=A,o=0):a=s,(0|(s=(0|o)<(0|(s=(0|i)<(0|a)?i:a))?o:s))<=0||(r[t>>2]=a-s,r[n>>2]=i-s,r[e>>2]=o-s)}function At(t){var e,n,i=0,o=0,s=0,a=0,A=0;o=0|r[(e=(t|=0)+8|0)>>2],s=0|Ie(+(((i=(0|r[t>>2])-o|0)<<1)+(o=(0|r[(n=t+4|0)>>2])-o|0)|0)/7),r[t>>2]=s,i=0|Ie(+((3*o|0)-i|0)/7),r[n>>2]=i,r[e>>2]=0,o=i-s|0,(0|s)<0?(A=0-s|0,r[n>>2]=o,r[e>>2]=A,r[t>>2]=0,i=o,s=0,o=A):o=0,(0|i)<0&&(s=s-i|0,r[t>>2]=s,o=o-i|0,r[e>>2]=o,r[n>>2]=0,i=0),A=s-o|0,a=i-o|0,(0|o)<0?(r[t>>2]=A,r[n>>2]=a,r[e>>2]=0,i=a,a=A,o=0):a=s,(0|(s=(0|o)<(0|(s=(0|i)<(0|a)?i:a))?o:s))<=0||(r[t>>2]=a-s,r[n>>2]=i-s,r[e>>2]=o-s)}function ut(t){var e,n,i,o=0,s=0,a=0,A=0;o=0|r[(t|=0)>>2],s=0|r[(n=t+4|0)>>2],a=0|r[(i=t+8|0)>>2],A=s+(3*o|0)|0,r[t>>2]=A,s=a+(3*s|0)|0,r[n>>2]=s,o=(3*a|0)+o|0,r[i>>2]=o,a=s-A|0,(0|A)<0?(o=o-A|0,r[n>>2]=a,r[i>>2]=o,r[t>>2]=0,s=a,a=0):a=A,(0|s)<0&&(a=a-s|0,r[t>>2]=a,o=o-s|0,r[i>>2]=o,r[n>>2]=0,s=0),e=a-o|0,A=s-o|0,(0|o)<0?(r[t>>2]=e,r[n>>2]=A,r[i>>2]=0,a=e,o=0):A=s,(0|(s=(0|o)<(0|(s=(0|A)<(0|a)?A:a))?o:s))<=0||(r[t>>2]=a-s,r[n>>2]=A-s,r[i>>2]=o-s)}function lt(t){var e,n,i,o=0,s=0,a=0,A=0;A=0|r[(t|=0)>>2],a=(3*(o=0|r[(n=t+4|0)>>2])|0)+A|0,A=(s=0|r[(i=t+8|0)>>2])+(3*A|0)|0,r[t>>2]=A,r[n>>2]=a,o=(3*s|0)+o|0,r[i>>2]=o,s=a-A|0,(0|A)<0?(o=o-A|0,r[n>>2]=s,r[i>>2]=o,r[t>>2]=0,A=0):s=a,(0|s)<0&&(A=A-s|0,r[t>>2]=A,o=o-s|0,r[i>>2]=o,r[n>>2]=0,s=0),e=A-o|0,a=s-o|0,(0|o)<0?(r[t>>2]=e,r[n>>2]=a,r[i>>2]=0,A=e,o=0):a=s,(0|(s=(0|o)<(0|(s=(0|a)<(0|A)?a:A))?o:s))<=0||(r[t>>2]=A-s,r[n>>2]=a-s,r[i>>2]=o-s)}function ct(t,e){t|=0;var n,i,o,s=0,a=0,A=0;((e|=0)+-1|0)>>>0>=6||(A=(0|r[15440+(12*e|0)>>2])+(0|r[t>>2])|0,r[t>>2]=A,o=t+4|0,a=(0|r[15440+(12*e|0)+4>>2])+(0|r[o>>2])|0,r[o>>2]=a,i=t+8|0,e=(0|r[15440+(12*e|0)+8>>2])+(0|r[i>>2])|0,r[i>>2]=e,s=a-A|0,(0|A)<0?(e=e-A|0,r[o>>2]=s,r[i>>2]=e,r[t>>2]=0,a=0):(s=a,a=A),(0|s)<0&&(a=a-s|0,r[t>>2]=a,e=e-s|0,r[i>>2]=e,r[o>>2]=0,s=0),n=a-e|0,A=s-e|0,(0|e)<0?(r[t>>2]=n,r[o>>2]=A,r[i>>2]=0,a=n,e=0):A=s,(0|(s=(0|e)<(0|(s=(0|A)<(0|a)?A:a))?e:s))<=0||(r[t>>2]=a-s,r[o>>2]=A-s,r[i>>2]=e-s))}function ht(t){var e,n,i,o=0,s=0,a=0,A=0;A=0|r[(t|=0)>>2],a=(o=0|r[(n=t+4|0)>>2])+A|0,A=(s=0|r[(i=t+8|0)>>2])+A|0,r[t>>2]=A,r[n>>2]=a,o=s+o|0,r[i>>2]=o,s=a-A|0,(0|A)<0?(o=o-A|0,r[n>>2]=s,r[i>>2]=o,r[t>>2]=0,a=0):(s=a,a=A),(0|s)<0&&(a=a-s|0,r[t>>2]=a,o=o-s|0,r[i>>2]=o,r[n>>2]=0,s=0),e=a-o|0,A=s-o|0,(0|o)<0?(r[t>>2]=e,r[n>>2]=A,r[i>>2]=0,a=e,o=0):A=s,(0|(s=(0|o)<(0|(s=(0|A)<(0|a)?A:a))?o:s))<=0||(r[t>>2]=a-s,r[n>>2]=A-s,r[i>>2]=o-s)}function ft(t){var e,n,i,o=0,s=0,a=0,A=0;o=0|r[(t|=0)>>2],a=0|r[(n=t+4|0)>>2],s=0|r[(i=t+8|0)>>2],A=a+o|0,r[t>>2]=A,a=s+a|0,r[n>>2]=a,o=s+o|0,r[i>>2]=o,s=a-A|0,(0|A)<0?(o=o-A|0,r[n>>2]=s,r[i>>2]=o,r[t>>2]=0,a=0):(s=a,a=A),(0|s)<0&&(a=a-s|0,r[t>>2]=a,o=o-s|0,r[i>>2]=o,r[n>>2]=0,s=0),e=a-o|0,A=s-o|0,(0|o)<0?(r[t>>2]=e,r[n>>2]=A,r[i>>2]=0,a=e,o=0):A=s,(0|(s=(0|o)<(0|(s=(0|A)<(0|a)?A:a))?o:s))<=0||(r[t>>2]=a-s,r[n>>2]=A-s,r[i>>2]=o-s)}function pt(t){switch(0|(t|=0)){case 1:t=5;break;case 5:t=4;break;case 4:t=6;break;case 6:t=2;break;case 2:t=3;break;case 3:t=1}return 0|t}function dt(t){switch(0|(t|=0)){case 1:t=3;break;case 3:t=2;break;case 2:t=6;break;case 6:t=4;break;case 4:t=5;break;case 5:t=1}return 0|t}function gt(t){var e,n,i,o=0,s=0,a=0,A=0;o=0|r[(t|=0)>>2],s=0|r[(n=t+4|0)>>2],a=0|r[(i=t+8|0)>>2],A=s+(o<<1)|0,r[t>>2]=A,s=a+(s<<1)|0,r[n>>2]=s,o=(a<<1)+o|0,r[i>>2]=o,a=s-A|0,(0|A)<0?(o=o-A|0,r[n>>2]=a,r[i>>2]=o,r[t>>2]=0,s=a,a=0):a=A,(0|s)<0&&(a=a-s|0,r[t>>2]=a,o=o-s|0,r[i>>2]=o,r[n>>2]=0,s=0),e=a-o|0,A=s-o|0,(0|o)<0?(r[t>>2]=e,r[n>>2]=A,r[i>>2]=0,a=e,o=0):A=s,(0|(s=(0|o)<(0|(s=(0|A)<(0|a)?A:a))?o:s))<=0||(r[t>>2]=a-s,r[n>>2]=A-s,r[i>>2]=o-s)}function _t(t){var e,n,i,o=0,s=0,a=0,A=0;A=0|r[(t|=0)>>2],a=((o=0|r[(n=t+4|0)>>2])<<1)+A|0,A=(s=0|r[(i=t+8|0)>>2])+(A<<1)|0,r[t>>2]=A,r[n>>2]=a,o=(s<<1)+o|0,r[i>>2]=o,s=a-A|0,(0|A)<0?(o=o-A|0,r[n>>2]=s,r[i>>2]=o,r[t>>2]=0,A=0):s=a,(0|s)<0&&(A=A-s|0,r[t>>2]=A,o=o-s|0,r[i>>2]=o,r[n>>2]=0,s=0),e=A-o|0,a=s-o|0,(0|o)<0?(r[t>>2]=e,r[n>>2]=a,r[i>>2]=0,A=e,o=0):a=s,(0|(s=(0|o)<(0|(s=(0|a)<(0|A)?a:A))?o:s))<=0||(r[t>>2]=A-s,r[n>>2]=a-s,r[i>>2]=o-s)}function mt(t,e){e|=0;var n,i,o,s=0,a=0,A=0;return o=(0|(i=(0|r[(t|=0)>>2])-(0|r[e>>2])|0))<0,n=(0|(a=(0|r[t+4>>2])-(0|r[e+4>>2])-(o?i:0)|0))<0,e=(e=(t=(0|(A=(o?0-i|0:0)+(0|r[t+8>>2])-(0|r[e+8>>2])+(n?0-a|0:0)|0))<0)?0:A)-((a=(0|(t=(0|e)<(0|(t=(0|(s=(n?0:a)-(t?A:0)|0))<(0|(A=(o?0:i)-(n?a:0)-(t?A:0)|0))?s:A))?e:t))>0)?t:0)|0,s=s-(a?t:0)|0,0|((0|(t=(0|(t=A-(a?t:0)|0))>-1?t:0-t|0))>(0|(e=(0|(s=(0|s)>-1?s:0-s|0))>(0|(e=(0|e)>-1?e:0-e|0))?s:e))?t:e)}function yt(t,e){e|=0;var n;n=0|r[(t|=0)+8>>2],r[e>>2]=(0|r[t>>2])-n,r[e+4>>2]=(0|r[t+4>>2])-n}function vt(t,e){e|=0;var n,i,o,s=0,a=0,A=0;a=0|r[(t|=0)>>2],r[e>>2]=a,A=0|r[t+4>>2],r[(i=e+4|0)>>2]=A,r[(o=e+8|0)>>2]=0,t=(s=(0|A)<(0|a))?a:A,s=s?A:a;do{if((0|s)<0){if((0|t)>0){if((-2147483648|t)<(0|s)&-2147483648!=(0|s)&(2147483647-t|0)>=(0|s))break;return 0|(t=1)}if(-2147483648==(0|s)|(-2147483648-t|0)>(0|s))return 0|(e=1);if((0|t)>-1){if((-2147483648|t)<(0|s))break;return 0|(t=1)}if(!((-2147483648^t)<(0|s)))break;return 0|(t=1)}}while(0);return t=A-a|0,(0|a)<0?(s=0-a|0,r[i>>2]=t,r[o>>2]=s,r[e>>2]=0,a=0):(t=A,s=0),(0|t)<0&&(a=a-t|0,r[e>>2]=a,s=s-t|0,r[o>>2]=s,r[i>>2]=0,t=0),n=a-s|0,A=t-s|0,(0|s)<0?(r[e>>2]=n,r[i>>2]=A,r[o>>2]=0,t=A,A=n,s=0):A=a,(0|(a=(0|s)<(0|(a=(0|t)<(0|A)?t:A))?s:a))<=0||(r[e>>2]=A-a,r[i>>2]=t-a,r[o>>2]=s-a),0|(e=0)}function Et(t){var e,n,i,o;n=(o=0|r[(e=(t|=0)+8|0)>>2])-(0|r[t>>2])|0,r[t>>2]=n,t=(0|r[(i=t+4|0)>>2])-o|0,r[i>>2]=t,r[e>>2]=0-(t+n)}function bt(t){var e,n,i=0,o=0,s=0,a=0,A=0;i=0-(o=0|r[(t|=0)>>2])|0,r[t>>2]=i,r[(e=t+8|0)>>2]=0,a=(s=0|r[(n=t+4|0)>>2])+o|0,(0|o)>0?(r[n>>2]=a,r[e>>2]=o,r[t>>2]=0,i=0,s=a):o=0,(0|s)<0?(A=i-s|0,r[t>>2]=A,o=o-s|0,r[e>>2]=o,r[n>>2]=0,a=A-o|0,i=0-o|0,(0|o)<0?(r[t>>2]=a,r[n>>2]=i,r[e>>2]=0,s=i,o=0):(s=0,a=A)):a=i,(0|(i=(0|o)<(0|(i=(0|s)<(0|a)?s:a))?o:i))<=0||(r[t>>2]=a-i,r[n>>2]=s-i,r[e>>2]=o-i)}function wt(t,e,n){n|=0;var i,o,s=0,a=0;return o=L,L=L+16|0,i=o,a=-2130706433&(e|=0)|134217728,!0&268435456==(2013265920&e)?(s=0|ze(0|(t|=0),0|e,56),S(),s=0|function(t,e,n){t|=0,e|=0,n|=0;var i=0,o=0,s=0;if(s=L,L=L+16|0,o=s,i=0|kt(t,e),(n+-1|0)>>>0>5)return L=s,0|(o=-1);if(i=!!(0|i),1==(0|n)&i)return L=s,0|(o=-1);do{if(!(0|ye(t,e,o))){if(i){i=(5+(0|r[21936+(n<<2)>>2])-(0|r[o>>2])|0)%5|0;break}i=(6+(0|r[21968+(n<<2)>>2])-(0|r[o>>2])|0)%6|0;break}i=-1}while(0);return o=i,L=s,0|o}(t,a,7&s),-1==(0|s)?(r[n>>2]=0,L=o,0|(a=6)):(0|Xt(t,a,i)&&C(23313,22484,282,22499),e=0|ze(0|t,0|e,52),S(),e&=15,0|kt(t,a)?Tt(i,e,s,2,n):Mt(i,e,s,2,n),L=o,0|(a=0))):(L=o,0|(a=6))}function xt(t,e,n,i){e|=0,i|=0;var s,a=0,A=0,u=0,l=0;if(s=L,L=L+16|0,function(t,e,n){t|=0,e|=0,n|=0;var i=0,s=0,a=0;a=L,L=L+32|0,s=a,function(t,e){t|=0,e|=0;var n=0,i=0,r=0;n=+o[t>>3],i=+h(+n),n=+f(+n),o[e+16>>3]=n,n=+o[t+8>>3],r=i*+h(+n),o[e>>3]=r,n=i*+f(+n),o[e+8>>3]=n}(t,s),r[e>>2]=0,o[n>>3]=5,i=+me(16400,s),i<+o[n>>3]&&(r[e>>2]=0,o[n>>3]=i);i=+me(16424,s),i<+o[n>>3]&&(r[e>>2]=1,o[n>>3]=i);i=+me(16448,s),i<+o[n>>3]&&(r[e>>2]=2,o[n>>3]=i);i=+me(16472,s),i<+o[n>>3]&&(r[e>>2]=3,o[n>>3]=i);i=+me(16496,s),i<+o[n>>3]&&(r[e>>2]=4,o[n>>3]=i);i=+me(16520,s),i<+o[n>>3]&&(r[e>>2]=5,o[n>>3]=i);i=+me(16544,s),i<+o[n>>3]&&(r[e>>2]=6,o[n>>3]=i);i=+me(16568,s),i<+o[n>>3]&&(r[e>>2]=7,o[n>>3]=i);i=+me(16592,s),i<+o[n>>3]&&(r[e>>2]=8,o[n>>3]=i);i=+me(16616,s),i<+o[n>>3]&&(r[e>>2]=9,o[n>>3]=i);i=+me(16640,s),i<+o[n>>3]&&(r[e>>2]=10,o[n>>3]=i);i=+me(16664,s),i<+o[n>>3]&&(r[e>>2]=11,o[n>>3]=i);i=+me(16688,s),i<+o[n>>3]&&(r[e>>2]=12,o[n>>3]=i);i=+me(16712,s),i<+o[n>>3]&&(r[e>>2]=13,o[n>>3]=i);i=+me(16736,s),i<+o[n>>3]&&(r[e>>2]=14,o[n>>3]=i);i=+me(16760,s),i<+o[n>>3]&&(r[e>>2]=15,o[n>>3]=i);i=+me(16784,s),i<+o[n>>3]&&(r[e>>2]=16,o[n>>3]=i);i=+me(16808,s),i<+o[n>>3]&&(r[e>>2]=17,o[n>>3]=i);i=+me(16832,s),i<+o[n>>3]&&(r[e>>2]=18,o[n>>3]=i);if(i=+me(16856,s),!(i<+o[n>>3]))return void(L=a);r[e>>2]=19,o[n>>3]=i,L=a}(t|=0,n|=0,l=s),(A=+d(+(1-.5*+o[l>>3])))<1e-16)return r[i>>2]=0,r[i+4>>2]=0,r[i+8>>2]=0,r[i+12>>2]=0,void(L=s);if(l=0|r[n>>2],a=+Zt((a=+o[15920+(24*l|0)>>3])-+Zt(+function(t,e){t|=0,e|=0;var n=0,i=0,r=0,s=0,a=0;return s=+o[e>>3],i=+h(+s),r=+o[e+8>>3]-+o[t+8>>3],a=i*+f(+r),n=+o[t>>3],+ +m(+a,+(+f(+s)*+h(+n)-+h(+r)*(i*+f(+n))))}(15600+(l<<4)|0,t))),u=0|jt(e)?+Zt(a+-.3334731722518321):a,a=+p(+A)/.381966011250105,(0|e)>0){t=0;do{a*=2.6457513110645907,t=t+1|0}while((0|t)!=(0|e))}A=+h(+u)*a,o[i>>3]=A,u=+f(+u)*a,o[i+8>>3]=u,L=s}function St(t,e,n,i,s){e|=0,n|=0,i|=0,s|=0;var a=0,A=0;if(a=+function(t){t|=0;var e=0,n=0;return n=+o[t>>3],e=+o[t+8>>3],+ +l(+(n*n+e*e))}(t|=0),a<1e-16)return e=15600+(e<<4)|0,r[s>>2]=r[e>>2],r[s+4>>2]=r[e+4>>2],r[s+8>>2]=r[e+8>>2],void(r[s+12>>2]=r[e+12>>2]);if(A=+m(+ +o[t+8>>3],+ +o[t>>3]),(0|n)>0){t=0;do{a/=2.6457513110645907,t=t+1|0}while((0|t)!=(0|n))}i?(a/=3,n=!(0|jt(n)),a=+_(.381966011250105*(n?a:a/2.6457513110645907))):(a=+_(.381966011250105*a),0|jt(n)&&(A=+Zt(A+.3334731722518321))),function(t,e,n,i){t|=0,e=+e,n=+n,i|=0;var s=0,a=0,A=0,l=0;if(n<1e-16)return r[i>>2]=r[t>>2],r[i+4>>2]=r[t+4>>2],r[i+8>>2]=r[t+8>>2],void(r[i+12>>2]=r[t+12>>2]);a=e<0?e+6.283185307179586:e,a=e>=6.283185307179586?a+-6.283185307179586:a;do{if(!(a<1e-16)){if(s=+u(+(a+-3.141592653589793))<1e-16,e=+o[t>>3],s){e-=n,o[i>>3]=e,s=i;break}if(A=+h(+n),n=+f(+n),e=A*+f(+e)+ +h(+a)*(n*+h(+e)),e=+g(+((e=e>1?1:e)<-1?-1:e)),o[i>>3]=e,+u(+(e+-1.5707963267948966))<1e-16)return o[i>>3]=1.5707963267948966,void(o[i+8>>3]=0);if(+u(+(e+1.5707963267948966))<1e-16)return o[i>>3]=-1.5707963267948966,void(o[i+8>>3]=0);if(l=+h(+e),a=n*+f(+a)/l,n=+o[t>>3],e=(A-+f(+e)*+f(+n))/+h(+n)/l,A=a>1?1:a,e=e>1?1:e,(e=+o[t+8>>3]+ +m(+(A<-1?-1:A),+(e<-1?-1:e)))>3.141592653589793)do{e+=-6.283185307179586}while(e>3.141592653589793);if(e<-3.141592653589793)do{e+=6.283185307179586}while(e<-3.141592653589793);return void(o[i+8>>3]=e)}e=+o[t>>3]+n,o[i>>3]=e,s=i}while(0);if(+u(+(e+-1.5707963267948966))<1e-16)return o[s>>3]=1.5707963267948966,void(o[i+8>>3]=0);if(+u(+(e+1.5707963267948966))<1e-16)return o[s>>3]=-1.5707963267948966,void(o[i+8>>3]=0);if(e=+o[t+8>>3],e>3.141592653589793)do{e+=-6.283185307179586}while(e>3.141592653589793);if(e<-3.141592653589793)do{e+=6.283185307179586}while(e<-3.141592653589793);o[i+8>>3]=e}(15600+(e<<4)|0,+Zt(+o[15920+(24*e|0)>>3]-A),a,s)}function Ct(t,e,n){e|=0,n|=0;var i,o;i=L,L=L+16|0,tt((t|=0)+4|0,o=i),St(o,0|r[t>>2],e,0,n),L=i}function Tt(t,e,n,i,s){t|=0,e|=0,n|=0,i|=0,s|=0;var a,A,u,l,c,h,f,p,d,g,_,m,y,v,E,b,w,x,S,T,I,R,P=0,M=0,N=0,O=0,D=0,F=0;if(R=L,L=L+272|0,O=R+240|0,S=R,T=R+224|0,I=R+208|0,_=R+176|0,m=R+160|0,y=R+192|0,v=R+144|0,E=R+128|0,b=R+112|0,w=R+96|0,x=R+80|0,r[(P=R+256|0)>>2]=e,r[O>>2]=r[t>>2],r[O+4>>2]=r[t+4>>2],r[O+8>>2]=r[t+8>>2],r[O+12>>2]=r[t+12>>2],It(O,P,S),r[s>>2]=0,(0|(O=i+n+(5==(0|i)&1)|0))<=(0|n))L=R;else{A=T+4|0,u=_+4|0,l=n+5|0,c=16880+((a=0|r[P>>2])<<2)|0,h=16960+(a<<2)|0,f=E+8|0,p=b+8|0,d=w+8|0,g=I+4|0,N=n;t:for(;;){M=S+((0|N)%5<<4)|0,r[I>>2]=r[M>>2],r[I+4>>2]=r[M+4>>2],r[I+8>>2]=r[M+8>>2],r[I+12>>2]=r[M+12>>2];do{}while(2==(0|Rt(I,a,0,1)));if((0|N)>(0|n)&!!(0|jt(e))){if(r[_>>2]=r[I>>2],r[_+4>>2]=r[I+4>>2],r[_+8>>2]=r[I+8>>2],r[_+12>>2]=r[I+12>>2],tt(A,m),i=0|r[_>>2],P=0|r[17040+(80*i|0)+(r[T>>2]<<2)>>2],r[_>>2]=r[18640+(80*i|0)+(20*P|0)>>2],(0|(M=0|r[18640+(80*i|0)+(20*P|0)+16>>2]))>0){t=0;do{ht(u),t=t+1|0}while((0|t)<(0|M))}switch(M=18640+(80*i|0)+(20*P|0)+4|0,r[y>>2]=r[M>>2],r[y+4>>2]=r[M+4>>2],r[y+8>>2]=r[M+8>>2],it(y,3*(0|r[c>>2])|0),et(u,y,u),J(u),tt(u,v),D=+(0|r[h>>2]),o[E>>3]=3*D,o[f>>3]=0,F=-1.5*D,o[b>>3]=F,o[p>>3]=2.598076211353316*D,o[w>>3]=F,o[d>>3]=-2.598076211353316*D,0|r[17040+(80*(0|r[_>>2])|0)+(r[I>>2]<<2)>>2]){case 1:t=b,i=E;break;case 3:t=w,i=b;break;case 2:t=E,i=w;break;default:t=12;break t}ge(m,v,i,t,x),St(x,0|r[_>>2],a,1,s+8+(r[s>>2]<<4)|0),r[s>>2]=1+(0|r[s>>2])}if((0|N)<(0|l)&&(tt(g,_),St(_,0|r[I>>2],a,1,s+8+(r[s>>2]<<4)|0),r[s>>2]=1+(0|r[s>>2])),r[T>>2]=r[I>>2],r[T+4>>2]=r[I+4>>2],r[T+8>>2]=r[I+8>>2],r[T+12>>2]=r[I+12>>2],(0|(N=N+1|0))>=(0|O)){t=3;break}}3!=(0|t)?12==(0|t)&&C(22522,22569,571,22579):L=R}}function It(t,e,n){t|=0,e|=0,n|=0;var i,o=0,s=0,a=0,A=0,u=0;i=L,L=L+128|0,s=i,A=20240,u=(a=o=i+64|0)+60|0;do{r[a>>2]=r[A>>2],a=a+4|0,A=A+4|0}while((0|a)<(0|u));A=20304,u=(a=s)+60|0;do{r[a>>2]=r[A>>2],a=a+4|0,A=A+4|0}while((0|a)<(0|u));o=(u=!(0|jt(0|r[e>>2])))?o:s,gt(s=t+4|0),_t(s),0|jt(0|r[e>>2])&&(lt(s),r[e>>2]=1+(0|r[e>>2])),r[n>>2]=r[t>>2],et(s,o,e=n+4|0),J(e),r[n+16>>2]=r[t>>2],et(s,o+12|0,e=n+20|0),J(e),r[n+32>>2]=r[t>>2],et(s,o+24|0,e=n+36|0),J(e),r[n+48>>2]=r[t>>2],et(s,o+36|0,e=n+52|0),J(e),r[n+64>>2]=r[t>>2],et(s,o+48|0,n=n+68|0),J(n),L=i}function Rt(t,e,n,i){n|=0,i|=0;var o,s,a,A,u,l,c=0,h=0,f=0,p=0,d=0;if(l=L,L=L+32|0,u=l+12|0,s=l,d=(t|=0)+4|0,p=0|r[16960+((e|=0)<<2)>>2],p=(A=!!(0|i))?3*p|0:p,c=0|r[d>>2],o=0|r[(a=t+8|0)>>2],A){if((0|(c=o+c+(i=0|r[(h=t+12|0)>>2])|0))==(0|p))return L=l,0|(d=1);f=h}else c=o+c+(i=0|r[(f=t+12|0)>>2])|0;if((0|c)<=(0|p))return L=l,0|(d=0);do{if((0|i)>0){if(i=0|r[t>>2],(0|o)>0){h=18640+(80*i|0)+60|0,i=t;break}i=18640+(80*i|0)+40|0,n?(K(u,p,0,0),nt(d,u,s),ft(s),et(s,u,d),h=i,i=t):(h=i,i=t)}else h=18640+(80*(0|r[t>>2])|0)+20|0,i=t}while(0);if(r[i>>2]=r[h>>2],(0|r[(c=h+16|0)>>2])>0){i=0;do{ht(d),i=i+1|0}while((0|i)<(0|r[c>>2]))}return t=h+4|0,r[u>>2]=r[t>>2],r[u+4>>2]=r[t+4>>2],r[u+8>>2]=r[t+8>>2],e=0|r[16880+(e<<2)>>2],it(u,A?3*e|0:e),et(d,u,d),J(d),i=A&&((0|r[a>>2])+(0|r[d>>2])+(0|r[f>>2])|0)==(0|p)?1:2,L=l,0|(d=i)}function Pt(t,e){t|=0,e|=0;var n=0;do{n=0|Rt(t,e,0,1)}while(2==(0|n));return 0|n}function Mt(t,e,n,i,s){t|=0,e|=0,n|=0,i|=0,s|=0;var a,A,u,l,c,h,f,p,d,g,_,m,y,v,E,b,w,x,S=0,T=0,I=0,R=0,P=0;if(x=L,L=L+240|0,v=x+208|0,E=x,b=x+192|0,w=x+176|0,d=x+160|0,g=x+144|0,_=x+128|0,m=x+112|0,y=x+96|0,r[(S=x+224|0)>>2]=e,r[v>>2]=r[t>>2],r[v+4>>2]=r[t+4>>2],r[v+8>>2]=r[t+8>>2],r[v+12>>2]=r[t+12>>2],Lt(v,S,E),r[s>>2]=0,(0|(p=i+n+(6==(0|i)&1)|0))<=(0|n))L=x;else{A=n+6|0,u=16960+((a=0|r[S>>2])<<2)|0,l=g+8|0,c=_+8|0,h=m+8|0,f=b+4|0,T=0,I=n,i=-1;t:for(;;){if(t=E+((S=(0|I)%6|0)<<4)|0,r[b>>2]=r[t>>2],r[b+4>>2]=r[t+4>>2],r[b+8>>2]=r[t+8>>2],r[b+12>>2]=r[t+12>>2],t=T,T=0|Rt(b,a,0,1),(0|I)>(0|n)&!!(0|jt(e))&&(1!=(0|t)&&(0|r[b>>2])!=(0|i))){switch(tt(E+((S+5|0)%6<<4)+4|0,w),tt(E+(S<<4)+4|0,d),R=+(0|r[u>>2]),o[g>>3]=3*R,o[l>>3]=0,P=-1.5*R,o[_>>3]=P,o[c>>3]=2.598076211353316*R,o[m>>3]=P,o[h>>3]=-2.598076211353316*R,S=0|r[v>>2],0|r[17040+(80*S|0)+(((0|i)==(0|S)?r[b>>2]:i)<<2)>>2]){case 1:t=_,i=g;break;case 3:t=m,i=_;break;case 2:t=g,i=m;break;default:t=8;break t}ge(w,d,i,t,y),0|_e(w,y)||0|_e(d,y)||(St(y,0|r[v>>2],a,1,s+8+(r[s>>2]<<4)|0),r[s>>2]=1+(0|r[s>>2]))}if((0|I)<(0|A)&&(tt(f,w),St(w,0|r[b>>2],a,1,s+8+(r[s>>2]<<4)|0),r[s>>2]=1+(0|r[s>>2])),(0|(I=I+1|0))>=(0|p)){t=3;break}i=0|r[b>>2]}3!=(0|t)?8==(0|t)&&C(22606,22569,736,22651):L=x}}function Lt(t,e,n){t|=0,e|=0,n|=0;var i,o=0,s=0,a=0,A=0,u=0;i=L,L=L+160|0,s=i,A=20368,u=(a=o=i+80|0)+72|0;do{r[a>>2]=r[A>>2],a=a+4|0,A=A+4|0}while((0|a)<(0|u));A=20448,u=(a=s)+72|0;do{r[a>>2]=r[A>>2],a=a+4|0,A=A+4|0}while((0|a)<(0|u));o=(u=!(0|jt(0|r[e>>2])))?o:s,gt(s=t+4|0),_t(s),0|jt(0|r[e>>2])&&(lt(s),r[e>>2]=1+(0|r[e>>2])),r[n>>2]=r[t>>2],et(s,o,e=n+4|0),J(e),r[n+16>>2]=r[t>>2],et(s,o+12|0,e=n+20|0),J(e),r[n+32>>2]=r[t>>2],et(s,o+24|0,e=n+36|0),J(e),r[n+48>>2]=r[t>>2],et(s,o+36|0,e=n+52|0),J(e),r[n+64>>2]=r[t>>2],et(s,o+48|0,e=n+68|0),J(e),r[n+80>>2]=r[t>>2],et(s,o+60|0,n=n+84|0),J(n),L=i}function Nt(t,e){return e=0|ze(0|(t|=0),0|(e|=0),45),S(),127&e}function Ot(t,e){var n=0,i=0,r=0,o=0,s=0,a=0;if(!(!0&134217728==(-16777216&(e|=0))))return 0|(e=0);if(s=0|ze(0|(t|=0),0|e,45),S(),(s&=127)>>>0>121)return 0|(e=0);n=0|ze(0|t,0|e,52),S(),n&=15;do{if(0|n){for(r=1,i=0;;){if(o=0|ze(0|t,0|e,3*(15-r|0)|0),S(),!!(0|(o&=7))&(1^i)){if(1==(0|o)&!!(0|G(s))){a=0,i=13;break}i=1}if(7==(0|o)){a=0,i=13;break}if(!(r>>>0<n>>>0)){i=9;break}r=r+1|0}if(9==(0|i)){if(15!=(0|n))break;return 0|(a=1)}if(13==(0|i))return 0|a}}while(0);for(;;){if(a=0|ze(0|t,0|e,3*(14-n|0)|0),S(),!(!0&!(7&~a))){a=0,i=13;break}if(!(n>>>0<14)){a=1,i=13;break}n=n+1|0}return 13==(0|i)?0|a:0}function Dt(t,e,n,i){n|=0,i|=0;var o=0,s=0;if(s=0|ze(0|(t|=0),0|(e|=0),52),S(),n>>>0>15)return 0|(i=4);if((0|(s&=15))<(0|n))return 0|(i=12);if((0|s)==(0|n))return r[i>>2]=t,r[i+4>>2]=e,0|(i=0);if(o=0|Ve(0|n,0,52),o|=t,t=S()|-15728641&e,(0|s)>(0|n))do{e=0|Ve(7,0,3*(14-n|0)|0),n=n+1|0,o|=e,t=S()|t}while((0|n)<(0|s));return r[i>>2]=o,r[i+4>>2]=t,0|(i=0)}function Ft(t,e,n,i){n|=0,i|=0;var o=0,s=0,a=0;if(s=0|ze(0|(t|=0),0|(e|=0),52),S(),!((0|n)<16&(0|(s&=15))<=(0|n)))return 0|(i=4);o=n-s|0,n=0|ze(0|t,0|e,45),S();t:do{if(0|G(127&n)){e:do{if(0|s){for(n=1;!((a=0|Ve(7,0,3*(15-n|0)|0))&t)&!(S()&e);){if(!(n>>>0<s>>>0))break e;n=n+1|0}n=0|ce(7,0,o,((0|o)<0)<<31>>31),o=0|S();break t}}while(0);n=0|Le(0|(n=0|ke(0|(n=0|ce(7,0,o,((0|o)<0)<<31>>31)),0|S(),5,0)),0|S(),-5,-1),n=0|Le(0|(n=0|Fe(0|n,0|S(),6,0)),0|S(),1,0),o=0|S()}else n=0|ce(7,0,o,((0|o)<0)<<31>>31),o=0|S()}while(0);return r[(a=i)>>2]=n,r[a+4>>2]=o,0|(a=0)}function kt(t,e){var n=0,i=0,r=0;if(r=0|ze(0|(t|=0),0|(e|=0),45),S(),!(0|G(127&r)))return 0|(r=0);r=0|ze(0|t,0|e,52),S(),r&=15;t:do{if(r)for(i=1;;){if(n=0|ze(0|t,0|e,3*(15-i|0)|0),S(),0|(n&=7))break t;if(!(i>>>0<r>>>0)){n=0;break}i=i+1|0}else n=0}while(0);return 0|(r=1&!(0|n))}function Bt(t,e){var n=0,i=0,r=0;if(r=0|ze(0|(t|=0),0|(e|=0),52),S(),!(r&=15))return 0|(r=0);for(i=1;;){if(n=0|ze(0|t,0|e,3*(15-i|0)|0),S(),0|(n&=7)){i=5;break}if(!(i>>>0<r>>>0)){n=0,i=5;break}i=i+1|0}return 5==(0|i)?0|n:0}function Ut(t,e){var n=0,i=0,r=0,o=0,s=0,a=0,A=0;if(A=0|ze(0|(t|=0),0|(e|=0),52),S(),!(A&=15))return A=t,x(0|(a=e)),0|A;for(a=1,n=0;;){i=0|Ve(7,0,0|(o=3*(15-a|0)|0)),r=0|S(),s=0|ze(0|t,0|e,0|o),S(),t=(o=0|Ve(0|pt(7&s),0,0|o))|t&~i,e=(s=0|S())|e&~r;t:do{if(!n)if(!(o&i)&!(s&r))n=0;else if(i=0|ze(0|t,0|e,52),S(),i&=15){n=1;e:for(;;){switch(s=0|ze(0|t,0|e,3*(15-n|0)|0),S(),7&s){case 1:break e;case 0:break;default:n=1;break t}if(!(n>>>0<i>>>0)){n=1;break t}n=n+1|0}for(n=1;;){if(r=0|ze(0|t,0|e,0|(s=3*(15-n|0)|0)),S(),o=0|Ve(7,0,0|s),e&=~S(),t=t&~o|(s=0|Ve(0|pt(7&r),0,0|s)),e|=S(),!(n>>>0<i>>>0)){n=1;break}n=n+1|0}}else n=1}while(0);if(!(a>>>0<A>>>0))break;a=a+1|0}return x(0|e),0|t}function Gt(t,e){var n=0,i=0,r=0,o=0,s=0;if(i=0|ze(0|(t|=0),0|(e|=0),52),S(),!(i&=15))return i=t,x(0|(n=e)),0|i;for(n=1;s=0|ze(0|t,0|e,0|(o=3*(15-n|0)|0)),S(),r=0|Ve(7,0,0|o),e&=~S(),t=(o=0|Ve(0|pt(7&s),0,0|o))|t&~r,e=S()|e,n>>>0<i>>>0;)n=n+1|0;return x(0|e),0|t}function zt(t,e){var n=0,i=0,r=0,o=0,s=0,a=0,A=0;if(A=0|ze(0|(t|=0),0|(e|=0),52),S(),!(A&=15))return A=t,x(0|(a=e)),0|A;for(a=1,n=0;;){i=0|Ve(7,0,0|(o=3*(15-a|0)|0)),r=0|S(),s=0|ze(0|t,0|e,0|o),S(),t=(o=0|Ve(0|dt(7&s),0,0|o))|t&~i,e=(s=0|S())|e&~r;t:do{if(!n)if(!(o&i)&!(s&r))n=0;else if(i=0|ze(0|t,0|e,52),S(),i&=15){n=1;e:for(;;){switch(s=0|ze(0|t,0|e,3*(15-n|0)|0),S(),7&s){case 1:break e;case 0:break;default:n=1;break t}if(!(n>>>0<i>>>0)){n=1;break t}n=n+1|0}for(n=1;;){if(o=0|Ve(7,0,0|(r=3*(15-n|0)|0)),s=e&~S(),e=0|ze(0|t,0|e,0|r),S(),t=t&~o|(e=0|Ve(0|dt(7&e),0,0|r)),e=s|S(),!(n>>>0<i>>>0)){n=1;break}n=n+1|0}}else n=1}while(0);if(!(a>>>0<A>>>0))break;a=a+1|0}return x(0|e),0|t}function Vt(t,e){var n=0,i=0,r=0,o=0,s=0;if(i=0|ze(0|(t|=0),0|(e|=0),52),S(),!(i&=15))return i=t,x(0|(n=e)),0|i;for(n=1;o=0|Ve(7,0,0|(s=3*(15-n|0)|0)),r=e&~S(),e=0|ze(0|t,0|e,0|s),S(),t=(e=0|Ve(0|dt(7&e),0,0|s))|t&~o,e=S()|r,n>>>0<i>>>0;)n=n+1|0;return x(0|e),0|t}function jt(t){return(0|(t|=0))%2|0}function Wt(t,e,n){n|=0;var i,o=0;return i=L,L=L+16|0,o=i,(e|=0)>>>0>15?(L=i,0|(o=4)):2146435072&~r[(t|=0)+4>>2]&&2146435072&~r[t+8+4>>2]?(function(t,e,n){var i,r;i=L,L=L+16|0,xt(t|=0,e|=0,n|=0,r=i),Z(r,n+4|0),L=i}(t,e,o),e=0|function(t,e){t|=0;var n,i=0,o=0,s=0,a=0,A=0,u=0,l=0,c=0;if(n=L,L=L+64|0,u=n+40|0,o=n+24|0,s=n+12|0,a=n,Ve(0|(e|=0),0,52),i=134225919|S(),!e)return(0|r[t+4>>2])>2||(0|r[t+8>>2])>2||(0|r[t+12>>2])>2?(u=0,x(0|(A=0)),L=n,0|u):(Ve(0|V(t),0,45),A=S()|i,u=-1,x(0|A),L=n,0|u);if(r[u>>2]=r[t>>2],r[u+4>>2]=r[t+4>>2],r[u+8>>2]=r[t+8>>2],r[u+12>>2]=r[t+12>>2],A=u+4|0,(0|e)>0)for(t=-1;r[o>>2]=r[A>>2],r[o+4>>2]=r[A+4>>2],r[o+8>>2]=r[A+8>>2],1&e?(at(A),r[s>>2]=r[A>>2],r[s+4>>2]=r[A+4>>2],r[s+8>>2]=r[A+8>>2],ut(s)):(At(A),r[s>>2]=r[A>>2],r[s+4>>2]=r[A+4>>2],r[s+8>>2]=r[A+8>>2],lt(s)),nt(o,s,a),J(a),l=0|Ve(7,0,0|(c=3*(15-e|0)|0)),i&=~S(),t=(c=0|Ve(0|rt(a),0,0|c))|t&~l,i=S()|i,(0|e)>1;)e=e+-1|0;else t=-1;t:do{if((0|r[A>>2])<=2&&(0|r[u+8>>2])<=2&&(0|r[u+12>>2])<=2){if(e=0|Ve(0|(o=0|V(u)),0,45),e|=t,t=S()|-1040385&i,a=0|j(u),!(0|G(o))){if((0|a)<=0)break;for(s=0;;){if(o=0|ze(0|e,0|t,52),S(),o&=15)for(i=1;u=0|ze(0|e,0|t,0|(c=3*(15-i|0)|0)),S(),l=0|Ve(7,0,0|c),t&=~S(),e=e&~l|(c=0|Ve(0|pt(7&u),0,0|c)),t|=S(),i>>>0<o>>>0;)i=i+1|0;if((0|(s=s+1|0))==(0|a))break t}}s=0|ze(0|e,0|t,52),S(),s&=15;e:do{if(s){i=1;n:for(;;){switch(c=0|ze(0|e,0|t,3*(15-i|0)|0),S(),7&c){case 1:break n;case 0:break;default:break e}if(!(i>>>0<s>>>0))break e;i=i+1|0}if(0|W(o,0|r[u>>2]))for(i=1;l=0|Ve(7,0,0|(u=3*(15-i|0)|0)),c=t&~S(),t=0|ze(0|e,0|t,0|u),S(),e=e&~l|(t=0|Ve(0|dt(7&t),0,0|u)),t=c|S(),i>>>0<s>>>0;)i=i+1|0;else for(i=1;u=0|ze(0|e,0|t,0|(c=3*(15-i|0)|0)),S(),l=0|Ve(7,0,0|c),t&=~S(),e=e&~l|(c=0|Ve(0|pt(7&u),0,0|c)),t|=S(),i>>>0<s>>>0;)i=i+1|0}}while(0);if((0|a)>0){i=0;do{e=0|Ut(e,t),t=0|S(),i=i+1|0}while((0|i)!=(0|a))}}else e=0,t=0}while(0);return c=e,x(0|(l=t)),L=n,0|c}(o,e),o=0|S(),r[n>>2]=e,r[n+4>>2]=o,!(0|e)&!(0|o)&&C(23313,22674,786,22697),L=i,0|(o=0)):(L=i,0|(o=3))}function Ht(t,e,n){var i,o=0,s=0,a=0;if(i=(n|=0)+4|0,s=0|ze(0|(t|=0),0|(e|=0),52),S(),s&=15,a=0|ze(0|t,0|e,45),S(),o=!(0|s),0|G(127&a)){if(o)return 0|(a=1);o=1}else{if(o)return 0|(a=0);o=0|r[i>>2]||0|r[n+8>>2]?1:1&!!(0|r[n+12>>2])}for(n=1;1&n?ut(i):lt(i),a=0|ze(0|t,0|e,3*(15-n|0)|0),S(),ct(i,7&a),n>>>0<s>>>0;)n=n+1|0;return 0|o}function Xt(t,e,n){n|=0;var i,o,s=0,a=0,A=0,u=0,l=0,c=0;if(o=L,L=L+16|0,i=o,c=0|ze(0|(t|=0),0|(e|=0),45),S(),(c&=127)>>>0>121)return r[n>>2]=0,r[n+4>>2]=0,r[n+8>>2]=0,r[n+12>>2]=0,L=o,0|(c=5);t:do{if(0|G(c)&&(A=0|ze(0|t,0|e,52),S(),0|(A&=15))){s=1;e:for(;;){switch(l=0|ze(0|t,0|e,3*(15-s|0)|0),S(),7&l){case 5:break e;case 0:break;default:s=e;break t}if(!(s>>>0<A>>>0)){s=e;break t}s=s+1|0}for(a=1,s=e;u=0|Ve(7,0,0|(e=3*(15-a|0)|0)),l=s&~S(),s=0|ze(0|t,0|s,0|e),S(),t=t&~u|(s=0|Ve(0|dt(7&s),0,0|e)),s=l|S(),a>>>0<A>>>0;)a=a+1|0}else s=e}while(0);if(l=7696+(28*c|0)|0,r[n>>2]=r[l>>2],r[n+4>>2]=r[l+4>>2],r[n+8>>2]=r[l+8>>2],r[n+12>>2]=r[l+12>>2],!(0|Ht(t,s,n)))return L=o,0|(c=0);if(u=n+4|0,r[i>>2]=r[u>>2],r[i+4>>2]=r[u+4>>2],r[i+8>>2]=r[u+8>>2],A=0|ze(0|t,0|s,52),S(),l=15&A,1&A?(lt(u),A=l+1|0):A=l,0|G(c)){t:do{if(l)for(e=1;;){if(a=0|ze(0|t,0|s,3*(15-e|0)|0),S(),0|(a&=7)){s=a;break t}if(!(e>>>0<l>>>0)){s=0;break}e=e+1|0}else s=0}while(0);s=4==(0|s)&1}else s=0;if(0|Rt(n,A,s,0)){if(0|G(c))do{}while(0|Rt(n,A,0,0));(0|A)!=(0|l)&&At(u)}else(0|A)!=(0|l)&&(r[u>>2]=r[i>>2],r[u+4>>2]=r[i+4>>2],r[u+8>>2]=r[i+8>>2]);return L=o,0|(c=0)}function Yt(t,e,n){n|=0;var i,r,o=0;return r=L,L=L+16|0,0|(o=0|Xt(t|=0,e|=0,i=r))?(L=r,0|o):(o=0|ze(0|t,0|e,52),S(),Ct(i,15&o,n),L=r,0|(o=0))}function qt(t,e,n){n|=0;var i,r=0,o=0,s=0;if(i=L,L=L+16|0,0|(r=0|Xt(t|=0,e|=0,s=i)))return L=i,0|(s=r);r=0|ze(0|t,0|e,45),S(),r=!(0|G(127&r)),o=0|ze(0|t,0|e,52),S(),o&=15;t:do{if(!r){if(0|o)for(r=1;;){if(!(!((0|Ve(7,0,3*(15-r|0)|0))&t)&!(S()&e)))break t;if(!(r>>>0<o>>>0))break;r=r+1|0}return Tt(s,o,0,5,n),L=i,0|0}}while(0);return Mt(s,o,0,6,n),L=i,0|0}function Qt(t,e){e|=0;var n=0,i=0,o=0,s=0,a=0,A=0,u=0;if((t|=0)>>>0>15)return 0|(A=4);if(Ve(0|t,0,52),A=134225919|S(),!t){n=0,i=0;do{0|G(i)&&(Ve(0|i,0,45),a=A|S(),r[(t=e+(n<<3)|0)>>2]=-1,r[t+4>>2]=a,n=n+1|0),i=i+1|0}while(122!=(0|i));return 0|(n=0)}n=0,a=0;do{if(0|G(a)){for(Ve(0|a,0,45),i=1,o=-1,s=A|S();o&=~(u=0|Ve(7,0,3*(15-i|0)|0)),s&=~S(),(0|i)!=(0|t);)i=i+1|0;r[(u=e+(n<<3)|0)>>2]=o,r[u+4>>2]=s,n=n+1|0}a=a+1|0}while(122!=(0|a));return 0|(n=0)}function $t(t,e,n,i){t|=0,i|=0;var o=0,s=0;o=0|ze(0|(e|=0),0|(n|=0),52),S(),!(0|e)&!(0|n)|(0|i)>15|(0|(o&=15))>(0|i)?(i=-1,o=-1,e=0,n=0):(s=0|function(t,e,n,i){return t|=0,e|=0,(0|(i|=0))<(0|(n|=0))?(i=t,x(0|(n=e)),0|i):(n=0|Ve(-1,-1,3+(3*(i-n|0)|0)|0),i=0|Ve(0|~n,0|~S(),3*(15-i|0)|0),n=~S()&e,i=~i&t,x(0|n),0|i)}(e,n,o+1|0,i),n=-15728641&S(),e=0|Ve(0|i,0,52),i=(s=!(0|kt(e|=s,n|=S())))?-1:i),r[(s=t)>>2]=e,r[s+4>>2]=n,r[t+8>>2]=o,r[t+12>>2]=i}function Kt(t){var e,n=0,i=0,o=0,s=0,a=0,A=0,u=0,l=0;if(!(!(0|(n=0|r[(i=t|=0)>>2]))&!(0|(i=0|r[i+4>>2]))||(o=0|ze(0|n,0|i,52),S(),n=0|Le(0|(u=0|Ve(1,0,3*(15^(o&=15))|0)),0|S(),0|n,0|i),i=0|S(),r[(u=t)>>2]=n,r[u+4>>2]=i,(0|o)<(0|(A=0|r[(u=t+8|0)>>2]))))){for(e=t+12|0,a=o;;){if((0|a)==(0|A)){o=5;break}if(l=(0|a)==(0|r[e>>2]),o=0|ze(0|n,0|i,0|(s=3*(15-a|0)|0)),S(),l&1==(0|(o&=7))&!0){o=7;break}if(!(7==(0|o)&!0)){o=10;break}if(n=0|Le(0|n,0|i,0|(l=0|Ve(1,0,0|s)),0|S()),i=0|S(),r[(l=t)>>2]=n,r[l+4>>2]=i,!((0|a)>(0|A))){o=10;break}a=a+-1|0}if(5==(0|o))return r[(l=t)>>2]=0,r[l+4>>2]=0,r[u>>2]=-1,void(r[e>>2]=-1);if(7==(0|o))return A=0|Le(0|n,0|i,0|(A=0|Ve(1,0,0|s)),0|S()),u=0|S(),r[(l=t)>>2]=A,r[l+4>>2]=u,void(r[e>>2]=a+-1)}}function Zt(t){var e;return e=(t=+t)<0?t+6.283185307179586:t,+(t>=6.283185307179586?e+-6.283185307179586:e)}function Jt(t,e){return e|=0,+u(+(+o[(t|=0)>>3]-+o[e>>3]))<17453292519943298e-27?0|(e=+u(+(+o[t+8>>3]-+o[e+8>>3]))<17453292519943298e-27):0|(e=0)}function te(t,e){t|=0;var n,i,r,s=0;return i=+o[(e|=0)>>3],n=+o[t>>3],s=(r=+f(.5*(i-n)))*r+(s=+f(.5*(+o[e+8>>3]-+o[t+8>>3])))*(+h(+i)*+h(+n)*s),2*+m(+ +l(+s),+ +l(+(1-s)))*6371.007180918475}function ee(t,e){e|=0;var n=0;return(t|=0)>>>0>15?0|(e=4):(n=0|ke(0|(n=0|ce(7,0,t,((0|t)<0)<<31>>31)),0|S(),120,0),t=0|S(),r[e>>2]=2|n,r[e+4>>2]=t,0|(e=0))}function ne(t,e,n){t|=0,n|=0;var i,r,s,a,A=0,u=0,c=0,d=0,g=0,y=0;return y=+o[(e|=0)>>3],s=+o[t>>3],g=+f(.5*(y-s)),c=+o[e+8>>3],r=+o[t+8>>3],d=+f(.5*(c-r)),i=+h(+s),a=+h(+y),d=2*+m(+ +l(+(d=g*g+d*(a*i*d))),+ +l(+(1-d))),g=+o[n>>3],y=+f(.5*(g-y)),A=+o[n+8>>3],c=+f(.5*(A-c)),u=+h(+g),c=2*+m(+ +l(+(c=y*y+c*(a*u*c))),+ +l(+(1-c))),g=+f(.5*(s-g)),A=+f(.5*(r-A)),A=2*+m(+ +l(+(A=g*g+A*(i*u*A))),+ +l(+(1-A))),4*+_(+ +l(+ +p(.5*(u=.5*(d+c+A)))*+p(.5*(u-d))*+p(.5*(u-c))*+p(.5*(u-A))))}function ie(t,e,n){n|=0;var i,s,a,A=0,u=0;if(a=L,L=L+192|0,s=a,0|(u=0|Yt(t|=0,e|=0,i=a+168|0)))return L=a,0|(n=u);if(0|qt(t,e,s)&&C(23313,22742,386,22751),(0|(e=0|r[s>>2]))>0){if(A=+ne(s+8|0,s+8+((1!=(0|e)&1)<<4)|0,i)+0,1!=(0|e)){t=1;do{A+=+ne(s+8+((u=t)<<4)|0,s+8+((0|(t=t+1|0))%(0|e)<<4)|0,i)}while((0|t)<(0|e))}}else A=0;return o[n>>3]=A,L=a,0|(n=0)}function re(t){t|=0;var e,n,i=0;return(e=0|Me(1,12))||C(22832,22787,49,22845),0|(i=0|r[(n=t+4|0)>>2])?(r[(i=i+8|0)>>2]=e,r[n>>2]=e,0|e):(0|r[t>>2]&&C(22862,22787,61,22885),r[(i=t)>>2]=e,r[n>>2]=e,0|e)}function oe(t,e){t|=0,e|=0;var n,i;return(i=0|Re(24))||C(22899,22787,78,22913),r[i>>2]=r[e>>2],r[i+4>>2]=r[e+4>>2],r[i+8>>2]=r[e+8>>2],r[i+12>>2]=r[e+12>>2],r[i+16>>2]=0,0|(n=0|r[(e=t+4|0)>>2])?(r[n+16>>2]=i,r[e>>2]=i,0|i):(0|r[t>>2]&&C(22928,22787,82,22913),r[t>>2]=i,r[e>>2]=i,0|i)}function se(t){var e=0,n=0,i=0,o=0;if(t|=0)for(i=1;;){if(0|(e=0|r[t>>2]))do{if(0|(n=0|r[e>>2]))do{o=n,n=0|r[n+16>>2],Pe(o)}while(0|n);o=e,e=0|r[e+8>>2],Pe(o)}while(0|e);if(e=t,t=0|r[t+8>>2],i||Pe(e),!t)break;i=0}}function ae(t){var e,n,i=0,s=0,a=0,A=0,l=0,c=0,h=0,f=0,p=0,d=0,g=0,_=0,m=0,y=0,v=0,E=0,b=0,w=0,x=0,S=0,T=0,I=0,R=0,P=0,M=0,L=0,N=0,O=0,D=0,F=0;if(0|r[(A=(t|=0)+8|0)>>2])return 0|(F=1);if(!(a=0|r[t>>2]))return 0|(F=0);i=a,s=0;do{s=s+1|0,i=0|r[i+8>>2]}while(0|i);if(s>>>0<2)return 0|(F=0);(n=0|Re(s<<2))||C(22948,22787,317,22967),(e=0|Re(s<<5))||C(22989,22787,321,22967),r[t>>2]=0,r[(I=t+4|0)>>2]=0,r[A>>2]=0,s=0,O=0,T=0,g=0;t:for(;;){if(d=0|r[a>>2]){l=0,c=d;do{if(f=+o[c+8>>3],i=c,c=0|r[c+16>>2],h=+o[(A=(p=!(0|c))?d:c)+8>>3],+u(+(f-h))>3.141592653589793){F=14;break}l+=(h-f)*(+o[i>>3]+ +o[A>>3])}while(!p);if(14==(0|F)){F=0,l=0,i=d;do{S=+o[i+8>>3],L=0|r[(N=i+16|0)>>2],x=+o[(L=0|L?L:d)+8>>3],l+=(+o[i>>3]+ +o[L>>3])*((x<0?x+6.283185307179586:x)-(S<0?S+6.283185307179586:S)),i=0|r[(0|i?N:a)>>2]}while(0|i)}l>0?(r[n+(O<<2)>>2]=a,O=O+1|0,A=T,i=g):F=19}else F=19;if(19==(0|F)){F=0;do{if(!s){if(g){A=I,c=g+8|0,i=a,s=t;break}if(0|r[t>>2]){F=27;break t}A=I,c=t,i=a,s=t;break}if(0|r[(i=s+8|0)>>2]){F=21;break t}if(!(s=0|Me(1,12))){F=23;break t}r[i>>2]=s,A=s+4|0,c=s,i=g}while(0);if(r[c>>2]=a,r[A>>2]=a,c=e+(T<<5)|0,p=0|r[a>>2]){for(o[(d=e+(T<<5)+8|0)>>3]=17976931348623157e292,o[(g=e+(T<<5)+24|0)>>3]=17976931348623157e292,o[c>>3]=-17976931348623157e292,o[(_=e+(T<<5)+16|0)>>3]=-17976931348623157e292,b=17976931348623157e292,w=-17976931348623157e292,A=0,m=p,f=17976931348623157e292,v=17976931348623157e292,E=-17976931348623157e292,h=-17976931348623157e292;l=+o[m>>3],S=+o[m+8>>3],m=0|r[m+16>>2],x=+o[((y=!(0|m))?p:m)+8>>3],l<f&&(o[d>>3]=l,f=l),S<v&&(o[g>>3]=S,v=S),l>E?o[c>>3]=l:l=E,S>h&&(o[_>>3]=S,h=S),b=S>0&S<b?S:b,w=S<0&S>w?S:w,A|=+u(+(S-x))>3.141592653589793,!y;)E=l;A&&(o[_>>3]=w,o[g>>3]=b)}else r[c>>2]=0,r[c+4>>2]=0,r[c+8>>2]=0,r[c+12>>2]=0,r[c+16>>2]=0,r[c+20>>2]=0,r[c+24>>2]=0,r[c+28>>2]=0;A=T+1|0}if(a=0|r[(N=a+8|0)>>2],r[N>>2]=0,!a){F=45;break}T=A,g=i}if(21==(0|F))C(22765,22787,35,22799);else if(23==(0|F))C(22819,22787,37,22799);else if(27==(0|F))C(22862,22787,61,22885);else if(45==(0|F)){t:do{if((0|O)>0){for(N=!(0|A),M=A<<2,L=!(0|t),P=0,i=0;;){if(R=0|r[n+(P<<2)>>2],N)F=73;else{if(!(T=0|Re(M))){F=50;break}if(!(I=0|Re(M))){F=52;break}e:do{if(L)s=0;else{for(A=0,s=0,c=t;a=e+(A<<5)|0,0|Ae(0|r[c>>2],a,0|r[R>>2])?(r[T+(s<<2)>>2]=c,r[I+(s<<2)>>2]=a,y=s+1|0):y=s,c=0|r[c+8>>2];)A=A+1|0,s=y;if((0|y)>0)if(a=0|r[T>>2],1==(0|y))s=a;else for(_=0,m=-1,s=a,g=a;;){for(p=0|r[g>>2],a=0,c=0;d=(0|(A=0|r[r[T+(c<<2)>>2]>>2]))==(0|p)?a:a+(1&Ae(A,0|r[I+(c<<2)>>2],0|r[p>>2]))|0,(0|(c=c+1|0))!=(0|y);)a=d;if(s=(A=(0|d)>(0|m))?g:s,(0|(a=_+1|0))==(0|y))break e;_=a,m=A?d:m,g=0|r[T+(a<<2)>>2]}else s=0}}while(0);if(Pe(T),Pe(I),s){if(a=0|r[(A=s+4|0)>>2])s=a+8|0;else if(0|r[s>>2]){F=70;break}r[s>>2]=R,r[A>>2]=R}else F=73}if(73==(0|F)){if(F=0,0|(i=0|r[R>>2]))do{I=i,i=0|r[i+16>>2],Pe(I)}while(0|i);Pe(R),i=1}if((0|(P=P+1|0))>=(0|O)){D=i;break t}}50==(0|F)?C(23004,22787,249,23023):52==(0|F)?C(23042,22787,252,23023):70==(0|F)&&C(22862,22787,61,22885)}else D=0}while(0);return Pe(n),Pe(e),0|(F=D)}return 0}function Ae(t,e,n){t|=0;var i=0,s=0,a=0,A=0,u=0,l=0,c=0,h=0;if(!(0|q(e|=0,n|=0)))return 0|(t=0);if(e=0|Y(e),i=+o[n>>3],s=e&(s=+o[n+8>>3])<0?s+6.283185307179586:s,!(t=0|r[t>>2]))return 0|(t=0);if(e){e=0,c=s,n=t;t:for(;;){for(;A=+o[n>>3],s=+o[n+8>>3],h=0|r[(n=n+16|0)>>2],a=+o[(h=0|h?h:t)>>3],u=+o[h+8>>3],A>a?(l=A,A=u):(l=a,a=A,A=s,s=u),(i=i==a|i==l?i+2220446049250313e-31:i)<a|i>l;)if(!(n=0|r[n>>2])){n=22;break t}if(((l=(u=A<0?A+6.283185307179586:A)+(i-a)/(l-a)*((A=s<0?s+6.283185307179586:s)-u))<0?l+6.283185307179586:l)>(c=u==c|A==c?c+-2220446049250313e-31:c)&&(e^=1),!(n=0|r[n>>2])){n=22;break}}if(22==(0|n))return 0|e}else{e=0,c=s,n=t;t:for(;;){for(;A=+o[n>>3],s=+o[n+8>>3],h=0|r[(n=n+16|0)>>2],a=+o[(h=0|h?h:t)>>3],u=+o[h+8>>3],A>a?(l=A,A=u):(l=a,a=A,A=s,s=u),(i=i==a|i==l?i+2220446049250313e-31:i)<a|i>l;)if(!(n=0|r[n>>2])){n=22;break t}if(A+(i-a)/(l-a)*(s-A)>(c=A==c|s==c?c+-2220446049250313e-31:c)&&(e^=1),!(n=0|r[n>>2])){n=22;break}}if(22==(0|n))return 0|e}return 0}function ue(t,e,n,o,s){n|=0,o|=0,s|=0;var a,A,u,l,c=0,h=0,f=0,p=0,d=0,g=0,_=0,m=0,y=0,v=0;if(l=L,L=L+32|0,v=l+16|0,u=l,c=0|ze(0|(t|=0),0|(e|=0),52),S(),c&=15,_=0|ze(0|n,0|o,52),S(),(0|c)!=(15&_))return L=l,0|(v=12);if(d=0|ze(0|t,0|e,45),S(),d&=127,g=0|ze(0|n,0|o,45),S(),d>>>0>121|(g&=127)>>>0>121)return L=l,0|(v=5);if(_=(0|d)!=(0|g)){if(7==(0|(f=0|X(d,g))))return L=l,0|(v=1);7==(0|(p=0|X(g,d)))?C(23066,23090,161,23100):(m=f,h=p)}else m=0,h=0;a=0|G(d),A=0|G(g),r[v>>2]=0,r[v+4>>2]=0,r[v+8>>2]=0,r[v+12>>2]=0;do{if(m){if(f=(0|(g=0|r[4272+(28*d|0)+(m<<2)>>2]))>0,A)if(f){d=0,p=n,f=o;do{p=0|zt(p,f),f=0|S(),1==(0|(h=0|dt(h)))&&(h=0|dt(1)),d=d+1|0}while((0|d)!=(0|g));g=h,d=p,p=f}else g=h,d=n,p=o;else if(f){d=0,p=n,f=o;do{p=0|Vt(p,f),f=0|S(),h=0|dt(h),d=d+1|0}while((0|d)!=(0|g));g=h,d=p,p=f}else g=h,d=n,p=o;if(Ht(d,p,v),_||C(23115,23090,191,23100),(f=!!(0|a))&(h=!!(0|A))&&C(23142,23090,192,23100),f){if(7==(0|(h=0|Bt(t,e)))){c=5;break}if(0|i[21872+(7*h|0)+m|0]){c=1;break}d=p=0|r[21040+(28*h|0)+(m<<2)>>2]}else if(h){if(7==(0|(h=0|Bt(d,p)))){c=5;break}if(0|i[21872+(7*h|0)+g|0]){c=1;break}d=0,p=0|r[21040+(28*g|0)+(h<<2)>>2]}else d=0,p=0;if((d|p)<0)c=5;else{if((0|p)>0){f=v+4|0,h=0;do{ft(f),h=h+1|0}while((0|h)!=(0|p))}if(r[u>>2]=0,r[u+4>>2]=0,r[u+8>>2]=0,ct(u,m),0|c)for(;0|jt(c)?ut(u):lt(u),(0|c)>1;)c=c+-1|0;if((0|d)>0){c=0;do{ft(u),c=c+1|0}while((0|c)!=(0|d))}et(y=v+4|0,u,y),J(y),y=51}}else if(Ht(n,o,v),!!(0|a)&!!(0|A))if((0|g)!=(0|d)&&C(23173,23090,261,23100),7==(0|(h=0|Bt(t,e)))|7==(0|(c=0|Bt(n,o))))c=5;else if(0|i[21872+(7*h|0)+c|0])c=1;else if((0|(h=0|r[21040+(28*h|0)+(c<<2)>>2]))>0){f=v+4|0,c=0;do{ft(f),c=c+1|0}while((0|c)!=(0|h));y=51}else y=51;else y=51}while(0);return 51==(0|y)&&(c=v+4|0,r[s>>2]=r[c>>2],r[s+4>>2]=r[c+4>>2],r[s+8>>2]=r[c+8>>2],c=0),L=l,0|(v=c)}function le(t,e,n,i){n|=0,i|=0;var o,s,a,A=0,u=0,l=0,c=0,h=0,f=0,p=0,d=0,g=0,_=0,m=0,y=0,v=0;if(a=L,L=L+48|0,o=a+36|0,l=a+24|0,c=a+12|0,h=a,A=0|ze(0|(t|=0),0|(e|=0),52),S(),A&=15,p=0|ze(0|t,0|e,45),S(),(p&=127)>>>0>121)return L=a,0|(i=5);if(s=0|G(p),Ve(0|A,0,52),_=134225919|S(),r[(u=i)>>2]=-1,r[u+4>>2]=_,!A)return 7==(0|(A=0|rt(n)))||127==(0|(A=0|H(p,A)))?(L=a,0|(_=1)):(d=0|Ve(0|A,0,45),g=0|S(),g=-1040385&r[(p=i)+4>>2]|g,r[(_=i)>>2]=r[p>>2]|d,r[_+4>>2]=g,L=a,0|(_=0));for(r[o>>2]=r[n>>2],r[o+4>>2]=r[n+4>>2],r[o+8>>2]=r[n+8>>2],n=A;;){if(u=n,n=n+-1|0,r[l>>2]=r[o>>2],r[l+4>>2]=r[o+4>>2],r[l+8>>2]=r[o+8>>2],0|jt(u)){if(0|(A=0|ot(o))){n=13;break}r[c>>2]=r[o>>2],r[c+4>>2]=r[o+4>>2],r[c+8>>2]=r[o+8>>2],ut(c)}else{if(0|(A=0|st(o))){n=13;break}r[c>>2]=r[o>>2],r[c+4>>2]=r[o+4>>2],r[c+8>>2]=r[o+8>>2],lt(c)}if(nt(l,c,h),J(h),y=0|r[(A=i)>>2],A=0|r[A+4>>2],m=0|Ve(7,0,0|(v=3*(15-u|0)|0)),A&=~S(),v=0|Ve(0|rt(h),0,0|v),A=S()|A,r[(_=i)>>2]=v|y&~m,r[_+4>>2]=A,(0|u)<=1){n=14;break}}t:do{if(13!=(0|n)&&14==(0|n))if((0|r[o>>2])<=1&&(0|r[o+4>>2])<=1&&(0|r[o+8>>2])<=1){h=127==(0|(A=0|H(p,n=0|rt(o))))?0:0|G(A);e:do{if(n){if(s){if(7==(0|(A=0|Bt(t,e)))){A=5;break t}if((0|(u=0|r[21248+(28*A|0)+(n<<2)>>2]))>0){A=n,n=0;do{A=0|pt(A),n=n+1|0}while((0|n)!=(0|u))}else A=n;if(1==(0|A)){A=9;break t}127==(0|(n=0|H(p,A)))&&C(23200,23090,411,23230),0|G(n)?C(23245,23090,412,23230):(g=n,d=u,f=A)}else g=A,d=0,f=n;if((0|(c=0|r[4272+(28*p|0)+(f<<2)>>2]))<=-1&&C(23276,23090,419,23230),!h){if((0|d)<0){A=5;break t}if(0|d){A=0,n=0|r[(u=i)>>2],u=0|r[u+4>>2];do{n=0|Gt(n,u),u=0|S(),r[(v=i)>>2]=n,r[v+4>>2]=u,A=A+1|0}while((0|A)<(0|d))}if((0|c)<=0){A=g,n=58;break}for(A=0,n=0|r[(u=i)>>2],u=0|r[u+4>>2];;)if(n=0|Gt(n,u),u=0|S(),r[(v=i)>>2]=n,r[v+4>>2]=u,(0|(A=A+1|0))==(0|c)){A=g,n=58;break e}}if(7==(0|(l=0|X(g,p)))&&C(23066,23090,428,23230),n=0|r[(A=i)>>2],A=0|r[A+4>>2],(0|c)>0){u=0;do{n=0|Gt(n,A),A=0|S(),r[(v=i)>>2]=n,r[v+4>>2]=A,u=u+1|0}while((0|u)!=(0|c))}if(7==(0|(A=0|Bt(n,A)))&&C(23313,23090,440,23230),n=0|z(g),(0|(n=0|r[(n?21664:21456)+(28*l|0)+(A<<2)>>2]))<0&&C(23313,23090,454,23230),n){A=0,u=0|r[(l=i)>>2],l=0|r[l+4>>2];do{u=0|Ut(u,l),l=0|S(),r[(v=i)>>2]=u,r[v+4>>2]=l,A=A+1|0}while((0|A)<(0|n));A=g,n=58}else A=g,n=58}else if(!!(0|s)&!!(0|h)){if(7==(0|(n=0|Bt(t,e)))|7==(0|(u=0|Bt(0|r[(u=i)>>2],0|r[u+4>>2])))){A=5;break t}if((0|(u=0|r[21248+(28*n|0)+(u<<2)>>2]))<0){A=5;break t}if(u){n=0,l=0|r[(c=i)>>2],c=0|r[c+4>>2];do{l=0|Gt(l,c),c=0|S(),r[(v=i)>>2]=l,r[v+4>>2]=c,n=n+1|0}while((0|n)<(0|u));n=58}else n=59}else n=58}while(0);if(58==(0|n)&&h&&(n=59),59==(0|n)&&1==(0|Bt(0|r[(v=i)>>2],0|r[v+4>>2]))){A=9;break}m=0|r[(v=i)>>2],v=-1040385&r[v+4>>2],y=0|Ve(0|A,0,45),v|=S(),r[(A=i)>>2]=m|y,r[A+4>>2]=v,A=0}else A=1}while(0);return L=a,0|(v=A)}function ce(t,e,n,i){t|=0,e|=0;var r=0,o=0,s=0;if(!(0|(n|=0))&!(0|(i|=0)))return o=1,x(0|(r=0)),0|o;o=t,r=e,t=1,e=0;do{t=0|ke(0|((s=!0&!(1&n))?1:o),0|(s?0:r),0|t,0|e),e=0|S(),n=0|Ge(0|n,0|i,1),i=0|S(),o=0|ke(0|o,0|r,0|o,0|r),r=0|S()}while(!(!(0|n)&!(0|i)));return x(0|e),0|t}function he(t,e,n){t|=0;var i,s=0,a=0,A=0,u=0,l=0,c=0,h=0,f=0,p=0;if(!(0|q(e|=0,n|=0)))return 0|(p=0);if(e=0|Y(e),s=+o[n>>3],a=e&(a=+o[n+8>>3])<0?a+6.283185307179586:a,(0|(p=0|r[t>>2]))<=0)return 0|(p=0);if(i=0|r[t+4>>2],e){e=0,f=a,n=-1,t=0;t:for(;;){for(h=t;u=+o[i+(h<<4)>>3],a=+o[i+(h<<4)+8>>3],A=+o[i+((t=(n+2|0)%(0|p)|0)<<4)>>3],l=+o[i+(t<<4)+8>>3],u>A?(c=u,u=l):(c=A,A=u,u=a,a=l),(s=s==A|s==c?s+2220446049250313e-31:s)<A|s>c;){if((0|(n=h+1|0))>=(0|p)){n=22;break t}t=h,h=n,n=t}if(((c=(l=u<0?u+6.283185307179586:u)+(s-A)/(c-A)*((u=a<0?a+6.283185307179586:a)-l))<0?c+6.283185307179586:c)>(f=l==f|u==f?f+-2220446049250313e-31:f)&&(e^=1),(0|(t=h+1|0))>=(0|p)){n=22;break}n=h}if(22==(0|n))return 0|e}else{e=0,f=a,n=-1,t=0;t:for(;;){for(h=t;u=+o[i+(h<<4)>>3],a=+o[i+(h<<4)+8>>3],A=+o[i+((t=(n+2|0)%(0|p)|0)<<4)>>3],l=+o[i+(t<<4)+8>>3],u>A?(c=u,u=l):(c=A,A=u,u=a,a=l),(s=s==A|s==c?s+2220446049250313e-31:s)<A|s>c;){if((0|(n=h+1|0))>=(0|p)){n=22;break t}t=h,h=n,n=t}if(u+(s-A)/(c-A)*(a-u)>(f=u==f|a==f?f+-2220446049250313e-31:f)&&(e^=1),(0|(t=h+1|0))>=(0|p)){n=22;break}n=h}if(22==(0|n))return 0|e}return 0}function fe(t,e){e|=0;var n,i,s,a,A,l=0,c=0,h=0,f=0,p=0,d=0,g=0,_=0,m=0,y=0,v=0,E=0;if(!(i=0|r[(t|=0)>>2]))return r[e>>2]=0,r[e+4>>2]=0,r[e+8>>2]=0,r[e+12>>2]=0,r[e+16>>2]=0,r[e+20>>2]=0,r[e+24>>2]=0,void(r[e+28>>2]=0);if(o[(s=e+8|0)>>3]=17976931348623157e292,o[(a=e+24|0)>>3]=17976931348623157e292,o[e>>3]=-17976931348623157e292,o[(A=e+16|0)>>3]=-17976931348623157e292,!((0|i)<=0)){for(n=0|r[t+4>>2],_=17976931348623157e292,m=-17976931348623157e292,y=0,t=-1,f=17976931348623157e292,p=17976931348623157e292,g=-17976931348623157e292,c=-17976931348623157e292,v=0;l=+o[n+(v<<4)>>3],d=+o[n+(v<<4)+8>>3],h=+o[n+(((0|(t=t+2|0))==(0|i)?0:t)<<4)+8>>3],l<f&&(o[s>>3]=l,f=l),d<p&&(o[a>>3]=d,p=d),l>g?o[e>>3]=l:l=g,d>c&&(o[A>>3]=d,c=d),_=d>0&d<_?d:_,m=d<0&d>m?d:m,y|=+u(+(d-h))>3.141592653589793,(0|(t=v+1|0))!=(0|i);)E=v,g=l,v=t,t=E;y&&(o[A>>3]=m,o[a>>3]=_)}}function pe(t,e){e|=0;var n,i=0,s=0,a=0,A=0,l=0,c=0,h=0,f=0,p=0,d=0,g=0,_=0,m=0,y=0,v=0,E=0,b=0,w=0,x=0,S=0,C=0;if(m=0|r[(t|=0)>>2]){if(o[(y=e+8|0)>>3]=17976931348623157e292,o[(v=e+24|0)>>3]=17976931348623157e292,o[e>>3]=-17976931348623157e292,o[(E=e+16|0)>>3]=-17976931348623157e292,(0|m)>0){for(a=0|r[t+4>>2],g=17976931348623157e292,_=-17976931348623157e292,s=0,i=-1,h=17976931348623157e292,f=17976931348623157e292,d=-17976931348623157e292,l=-17976931348623157e292,b=0;A=+o[a+(b<<4)>>3],p=+o[a+(b<<4)+8>>3],c=+o[a+(((0|(S=i+2|0))==(0|m)?0:S)<<4)+8>>3],A<h&&(o[y>>3]=A,h=A),p<f&&(o[v>>3]=p,f=p),A>d?o[e>>3]=A:A=d,p>l&&(o[E>>3]=p,l=p),g=p>0&p<g?p:g,_=p<0&p>_?p:_,s|=+u(+(p-c))>3.141592653589793,(0|(i=b+1|0))!=(0|m);)S=b,d=A,b=i,i=S;s&&(o[E>>3]=_,o[v>>3]=g)}}else r[e>>2]=0,r[e+4>>2]=0,r[e+8>>2]=0,r[e+12>>2]=0,r[e+16>>2]=0,r[e+20>>2]=0,r[e+24>>2]=0,r[e+28>>2]=0;if(!((0|(i=0|r[(S=t+8|0)>>2]))<=0)){n=t+12|0,x=0;do{if(a=0|r[n>>2],s=x,v=e+((x=x+1|0)<<5)|0,E=0|r[a+(s<<3)>>2]){if(o[(b=e+(x<<5)+8|0)>>3]=17976931348623157e292,o[(t=e+(x<<5)+24|0)>>3]=17976931348623157e292,o[v>>3]=-17976931348623157e292,o[(w=e+(x<<5)+16|0)>>3]=-17976931348623157e292,(0|E)>0){for(m=0|r[a+(s<<3)+4>>2],g=17976931348623157e292,_=-17976931348623157e292,a=0,s=-1,y=0,h=17976931348623157e292,f=17976931348623157e292,p=-17976931348623157e292,l=-17976931348623157e292;A=+o[m+(y<<4)>>3],d=+o[m+(y<<4)+8>>3],c=+o[m+(((0|(s=s+2|0))==(0|E)?0:s)<<4)+8>>3],A<h&&(o[b>>3]=A,h=A),d<f&&(o[t>>3]=d,f=d),A>p?o[v>>3]=A:A=p,d>l&&(o[w>>3]=d,l=d),g=d>0&d<g?d:g,_=d<0&d>_?d:_,a|=+u(+(d-c))>3.141592653589793,(0|(s=y+1|0))!=(0|E);)C=y,y=s,p=A,s=C;a&&(o[w>>3]=_,o[t>>3]=g)}}else r[v>>2]=0,r[v+4>>2]=0,r[v+8>>2]=0,r[v+12>>2]=0,r[v+16>>2]=0,r[v+20>>2]=0,r[v+24>>2]=0,r[v+28>>2]=0,i=0|r[S>>2]}while((0|x)<(0|i))}}function de(t,e,n){var i=0,o=0,s=0;if(!(0|he(t|=0,e|=0,n|=0)))return 0|(o=0);if((0|r[(o=t+8|0)>>2])<=0)return 0|(o=1);for(i=t+12|0,t=0;;){if(s=t,t=t+1|0,0|he((0|r[i>>2])+(s<<3)|0,e+(t<<5)|0,n)){t=0,i=6;break}if((0|t)>=(0|r[o>>2])){t=1,i=6;break}}return 6==(0|i)?0|t:0}function ge(t,e,n,i,r){e|=0,n|=0,i|=0,r|=0;var s,a,A,u,l,c,h,f=0;u=+o[(t|=0)>>3],A=+o[e>>3]-u,a=+o[t+8>>3],s=+o[e+8>>3]-a,c=+o[n>>3],f=((f=+o[i>>3]-c)*(a-(h=+o[n+8>>3]))-(u-c)*(l=+o[i+8>>3]-h))/(A*l-s*f),o[r>>3]=u+A*f,o[r+8>>3]=a+s*f}function _e(t,e){return e|=0,+u(+(+o[(t|=0)>>3]-+o[e>>3]))<1.1920928955078125e-7?0|(e=+u(+(+o[t+8>>3]-+o[e+8>>3]))<1.1920928955078125e-7):0|(e=0)}function me(t,e){e|=0;var n,i,r;return+((r=+o[(t|=0)>>3]-+o[e>>3])*r+(i=+o[t+8>>3]-+o[e+8>>3])*i+(n=+o[t+16>>3]-+o[e+16>>3])*n)}function ye(t,e,n){n|=0;var i,o,s,a,A=0,u=0,l=0;if(a=L,L=L+32|0,l=a,0|(A=0|Xt(t|=0,e|=0,o=a+16|0)))return L=a,0|(n=A);i=0|Nt(t,e),s=0|Bt(t,e),function(t,e){t=7696+(28*(t|=0)|0)|0,r[(e|=0)>>2]=r[t>>2],r[e+4>>2]=r[t+4>>2],r[e+8>>2]=r[t+8>>2],r[e+12>>2]=r[t+12>>2]}(i,l),A=0|function(t,e){t|=0;var n=0,i=0;if((e|=0)>>>0>20)return-1;do{if((0|r[11120+(216*e|0)>>2])!=(0|t))if((0|r[11120+(216*e|0)+8>>2])!=(0|t))if((0|r[11120+(216*e|0)+16>>2])!=(0|t))if((0|r[11120+(216*e|0)+24>>2])!=(0|t))if((0|r[11120+(216*e|0)+32>>2])!=(0|t))if((0|r[11120+(216*e|0)+40>>2])!=(0|t))if((0|r[11120+(216*e|0)+48>>2])!=(0|t))if((0|r[11120+(216*e|0)+56>>2])!=(0|t))if((0|r[11120+(216*e|0)+64>>2])!=(0|t))if((0|r[11120+(216*e|0)+72>>2])!=(0|t))if((0|r[11120+(216*e|0)+80>>2])!=(0|t))if((0|r[11120+(216*e|0)+88>>2])!=(0|t))if((0|r[11120+(216*e|0)+96>>2])!=(0|t))if((0|r[11120+(216*e|0)+104>>2])!=(0|t))if((0|r[11120+(216*e|0)+112>>2])!=(0|t))if((0|r[11120+(216*e|0)+120>>2])!=(0|t))if((0|r[11120+(216*e|0)+128>>2])!=(0|t)){if((0|r[11120+(216*e|0)+136>>2])!=(0|t)){if((0|r[11120+(216*e|0)+144>>2])==(0|t)){t=0,n=2,i=0;break}if((0|r[11120+(216*e|0)+152>>2])==(0|t)){t=0,n=2,i=1;break}if((0|r[11120+(216*e|0)+160>>2])==(0|t)){t=0,n=2,i=2;break}if((0|r[11120+(216*e|0)+168>>2])==(0|t)){t=1,n=2,i=0;break}if((0|r[11120+(216*e|0)+176>>2])==(0|t)){t=1,n=2,i=1;break}if((0|r[11120+(216*e|0)+184>>2])==(0|t)){t=1,n=2,i=2;break}if((0|r[11120+(216*e|0)+192>>2])==(0|t)){t=2,n=2,i=0;break}if((0|r[11120+(216*e|0)+200>>2])==(0|t)){t=2,n=2,i=1;break}if((0|r[11120+(216*e|0)+208>>2])==(0|t)){t=2,n=2,i=2;break}return-1}t=2,n=1,i=2}else t=2,n=1,i=1;else t=2,n=1,i=0;else t=1,n=1,i=2;else t=1,n=1,i=1;else t=1,n=1,i=0;else t=0,n=1,i=2;else t=0,n=1,i=1;else t=0,n=1,i=0;else t=2,n=0,i=2;else t=2,n=0,i=1;else t=2,n=0,i=0;else t=1,n=0,i=2;else t=1,n=0,i=1;else t=1,n=0,i=0;else t=0,n=0,i=2;else t=0,n=0,i=1;else t=0,n=0,i=0}while(0);return 0|r[11120+(216*e|0)+(72*n|0)+(24*t|0)+(i<<3)+4>>2]}(i,0|r[o>>2]);t:do{if(0|G(i)){switch(0|i){case 4:t=0;break;case 14:t=1;break;case 24:t=2;break;case 38:t=3;break;case 49:t=4;break;case 58:t=5;break;case 63:t=6;break;case 72:t=7;break;case 83:t=8;break;case 97:t=9;break;case 107:t=10;break;case 117:t=11;break;default:A=1;break t}if(u=0|r[22e3+(24*t|0)+8>>2],e=0|r[22e3+(24*t|0)+16>>2],(0|(t=0|r[o>>2]))!=(0|r[l>>2])&&(l=0|z(i))|(0|(t=0|r[o>>2]))==(0|e)&&(A=(A+1|0)%6|0),3==(0|s)&(0|t)==(0|e)){A=(A+5|0)%6|0,u=22;break}5==(0|s)&(0|t)==(0|u)?(A=(A+1|0)%6|0,u=22):u=22}else u=22}while(0);return 22==(0|u)&&(r[n>>2]=A,A=0),L=a,0|(n=A)}function ve(t,e,n,i){n|=0,i|=0;var o,s,a,A,u,l=0,c=0,h=0,f=0,p=0,d=0,g=0,_=0,m=0,y=0,v=0;if(u=L,L=L+32|0,v=u+24|0,A=u+20|0,a=u+8|0,s=u+16|0,o=u,p=(p=!(0|kt(t|=0,e|=0)))?6:5,g=0|ze(0|t,0|e,52),S(),p>>>0<=n>>>0)return L=u,0|(i=2);!(_=!(0|(g&=15)))&&!((m=0|Ve(7,0,3*(15^g)|0))&t)&!(S()&e)?l=n:c=4;t:do{if(4==(0|c)){if((0|((l=!!(0|kt(t,e)))?4:5))<(0|n))return L=u,0|(i=1);if(0|ye(t,e,v))return L=u,0|(i=1);if(c=(0|r[v>>2])+n|0,7==(0|(m=0|r[(l=l?22288+((0|c)%5<<2)|0:22320+((0|c)%6<<2)|0)>>2])))return L=u,0|(i=1);r[A>>2]=0,l=0|k(t,e,m,A,a);do{if(!l){if(d=0|r[(f=a)>>2],c=(h=(f=0|r[f+4>>2])>>>0<e>>>0|(0|f)==(0|e)&d>>>0<t>>>0)?d:t,h=h?f:e,!_&&!(d&(_=0|Ve(7,0,3*(15^g)|0)))&!(f&S()))l=n;else{if(f=(n+-1+p|0)%(0|p)|0,l=0|kt(t,e),(0|f)<0&&C(23313,23315,245,23324),(0|((p=!!(0|l))?4:5))<(0|f)&&C(23313,23315,245,23324),0|ye(t,e,v)&&C(23313,23315,245,23324),l=(0|r[v>>2])+f|0,7==(0|(f=0|r[(l=p?22288+((0|l)%5<<2)|0:22320+((0|l)%6<<2)|0)>>2]))&&C(23313,23315,245,23324),r[s>>2]=0,0|(l=0|k(t,e,f,s,o)))break;p=0|r[(d=o)>>2],d=0|r[d+4>>2];do{if(d>>>0<h>>>0|(0|d)==(0|h)&p>>>0<c>>>0){if(c=0|kt(p,d)?0|B(p,d,t,e):0|r[22384+(((0|r[s>>2])+(0|r[22352+(f<<2)>>2])|0)%6<<2)>>2],l=0|kt(p,d),(c+-1|0)>>>0>5){l=-1,c=p,h=d;break}if(1==(0|c)&(l=!!(0|l))){l=-1,c=p,h=d;break}do{if(!(0|ye(p,d,v))){if(l){l=(5+(0|r[21936+(c<<2)>>2])-(0|r[v>>2])|0)%5|0;break}l=(6+(0|r[21968+(c<<2)>>2])-(0|r[v>>2])|0)%6|0;break}l=-1}while(0);c=p,h=d}else l=n}while(0);d=0|r[(f=a)>>2],f=0|r[f+4>>2]}if((0|c)==(0|d)&(0|h)==(0|f)){if(t=(p=!!(0|kt(d,f)))?0|B(d,f,t,e):0|r[22384+(((0|r[A>>2])+(0|r[22352+(m<<2)>>2])|0)%6<<2)>>2],l=0|kt(d,f),(t+-1|0)>>>0<=5&&!(1==(0|t)&(y=!!(0|l))))do{if(!(0|ye(d,f,v))){if(y){l=(5+(0|r[21936+(t<<2)>>2])-(0|r[v>>2])|0)%5|0;break}l=(6+(0|r[21968+(t<<2)>>2])-(0|r[v>>2])|0)%6|0;break}l=-1}while(0);else l=-1;l=6==(0|(l=l+1|0))|p&5==(0|l)?0:l}e=h,t=c;break t}}while(0);return L=u,0|(i=l)}}while(0);return y=0|Ve(0|l,0,56),v=S()|-2130706433&e|536870912,r[i>>2]=y|t,r[i+4>>2]=v,L=u,0|(i=0)}function Ee(t,e,n){t|=0,n|=0;var i=0;(0|(e|=0))>0?(i=0|Me(e,4),r[t>>2]=i,i||C(23337,23360,40,23374)):r[t>>2]=0,r[t+4>>2]=e,r[t+8>>2]=0,r[t+12>>2]=n}function be(t){var e,n,i,s=0,a=0,A=0,l=0;e=(t|=0)+4|0,n=t+12|0,i=t+8|0;t:for(;;){for(a=0|r[e>>2],s=0;;){if((0|s)>=(0|a))break t;if(A=0|r[t>>2],l=0|r[A+(s<<2)>>2])break;s=s+1|0}s=A+(~~(+u(+ +c(10,+ +(15-(0|r[n>>2])|0))*(+o[l>>3]+ +o[l+8>>3]))%+(0|a))>>>0<<2)|0,a=0|r[s>>2];e:do{if(0|a){if(A=l+32|0,(0|a)==(0|l))r[s>>2]=r[A>>2];else{if(!(s=0|r[(a=a+32|0)>>2]))break;for(;(0|s)!=(0|l);)if(!(s=0|r[(a=s+32|0)>>2]))break e;r[a>>2]=r[A>>2]}Pe(l),r[i>>2]=(0|r[i>>2])-1}}while(0)}Pe(0|r[t>>2])}function we(t){var e,n=0,i=0;for(e=0|r[(t|=0)+4>>2],i=0;;){if((0|i)>=(0|e)){n=0,i=4;break}if(n=0|r[(0|r[t>>2])+(i<<2)>>2]){i=4;break}i=i+1|0}return 4==(0|i)?0|n:0}function xe(t,e){e|=0;var n=0,i=0,s=0,a=0;if(n=~~(+u(+ +c(10,+ +(15-(0|r[(t|=0)+12>>2])|0))*(+o[e>>3]+ +o[e+8>>3]))%+(0|r[t+4>>2]))>>>0,n=(0|r[t>>2])+(n<<2)|0,!(i=0|r[n>>2]))return 0|(a=1);a=e+32|0;do{if((0|i)!=(0|e)){if(!(n=0|r[i+32>>2]))return 0|(a=1);for(s=n;;){if((0|s)==(0|e)){s=8;break}if(!(n=0|r[s+32>>2])){n=1,s=10;break}i=s,s=n}if(8==(0|s)){r[i+32>>2]=r[a>>2];break}if(10==(0|s))return 0|n}else r[n>>2]=r[a>>2]}while(0);return Pe(e),r[(a=t+8|0)>>2]=(0|r[a>>2])-1,0|(a=0)}function Se(t,e,n){t|=0,e|=0,n|=0;var i,s=0,a=0,A=0;(i=0|Re(40))||C(23390,23360,98,23403),r[i>>2]=r[e>>2],r[i+4>>2]=r[e+4>>2],r[i+8>>2]=r[e+8>>2],r[i+12>>2]=r[e+12>>2],r[(a=i+16|0)>>2]=r[n>>2],r[a+4>>2]=r[n+4>>2],r[a+8>>2]=r[n+8>>2],r[a+12>>2]=r[n+12>>2],r[i+32>>2]=0,a=~~(+u(+ +c(10,+ +(15-(0|r[t+12>>2])|0))*(+o[e>>3]+ +o[e+8>>3]))%+(0|r[t+4>>2]))>>>0,a=(0|r[t>>2])+(a<<2)|0,s=0|r[a>>2];do{if(s){for(;!(0|Jt(s,e)&&0|Jt(s+16|0,n));)if(a=0|r[s+32>>2],!(0|r[(s=0|a?a:s)+32>>2])){A=10;break}if(10==(0|A)){r[s+32>>2]=i;break}return Pe(i),0|(A=s)}r[a>>2]=i}while(0);return r[(A=t+8|0)>>2]=1+(0|r[A>>2]),0|(A=i)}function Ce(t,e,n){e|=0,n|=0;var i=0,s=0;if(s=~~(+u(+ +c(10,+ +(15-(0|r[(t|=0)+12>>2])|0))*(+o[e>>3]+ +o[e+8>>3]))%+(0|r[t+4>>2]))>>>0,!(s=0|r[(0|r[t>>2])+(s<<2)>>2]))return 0|(n=0);if(!n){for(t=s;;){if(0|Jt(t,e)){i=10;break}if(!(t=0|r[t+32>>2])){t=0,i=10;break}}if(10==(0|i))return 0|t}for(t=s;;){if(0|Jt(t,e)&&0|Jt(t+16|0,n)){i=10;break}if(!(t=0|r[t+32>>2])){t=0,i=10;break}}return 10==(0|i)?0|t:0}function Te(t,e){e|=0;var n=0;if(n=~~(+u(+ +c(10,+ +(15-(0|r[(t|=0)+12>>2])|0))*(+o[e>>3]+ +o[e+8>>3]))%+(0|r[t+4>>2]))>>>0,!(t=0|r[(0|r[t>>2])+(n<<2)>>2]))return 0|(n=0);for(;;){if(0|Jt(t,e)){e=5;break}if(!(t=0|r[t+32>>2])){t=0,e=5;break}}return 5==(0|e)?0|t:0}function Ie(t){return 0|+function(t){return+ +qe(+(t=+t))}(t=+t)}function Re(t){t|=0;var e,n=0,i=0,o=0,s=0,a=0,A=0,u=0,l=0,c=0,h=0,f=0,p=0,d=0,g=0,_=0,m=0,y=0,v=0,E=0,b=0;e=L,L=L+16|0,p=e;do{if(t>>>0<245){if(t=(c=t>>>0<11?16:t+11&-8)>>>3,3&(i=(f=0|r[5857])>>>t))return o=0|r[(i=(t=23468+((n=(1&i^1)+t|0)<<1<<2)|0)+8|0)>>2],(0|(a=0|r[(s=o+8|0)>>2]))==(0|t)?r[5857]=f&~(1<<n):(r[a+12>>2]=t,r[i>>2]=a),b=n<<3,r[o+4>>2]=3|b,r[(b=o+b+4|0)>>2]=1|r[b>>2],L=e,0|(b=s);if(c>>>0>(h=0|r[5859])>>>0){if(0|i)return n=((n=i<<t&((n=2<<t)|0-n))&0-n)-1|0,a=0|r[(t=(n=23468+((o=((i=(n>>>=u=n>>>12&16)>>>5&8)|u|(a=(n>>>=i)>>>2&4)|(t=(n>>>=a)>>>1&2)|(o=(n>>>=t)>>>1&1))+(n>>>o)|0)<<1<<2)|0)+8|0)>>2],(0|(i=0|r[(u=a+8|0)>>2]))==(0|n)?(t=f&~(1<<o),r[5857]=t):(r[i+12>>2]=n,r[t>>2]=i,t=f),A=(b=o<<3)-c|0,r[a+4>>2]=3|c,r[(s=a+c|0)+4>>2]=1|A,r[a+b>>2]=A,0|h&&(o=0|r[5862],i=23468+((n=h>>>3)<<1<<2)|0,t&(n=1<<n)?n=0|r[(t=i+8|0)>>2]:(r[5857]=t|n,n=i,t=i+8|0),r[t>>2]=o,r[n+12>>2]=o,r[o+8>>2]=n,r[o+12>>2]=i),r[5859]=A,r[5862]=s,L=e,0|(b=u);if(a=0|r[5858]){for(i=(a&0-a)-1|0,i=l=0|r[23732+(((o=(i>>>=s=i>>>12&16)>>>5&8)|s|(A=(i>>>=o)>>>2&4)|(u=(i>>>=A)>>>1&2)|(l=(i>>>=u)>>>1&1))+(i>>>l)<<2)>>2],u=l,l=(-8&r[l+4>>2])-c|0;(t=0|r[i+16>>2])||(t=0|r[i+20>>2]);)i=t,u=(s=(A=(-8&r[t+4>>2])-c|0)>>>0<l>>>0)?t:u,l=s?A:l;if((A=u+c|0)>>>0>u>>>0){s=0|r[u+24>>2],n=0|r[u+12>>2];do{if((0|n)==(0|u)){if(!(n=0|r[(t=u+20|0)>>2])&&!(n=0|r[(t=u+16|0)>>2])){i=0;break}for(;;)if(i=0|r[(o=n+20|0)>>2])n=i,t=o;else{if(!(i=0|r[(o=n+16|0)>>2]))break;n=i,t=o}r[t>>2]=0,i=n}else i=0|r[u+8>>2],r[i+12>>2]=n,r[n+8>>2]=i,i=n}while(0);do{if(0|s){if(n=0|r[u+28>>2],(0|u)==(0|r[(t=23732+(n<<2)|0)>>2])){if(r[t>>2]=i,!i){r[5858]=a&~(1<<n);break}}else if(r[((0|r[(b=s+16|0)>>2])==(0|u)?b:s+20)>>2]=i,!i)break;r[i+24>>2]=s,0|(n=0|r[u+16>>2])&&(r[i+16>>2]=n,r[n+24>>2]=i),0|(n=0|r[u+20>>2])&&(r[i+20>>2]=n,r[n+24>>2]=i)}}while(0);return l>>>0<16?(b=l+c|0,r[u+4>>2]=3|b,r[(b=u+b+4|0)>>2]=1|r[b>>2]):(r[u+4>>2]=3|c,r[A+4>>2]=1|l,r[A+l>>2]=l,0|h&&(o=0|r[5862],i=23468+((n=h>>>3)<<1<<2)|0,(n=1<<n)&f?n=0|r[(t=i+8|0)>>2]:(r[5857]=n|f,n=i,t=i+8|0),r[t>>2]=o,r[n+12>>2]=o,r[o+8>>2]=n,r[o+12>>2]=i),r[5859]=l,r[5862]=A),L=e,0|(b=u+8|0)}f=c}else f=c}else f=c}else if(t>>>0<=4294967231)if(c=-8&(t=t+11|0),o=0|r[5858]){s=0-c|0,l=(t>>>=8)?c>>>0>16777215?31:c>>>((l=14-((u=((_=t<<(f=(t+1048320|0)>>>16&8))+520192|0)>>>16&4)|f|(l=((_<<=u)+245760|0)>>>16&2))+(_<<l>>>15)|0)+7|0)&1|l<<1:0,i=0|r[23732+(l<<2)>>2];t:do{if(i)for(t=0,u=c<<(31==(0|l)?0:25-(l>>>1)),a=0;;){if((A=(-8&r[i+4>>2])-c|0)>>>0<s>>>0){if(!A){t=i,s=0,_=65;break t}t=i,s=A}if(a=!(0|(_=0|r[i+20>>2]))|(0|_)==(0|(i=0|r[i+16+(u>>>31<<2)>>2]))?a:_,!i){i=a,_=61;break}u<<=1}else i=0,t=0,_=61}while(0);if(61==(0|_)){if(!(0|i)&!(0|t)){if(!(t=((t=2<<l)|0-t)&o)){f=c;break}f=(t&0-t)-1|0,t=0,i=0|r[23732+(((a=(f>>>=A=f>>>12&16)>>>5&8)|A|(u=(f>>>=a)>>>2&4)|(l=(f>>>=u)>>>1&2)|(i=(f>>>=l)>>>1&1))+(f>>>i)<<2)>>2]}i?_=65:(u=t,A=s)}if(65==(0|_))for(a=i;;){if(s=(i=(f=(-8&r[a+4>>2])-c|0)>>>0<s>>>0)?f:s,t=i?a:t,(i=0|r[a+16>>2])||(i=0|r[a+20>>2]),!i){u=t,A=s;break}a=i}if(0|u&&A>>>0<((0|r[5859])-c|0)>>>0&&(h=u+c|0)>>>0>u>>>0){a=0|r[u+24>>2],n=0|r[u+12>>2];do{if((0|n)==(0|u)){if(!(n=0|r[(t=u+20|0)>>2])&&!(n=0|r[(t=u+16|0)>>2])){n=0;break}for(;;)if(i=0|r[(s=n+20|0)>>2])n=i,t=s;else{if(!(i=0|r[(s=n+16|0)>>2]))break;n=i,t=s}r[t>>2]=0}else b=0|r[u+8>>2],r[b+12>>2]=n,r[n+8>>2]=b}while(0);do{if(a){if(t=0|r[u+28>>2],(0|u)==(0|r[(i=23732+(t<<2)|0)>>2])){if(r[i>>2]=n,!n){o&=~(1<<t),r[5858]=o;break}}else if(r[((0|r[(b=a+16|0)>>2])==(0|u)?b:a+20)>>2]=n,!n)break;r[n+24>>2]=a,0|(t=0|r[u+16>>2])&&(r[n+16>>2]=t,r[t+24>>2]=n),(t=0|r[u+20>>2])&&(r[n+20>>2]=t,r[t+24>>2]=n)}}while(0);t:do{if(A>>>0<16)b=A+c|0,r[u+4>>2]=3|b,r[(b=u+b+4|0)>>2]=1|r[b>>2];else{if(r[u+4>>2]=3|c,r[h+4>>2]=1|A,r[h+A>>2]=A,n=A>>>3,A>>>0<256){i=23468+(n<<1<<2)|0,(t=0|r[5857])&(n=1<<n)?n=0|r[(t=i+8|0)>>2]:(r[5857]=t|n,n=i,t=i+8|0),r[t>>2]=h,r[n+12>>2]=h,r[h+8>>2]=n,r[h+12>>2]=i;break}if(n=23732+((i=(n=A>>>8)?A>>>0>16777215?31:A>>>((i=14-((v=((b=n<<(E=(n+1048320|0)>>>16&8))+520192|0)>>>16&4)|E|(i=((b<<=v)+245760|0)>>>16&2))+(b<<i>>>15)|0)+7|0)&1|i<<1:0)<<2)|0,r[h+28>>2]=i,r[(t=h+16|0)+4>>2]=0,r[t>>2]=0,!(o&(t=1<<i))){r[5858]=o|t,r[n>>2]=h,r[h+24>>2]=n,r[h+12>>2]=h,r[h+8>>2]=h;break}n=0|r[n>>2];e:do{if((-8&r[n+4>>2])!=(0|A)){for(o=A<<(31==(0|i)?0:25-(i>>>1));t=0|r[(i=n+16+(o>>>31<<2)|0)>>2];){if((-8&r[t+4>>2])==(0|A)){n=t;break e}o<<=1,n=t}r[i>>2]=h,r[h+24>>2]=n,r[h+12>>2]=h,r[h+8>>2]=h;break t}}while(0);b=0|r[(E=n+8|0)>>2],r[b+12>>2]=h,r[E>>2]=h,r[h+8>>2]=b,r[h+12>>2]=n,r[h+24>>2]=0}}while(0);return L=e,0|(b=u+8|0)}f=c}else f=c;else f=-1}while(0);if((i=0|r[5859])>>>0>=f>>>0)return n=i-f|0,t=0|r[5862],n>>>0>15?(b=t+f|0,r[5862]=b,r[5859]=n,r[b+4>>2]=1|n,r[t+i>>2]=n,r[t+4>>2]=3|f):(r[5859]=0,r[5862]=0,r[t+4>>2]=3|i,r[(b=t+i+4|0)>>2]=1|r[b>>2]),L=e,0|(b=t+8|0);if((A=0|r[5860])>>>0>f>>>0)return v=A-f|0,r[5860]=v,E=(b=0|r[5863])+f|0,r[5863]=E,r[E+4>>2]=1|v,r[b+4>>2]=3|f,L=e,0|(b=b+8|0);if(0|r[5975]?t=0|r[5977]:(r[5977]=4096,r[5976]=4096,r[5978]=-1,r[5979]=-1,r[5980]=0,r[5968]=0,r[5975]=-16&p^1431655768,t=4096),u=f+48|0,(c=(a=t+(l=f+47|0)|0)&(s=0-t|0))>>>0<=f>>>0)return L=e,0|(b=0);if(0|(t=0|r[5967])&&(p=(h=0|r[5965])+c|0)>>>0<=h>>>0|p>>>0>t>>>0)return L=e,0|(b=0);t:do{if(4&r[5968])n=0,_=143;else{i=0|r[5863];e:do{if(i){for(o=23876;!((p=0|r[o>>2])>>>0<=i>>>0&&(p+(0|r[o+4>>2])|0)>>>0>i>>>0);){if(!(t=0|r[o+8>>2])){_=128;break e}o=t}if((n=a-A&s)>>>0<2147483647)if((0|(t=0|Qe(0|n)))==((0|r[o>>2])+(0|r[o+4>>2])|0)){if(-1!=(0|t)){A=n,a=t,_=145;break t}}else o=t,_=136;else n=0}else _=128}while(0);do{if(128==(0|_))if(-1!=(0|(i=0|Qe(0)))&&(n=i,g=(n=((g=(d=0|r[5976])+-1|0)&n?(g+n&0-d)-n|0:0)+c|0)+(d=0|r[5965])|0,n>>>0>f>>>0&n>>>0<2147483647)){if(0|(p=0|r[5967])&&g>>>0<=d>>>0|g>>>0>p>>>0){n=0;break}if((0|(t=0|Qe(0|n)))==(0|i)){A=n,a=i,_=145;break t}o=t,_=136}else n=0}while(0);do{if(136==(0|_)){if(i=0-n|0,!(u>>>0>n>>>0&n>>>0<2147483647&-1!=(0|o))){if(-1==(0|o)){n=0;break}A=n,a=o,_=145;break t}if((t=l-n+(t=0|r[5977])&0-t)>>>0>=2147483647){A=n,a=o,_=145;break t}if(-1==(0|Qe(0|t))){Qe(0|i),n=0;break}A=t+n|0,a=o,_=145;break t}}while(0);r[5968]=4|r[5968],_=143}}while(0);if(143==(0|_)&&c>>>0<2147483647&&!(-1==(0|(v=0|Qe(0|c)))|1^(y=(m=(g=0|Qe(0))-v|0)>>>0>(f+40|0)>>>0)|v>>>0<g>>>0&-1!=(0|v)&-1!=(0|g)^1)&&(A=y?m:n,a=v,_=145),145==(0|_)){n=(0|r[5965])+A|0,r[5965]=n,n>>>0>(0|r[5966])>>>0&&(r[5966]=n),l=0|r[5863];t:do{if(l){for(n=23876;;){if((0|a)==((t=0|r[n>>2])+(i=0|r[n+4>>2])|0)){_=154;break}if(!(o=0|r[n+8>>2]))break;n=o}if(!(154!=(0|_)||(E=n+4|0,8&r[n+12>>2]))&&a>>>0>l>>>0&t>>>0<=l>>>0){r[E>>2]=i+A,E=l+(v=7&(v=l+8|0)?0-v&7:0)|0,v=(b=(0|r[5860])+A|0)-v|0,r[5863]=E,r[5860]=v,r[E+4>>2]=1|v,r[l+b+4>>2]=40,r[5864]=r[5979];break}for(a>>>0<(0|r[5861])>>>0&&(r[5861]=a),i=a+A|0,n=23876;;){if((0|r[n>>2])==(0|i)){_=162;break}if(!(t=0|r[n+8>>2]))break;n=t}if(162==(0|_)&&!(8&r[n+12>>2])){r[n>>2]=a,r[(h=n+4|0)>>2]=(0|r[h>>2])+A,c=(h=a+(7&(h=a+8|0)?0-h&7:0)|0)+f|0,u=(n=i+(7&(n=i+8|0)?0-n&7:0)|0)-h-f|0,r[h+4>>2]=3|f;e:do{if((0|l)==(0|n))b=(0|r[5860])+u|0,r[5860]=b,r[5863]=c,r[c+4>>2]=1|b;else{if((0|r[5862])==(0|n)){b=(0|r[5859])+u|0,r[5859]=b,r[5862]=c,r[c+4>>2]=1|b,r[c+b>>2]=b;break}if(1==(3&(t=0|r[n+4>>2]))){A=-8&t,o=t>>>3;n:do{if(t>>>0<256){if(t=0|r[n+8>>2],(0|(i=0|r[n+12>>2]))==(0|t)){r[5857]=r[5857]&~(1<<o);break}r[t+12>>2]=i,r[i+8>>2]=t;break}a=0|r[n+24>>2],t=0|r[n+12>>2];do{if((0|t)==(0|n)){if(t=0|r[(o=(i=n+16|0)+4|0)>>2])i=o;else if(!(t=0|r[i>>2])){t=0;break}for(;;)if(o=0|r[(s=t+20|0)>>2])t=o,i=s;else{if(!(o=0|r[(s=t+16|0)>>2]))break;t=o,i=s}r[i>>2]=0}else b=0|r[n+8>>2],r[b+12>>2]=t,r[t+8>>2]=b}while(0);if(!a)break;o=23732+((i=0|r[n+28>>2])<<2)|0;do{if((0|r[o>>2])==(0|n)){if(r[o>>2]=t,0|t)break;r[5858]=r[5858]&~(1<<i);break n}if(r[((0|r[(b=a+16|0)>>2])==(0|n)?b:a+20)>>2]=t,!t)break n}while(0);if(r[t+24>>2]=a,0|(o=0|r[(i=n+16|0)>>2])&&(r[t+16>>2]=o,r[o+24>>2]=t),!(i=0|r[i+4>>2]))break;r[t+20>>2]=i,r[i+24>>2]=t}while(0);n=n+A|0,s=A+u|0}else s=u;if(r[(n=n+4|0)>>2]=-2&r[n>>2],r[c+4>>2]=1|s,r[c+s>>2]=s,n=s>>>3,s>>>0<256){i=23468+(n<<1<<2)|0,(t=0|r[5857])&(n=1<<n)?n=0|r[(t=i+8|0)>>2]:(r[5857]=t|n,n=i,t=i+8|0),r[t>>2]=c,r[n+12>>2]=c,r[c+8>>2]=n,r[c+12>>2]=i;break}n=s>>>8;do{if(n){if(s>>>0>16777215){o=31;break}o=s>>>((o=14-((v=((b=n<<(E=(n+1048320|0)>>>16&8))+520192|0)>>>16&4)|E|(o=((b<<=v)+245760|0)>>>16&2))+(b<<o>>>15)|0)+7|0)&1|o<<1}else o=0}while(0);if(n=23732+(o<<2)|0,r[c+28>>2]=o,r[(t=c+16|0)+4>>2]=0,r[t>>2]=0,!((t=0|r[5858])&(i=1<<o))){r[5858]=t|i,r[n>>2]=c,r[c+24>>2]=n,r[c+12>>2]=c,r[c+8>>2]=c;break}n=0|r[n>>2];n:do{if((-8&r[n+4>>2])!=(0|s)){for(o=s<<(31==(0|o)?0:25-(o>>>1));t=0|r[(i=n+16+(o>>>31<<2)|0)>>2];){if((-8&r[t+4>>2])==(0|s)){n=t;break n}o<<=1,n=t}r[i>>2]=c,r[c+24>>2]=n,r[c+12>>2]=c,r[c+8>>2]=c;break e}}while(0);b=0|r[(E=n+8|0)>>2],r[b+12>>2]=c,r[E>>2]=c,r[c+8>>2]=b,r[c+12>>2]=n,r[c+24>>2]=0}}while(0);return L=e,0|(b=h+8|0)}for(n=23876;!((t=0|r[n>>2])>>>0<=l>>>0&&(b=t+(0|r[n+4>>2])|0)>>>0>l>>>0);)n=0|r[n+8>>2];n=(t=(t=(s=b+-47|0)+(7&(t=s+8|0)?0-t&7:0)|0)>>>0<(s=l+16|0)>>>0?l:t)+8|0,E=a+(v=7&(v=a+8|0)?0-v&7:0)|0,v=(i=A+-40|0)-v|0,r[5863]=E,r[5860]=v,r[E+4>>2]=1|v,r[a+i+4>>2]=40,r[5864]=r[5979],r[(i=t+4|0)>>2]=27,r[n>>2]=r[5969],r[n+4>>2]=r[5970],r[n+8>>2]=r[5971],r[n+12>>2]=r[5972],r[5969]=a,r[5970]=A,r[5972]=0,r[5971]=n,n=t+24|0;do{E=n,r[(n=n+4|0)>>2]=7}while((E+8|0)>>>0<b>>>0);if((0|t)!=(0|l)){if(a=t-l|0,r[i>>2]=-2&r[i>>2],r[l+4>>2]=1|a,r[t>>2]=a,n=a>>>3,a>>>0<256){i=23468+(n<<1<<2)|0,(t=0|r[5857])&(n=1<<n)?n=0|r[(t=i+8|0)>>2]:(r[5857]=t|n,n=i,t=i+8|0),r[t>>2]=l,r[n+12>>2]=l,r[l+8>>2]=n,r[l+12>>2]=i;break}if(i=23732+((o=(n=a>>>8)?a>>>0>16777215?31:a>>>((o=14-((v=((b=n<<(E=(n+1048320|0)>>>16&8))+520192|0)>>>16&4)|E|(o=((b<<=v)+245760|0)>>>16&2))+(b<<o>>>15)|0)+7|0)&1|o<<1:0)<<2)|0,r[l+28>>2]=o,r[l+20>>2]=0,r[s>>2]=0,!((n=0|r[5858])&(t=1<<o))){r[5858]=n|t,r[i>>2]=l,r[l+24>>2]=i,r[l+12>>2]=l,r[l+8>>2]=l;break}n=0|r[i>>2];e:do{if((-8&r[n+4>>2])!=(0|a)){for(o=a<<(31==(0|o)?0:25-(o>>>1));t=0|r[(i=n+16+(o>>>31<<2)|0)>>2];){if((-8&r[t+4>>2])==(0|a)){n=t;break e}o<<=1,n=t}r[i>>2]=l,r[l+24>>2]=n,r[l+12>>2]=l,r[l+8>>2]=l;break t}}while(0);b=0|r[(E=n+8|0)>>2],r[b+12>>2]=l,r[E>>2]=l,r[l+8>>2]=b,r[l+12>>2]=n,r[l+24>>2]=0}}else!(0|(b=0|r[5861]))|a>>>0<b>>>0&&(r[5861]=a),r[5969]=a,r[5970]=A,r[5972]=0,r[5866]=r[5975],r[5865]=-1,r[5870]=23468,r[5869]=23468,r[5872]=23476,r[5871]=23476,r[5874]=23484,r[5873]=23484,r[5876]=23492,r[5875]=23492,r[5878]=23500,r[5877]=23500,r[5880]=23508,r[5879]=23508,r[5882]=23516,r[5881]=23516,r[5884]=23524,r[5883]=23524,r[5886]=23532,r[5885]=23532,r[5888]=23540,r[5887]=23540,r[5890]=23548,r[5889]=23548,r[5892]=23556,r[5891]=23556,r[5894]=23564,r[5893]=23564,r[5896]=23572,r[5895]=23572,r[5898]=23580,r[5897]=23580,r[5900]=23588,r[5899]=23588,r[5902]=23596,r[5901]=23596,r[5904]=23604,r[5903]=23604,r[5906]=23612,r[5905]=23612,r[5908]=23620,r[5907]=23620,r[5910]=23628,r[5909]=23628,r[5912]=23636,r[5911]=23636,r[5914]=23644,r[5913]=23644,r[5916]=23652,r[5915]=23652,r[5918]=23660,r[5917]=23660,r[5920]=23668,r[5919]=23668,r[5922]=23676,r[5921]=23676,r[5924]=23684,r[5923]=23684,r[5926]=23692,r[5925]=23692,r[5928]=23700,r[5927]=23700,r[5930]=23708,r[5929]=23708,r[5932]=23716,r[5931]=23716,E=a+(v=7&(v=a+8|0)?0-v&7:0)|0,v=(b=A+-40|0)-v|0,r[5863]=E,r[5860]=v,r[E+4>>2]=1|v,r[a+b+4>>2]=40,r[5864]=r[5979]}while(0);if((n=0|r[5860])>>>0>f>>>0)return v=n-f|0,r[5860]=v,E=(b=0|r[5863])+f|0,r[5863]=E,r[E+4>>2]=1|v,r[b+4>>2]=3|f,L=e,0|(b=b+8|0)}return r[(b=23424)>>2]=12,L=e,0|(b=0)}function Pe(t){var e=0,n=0,i=0,o=0,s=0,a=0,A=0,u=0;if(t|=0){n=t+-8|0,o=0|r[5861],u=n+(e=-8&(t=0|r[t+-4>>2]))|0;do{if(1&t)A=n,a=n;else{if(i=0|r[n>>2],!(3&t))return;if(s=i+e|0,(a=n+(0-i)|0)>>>0<o>>>0)return;if((0|r[5862])==(0|a)){if(3&~(e=0|r[(t=u+4|0)>>2])){A=a,e=s;break}return r[5859]=s,r[t>>2]=-2&e,r[a+4>>2]=1|s,void(r[a+s>>2]=s)}if(n=i>>>3,i>>>0<256){if(t=0|r[a+8>>2],(0|(e=0|r[a+12>>2]))==(0|t)){r[5857]=r[5857]&~(1<<n),A=a,e=s;break}r[t+12>>2]=e,r[e+8>>2]=t,A=a,e=s;break}o=0|r[a+24>>2],t=0|r[a+12>>2];do{if((0|t)==(0|a)){if(t=0|r[(n=(e=a+16|0)+4|0)>>2])e=n;else if(!(t=0|r[e>>2])){t=0;break}for(;;)if(n=0|r[(i=t+20|0)>>2])t=n,e=i;else{if(!(n=0|r[(i=t+16|0)>>2]))break;t=n,e=i}r[e>>2]=0}else A=0|r[a+8>>2],r[A+12>>2]=t,r[t+8>>2]=A}while(0);if(o){if(e=0|r[a+28>>2],(0|r[(n=23732+(e<<2)|0)>>2])==(0|a)){if(r[n>>2]=t,!t){r[5858]=r[5858]&~(1<<e),A=a,e=s;break}}else if(r[((0|r[(A=o+16|0)>>2])==(0|a)?A:o+20)>>2]=t,!t){A=a,e=s;break}r[t+24>>2]=o,0|(n=0|r[(e=a+16|0)>>2])&&(r[t+16>>2]=n,r[n+24>>2]=t),(e=0|r[e+4>>2])?(r[t+20>>2]=e,r[e+24>>2]=t,A=a,e=s):(A=a,e=s)}else A=a,e=s}}while(0);if(!(a>>>0>=u>>>0)&&1&(i=0|r[(t=u+4|0)>>2])){if(2&i)r[t>>2]=-2&i,r[A+4>>2]=1|e,r[a+e>>2]=e,o=e;else{if((0|r[5863])==(0|u)){if(u=(0|r[5860])+e|0,r[5860]=u,r[5863]=A,r[A+4>>2]=1|u,(0|A)!=(0|r[5862]))return;return r[5862]=0,void(r[5859]=0)}if((0|r[5862])==(0|u))return u=(0|r[5859])+e|0,r[5859]=u,r[5862]=a,r[A+4>>2]=1|u,void(r[a+u>>2]=u);o=(-8&i)+e|0,n=i>>>3;do{if(i>>>0<256){if(e=0|r[u+8>>2],(0|(t=0|r[u+12>>2]))==(0|e)){r[5857]=r[5857]&~(1<<n);break}r[e+12>>2]=t,r[t+8>>2]=e;break}s=0|r[u+24>>2],t=0|r[u+12>>2];do{if((0|t)==(0|u)){if(t=0|r[(n=(e=u+16|0)+4|0)>>2])e=n;else if(!(t=0|r[e>>2])){n=0;break}for(;;)if(n=0|r[(i=t+20|0)>>2])t=n,e=i;else{if(!(n=0|r[(i=t+16|0)>>2]))break;t=n,e=i}r[e>>2]=0,n=t}else n=0|r[u+8>>2],r[n+12>>2]=t,r[t+8>>2]=n,n=t}while(0);if(0|s){if(t=0|r[u+28>>2],(0|r[(e=23732+(t<<2)|0)>>2])==(0|u)){if(r[e>>2]=n,!n){r[5858]=r[5858]&~(1<<t);break}}else if(r[((0|r[(i=s+16|0)>>2])==(0|u)?i:s+20)>>2]=n,!n)break;r[n+24>>2]=s,0|(e=0|r[(t=u+16|0)>>2])&&(r[n+16>>2]=e,r[e+24>>2]=n),0|(t=0|r[t+4>>2])&&(r[n+20>>2]=t,r[t+24>>2]=n)}}while(0);if(r[A+4>>2]=1|o,r[a+o>>2]=o,(0|A)==(0|r[5862]))return void(r[5859]=o)}if(t=o>>>3,o>>>0<256)return n=23468+(t<<1<<2)|0,(e=0|r[5857])&(t=1<<t)?t=0|r[(e=n+8|0)>>2]:(r[5857]=e|t,t=n,e=n+8|0),r[e>>2]=A,r[t+12>>2]=A,r[A+8>>2]=t,void(r[A+12>>2]=n);t=23732+((i=(t=o>>>8)?o>>>0>16777215?31:o>>>((i=14-((s=((u=t<<(a=(t+1048320|0)>>>16&8))+520192|0)>>>16&4)|a|(i=((u<<=s)+245760|0)>>>16&2))+(u<<i>>>15)|0)+7|0)&1|i<<1:0)<<2)|0,r[A+28>>2]=i,r[A+20>>2]=0,r[A+16>>2]=0,e=0|r[5858],n=1<<i;t:do{if(e&n){t=0|r[t>>2];e:do{if((-8&r[t+4>>2])!=(0|o)){for(i=o<<(31==(0|i)?0:25-(i>>>1));e=0|r[(n=t+16+(i>>>31<<2)|0)>>2];){if((-8&r[e+4>>2])==(0|o)){t=e;break e}i<<=1,t=e}r[n>>2]=A,r[A+24>>2]=t,r[A+12>>2]=A,r[A+8>>2]=A;break t}}while(0);u=0|r[(a=t+8|0)>>2],r[u+12>>2]=A,r[a>>2]=A,r[A+8>>2]=u,r[A+12>>2]=t,r[A+24>>2]=0}else r[5858]=e|n,r[t>>2]=A,r[A+24>>2]=t,r[A+12>>2]=A,r[A+8>>2]=A}while(0);if(u=(0|r[5865])-1|0,r[5865]=u,!(0|u)){for(t=23884;t=0|r[t>>2];)t=t+8|0;r[5865]=-1}}}}function Me(t,e){e|=0;var n=0;return(t|=0)?(n=0|v(e,t),(e|t)>>>0>65535&&(n=((n>>>0)/(t>>>0)|0)==(0|e)?n:-1)):n=0,(t=0|Re(n))&&3&r[t+-4>>2]?(Ye(0|t,0,0|n),0|t):0|t}function Le(t,e,n,i){return 0|(x((e|=0)+(i|=0)+((n=(t|=0)+(n|=0)>>>0)>>>0<t>>>0|0)>>>0|0),n)}function Ne(t,e,n,i){return 0|(x(0|(i=(e|=0)-(i|=0)-((n|=0)>>>0>(t|=0)>>>0|0)>>>0)),t-n>>>0)}function Oe(t){return 0|((t|=0)?31-(0|w(t^t-1)):32)}function De(t,e,n,i,o){o|=0;var s=0,a=0,A=0,u=0,l=0,c=0,h=0,f=0,p=0,d=0;if(c=t|=0,a=n|=0,A=f=i|=0,!(l=u=e|=0))return s=!!(0|o),A?s?(r[o>>2]=0|t,r[o+4>>2]=0,o=0,0|(x(0|(f=0)),o)):(o=0,0|(x(0|(f=0)),o)):(s&&(r[o>>2]=(c>>>0)%(a>>>0),r[o+4>>2]=0),o=(c>>>0)/(a>>>0)>>>0,0|(x(0|(f=0)),o));s=!(0|A);do{if(a){if(!s){if((s=(0|w(0|A))-(0|w(0|l))|0)>>>0<=31){a=h=s+1|0,t=c>>>(h>>>0)&(e=s-31>>31)|l<<(A=31-s|0),e&=l>>>(h>>>0),s=0,A=c<<A;break}return o?(r[o>>2]=0|t,r[o+4>>2]=0|u,o=0,0|(x(0|(f=0)),o)):(o=0,0|(x(0|(f=0)),o))}if((s=a-1|0)&a){a=A=33+(0|w(0|a))-(0|w(0|l))|0,t=(h=32-A|0)-1>>31&l>>>((p=A-32|0)>>>0)|(l<<h|c>>>(A>>>0))&(e=p>>31),e&=l>>>(A>>>0),s=c<<(d=64-A|0)&(u=h>>31),A=(l<<d|c>>>(p>>>0))&u|c<<h&A-33>>31;break}return 0|o&&(r[o>>2]=s&c,r[o+4>>2]=0),1==(0|a)?(d=0|t,0|(x(0|(p=0|u)),d)):(p=l>>>((d=0|Oe(0|a))>>>0)|0,d=l<<32-d|c>>>(d>>>0),0|(x(0|p),d))}if(s)return 0|o&&(r[o>>2]=(l>>>0)%(a>>>0),r[o+4>>2]=0),d=(l>>>0)/(a>>>0)>>>0,0|(x(0|(p=0)),d);if(!c)return 0|o&&(r[o>>2]=0,r[o+4>>2]=(l>>>0)%(A>>>0)),d=(l>>>0)/(A>>>0)>>>0,0|(x(0|(p=0)),d);if(!((s=A-1|0)&A))return 0|o&&(r[o>>2]=0|t,r[o+4>>2]=s&l),p=0,d=l>>>((0|Oe(0|A))>>>0),0|(x(0|p),d);if((s=(0|w(0|A))-(0|w(0|l))|0)>>>0<=30){a=e=s+1|0,t=l<<(A=31-s|0)|c>>>(e>>>0),e=l>>>(e>>>0),s=0,A=c<<A;break}return o?(r[o>>2]=0|t,r[o+4>>2]=0|u,d=0,0|(x(0|(p=0)),d)):(d=0,0|(x(0|(p=0)),d))}while(0);if(a){l=0|Le(0|(h=0|n),0|(c=0|f),-1,-1),n=0|S(),u=A,A=0;do{i=u,u=s>>>31|u<<1,s=A|s<<1,Ne(0|l,0|n,0|(i=t<<1|i>>>31),0|(f=t>>>31|e<<1)),A=1&(p=(d=0|S())>>31|((0|d)<0?-1:0)<<1),t=0|Ne(0|i,0|f,p&h,(((0|d)<0?-1:0)>>31|((0|d)<0?-1:0)<<1)&c),e=0|S(),a=a-1|0}while(0|a);l=u,u=0}else l=A,u=0,A=0;return a=0,0|o&&(r[o>>2]=t,r[o+4>>2]=e),d=s<<1&-2|A,0|(x(0|(p=(0|s)>>>31|(l|a)<<1|u)),d)}function Fe(t,e,n,i){n|=0;var r,o,s,a,A;return o=(i|=0)>>31|((0|i)<0?-1:0)<<1,r=((0|i)<0?-1:0)>>31|((0|i)<0?-1:0)<<1,s=0|Ne((A=(e|=0)>>31|((0|e)<0?-1:0)<<1)^(t|=0),(a=((0|e)<0?-1:0)>>31|((0|e)<0?-1:0)<<1)^e,0|A,0|a),t=o^A,e=r^a,0|Ne(De(s,0|S(),0|Ne(o^n,r^i,0|o,0|r),0|S(),0)^t,S()^e,0|t,0|e)}function ke(t,e,n,i){e|=0,i|=0;var r,o;return n=0|function(t,e){var n,i,r,o=0;return t=((n=0|v(o=65535&(e|=0),r=65535&(t|=0)))>>>16)+(0|v(o,i=t>>>16))|0,e=0|v(o=e>>>16,r),0|(x((t>>>16)+(0|v(o,i))+(((65535&t)+e|0)>>>16)|0),t+e<<16|65535&n)}(r=t|=0,o=n|=0),t=0|S(),0|(x((0|v(e,o))+(0|v(i,r))+t|0),n)}function Be(t,e,n,i){n|=0;var o,s,a,A,u,l;return o=L,L=L+16|0,A=0|o,l=(i|=0)>>31|((0|i)<0?-1:0)<<1,u=((0|i)<0?-1:0)>>31|((0|i)<0?-1:0)<<1,De(t=0|Ne((a=(e|=0)>>31|((0|e)<0?-1:0)<<1)^(t|=0),(s=((0|e)<0?-1:0)>>31|((0|e)<0?-1:0)<<1)^e,0|a,0|s),e=0|S(),0|Ne(l^n,u^i,0|l,0|u),0|S(),A),i=0|Ne(r[A>>2]^a,r[A+4>>2]^s,0|a,0|s),n=0|S(),L=o,0|(x(0|n),i)}function Ue(t,e,n,i){var o,s;return s=L,L=L+16|0,De(t|=0,e|=0,n|=0,i|=0,o=0|s),L=s,0|(x(0|r[o+4>>2]),r[o>>2])}function Ge(t,e,n){return t|=0,e|=0,(0|(n|=0))<32?(x(e>>n),t>>>n|(e&(1<<n)-1)<<32-n):(x(0|((0|e)<0?-1:0)),e>>n-32)}function ze(t,e,n){return t|=0,e|=0,(0|(n|=0))<32?(x(e>>>n|0),t>>>n|(e&(1<<n)-1)<<32-n):(x(0),e>>>n-32|0)}function Ve(t,e,n){return t|=0,e|=0,(0|(n|=0))<32?(x(e<<n|(t&(1<<n)-1<<32-n)>>>32-n),t<<n):(x(t<<n-32),0)}function je(t,e){return e=+e,(t=+t)!=t?+e:e!=e?+t:+b(+t,+e)}function We(t,e){return e=+e,(t=+t)!=t?+e:e!=e?+t:+E(+t,+e)}function He(t){return(t=+t)>=0?+A(t+.5):+y(t-.5)}function Xe(t,e,n){t|=0,e|=0;var o,s,a=0;if((0|(n|=0))>=8192)return R(0|t,0|e,0|n),0|t;if(s=0|t,o=t+n|0,(3&t)==(3&e)){for(;3&t;){if(!n)return 0|s;i[t|0]=0|i[e|0],t=t+1|0,e=e+1|0,n=n-1|0}for(a=(n=-4&o)-64|0;(0|t)<=(0|a);)r[t>>2]=r[e>>2],r[t+4>>2]=r[e+4>>2],r[t+8>>2]=r[e+8>>2],r[t+12>>2]=r[e+12>>2],r[t+16>>2]=r[e+16>>2],r[t+20>>2]=r[e+20>>2],r[t+24>>2]=r[e+24>>2],r[t+28>>2]=r[e+28>>2],r[t+32>>2]=r[e+32>>2],r[t+36>>2]=r[e+36>>2],r[t+40>>2]=r[e+40>>2],r[t+44>>2]=r[e+44>>2],r[t+48>>2]=r[e+48>>2],r[t+52>>2]=r[e+52>>2],r[t+56>>2]=r[e+56>>2],r[t+60>>2]=r[e+60>>2],t=t+64|0,e=e+64|0;for(;(0|t)<(0|n);)r[t>>2]=r[e>>2],t=t+4|0,e=e+4|0}else for(n=o-4|0;(0|t)<(0|n);)i[t|0]=0|i[e|0],i[t+1|0]=0|i[e+1|0],i[t+2|0]=0|i[e+2|0],i[t+3|0]=0|i[e+3|0],t=t+4|0,e=e+4|0;for(;(0|t)<(0|o);)i[t|0]=0|i[e|0],t=t+1|0,e=e+1|0;return 0|s}function Ye(t,e,n){e|=0;var o,s=0,a=0,A=0;if(o=(t|=0)+(n|=0)|0,e&=255,(0|n)>=67){for(;3&t;)i[t|0]=e,t=t+1|0;for(A=e|e<<8|e<<16|e<<24,a=(s=-4&o)-64|0;(0|t)<=(0|a);)r[t>>2]=A,r[t+4>>2]=A,r[t+8>>2]=A,r[t+12>>2]=A,r[t+16>>2]=A,r[t+20>>2]=A,r[t+24>>2]=A,r[t+28>>2]=A,r[t+32>>2]=A,r[t+36>>2]=A,r[t+40>>2]=A,r[t+44>>2]=A,r[t+48>>2]=A,r[t+52>>2]=A,r[t+56>>2]=A,r[t+60>>2]=A,t=t+64|0;for(;(0|t)<(0|s);)r[t>>2]=A,t=t+4|0}for(;(0|t)<(0|o);)i[t|0]=e,t=t+1|0;return o-n|0}function qe(t){return(t=+t)>=0?+A(t+.5):+y(t-.5)}function Qe(t){t|=0;var e,n,i;return i=0|I(),(0|t)>0&(0|(e=(n=0|r[a>>2])+t|0))<(0|n)|(0|e)<0?(M(0|e),T(12),-1):(0|e)>(0|i)&&!(0|P(0|e))?(T(12),-1):(r[a>>2]=e,0|n)}return{___divdi3:Fe,___muldi3:ke,___remdi3:Be,___uremdi3:Ue,_areNeighborCells:function(t,e,n,i,o){o|=0;var s,a,A,u=0,l=0,c=0,h=0;if(A=L,L=L+64|0,a=A,s=A+56|0,!(!0&134217728==(2013265920&(e|=0))&!0&134217728==(2013265920&(i|=0))))return L=A,0|(o=5);if((0|(t|=0))==(0|(n|=0))&(0|e)==(0|i))return r[o>>2]=0,L=A,0|(o=0);if(l=0|ze(0|t,0|e,52),S(),l&=15,h=0|ze(0|n,0|i,52),S(),(0|l)!=(15&h))return L=A,0|(o=12);if(u=l+-1|0,l>>>0>1){Dt(t,e,u,a),Dt(n,i,u,s),c=0|r[(h=a)>>2],h=0|r[h+4>>2];t:do{if((0|c)==(0|r[s>>2])&&(0|h)==(0|r[s+4>>2])){u=0|ze(0|t,0|e,0|(l=3*(15^l)|0)),S(),u&=7,l=0|ze(0|n,0|i,0|l),S(),l&=7;do{if(!(0|u)|!(0|l))r[o>>2]=1,u=0;else if(7==(0|u))u=5;else{if(1==(0|u)|1==(0|l)&&0|kt(c,h)){u=5;break}if((0|r[15536+(u<<2)>>2])!=(0|l)&&(0|r[15568+(u<<2)>>2])!=(0|l))break t;r[o>>2]=1,u=0}}while(0);return L=A,0|(o=u)}}while(0)}l=(u=a)+56|0;do{r[u>>2]=0,u=u+4|0}while((0|u)<(0|l));return N(t,e,1,a),u=(0|r[(e=a)>>2])==(0|n)&&(0|r[e+4>>2])==(0|i)||(0|r[(e=a+8|0)>>2])==(0|n)&&(0|r[e+4>>2])==(0|i)||(0|r[(e=a+16|0)>>2])==(0|n)&&(0|r[e+4>>2])==(0|i)||(0|r[(e=a+24|0)>>2])==(0|n)&&(0|r[e+4>>2])==(0|i)||(0|r[(e=a+32|0)>>2])==(0|n)&&(0|r[e+4>>2])==(0|i)||(0|r[(e=a+40|0)>>2])==(0|n)&&(0|r[e+4>>2])==(0|i)?1:1&((0|r[(u=a+48|0)>>2])==(0|n)?(0|r[u+4>>2])==(0|i):0),r[o>>2]=u,L=A,0|(o=0)},_bitshift64Ashr:Ge,_bitshift64Lshr:ze,_bitshift64Shl:Ve,_calloc:Me,_cellAreaKm2:function(t,e,n){return 0|(t=0|ie(t|=0,e|=0,n|=0))||(o[n>>3]=6371.007180918475*+o[n>>3]*6371.007180918475),0|t},_cellAreaM2:function(t,e,n){return 0|(t=0|ie(t|=0,e|=0,n|=0))||(o[n>>3]=6371.007180918475*+o[n>>3]*6371.007180918475*1e3*1e3),0|t},_cellAreaRads2:ie,_cellToBoundary:qt,_cellToCenterChild:function(t,e,n,i){n|=0,i|=0;var o=0;return o=0|ze(0|(t|=0),0|(e|=0),52),S(),(0|n)<16&(0|(o&=15))<=(0|n)?((0|o)<(0|n)&&(o=0|Ve(-1,-1,3+(3*(n+-1-o|0)|0)|0),o=0|Ve(0|~o,0|~S(),3*(15-n|0)|0),e=~S()&e,t&=~o),o=0|Ve(0|n,0,52),n=-15728641&e|S(),r[i>>2]=t|o,r[i+4>>2]=n,0|(i=0)):0|(i=4)},_cellToChildPos:function(t,e,n,i){n|=0,i|=0;var o,s=0,a=0,A=0,u=0,l=0,c=0,h=0,f=0,p=0,d=0,g=0,_=0,m=0,y=0;if(o=L,L=L+16|0,m=o,y=0|ze(0|(t|=0),0|(e|=0),52),S(),y&=15,n>>>0>15)return L=o,0|(y=4);if((0|y)<(0|n))return L=o,0|(y=12);if((0|y)!=(0|n))if(a=0|Ve(0|n,0,52),a|=t,u=S()|-15728641&e,(0|y)>(0|n)){l=n;do{_=0|Ve(7,0,3*(14-l|0)|0),l=l+1|0,a|=_,u=S()|u}while((0|l)<(0|y));_=a}else _=a;else _=t,u=e;g=0|ze(0|_,0|u,45),S();t:do{if(0|G(127&g)){if(l=0|ze(0|_,0|u,52),S(),0|(l&=15))for(a=1;;){if(!(!((g=0|Ve(7,0,3*(15-a|0)|0))&_)&!(S()&u))){c=33;break t}if(!(a>>>0<l>>>0))break;a=a+1|0}if(r[(g=i)>>2]=0,r[g+4>>2]=0,(0|y)>(0|n)){for(g=-15728641&e,d=y;;){if(p=d,(d=d+-1|0)>>>0>15|(0|y)<(0|d)){c=19;break}if((0|y)!=(0|d))if(a=0|Ve(0|d,0,52),a|=t,l=S()|g,(0|y)<(0|p))f=a;else{c=d;do{f=0|Ve(7,0,3*(14-c|0)|0),c=c+1|0,a|=f,l=S()|l}while((0|c)<(0|y));f=a}else f=t,l=e;if(h=0|ze(0|f,0|l,45),S(),0|G(127&h)){h=0|ze(0|f,0|l,52),S(),h&=15;e:do{if(h)for(c=1;;){if(a=0|ze(0|f,0|l,3*(15-c|0)|0),S(),0|(a&=7))break e;if(!(c>>>0<h>>>0)){a=0;break}c=c+1|0}else a=0}while(0);a=1&!(0|a)}else a=0;if(l=0|ze(0|t,0|e,3*(15-p|0)|0),S(),7==(0|(l&=7))){s=5,c=42;break}if(1==(0|l)&(a=!!(0|a))){s=5,c=42;break}if(0|(f=l+((!!(0|l)&a)<<31>>31)|0)&&(c=0|ce(7,0,c=y-p|0,((0|c)<0)<<31>>31),h=0|S(),a?(a=0|Le(0|(a=0|ke(0|c,0|h,5,0)),0|S(),-5,-1),a=0|Le(0|(a=0|Fe(0|a,0|S(),6,0)),0|S(),1,0),l=0|S()):(a=c,l=h),p=0|Le(0|a,0|l,0|(p=0|ke(0|c,0|h,0|(p=f+-1|0),((0|p)<0)<<31>>31)),0|S()),h=0|Le(0|p,0|(f=0|S()),0|r[(h=i)>>2],0|r[h+4>>2]),f=0|S(),r[(p=i)>>2]=h,r[p+4>>2]=f),(0|d)<=(0|n)){c=37;break}}if(19==(0|c))C(23313,22674,1099,22710);else{if(37==(0|c)){s=0|r[(A=i)+4>>2],A=0|r[A>>2];break}if(42==(0|c))return L=o,0|s}}else s=0,A=0}else c=33}while(0);t:do{if(33==(0|c)){if(r[(g=i)>>2]=0,r[g+4>>2]=0,(0|y)>(0|n)){for(a=y;;){if(s=0|ze(0|t,0|e,3*(15-a|0)|0),S(),7==(0|(s&=7))){s=5;break}if(s=0|ke(0|(A=0|ce(7,0,A=y-a|0,((0|A)<0)<<31>>31)),0|S(),0|s,0),A=0|S(),A=0|Le(0|r[(g=i)>>2],0|r[g+4>>2],0|s,0|A),s=0|S(),r[(g=i)>>2]=A,r[g+4>>2]=s,(0|(a=a+-1|0))<=(0|n))break t}return L=o,0|s}s=0,A=0}}while(0);return 0|Ft(_,u,y,m)&&C(23313,22674,1063,22725),((0|s)>-1|-1==(0|s)&A>>>0>4294967295)&((0|(m=0|r[(y=m)+4>>2]))>(0|s)|((0|m)==(0|s)?(0|r[y>>2])>>>0>A>>>0:0))?(L=o,0|(y=0)):(C(23313,22674,1139,22710),0)},_cellToChildren:function(t,e,n,i){i|=0;var o,s,a=0,A=0;if(s=L,L=L+16|0,$t(o=s,t|=0,e|=0,n|=0),!(0|(t=0|r[(e=o)>>2]))&!(0|(e=0|r[e+4>>2])))return L=s,0;a=0,n=0;do{r[(A=i+(a<<3)|0)>>2]=t,r[A+4>>2]=e,a=0|Le(0|a,0|n,1,0),n=0|S(),Kt(o),t=0|r[(A=o)>>2],e=0|r[A+4>>2]}while(!(!(0|t)&!(0|e)));return L=s,0},_cellToChildrenSize:Ft,_cellToLatLng:Yt,_cellToLocalIj:function(t,e,n,i,r,o){var s,a;return t|=0,e|=0,n|=0,i|=0,o|=0,a=L,L=L+16|0,s=a,(r|=0)?t=15:(t=0|ue(t,e,n,i,s))||(yt(s,o),t=0),L=a,0|t},_cellToParent:Dt,_cellToVertex:ve,_cellToVertexes:function(t,e,n){n|=0;var i,o=0,s=0;return s=!(0|kt(t|=0,e|=0)),i=!(0|(o=0|ve(t,e,0,n))),s?i?0|(o=0|ve(t,e,1,n+8|0))||0|(o=0|ve(t,e,2,n+16|0))||0|(o=0|ve(t,e,3,n+24|0))||(o=0|ve(t,e,4,n+32|0))?0|(s=o):0|ve(t,e,5,n+40|0):0|(s=o):i?0|(o=0|ve(t,e,1,n+8|0))||0|(o=0|ve(t,e,2,n+16|0))||0|(o=0|ve(t,e,3,n+24|0))||0|(o=0|ve(t,e,4,n+32|0))?0|(s=o):(r[(s=n+40|0)>>2]=0,r[s+4>>2]=0,0|(s=0)):0|(s=o)},_cellsToDirectedEdge:function(t,e,n,i,o){return o|=0,7==(0|(n=0|B(t|=0,e|=0,n|=0,i|=0)))?0|(o=11):(i=0|Ve(0|n,0,56),e=-2130706433&e|S()|268435456,r[o>>2]=t|i,r[o+4>>2]=e,0|(o=0))},_cellsToLinkedMultiPolygon:function(t,e,n){n|=0;var i,o,s,a=0;if(s=L,L=L+32|0,i=s,t=0|function(t,e,n){t|=0,n|=0;var i,o,s=0,a=0,A=0,u=0,l=0,c=0;if(o=L,L=L+176|0,i=o,(0|(e|=0))<1)return Ee(n,0,0),L=o,0;for(l=0|ze(0|r[(l=t)>>2],0|r[l+4>>2],52),S(),Ee(n,(0|e)>6?e:6,15&l),l=0;!(0|(s=0|qt(0|r[(s=t+(l<<3)|0)>>2],0|r[s+4>>2],i)));){if((0|(s=0|r[i>>2]))>0){u=0;do{A=i+8+(u<<4)|0,(a=0|Ce(n,s=i+8+((0|(u=u+1|0))%(0|s)<<4)|0,A))?xe(n,a):Se(n,A,s),s=0|r[i>>2]}while((0|u)<(0|s))}if((0|(l=l+1|0))>=(0|e)){s=0,c=13;break}}return 13==(0|c)?(L=o,0|s):(be(n),L=o,0|(c=s))}(t|=0,e|=0,o=s+16|0),0|t)return L=s,0|(n=t);if(r[n>>2]=0,r[n+4>>2]=0,r[n+8>>2]=0,0|(t=0|we(o)))do{e=0|re(n);do{oe(e,t),a=t+16|0,r[i>>2]=r[a>>2],r[i+4>>2]=r[a+4>>2],r[i+8>>2]=r[a+8>>2],r[i+12>>2]=r[a+12>>2],xe(o,t),t=0|Te(o,i)}while(0|t);t=0|we(o)}while(0|t);return be(o),(t=0|ae(n))?(se(n),L=s,0|(a=t)):(L=s,0|(a=0))},_childPosToCell:function(t,e,n,i,o,s){t|=0,e|=0,s|=0;var a,A=0,u=0,l=0,c=0,h=0,f=0,p=0,d=0,g=0;if(a=L,L=L+16|0,A=a,(o|=0)>>>0>15)return L=a,0|(s=4);if(u=0|ze(0|(n|=0),0|(i|=0),52),S(),(0|(u&=15))>(0|o))return L=a,0|(s=12);if(0|Ft(n,i,o,A)&&C(23313,22674,1063,22725),!(((0|e)>-1|-1==(0|e)&t>>>0>4294967295)&((0|(c=0|r[(h=A)+4>>2]))>(0|e)|((0|c)==(0|e)?(0|r[h>>2])>>>0>t>>>0:0))))return L=a,0|(s=2);h=o-u|0,o=0|Ve(0|o,0,52),l=S()|-15728641&i,r[(c=s)>>2]=o|n,r[c+4>>2]=l,c=0|ze(0|n,0|i,45),S();t:do{if(0|G(127&c)){if(0|u)for(A=1;;){if(!(!((c=0|Ve(7,0,3*(15-A|0)|0))&n)&!(S()&i)))break t;if(!(A>>>0<u>>>0))break;A=A+1|0}if((0|h)<1)return L=a,0|(s=0);for(c=15^u,i=-1,l=1,A=1;;){u=0|ce(7,0,u=h-l|0,((0|u)<0)<<31>>31),n=0|S();do{if(A){if(A=0|Fe(0|(A=0|Le(0|(A=0|ke(0|u,0|n,5,0)),0|S(),-5,-1)),0|S(),6,0),(0|e)>(0|(o=0|S()))|(0|e)==(0|o)&t>>>0>A>>>0){e=0|Ne(0|(e=0|Le(0|t,0|e,-1,-1)),0|S(),0|A,0|o),A=0|S(),d=0|r[(f=s)>>2],f=0|r[f+4>>2],p=0|Ve(7,0,0|(g=3*(c+i|0)|0)),f&=~S(),g=0|Ve(0|(o=0|Le(0|(i=0|Fe(0|e,0|A,0|u,0|n)),0|(t=0|S()),2,0)),0|S(),0|g),f=S()|f,r[(o=s)>>2]=g|d&~p,r[o+4>>2]=f,t=0|Ne(0|e,0|A,0|(t=0|ke(0|i,0|t,0|u,0|n)),0|S()),A=0,e=0|S();break}p=0|r[(g=s)>>2],g=0|r[g+4>>2],d=0|Ve(7,0,3*(c+i|0)|0),g&=~S(),r[(A=s)>>2]=p&~d,r[A+4>>2]=g,A=1;break}o=0|r[(p=s)>>2],p=0|r[p+4>>2],f=0|Ve(7,0,0|(i=3*(c+i|0)|0)),p&=~S(),i=0|Ve(0|(g=0|Fe(0|t,0|e,0|u,0|n)),0|(A=0|S()),0|i),p=S()|p,r[(d=s)>>2]=i|o&~f,r[d+4>>2]=p,t=0|Ne(0|t,0|e,0|(A=0|ke(0|g,0|A,0|u,0|n)),0|S()),A=0,e=0|S()}while(0);if(!((0|h)>(0|l))){e=0;break}i=~l,l=l+1|0}return L=a,0|e}}while(0);if((0|h)<1)return L=a,0|(g=0);for(o=15^u,A=1;;){if(d=0|ce(7,0,d=h-A|0,((0|d)<0)<<31>>31),g=0|S(),n=0|r[(l=s)>>2],l=0|r[l+4>>2],i=0|Ve(7,0,0|(u=3*(o-A|0)|0)),l&=~S(),u=0|Ve(0|(f=0|Fe(0|t,0|e,0|d,0|g)),0|(p=0|S()),0|u),l=S()|l,r[(c=s)>>2]=u|n&~i,r[c+4>>2]=l,t=0|Ne(0|t,0|e,0|(g=0|ke(0|f,0|p,0|d,0|g)),0|S()),e=0|S(),(0|h)<=(0|A)){e=0;break}A=A+1|0}return L=a,0|e},_compactCells:function(t,e,n,i){e|=0;var o,s=0,a=0,A=0,u=0,l=0,c=0,h=0,f=0,p=0,d=0,g=0,_=0,m=0,y=0,v=0,E=0,b=0,w=0,x=0,T=0;if(!(0|(n|=0))&!(0|(i|=0)))return 0|(x=0);if(a=0|r[(s=t|=0)>>2],!0&!(15728640&(s=0|r[s+4>>2]))){if(!((0|i)>0|!(0|i)&n>>>0>0))return 0|(x=0);if(r[(x=e)>>2]=a,r[x+4>>2]=s,1==(0|n)&!(0|i))return 0|(x=0);s=1;do{w=0|r[(b=t+(s<<3)|0)+4>>2],r[(x=e+(s<<3)|0)>>2]=r[b>>2],r[x+4>>2]=w,s=s+1|0}while(0<(0|i)|!(0|i)&s>>>0<n>>>0);return 0|(s=0)}if(!(w=0|Re(o=n<<3)))return 0|(x=13);if(Xe(0|w,0|t,0|o),!(b=0|Me(n,8)))return Pe(w),0|(x=13);t:do{if(0|n){e:for(;;){v=0|ze(0|(y=0|r[(s=w)>>2]),0|(s=0|r[s+4>>2]),52),S(),E=(v&=15)+-1|0,m=(0|n)>0;n:do{if(!!(0|v)&m){if(d=((0|n)<0)<<31>>31,g=0|Ve(0|E,0,52),_=0|S(),E>>>0>15){if(!(!(0|y)&!(0|s))){x=17;break e}for(a=0;;){if((0|(a=a+1|0))>=(0|n))break n;if(!(!(0|(_=0|r[(i=w+(a<<3)|0)>>2]))&!(0|(i=0|r[i+4>>2])))){s=i,x=17;break e}}}for(a=0,t=y,i=s;;){if(!(!(0|t)&!(0|i))){if(!(!0&!(117440512&i))){x=22;break e}if(u=0|ze(0|t,0|i,52),S(),(0|(u&=15))<(0|E)){s=12,x=28;break e}if((0|u)!=(0|E)&&(t|=g,i=-15728641&i|_,u>>>0>=v>>>0)){A=E;do{p=0|Ve(7,0,3*(14-A|0)|0),A=A+1|0,t|=p,i=S()|i}while(A>>>0<u>>>0)}if(A=0|Ue(0|t,0|i,0|n,0|d),S(),!(0|(l=0|r[(u=c=b+(A<<3)|0)>>2]))&!(0|(u=0|r[u+4>>2])))A=c;else for(p=0;;){if((0|p)>(0|n)){x=32;break e}if((0|l)==(0|t)&(-117440513&u)==(0|i)){h=0|ze(0|l,0|u,56),S(),f=(h&=7)+1|0,T=0|ze(0|l,0|u,45),S();i:do{if(0|G(127&T)){if(l=0|ze(0|l,0|u,52),S(),!(l&=15)){u=6;break}for(u=1;;){if(!(!((T=0|Ve(7,0,3*(15-u|0)|0))&t)&!(S()&i))){u=7;break i}if(!(u>>>0<l>>>0)){u=6;break}u=u+1|0}}else u=7}while(0);if((h+2|0)>>>0>u>>>0){x=42;break e}T=0|Ve(0|f,0,56),i=S()|-117440513&i,r[(f=c)>>2]=0,r[f+4>>2]=0,t|=T}else A=(A+1|0)%(0|n)|0;if(!(0|(l=0|r[(u=c=b+(A<<3)|0)>>2]))&!(0|(u=0|r[u+4>>2]))){A=c;break}p=p+1|0}r[(T=A)>>2]=t,r[T+4>>2]=i}if((0|(a=a+1|0))>=(0|n))break n;t=0|r[(i=w+(a<<3)|0)>>2],i=0|r[i+4>>2]}}}while(0);if((n+5|0)>>>0<11){x=85;break}if(!(_=0|Me((0|n)/6|0,8))){x=49;break}n:do{if(m){p=0,f=0;do{if(!(!(0|(a=0|r[(i=u=b+(p<<3)|0)>>2]))&!(0|(i=0|r[i+4>>2])))){l=0|ze(0|a,0|i,56),S(),t=(l&=7)+1|0,c=-117440513&i,T=0|ze(0|a,0|i,45),S();i:do{if(0|G(127&T)){if(h=0|ze(0|a,0|i,52),S(),0|(h&=15))for(A=1;;){if(!(!(a&(T=0|Ve(7,0,3*(15-A|0)|0)))&!(c&S())))break i;if(!(A>>>0<h>>>0))break;A=A+1|0}a|=i=0|Ve(0|t,0,56),i=S()|c,r[(t=u)>>2]=a,r[t+4>>2]=i,t=l+2|0}}while(0);7==(0|t)&&(r[(T=_+(f<<3)|0)>>2]=a,r[T+4>>2]=-117440513&i,f=f+1|0)}p=p+1|0}while((0|p)!=(0|n));if(m){if(p=((0|n)<0)<<31>>31,d=0|Ve(0|E,0,52),g=0|S(),E>>>0>15){if(!(!(0|y)&!(0|s))){s=4,x=84;break e}for(s=0;;){if((0|(s=s+1|0))>=(0|n)){a=0,s=f;break n}if(!(!(0|r[(T=w+(s<<3)|0)>>2])&!(0|r[T+4>>2]))){s=4,x=84;break e}}}for(h=0,a=0,c=y;;){do{if(!(!(0|c)&!(0|s))){if(u=0|ze(0|c,0|s,52),S(),(0|(u&=15))<(0|E)){s=12,x=84;break e}do{if((0|u)==(0|E))i=c,u=s;else{if(i=c|d,t=-15728641&s|g,u>>>0<v>>>0){u=t;break}A=E;do{T=0|Ve(7,0,3*(14-A|0)|0),A=A+1|0,i|=T,t=S()|t}while(A>>>0<u>>>0);u=t}}while(0);for(A=0|Ue(0|i,0|u,0|n,0|p),S(),t=0;;){if((0|t)>(0|n)){x=77;break e}if((-117440513&(l=0|r[(T=b+(A<<3)|0)+4>>2]))==(0|u)&&(0|r[T>>2])==(0|i)){x=79;break}if((0|r[(T=b+((A=(A+1|0)%(0|n)|0)<<3)|0)>>2])==(0|i)&&(0|r[T+4>>2])==(0|u))break;t=t+1|0}if(79==(0|x)&&(x=0,!0&100663296==(117440512&l)))break;r[(T=e+(a<<3)|0)>>2]=c,r[T+4>>2]=s,a=a+1|0}}while(0);if((0|(s=h+1|0))>=(0|n)){s=f;break n}h=s,c=0|r[(T=w+(s<<3)|0)>>2],s=0|r[T+4>>2]}}else a=0,s=f}else a=0,s=0}while(0);if(Ye(0|b,0,0|o),Xe(0|w,0|_,s<<3),Pe(_),!s)break t;e=e+(a<<3)|0,n=s}if(17==(0|x))!0&!(117440512&s)?(s=4,x=28):x=22;else if(32==(0|x))C(23313,22674,362,22684);else{if(42==(0|x))return Pe(w),Pe(b),0|(T=10);if(49==(0|x))return Pe(w),Pe(b),0|(T=13);if(77==(0|x))C(23313,22674,462,22684);else{if(84==(0|x))return Pe(_),Pe(w),Pe(b),0|(T=s);if(85==(0|x)){Xe(0|e,0|w,n<<3);break}}}if(22==(0|x))return Pe(w),Pe(b),0|(T=5);if(28==(0|x))return Pe(w),Pe(b),0|(T=s)}}while(0);return Pe(w),Pe(b),0|(T=0)},_destroyLinkedMultiPolygon:se,_directedEdgeToBoundary:wt,_directedEdgeToCells:function(t,e,n){t|=0;var i,o,s,a=0;return i=L,L=L+16|0,a=i,!0&268435456==(2013265920&(e|=0))?(o=-2130706433&e|134217728,r[(s=n|=0)>>2]=t,r[s+4>>2]=o,r[a>>2]=0,e=0|ze(0|t,0|e,56),S(),a=0|k(t,o,7&e,a,n+8|0),L=i,0|a):(L=i,0|(a=6))},_edgeLengthKm:function(t,e,n){n|=0;var i,s=0,a=0,A=0,u=0,c=0,p=0,d=0;if(i=L,L=L+176|0,0|(t=0|wt(t|=0,e|=0,u=i)))return u=t,A=+o[n>>3],A*=6371.007180918475,o[n>>3]=A,L=i,0|u;if(o[n>>3]=0,(0|(t=0|r[u>>2]))<=1)return u=0,A=0,A*=6371.007180918475,o[n>>3]=A,L=i,0|u;e=t+-1|0,t=0,s=+o[u+8>>3],a=+o[u+16>>3],A=0;do{p=s,s=+o[u+8+((t=t+1|0)<<4)>>3],d=+f(.5*(s-p)),c=a,a=+o[u+8+(t<<4)+8>>3],c=d*d+(c=+f(.5*(a-c)))*(+h(+p)*+h(+s)*c),A+=2*+m(+ +l(+c),+ +l(+(1-c)))}while((0|t)!=(0|e));return o[n>>3]=A,u=0,d=A,d*=6371.007180918475,o[n>>3]=d,L=i,0|u},_edgeLengthM:function(t,e,n){n|=0;var i,s=0,a=0,A=0,u=0,c=0,p=0,d=0;if(i=L,L=L+176|0,0|(t=0|wt(t|=0,e|=0,u=i)))return u=t,A=+o[n>>3],A*=6371.007180918475,A*=1e3,o[n>>3]=A,L=i,0|u;if(o[n>>3]=0,(0|(t=0|r[u>>2]))<=1)return u=0,A=0,A*=6371.007180918475,A*=1e3,o[n>>3]=A,L=i,0|u;e=t+-1|0,t=0,s=+o[u+8>>3],a=+o[u+16>>3],A=0;do{p=s,s=+o[u+8+((t=t+1|0)<<4)>>3],d=+f(.5*(s-p)),c=a,a=+o[u+8+(t<<4)+8>>3],c=d*d+(c=+f(.5*(a-c)))*(+h(+p)*+h(+s)*c),A+=2*+m(+ +l(+c),+ +l(+(1-c)))}while((0|t)!=(0|e));return o[n>>3]=A,u=0,d=A,d*=6371.007180918475,d*=1e3,o[n>>3]=d,L=i,0|u},_edgeLengthRads:function(t,e,n){n|=0;var i,s=0,a=0,A=0,u=0,c=0,p=0,d=0;if(i=L,L=L+176|0,0|(t=0|wt(t|=0,e|=0,u=i)))return L=i,0|(u=t);if(o[n>>3]=0,(0|(t=0|r[u>>2]))<=1)return L=i,0|(u=0);e=t+-1|0,t=0,s=+o[u+8>>3],a=+o[u+16>>3],A=0;do{p=s,s=+o[u+8+((t=t+1|0)<<4)>>3],d=+f(.5*(s-p)),c=a,a=+o[u+8+(t<<4)+8>>3],c=d*d+(c=+f(.5*(a-c)))*(+h(+s)*+h(+p)*c),A+=2*+m(+ +l(+c),+ +l(+(1-c)))}while((0|t)<(0|e));return o[n>>3]=A,L=i,0|(u=0)},_emscripten_replace_memory:function(t){return i=new Int8Array(t),new Uint8Array(t),r=new Int32Array(t),new Float32Array(t),o=new Float64Array(t),n=t,!0},_free:Pe,_getBaseCellNumber:Nt,_getDirectedEdgeDestination:function(t,e,n){t|=0,e|=0,n|=0;var i,o,s=0;return i=L,L=L+16|0,r[(s=i)>>2]=0,!0&268435456==(2013265920&e)?(o=0|ze(0|t,0|e,56),S(),s=0|k(t,-2130706433&e|134217728,7&o,s,n),L=i,0|s):(L=i,0|(s=6))},_getDirectedEdgeOrigin:function(t,e,n){return t|=0,n|=0,!0&268435456==(2013265920&(e|=0))?(r[n>>2]=t,r[n+4>>2]=-2130706433&e|134217728,0|(n=0)):0|(n=6)},_getHexagonAreaAvgKm2:function(t,e){return e|=0,(t|=0)>>>0>15?0|(e=4):(o[e>>3]=+o[20528+(t<<3)>>3],0|(e=0))},_getHexagonAreaAvgM2:function(t,e){return e|=0,(t|=0)>>>0>15?0|(e=4):(o[e>>3]=+o[20656+(t<<3)>>3],0|(e=0))},_getHexagonEdgeLengthAvgKm:function(t,e){return e|=0,(t|=0)>>>0>15?0|(e=4):(o[e>>3]=+o[20784+(t<<3)>>3],0|(e=0))},_getHexagonEdgeLengthAvgM:function(t,e){return e|=0,(t|=0)>>>0>15?0|(e=4):(o[e>>3]=+o[20912+(t<<3)>>3],0|(e=0))},_getIcosahedronFaces:function t(e,n,i){i|=0;var o,s=0,a=0,A=0,u=0,l=0,c=0,h=0,f=0;o=L,L=L+128|0,h=o+112|0,A=o+96|0,f=o,a=0|ze(0|(e|=0),0|(n|=0),52),S(),l=15&a,r[h>>2]=l,u=0|ze(0|e,0|n,45),S(),u&=127;t:do{if(0|G(u)){if(0|l)for(s=1;;){if(!(!((c=0|Ve(7,0,3*(15-s|0)|0))&e)&!(S()&n))){a=0;break t}if(!(s>>>0<l>>>0))break;s=s+1|0}if(!(1&a))return c=0|Ve(l+1|0,0,52),f=S()|-15728641&n,f=0|t((c|e)&~(h=0|Ve(7,0,3*(14-l|0)|0)),f&~S(),i),L=o,0|f;a=1}else a=0}while(0);if(!(s=0|Xt(e,n,A))){a?(It(A,h,f),c=5):(Lt(A,h,f),c=6);t:do{if(0|G(u))if(l)for(s=1;;){if(!(!((u=0|Ve(7,0,3*(15-s|0)|0))&e)&!(S()&n))){e=2;break t}if(!(s>>>0<l>>>0)){e=5;break}s=s+1|0}else e=5;else e=2}while(0);Ye(0|i,-1,e<<2);t:do{if(a)for(A=0;;){if(Pt(u=f+(A<<4)|0,0|r[h>>2]),u=0|r[u>>2],-1==(0|(l=0|r[i>>2]))|(0|l)==(0|u))s=i;else{a=0;do{if((a=a+1|0)>>>0>=e>>>0){s=1;break t}l=0|r[(s=i+(a<<2)|0)>>2]}while(!(-1==(0|l)|(0|l)==(0|u)))}if(r[s>>2]=u,(A=A+1|0)>>>0>=c>>>0){s=0;break}}else for(A=0;;){if(Rt(u=f+(A<<4)|0,0|r[h>>2],0,1),u=0|r[u>>2],-1==(0|(l=0|r[i>>2]))|(0|l)==(0|u))s=i;else{a=0;do{if((a=a+1|0)>>>0>=e>>>0){s=1;break t}l=0|r[(s=i+(a<<2)|0)>>2]}while(!(-1==(0|l)|(0|l)==(0|u)))}if(r[s>>2]=u,(A=A+1|0)>>>0>=c>>>0){s=0;break}}}while(0)}return L=o,0|(f=s)},_getNumCells:ee,_getPentagons:Qt,_getRes0Cells:function(t){t|=0;var e=0,n=0,i=0;e=0;do{Ve(0|e,0,45),i=134225919|S(),r[(n=t+(e<<3)|0)>>2]=-1,r[n+4>>2]=i,e=e+1|0}while(122!=(0|e));return 0},_getResolution:function(t,e){return e=0|ze(0|(t|=0),0|(e|=0),52),S(),15&e},_greatCircleDistanceKm:te,_greatCircleDistanceM:function(t,e){t|=0;var n,i,r,s=0;return i=+o[(e|=0)>>3],n=+o[t>>3],s=(r=+f(.5*(i-n)))*r+(s=+f(.5*(+o[e+8>>3]-+o[t+8>>3])))*(+h(+i)*+h(+n)*s),2*+m(+ +l(+s),+ +l(+(1-s)))*6371.007180918475*1e3},_greatCircleDistanceRads:function(t,e){t|=0;var n,i,r,s=0;return i=+o[(e|=0)>>3],n=+o[t>>3],s=(r=+f(.5*(i-n)))*r+(s=+f(.5*(+o[e+8>>3]-+o[t+8>>3])))*(+h(+i)*+h(+n)*s),2*+m(+ +l(+s),+ +l(+(1-s)))},_gridDisk:N,_gridDiskDistances:O,_gridDistance:function(t,e,n,i,o){n|=0,i|=0,o|=0;var s,a,A=0,u=0;return a=L,L=L+32|0,u=a,0|(s=0|ue(t|=0,e|=0,t,e,A=a+12|0))?(L=a,0|(u=s)):0|(t=0|ue(t,e,n,i,u))?(L=a,0|(u=t)):(A=0|mt(A,u),r[(u=o)>>2]=A,r[u+4>>2]=((0|A)<0)<<31>>31,L=a,0|(u=0))},_gridPathCells:function(t,e,n,i,o){n|=0,i|=0,o|=0;var s,a=0,A=0,l=0,c=0,h=0,f=0,p=0,d=0,g=0,_=0,m=0,y=0,v=0,E=0,b=0,w=0,x=0,T=0,I=0;if(s=L,L=L+48|0,l=s+12|0,T=s,!(a=0|ue(t|=0,e|=0,t,e,A=s+24|0))&&!(a=0|ue(t,e,n,i,l))){x=((0|(w=0|mt(A,l)))<0)<<31>>31,r[A>>2]=0,r[A+4>>2]=0,r[A+8>>2]=0,r[l>>2]=0,r[l+4>>2]=0,r[l+8>>2]=0,0|ue(t,e,t,e,A)&&C(23313,23090,691,23299),0|ue(t,e,n,i,l)&&C(23313,23090,696,23299),Et(A),Et(l),w?(_=+(0|w),b=A,i=p=0|r[A>>2],a=d=0|r[(v=A+4|0)>>2],n=g=0|r[(E=A+8|0)>>2],m=+((0|r[l>>2])-p|0)/_,y=+((0|r[l+4>>2])-d|0)/_,_=+((0|r[l+8>>2])-g|0)/_):(v=a=A+4|0,E=n=A+8|0,b=A,i=0|r[A>>2],a=0|r[a>>2],n=0|r[n>>2],m=0,y=0,_=0),r[T>>2]=i,r[(g=T+4|0)>>2]=a,r[(d=T+8|0)>>2]=n;t:do{if((0|w)<0)a=0;else for(f=0,p=0,a=i;;){I=m*(h=+(p>>>0)+4294967296*+(0|f))+ +(0|a),c=y*h+ +(0|r[v>>2]),h=_*h+ +(0|r[E>>2]),n=~~+He(+I),A=~~+He(+c),a=~~+He(+h),I=+u(+(+(0|n)-I)),c=+u(+(+(0|A)-c)),h=+u(+(+(0|a)-h));do{if(!(I>c&I>h)){if(l=0-n|0,c>h){i=l-a|0;break}i=A,a=l-A|0;break}n=0-(A+a)|0,i=A}while(0);if(r[T>>2]=n,r[g>>2]=i,r[d>>2]=a,bt(T),0|(a=0|le(t,e,T,o+(p<<3)|0)))break t;if(!((0|f)<(0|x)|(0|f)==(0|x)&p>>>0<w>>>0)){a=0;break t}a=0|Le(0|p,0|f,1,0),f=l=0|S(),p=a,a=0|r[b>>2]}}while(0);return L=s,0|(T=a)}return L=s,0|(T=a)},_gridPathCellsSize:function(t,e,n,i,o){n|=0,i|=0,o|=0;var s,a=0,A=0,u=0;return s=L,L=L+32|0,u=s,(a=0|ue(t|=0,e|=0,t,e,A=s+12|0))||(a=0|ue(t,e,n,i,u))?(L=s,0|(u=a)):(i=0|Le(0|(i=0|mt(A,u)),((0|i)<0)<<31>>31,1,0),A=0|S(),r[(u=o)>>2]=i,r[u+4>>2]=A,L=s,0|(u=0))},_gridRingUnsafe:function(t,e,n,i){t|=0,e|=0,n|=0,i|=0;var o,s,a=0,A=0,u=0,l=0,c=0,h=0,f=0,p=0,d=0;if(s=L,L=L+16|0,d=s+8|0,r[(p=o=s)>>2]=t,r[p+4>>2]=e,!n)return r[(d=i)>>2]=t,r[d+4>>2]=e,L=s,0|(d=0);r[d>>2]=0;t:do{if(0|kt(t,e))t=9;else{if(A=(0|n)>0){a=0,p=t;do{if(0|(t=0|k(p,e,4,d,o)))break t;if(a=a+1|0,0|kt(p=0|r[(e=o)>>2],e=0|r[e+4>>2])){t=9;break t}}while((0|a)<(0|n));if(r[(f=i)>>2]=p,r[f+4>>2]=e,f=n+-1|0,A){h=0,t=1;do{if(a=22384+(h<<2)|0,5==(0|h))for(u=0|r[a>>2],A=0,a=t;;){if(0|(t=0|k(0|r[(t=o)>>2],0|r[t+4>>2],u,d,o)))break t;if((0|A)!=(0|f)){if(l=0|r[(c=o)>>2],c=0|r[c+4>>2],r[(t=i+(a<<3)|0)>>2]=l,r[t+4>>2]=c,0|kt(l,c)){t=9;break t}t=a+1|0}else t=a;if((0|(A=A+1|0))>=(0|n))break;a=t}else for(u=o,c=0|r[a>>2],l=0,a=t,A=0|r[u>>2],u=0|r[u+4>>2];;){if(0|(t=0|k(A,u,c,d,o)))break t;if(A=0|r[(u=o)>>2],u=0|r[u+4>>2],r[(t=i+(a<<3)|0)>>2]=A,r[t+4>>2]=u,t=a+1|0,0|kt(A,u)){t=9;break t}if((0|(l=l+1|0))>=(0|n))break;a=t}h=h+1|0}while(h>>>0<6);u=p,a=0|r[(t=o)>>2],A=e,t=0|r[t+4>>2]}else u=p,a=p,A=e,t=e}else r[(u=i)>>2]=t,r[u+4>>2]=e,u=t,a=t,A=e,t=e;t=(0|u)==(0|a)&(0|A)==(0|t)?0:9}}while(0);return L=s,0|(d=t)},_i64Add:Le,_i64Subtract:Ne,_isPentagon:kt,_isResClassIII:function(t,e){return e=0|ze(0|(t|=0),0|(e|=0),52),S(),1&e},_isValidCell:Ot,_isValidDirectedEdge:function(t,e){var n=0;switch(n=0|ze(0|(t|=0),0|(e|=0),56),S(),7&n){case 0:case 7:return 0|(n=0)}return n=-2130706433&e|134217728,!0&268435456==(2013265920&e)?!0&16777216==(117440512&e)&!!(0|kt(t,n))?0|(n=0):0|(n=0|Ot(t,n)):0|(n=0)},_isValidVertex:function(t,e){t|=0;var n,i,o=0,s=0;return i=L,L=L+16|0,n=i,!0&536870912==(2013265920&(e|=0))&&0|Ot(t,o=-2130706433&e|134217728)?(s=0|ze(0|t,0|e,56),S(),o=(s=!(0|ve(t,o,7&s,n)))&((0|r[(o=n)>>2])==(0|t)?(0|r[o+4>>2])==(0|e):0)&1,L=i,0|o):(L=i,0|(o=0))},_latLngToCell:Wt,_llvm_maxnum_f64:je,_llvm_minnum_f64:We,_llvm_round_f64:He,_localIjToCell:function(t,e,n,i,r){var o,s;return t|=0,e|=0,n|=0,r|=0,s=L,L=L+16|0,o=s,(i|=0)?n=15:(n=0|vt(n,o))||(n=0|le(t,e,o,r)),L=s,0|n},_malloc:Re,_maxFaceCount:function(t,e,n){n|=0;var i=0,o=0;if(o=0|ze(0|(t|=0),0|(e|=0),45),S(),!(0|G(127&o)))return o=2,r[n>>2]=o,0;if(o=0|ze(0|t,0|e,52),S(),!(o&=15))return o=5,r[n>>2]=o,0;for(i=1;;){if(!(!((0|Ve(7,0,3*(15-i|0)|0))&t)&!(S()&e))){i=2,t=6;break}if(!(i>>>0<o>>>0)){i=5,t=6;break}i=i+1|0}return 6==(0|t)?(r[n>>2]=i,0):0},_maxGridDiskSize:function(t,e){e|=0;var n=0,i=0,o=0;return(0|(t|=0))<0?0|(e=2):(0|t)>13780509?0|(e=0|ee(15,e)):(o=0|ke(0|t,0|(n=((0|t)<0)<<31>>31),3,0),i=0|S(),n=0|Le(0|t,0|n,1,0),n=0|Le(0|(n=0|ke(0|o,0|i,0|n,0|S())),0|S(),1,0),t=0|S(),r[e>>2]=n,r[e+4>>2]=t,0|(e=0))},_maxPolygonToCellsSize:function(t,e,n,i){e|=0,i|=0;var o,s=0,a=0,A=0,u=0,l=0;if(o=L,L=L+48|0,s=o+16|0,a=o+8|0,A=o,0|(n|=0))return L=o,0|(A=15);if(u=0|r[(l=t|=0)+4>>2],r[(n=a)>>2]=r[l>>2],r[n+4>>2]=u,fe(a,s),!(e=0|Q(s,e,A))){if(n=0|r[a>>2],(0|(a=0|r[t+8>>2]))>0){s=0|r[t+12>>2],e=0;do{n=(0|r[s+(e<<3)>>2])+n|0,e=e+1|0}while((0|e)<(0|a))}s=0|r[(e=A)>>2],(0|(e=0|r[e+4>>2]))<(0|(a=((0|n)<0)<<31>>31))|(0|e)==(0|a)&s>>>0<n>>>0?(r[(e=A)>>2]=n,r[e+4>>2]=a,e=a):n=s,u=0|Le(0|n,0|e,12,0),l=0|S(),r[(e=A)>>2]=u,r[e+4>>2]=l,r[(e=i)>>2]=u,r[e+4>>2]=l,e=0}return L=o,0|(l=e)},_memcpy:Xe,_memset:Ye,_originToDirectedEdges:function(t,e,n){n|=0;var i,o=0;return i=!(0|kt(t|=0,e|=0)),e&=-2130706433,r[(o=n)>>2]=i?t:0,r[o+4>>2]=i?285212672|e:0,r[(o=n+8|0)>>2]=t,r[o+4>>2]=301989888|e,r[(o=n+16|0)>>2]=t,r[o+4>>2]=318767104|e,r[(o=n+24|0)>>2]=t,r[o+4>>2]=335544320|e,r[(o=n+32|0)>>2]=t,r[o+4>>2]=352321536|e,r[(n=n+40|0)>>2]=t,r[n+4>>2]=369098752|e,0},_pentagonCount:function(){return 12},_polygonToCells:function(t,e,n,i){e|=0,i|=0;var o,s,a,A,u=0,l=0,c=0,h=0,f=0,p=0,d=0,g=0,_=0,m=0,y=0,v=0,E=0,b=0,w=0,x=0,C=0,T=0,I=0,R=0,P=0,M=0,N=0,O=0,k=0,B=0,G=0;if(A=L,L=L+112|0,o=A+80|0,f=A+72|0,s=A,a=A+56|0,0|(n|=0))return L=A,0|(G=15);if(!(G=0|Re(32+(r[(p=(t|=0)+8|0)>>2]<<5)|0)))return L=A,0|(G=13);if(pe(t,G),B=0|r[(k=t)+4>>2],r[(n=f)>>2]=r[k>>2],r[n+4>>2]=B,fe(f,o),n=0|Q(o,e,s))k=0,B=0;else{if(n=0|r[f>>2],(0|(l=0|r[p>>2]))>0){c=0|r[t+12>>2],u=0;do{n=(0|r[c+(u<<3)>>2])+n|0,u=u+1|0}while((0|u)!=(0|l));u=n}else u=n;l=0|r[(n=s)>>2],(0|(n=0|r[n+4>>2]))<(0|(c=((0|u)<0)<<31>>31))|(0|n)==(0|c)&l>>>0<u>>>0?(r[(n=s)>>2]=u,r[n+4>>2]=c,n=c):u=l,k=0|Le(0|u,0|n,12,0),B=0|S(),r[(n=s)>>2]=k,r[n+4>>2]=B,n=0}if(0|n)return Pe(G),L=A,0|(G=n);if(!(u=0|Me(k,8)))return Pe(G),L=A,0|(G=13);if(!(h=0|Me(k,8)))return Pe(G),Pe(u),L=A,0|(G=13);r[(N=o)>>2]=0,r[N+4>>2]=0,O=0|r[(N=t)+4>>2],r[(n=f)>>2]=r[N>>2],r[n+4>>2]=O,n=0|U(f,k,B,e,o,u,h);t:do{if(n)Pe(u),Pe(h),Pe(G);else{e:do{if((0|r[p>>2])>0){for(c=t+12|0,l=0;n=0|U((0|r[c>>2])+(l<<3)|0,k,B,e,o,u,h),l=l+1|0,!(0|n);)if((0|l)>=(0|r[p>>2]))break e;Pe(u),Pe(h),Pe(G);break t}}while(0);(0|B)>0|!(0|B)&k>>>0>0&&Ye(0|h,0,k<<3),N=0|r[(O=o)+4>>2];e:do{if((0|N)>0|!(0|N)&(0|r[O>>2])>>>0>0){R=u,P=h,M=u,N=h,O=u,n=u,C=u,T=h,I=h,u=h;n:for(;;){for(E=0,b=0,w=0,x=0,l=0,c=0;;){f=(h=s)+56|0;do{r[h>>2]=0,h=h+4|0}while((0|h)<(0|f));if(0|D(p=0|r[(e=R+(E<<3)|0)>>2],e=0|r[e+4>>2],1,s,0)){f=(h=s)+56|0;do{r[h>>2]=0,h=h+4|0}while((0|h)<(0|f));0|(h=0|Me(7,4))&&(F(p,e,1,s,h,7,0,0),Pe(h))}for(v=0;;){m=0|r[(y=s+(v<<3)|0)>>2],y=0|r[y+4>>2];i:do{if(!(0|m)&!(0|y))h=l,f=c;else{if(d=0|Ue(0|m,0|y,0|k,0|B),p=0|S(),!(!(0|(f=0|r[(e=h=i+(d<<3)|0)>>2]))&!(0|(e=0|r[e+4>>2])))){g=0,_=0;do{if((0|g)>(0|B)|(0|g)==(0|B)&_>>>0>k>>>0)break n;if((0|f)==(0|m)&(0|e)==(0|y)){h=l,f=c;break i}d=0|Be(0|(h=0|Le(0|d,0|p,1,0)),0|S(),0|k,0|B),p=0|S(),_=0|Le(0|_,0|g,1,0),g=0|S(),f=0|r[(e=h=i+(d<<3)|0)>>2],e=0|r[e+4>>2]}while(!(!(0|f)&!(0|e)))}!(0|m)&!(0|y)?(h=l,f=c):(Yt(m,y,a),0|de(t,G,a)&&(_=0|Le(0|l,0|c,1,0),c=0|S(),r[(g=h)>>2]=m,r[g+4>>2]=y,r[(l=P+(l<<3)|0)>>2]=m,r[l+4>>2]=y,l=_),h=l,f=c)}}while(0);if((v=v+1|0)>>>0>=7)break;l=h,c=f}if(E=0|Le(0|E,0|b,1,0),b=0|S(),w=0|Le(0|w,0|x,1,0),x=0|S(),l=0|r[(c=o)>>2],!((0|x)<(0|(c=0|r[c+4>>2]))|(0|x)==(0|c)&w>>>0<l>>>0))break;l=h,c=f}if((0|c)>0|!(0|c)&l>>>0>0){l=0,c=0;do{r[(x=R+(l<<3)|0)>>2]=0,r[x+4>>2]=0,l=0|Le(0|l,0|c,1,0),c=0|S(),w=0|r[(x=o)+4>>2]}while((0|c)<(0|w)|((0|c)==(0|w)?l>>>0<(0|r[x>>2])>>>0:0))}if(r[(x=o)>>2]=h,r[x+4>>2]=f,!((0|f)>0|!(0|f)&h>>>0>0))break e;v=u,E=I,b=O,w=T,x=P,u=C,I=n,T=M,C=v,n=E,O=N,N=b,M=w,P=R,R=x}Pe(M),Pe(N),Pe(G),n=1;break t}n=h}while(0);Pe(G),Pe(u),Pe(n),n=0}}while(0);return L=A,0|(G=n)},_readInt64AsDoubleFromPointer:function(t){return+(+((0|r[(t|=0)>>2])>>>0)+4294967296*+(0|r[t+4>>2]))},_res0CellCount:function(){return 122},_round:qe,_sbrk:Qe,_sizeOfCellBoundary:function(){return 168},_sizeOfCoordIJ:function(){return 8},_sizeOfGeoLoop:function(){return 8},_sizeOfGeoPolygon:function(){return 16},_sizeOfH3Index:function(){return 8},_sizeOfLatLng:function(){return 16},_sizeOfLinkedGeoPolygon:function(){return 12},_uncompactCells:function(t,e,n,i,o,s,a){t|=0,i|=0,o|=0,s|=0;var A,u=0,l=0,c=0,h=0,f=0,p=0,d=0,g=0;if(A=L,L=L+16|0,g=A,!((0|(n|=0))>0|!(0|n)&(e|=0)>>>0>0))return L=A,0|(g=0);if((0|(a|=0))>=16)return L=A,0|(g=12);p=0,d=0,f=0,u=0;t:for(;;){if(h=0|ze(0|(l=0|r[(c=t+(p<<3)|0)>>2]),0|(c=0|r[c+4>>2]),52),S(),(15&h)>(0|a)){u=12,l=11;break}if($t(g,l,c,a),!(0|(c=0|r[(h=g)>>2]))&!(0|(h=0|r[h+4>>2])))l=f;else{l=f;do{if(!((0|u)<(0|s)|(0|u)==(0|s)&l>>>0<o>>>0)){l=10;break t}r[(f=i+(l<<3)|0)>>2]=c,r[f+4>>2]=h,l=0|Le(0|l,0|u,1,0),u=0|S(),Kt(g),c=0|r[(f=g)>>2],h=0|r[f+4>>2]}while(!(!(0|c)&!(0|h)))}if(p=0|Le(0|p,0|d,1,0),!((0|(d=0|S()))<(0|n)|(0|d)==(0|n)&p>>>0<e>>>0)){u=0,l=11;break}f=l}return 10==(0|l)?(L=A,0|(g=14)):11==(0|l)?(L=A,0|u):0},_uncompactCellsSize:function(t,e,n,i,o){t|=0,e|=0,n|=0,i|=0,o|=0;var s,a,A=0,u=0,l=0,c=0,h=0,f=0;a=L,L=L+16|0,s=a;t:do{if((0|n)>0|!(0|n)&e>>>0>0){for(h=0,u=0,A=0,f=0;;){if(!(!(0|(l=0|r[(c=t+(h<<3)|0)>>2]))&!(0|(c=0|r[c+4>>2]))||(c=!(0|Ft(l,c,i,s)),u=0|Le(0|r[(l=s)>>2],0|r[l+4>>2],0|u,0|A),A=0|S(),c))){A=12;break}if(h=0|Le(0|h,0|f,1,0),!((0|(f=0|S()))<(0|n)|(0|f)==(0|n)&h>>>0<e>>>0))break t}return L=a,0|A}u=0,A=0}while(0);return r[o>>2]=u,r[o+4>>2]=A,L=a,0|(o=0)},_vertexToLatLng:function(t,e,n){n|=0;var i,o,s,a,A=0,u=0;return a=L,L=L+192|0,o=a,s=a+168|0,A=0|ze(0|(t|=0),0|(e|=0),56),S(),A&=7,0|(i=0|Xt(t,u=-2130706433&e|134217728,s))?(L=a,0|(u=i)):(e=0|ze(0|t,0|e,52),S(),e&=15,0|kt(t,u)?Tt(s,e,A,1,o):Mt(s,e,A,1,o),u=o+8|0,r[n>>2]=r[u>>2],r[n+4>>2]=r[u+4>>2],r[n+8>>2]=r[u+8>>2],r[n+12>>2]=r[u+12>>2],L=a,0|(u=0))},establishStackSpace:function(t,e){L=t|=0},stackAlloc:function(t){var e;return e=L,L=(L=L+(t|=0)|0)+15&-16,0|e},stackRestore:function(t){L=t|=0},stackSave:function(){return 0|L}}}({Math:Math,Int8Array:Int8Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Float32Array:Float32Array,Float64Array:Float64Array},{a:at,b:function(t){u=t},c:function(){return u},d:function(t,e,n,i){at("Assertion failed: "+p(t)+", at: "+[e?p(e):"unknown filename",n,i?p(i):"unknown function"])},e:function(t){return n.___errno_location&&(y[n.___errno_location()>>2]=t),t},f:H,g:function(t,e,n){_.set(_.subarray(e,e+n),t)},h:function(t){var e=H(),n=16777216,i=2130706432;if(t>i)return!1;for(var r=Math.max(e,16777216);r<t;)r=r<=536870912?b(2*r,n):Math.min(b((3*r+2147483648)/4,n),i);return!!X(r)},i:function(t){at("OOM")},j:V,k:j,l:X,m:W,n:function(){var t=W();return n.extraStackTrace&&(t+="\n"+n.extraStackTrace()),j(t)},o:24144,p:24128},d),Z=(n.___divdi3=K.___divdi3,n.___muldi3=K.___muldi3,n.___remdi3=K.___remdi3,n.___uremdi3=K.___uremdi3,n._areNeighborCells=K._areNeighborCells,n._bitshift64Ashr=K._bitshift64Ashr,n._bitshift64Lshr=K._bitshift64Lshr,n._bitshift64Shl=K._bitshift64Shl,n._calloc=K._calloc,n._cellAreaKm2=K._cellAreaKm2,n._cellAreaM2=K._cellAreaM2,n._cellAreaRads2=K._cellAreaRads2,n._cellToBoundary=K._cellToBoundary,n._cellToCenterChild=K._cellToCenterChild,n._cellToChildPos=K._cellToChildPos,n._cellToChildren=K._cellToChildren,n._cellToChildrenSize=K._cellToChildrenSize,n._cellToLatLng=K._cellToLatLng,n._cellToLocalIj=K._cellToLocalIj,n._cellToParent=K._cellToParent,n._cellToVertex=K._cellToVertex,n._cellToVertexes=K._cellToVertexes,n._cellsToDirectedEdge=K._cellsToDirectedEdge,n._cellsToLinkedMultiPolygon=K._cellsToLinkedMultiPolygon,n._childPosToCell=K._childPosToCell,n._compactCells=K._compactCells,n._destroyLinkedMultiPolygon=K._destroyLinkedMultiPolygon,n._directedEdgeToBoundary=K._directedEdgeToBoundary,n._directedEdgeToCells=K._directedEdgeToCells,n._edgeLengthKm=K._edgeLengthKm,n._edgeLengthM=K._edgeLengthM,n._edgeLengthRads=K._edgeLengthRads,n._emscripten_replace_memory=K._emscripten_replace_memory),J=(n._free=K._free,n._getBaseCellNumber=K._getBaseCellNumber,n._getDirectedEdgeDestination=K._getDirectedEdgeDestination,n._getDirectedEdgeOrigin=K._getDirectedEdgeOrigin,n._getHexagonAreaAvgKm2=K._getHexagonAreaAvgKm2,n._getHexagonAreaAvgM2=K._getHexagonAreaAvgM2,n._getHexagonEdgeLengthAvgKm=K._getHexagonEdgeLengthAvgKm,n._getHexagonEdgeLengthAvgM=K._getHexagonEdgeLengthAvgM,n._getIcosahedronFaces=K._getIcosahedronFaces,n._getNumCells=K._getNumCells,n._getPentagons=K._getPentagons,n._getRes0Cells=K._getRes0Cells,n._getResolution=K._getResolution,n._greatCircleDistanceKm=K._greatCircleDistanceKm,n._greatCircleDistanceM=K._greatCircleDistanceM,n._greatCircleDistanceRads=K._greatCircleDistanceRads,n._gridDisk=K._gridDisk,n._gridDiskDistances=K._gridDiskDistances,n._gridDistance=K._gridDistance,n._gridPathCells=K._gridPathCells,n._gridPathCellsSize=K._gridPathCellsSize,n._gridRingUnsafe=K._gridRingUnsafe,n._i64Add=K._i64Add,n._i64Subtract=K._i64Subtract,n._isPentagon=K._isPentagon,n._isResClassIII=K._isResClassIII,n._isValidCell=K._isValidCell,n._isValidDirectedEdge=K._isValidDirectedEdge,n._isValidVertex=K._isValidVertex,n._latLngToCell=K._latLngToCell,n._llvm_maxnum_f64=K._llvm_maxnum_f64,n._llvm_minnum_f64=K._llvm_minnum_f64,n._llvm_round_f64=K._llvm_round_f64,n._localIjToCell=K._localIjToCell,n._malloc=K._malloc,n._maxFaceCount=K._maxFaceCount,n._maxGridDiskSize=K._maxGridDiskSize,n._maxPolygonToCellsSize=K._maxPolygonToCellsSize,n._memcpy=K._memcpy,n._memset=K._memset,n._originToDirectedEdges=K._originToDirectedEdges,n._pentagonCount=K._pentagonCount,n._polygonToCells=K._polygonToCells,n._readInt64AsDoubleFromPointer=K._readInt64AsDoubleFromPointer,n._res0CellCount=K._res0CellCount,n._round=K._round,n._sbrk=K._sbrk,n._sizeOfCellBoundary=K._sizeOfCellBoundary,n._sizeOfCoordIJ=K._sizeOfCoordIJ,n._sizeOfGeoLoop=K._sizeOfGeoLoop,n._sizeOfGeoPolygon=K._sizeOfGeoPolygon,n._sizeOfH3Index=K._sizeOfH3Index,n._sizeOfLatLng=K._sizeOfLatLng,n._sizeOfLinkedGeoPolygon=K._sizeOfLinkedGeoPolygon,n._uncompactCells=K._uncompactCells,n._uncompactCellsSize=K._uncompactCellsSize,n._vertexToLatLng=K._vertexToLatLng,n.establishStackSpace=K.establishStackSpace,n.stackAlloc=K.stackAlloc),tt=n.stackRestore=K.stackRestore,et=n.stackSave=K.stackSave;if(n.asm=K,n.cwrap=function(t,e,n,i){var r=(n=n||[]).every((function(t){return"number"===t}));return"string"!==e&&r&&!i?c(t):function(){return h(t,e,n,arguments)}},n.setValue=function(t,e,n,i){switch("*"===(n=n||"i8").charAt(n.length-1)&&(n="i32"),n){case"i1":case"i8":g[t|0]=e;break;case"i16":m[t>>1]=e;break;case"i32":y[t>>2]=e;break;case"i64":B=[e>>>0,(k=e,+P(k)>=1?k>0?(0|N(+L(k/4294967296),4294967295))>>>0:~~+M((k-+(~~k>>>0))/4294967296)>>>0:0)],y[t>>2]=B[0],y[t+4>>2]=B[1];break;case"float":v[t>>2]=e;break;case"double":E[t>>3]=e;break;default:at("invalid type for setValue: "+n)}},n.getValue=function(t,e,n){switch("*"===(e=e||"i8").charAt(e.length-1)&&(e="i32"),e){case"i1":case"i8":return g[t|0];case"i16":return m[t>>1];case"i32":case"i64":return y[t>>2];case"float":return v[t>>2];case"double":return E[t>>3];default:at("invalid type for getValue: "+e)}return null},U){z(U)||(Q=U,U=n.locateFile?n.locateFile(Q,s):s+Q),O++,n.monitorRunDependencies&&n.monitorRunDependencies(O);var nt=function(t){t.byteLength&&(t=new Uint8Array(t)),_.set(t,8),n.memoryInitializerRequest&&delete n.memoryInitializerRequest.response,function(t){if(O--,n.monitorRunDependencies&&n.monitorRunDependencies(O),0==O&&(null!==D&&(clearInterval(D),D=null),F)){var e=F;F=null,e()}}()},it=function(){r(U,nt,(function(){throw"could not load memory initializer "+U}))},rt=q(U);if(rt)nt(rt.buffer);else if(n.memoryInitializerRequest){var ot=function(){var t=n.memoryInitializerRequest,e=t.response;if(200!==t.status&&0!==t.status){var i=q(n.memoryInitializerRequestURL);if(!i)return console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+t.status+", retrying "+U),void it();e=i.buffer}nt(e)};n.memoryInitializerRequest.response?setTimeout(ot,0):n.memoryInitializerRequest.addEventListener("load",ot)}else it()}function st(t){function e(){$||($=!0,l||(S(T),S(I),n.onRuntimeInitialized&&n.onRuntimeInitialized(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)t=n.postRun.shift(),R.unshift(t);var t;S(R)}()))}t=t||o,O>0||(!function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)t=n.preRun.shift(),C.unshift(t);var t;S(C)}(),O>0||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),e()}),1)):e()))}function at(t){throw n.onAbort&&n.onAbort(t),a(t+=""),A(t),l=!0,"abort("+t+"). Build with -s ASSERTIONS=1 for more info."}if(F=function t(){$||st(),$||(F=t)},n.run=st,n.abort=at,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return st(),t}("object"==typeof i?i:{}),r="number",o=[["sizeOfH3Index",r],["sizeOfLatLng",r],["sizeOfCellBoundary",r],["sizeOfGeoLoop",r],["sizeOfGeoPolygon",r],["sizeOfLinkedGeoPolygon",r],["sizeOfCoordIJ",r],["readInt64AsDoubleFromPointer",r],["isValidCell",r,[r,r]],["latLngToCell",r,[r,r,r,r]],["cellToLatLng",r,[r,r,r]],["cellToBoundary",r,[r,r,r]],["maxGridDiskSize",r,[r,r]],["gridDisk",r,[r,r,r,r]],["gridDiskDistances",r,[r,r,r,r,r]],["gridRingUnsafe",r,[r,r,r,r]],["maxPolygonToCellsSize",r,[r,r,r,r]],["polygonToCells",r,[r,r,r,r]],["cellsToLinkedMultiPolygon",r,[r,r,r]],["destroyLinkedMultiPolygon",null,[r]],["compactCells",r,[r,r,r,r]],["uncompactCells",r,[r,r,r,r,r,r]],["uncompactCellsSize",r,[r,r,r,r,r]],["isPentagon",r,[r,r]],["isResClassIII",r,[r,r]],["getBaseCellNumber",r,[r,r]],["getResolution",r,[r,r]],["maxFaceCount",r,[r,r,r]],["getIcosahedronFaces",r,[r,r,r]],["cellToParent",r,[r,r,r,r]],["cellToChildren",r,[r,r,r,r]],["cellToCenterChild",r,[r,r,r,r]],["cellToChildrenSize",r,[r,r,r,r]],["cellToChildPos",r,[r,r,r,r]],["childPosToCell",r,[r,r,r,r,r,r]],["areNeighborCells",r,[r,r,r,r,r]],["cellsToDirectedEdge",r,[r,r,r,r,r]],["getDirectedEdgeOrigin",r,[r,r,r]],["getDirectedEdgeDestination",r,[r,r,r]],["isValidDirectedEdge",r,[r,r]],["directedEdgeToCells",r,[r,r,r]],["originToDirectedEdges",r,[r,r,r]],["directedEdgeToBoundary",r,[r,r,r]],["gridDistance",r,[r,r,r,r,r]],["gridPathCells",r,[r,r,r,r,r]],["gridPathCellsSize",r,[r,r,r,r,r]],["cellToLocalIj",r,[r,r,r,r,r,r]],["localIjToCell",r,[r,r,r,r,r]],["getHexagonAreaAvgM2",r,[r,r]],["getHexagonAreaAvgKm2",r,[r,r]],["getHexagonEdgeLengthAvgM",r,[r,r]],["getHexagonEdgeLengthAvgKm",r,[r,r]],["greatCircleDistanceM",r,[r,r]],["greatCircleDistanceKm",r,[r,r]],["greatCircleDistanceRads",r,[r,r]],["cellAreaM2",r,[r,r,r]],["cellAreaKm2",r,[r,r,r]],["cellAreaRads2",r,[r,r,r]],["edgeLengthM",r,[r,r,r]],["edgeLengthKm",r,[r,r,r]],["edgeLengthRads",r,[r,r,r]],["getNumCells",r,[r,r]],["getRes0Cells",r,[r]],["res0CellCount",r],["getPentagons",r,[r,r]],["pentagonCount",r],["cellToVertex",r,[r,r,r,r]],["cellToVertexes",r,[r,r,r]],["vertexToLatLng",r,[r,r,r]],["isValidVertex",r,[r,r]]],s=4,a=5,A={0:"Success",1:"The operation failed but a more specific error is not available",2:"Argument was outside of acceptable range",3:"Latitude or longitude arguments were outside of acceptable range"};A[s]="Resolution argument was outside of acceptable range",A[a]="Cell argument was not valid",A[6]="Directed edge argument was not valid",A[7]="Undirected edge argument was not valid",A[8]="Vertex argument was not valid",A[9]="Pentagon distortion was encountered",A[10]="Duplicate input",A[11]="Cell arguments were not neighbors",A[12]="Cell arguments had incompatible resolutions",A[13]="Memory allocation failed",A[14]="Bounds of provided memory were insufficient",A[15]="Mode or flags argument was not valid";var u=1e3,l=1001,c=1002,h={1e3:"Unknown unit"};h[l]="Array length out of bounds",h[c]="Got unexpected null value for H3 index";var f="Unknown error";function p(t,e,n){var i=n&&"value"in n,r=new Error((t[e]||f)+" (code: "+e+(i?", value: "+n.value:"")+")");return r.code=e,r}function d(t,e){return p(A,t,2===arguments.length?{value:e}:{})}function g(t,e){return p(h,t,2===arguments.length?{value:e}:{})}function _(t){if(0!==t)throw d(t)}var m={};o.forEach((function(t){m[t[0]]=i.cwrap.apply(i,t)}));var y=16,v=4,E=4,b=8,w=8,x=m.sizeOfH3Index(),S=m.sizeOfLatLng(),C=m.sizeOfCellBoundary(),T=(m.sizeOfGeoPolygon(),m.sizeOfGeoLoop(),m.sizeOfLinkedGeoPolygon()),I=(m.sizeOfCoordIJ(),"m"),R="km";function P(t){if("number"!=typeof t||t<0||t>15||Math.floor(t)!==t)throw d(s,t);return t}function M(t){if(!t)throw g(c);return t}Math.pow(2,32);var L=/[^0-9a-fA-F]/;function N(t){if(Array.isArray(t)&&2===t.length&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if("string"!=typeof t||L.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),y);return[parseInt(t.substring(t.length-8),y),e]}function O(t){if(t>=0)return t.toString(y);var e=D(8,(t&=2147483647).toString(y));return e=(parseInt(e[0],y)+8).toString(y)+e.substring(1)}function D(t,e){for(var n=t-e.length,i="",r=0;r<n;r++)i+="0";return i+=e}Math.pow(2,32);function F(t,e){void 0===e&&(e=0);var n=i.getValue(t+x*e,"i32"),r=i.getValue(t+x*e+v,"i32");return r?function(t,e){return O(e)+D(8,O(t))}(n,r):null}function k(t,e){return void 0===e&&(e=0),i.getValue(t+b*e,"double")}function B(t){return m.readInt64AsDoubleFromPointer(t)}function U(t,e,n){i.HEAPU32.set(N(t),e/v+2*n)}function G(t,e){for(var n=e.length,i=0;i<n;i++)U(e[i],t,i)}function z(t){return 180*i.getValue(t,"double")/Math.PI}function V(t){return[z(t),z(t+b)]}function j(t){return[z(t+b),z(t)]}function W(t,e,n){for(var r=i.getValue(t,"i32"),o=t+b,s=[],a=e?j:V,A=0;A<2*r;A+=2)s.push(a(o+b*A));return n&&s.push(s[0]),s}function H(t){var e=N(t),n=e[0],i=e[1];return Boolean(m.isPentagon(n,i))}function X(t){var e=i._malloc(S),n=N(t),r=n[0],o=n[1];try{return _(m.cellToLatLng(r,o,e)),V(e)}finally{i._free(e)}}function Y(t,e){if(!t||!t.length)return[];var n=t.length,r=i._calloc(n,x);G(r,t);var o=i._calloc(T);try{return _(m.cellsToLinkedMultiPolygon(r,n,o)),function(t,e){for(var n,r,o,s,a=[],A=e?j:V;t;){for(a.push(n=[]),r=i.getValue(t,"i8*");r;){for(n.push(o=[]),s=i.getValue(r,"i8*");s;)o.push(A(s)),s=i.getValue(s+2*b,"i8*");e&&o.push(o[0]),r=i.getValue(r+2*E,"i8*")}t=i.getValue(t+2*E,"i8*")}return a}(o,e)}finally{m.destroyLinkedMultiPolygon(o),i._free(o),i._free(r)}}function q(t,e){P(t);var n=i._malloc(b);try{switch(e){case I:_(m.getHexagonEdgeLengthAvgM(t,n));break;case R:_(m.getHexagonEdgeLengthAvgKm(t,n));break;default:throw g(u,e)}return k(n)}finally{i._free(n)}}function Q(t){return t*Math.PI/180}var $=n(3439),K=n(9452),Z=n(9751),J=n(688),tt=n(4175),et=n(9105),nt=n(3349),it=n(9350),rt=n(9067),ot=n(3459),st=n(5337),at=n(1746);class At extends st.V{constructor(t){const{indices:e,attributes:n}=function(t){const{radius:e,height:n=1,nradial:i=10}=t;let{vertices:r}=t;r&&(ot.A.assert(r.length>=i),r=r.flatMap((t=>[t[0],t[1]])),(0,at.UD)(r,at.rJ.COUNTER_CLOCKWISE));const o=n>0,s=i+1,a=o?3*s+1:i,A=2*Math.PI/i,u=new Uint16Array(o?3*i*2:0),l=new Float32Array(3*a),c=new Float32Array(3*a);let h=0;if(o){for(let t=0;t<s;t++){const o=t*A,s=t%i,a=Math.sin(o),u=Math.cos(o);for(let t=0;t<2;t++)l[h+0]=r?r[2*s]:u*e,l[h+1]=r?r[2*s+1]:a*e,l[h+2]=(.5-t)*n,c[h+0]=r?r[2*s]:u,c[h+1]=r?r[2*s+1]:a,h+=3}l[h+0]=l[h-3],l[h+1]=l[h-2],l[h+2]=l[h-1],h+=3}for(let f=o?0:1;f<s;f++){const t=Math.floor(f/2)*Math.sign(.5-f%2),o=t*A,s=(t+i)%i,a=Math.sin(o),u=Math.cos(o);l[h+0]=r?r[2*s]:u*e,l[h+1]=r?r[2*s+1]:a*e,l[h+2]=n/2,c[h+2]=1,h+=3}if(o){let t=0;for(let e=0;e<i;e++)u[t++]=2*e+0,u[t++]=2*e+2,u[t++]=2*e+0,u[t++]=2*e+1,u[t++]=2*e+1,u[t++]=2*e+3}return{indices:u,attributes:{POSITION:{size:3,value:l},NORMAL:{size:3,value:c}}}}(t);super({...t,indices:e,attributes:n})}}const ut=[0,0,0,255],lt={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:ut},getLineColor:{type:"accessor",value:ut},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class ct extends J.A{static{this.layerName="ColumnLayer"}static{this.defaultProps=lt}getShaders(){const t={},{flatShading:e}=this.props;return e&&(t.FLAT_SHADING=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME column-layer-vertex-shader\nin vec3 positions;\nin vec3 normals;\nin vec3 instancePositions;\nin float instanceElevations;\nin vec3 instancePositions64Low;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin float instanceStrokeWidths;\nin vec3 instancePickingColors;\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform bool extruded;\nuniform bool stroked;\nuniform bool isStroke;\nuniform float coverage;\nuniform float elevationScale;\nuniform float edgeDistance;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int radiusUnits;\nuniform int widthUnits;\nout vec4 vColor;\n#ifdef FLAT_SHADING\nout vec4 position_commonspace;\n#endif\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\nvec4 color = isStroke ? instanceLineColors : instanceFillColors;\nmat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\nfloat elevation = 0.0;\nfloat strokeOffsetRatio = 1.0;\nif (extruded) {\nelevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\n} else if (stroked) {\nfloat widthPixels = clamp(\nproject_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\nwidthMinPixels, widthMaxPixels) / 2.0;\nfloat halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\nif (isStroke) {\nstrokeOffsetRatio -= sign(positions.z) * halfOffset;\n} else {\nstrokeOffsetRatio -= halfOffset;\n}\n}\nfloat shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\nfloat dotRadius = radius * coverage * shouldRender;\ngeometry.pickingColor = instancePickingColors;\nvec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\nvec3 centroidPosition64Low = instancePositions64Low;\nvec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;\nif (radiusUnits == UNIT_METERS) {\noffset = project_size(offset);\n}\nvec3 pos = vec3(offset, 0.);\nDECKGL_FILTER_SIZE(pos, geometry);\ngl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\ngeometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nif (extruded && !isStroke) {\n#ifdef FLAT_SHADING\nposition_commonspace = geometry.position;\nvColor = vec4(color.rgb, color.a * opacity);\n#else\nvec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\nvColor = vec4(lightColor, color.a * opacity);\n#endif\n} else {\nvColor = vec4(color.rgb, color.a * opacity);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME column-layer-fragment-shader\nprecision highp float;\nuniform vec3 project_uCameraPosition;\nuniform bool extruded;\nuniform bool isStroke;\nout vec4 fragColor;\nin vec4 vColor;\n#ifdef FLAT_SHADING\nin vec4 position_commonspace;\n#endif\nvoid main(void) {\nfragColor = vColor;\ngeometry.uv = vec2(0.);\n#ifdef FLAT_SHADING\nif (extruded && !isStroke && !bool(picking.isActive)) {\nvec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\nfragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);\n}\n#endif\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",defines:t,modules:[tt.A,e?et.p:et.K,nt.A]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getFillColor",defaultValue:ut},instanceLineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getLineColor",defaultValue:ut},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:i}=t,r=i.extensionsChanged||e.flatShading!==n.flatShading;r&&(this.state.models?.forEach((t=>t.destroy())),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());const o=this.getNumInstances();this.state.fillModel.setInstanceCount(o),this.state.wireframeModel.setInstanceCount(o),(r||e.diskResolution!==n.diskResolution||e.vertices!==n.vertices||(e.extruded||e.stroked)!==(n.extruded||n.stroked))&&this._updateGeometry(e)}getGeometry(t,e,n){const i=new At({radius:1,height:n?2:0,vertices:e,nradial:t});let r=0;if(e)for(let o=0;o<t;o++){const n=e[o];r+=Math.sqrt(n[0]*n[0]+n[1]*n[1])/t}else r=1;return this.setState({edgeDistance:Math.cos(Math.PI/t)*r}),i}_getModels(){const t=this.getShaders(),e=this.getAttributeManager().getBufferLayouts(),n=new rt.K(this.context.device,{...t,id:`${this.props.id}-fill`,bufferLayout:e,isInstanced:!0}),i=new rt.K(this.context.device,{...t,id:`${this.props.id}-wireframe`,bufferLayout:e,isInstanced:!0});return{fillModel:n,wireframeModel:i,models:[i,n]}}_updateGeometry({diskResolution:t,vertices:e,extruded:n,stroked:i}){const r=this.getGeometry(t,e,n||i);this.setState({fillVertexCount:r.attributes.POSITION.value.length/3});const o=this.state.fillModel,s=this.state.wireframeModel;o.setGeometry(r),o.setTopology("triangle-strip"),o.setIndexBuffer(null),s.setGeometry(r),s.setTopology("line-list")}draw({uniforms:t}){const{lineWidthUnits:e,lineWidthScale:n,lineWidthMinPixels:i,lineWidthMaxPixels:r,radiusUnits:o,elevationScale:s,extruded:a,filled:A,stroked:u,wireframe:l,offset:c,coverage:h,radius:f,angle:p}=this.props,d=this.state.fillModel,g=this.state.wireframeModel,{fillVertexCount:_,edgeDistance:m}=this.state,y={...t,radius:f,angle:p/180*Math.PI,offset:c,extruded:a,stroked:u,coverage:h,elevationScale:s,edgeDistance:m,radiusUnits:it.p5[o],widthUnits:it.p5[e],widthScale:n,widthMinPixels:i,widthMaxPixels:r};a&&l&&(g.setUniforms(y),g.setUniforms({isStroke:!0}),g.draw(this.context.renderPass)),d.setUniforms(y),A&&(d.setVertexCount(_),d.setUniforms({isStroke:!1}),d.draw(this.context.renderPass)),!a&&u&&(d.setVertexCount(2*_/3),d.setUniforms({isStroke:!0}),d.draw(this.context.renderPass))}}var ht=n(4901);function ft(t,e){e=void 0===e?t[0][0]:e;for(const n of t){const t=n[0]-e;t>180?n[0]-=360:t<-180&&(n[0]+=360)}}function pt(t,e,n){const i=t(e,n),[r,o]=X(i);return[o,r]}function dt(t,e=1){const n=function(t,e){var n=i._malloc(C),r=N(t),o=r[0],s=r[1];try{return _(m.cellToBoundary(o,s,n)),W(n,e,e)}finally{i._free(n)}}(t,!0);return 1!==e?function(t,e,n){const[i,r]=X(t),o=e.length;ft(e,r);const s=e[0]===e[o-1]?o-1:o;for(let a=0;a<s;a++)e[a][0]=(0,ht.Cc)(r,e[a][0],n),e[a][1]=(0,ht.Cc)(i,e[a][1],n)}(t,n,e):ft(n),n}const gt={...Z.A.defaultProps,highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:t=>t.hexagon},extruded:!0};class _t extends K.A{static{this.defaultProps=gt}static{this.layerName="H3HexagonLayer"}static{this._checkH3Lib=()=>{}}initializeState(){_t._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState({changeFlags:t}){return this._shouldUseHighPrecision()?t.propsOrDataChanged:t.somethingChanged}updateState({props:t,changeFlags:e}){if(!0!==t.highPrecision&&(e.dataChanged||e.updateTriggersChanged&&e.updateTriggersChanged.getHexagon)){const t=this._calculateH3DataProps();this.setState(t)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let t=-1,e=!1,n=!1;const{iterable:i,objectInfo:r}=(0,$.X)(this.props.data);for(const A of i){r.index++;const i=this.props.getHexagon(A,r),u=(o=void 0,s=void 0,a=void 0,o=N(i),s=o[0],a=o[1],m.isValidCell(s,a)?m.getResolution(s,a):-1);if(t<0){if(t=u,!this.props.highPrecision)break}else if(t!==u){n=!0;break}if(H(i)){e=!0;break}}var o,s,a;return{resolution:t,edgeLengthKM:t>=0?q(t,"km"):0,hasMultipleRes:n,hasPentagon:e}}_shouldUseHighPrecision(){if("auto"===this.props.highPrecision){const{resolution:t,hasPentagon:e,hasMultipleRes:n}=this.state,{viewport:i}=this.context;return Boolean(i?.resolution)||n||e||t>=0&&t<=5}return this.props.highPrecision}_updateVertices(t){if(this._shouldUseHighPrecision())return;const{resolution:e,edgeLengthKM:n,centerHex:r}=this.state;if(e<0)return;const o=this.props.centerHexagon||function(t,e,n){var r=i._malloc(S);i.HEAPF64.set([t,e].map(Q),r/b);var o=i._malloc(x);try{return _(m.latLngToCell(r,n,o)),M(F(o))}finally{i._free(o),i._free(r)}}(t.latitude,t.longitude,e);if(r===o)return;if(r)try{if(function(t,e){var n=N(t),r=n[0],o=n[1],s=N(e),a=s[0],A=s[1],u=i._malloc(w);try{return _(m.gridDistance(r,o,a,A,u)),B(u)}finally{i._free(u)}}(r,o)*n<10)return}catch{}const{unitsPerMeter:s}=t.distanceScales;let a=dt(o);const[A,u]=X(o),[l,c]=t.projectFlat([u,A]);a=a.map((e=>{const n=t.projectFlat(e);return[(n[0]-l)/s[0],(n[1]-c)/s[1]]})),this.setState({centerHex:o,vertices:a})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){const{elevationScale:t,material:e,coverage:n,extruded:i,wireframe:r,stroked:o,filled:s,lineWidthUnits:a,lineWidthScale:A,lineWidthMinPixels:u,lineWidthMaxPixels:l,getFillColor:c,getElevation:h,getLineColor:f,getLineWidth:p,transitions:d,updateTriggers:g}=this.props;return{elevationScale:t,extruded:i,coverage:n,wireframe:r,stroked:o,filled:s,lineWidthUnits:a,lineWidthScale:A,lineWidthMinPixels:u,lineWidthMaxPixels:l,material:e,getElevation:h,getFillColor:c,getLineColor:f,getLineWidth:p,transitions:d,updateTriggers:{getFillColor:g.getFillColor,getElevation:g.getElevation,getLineColor:g.getLineColor,getLineWidth:g.getLineWidth}}}_renderPolygonLayer(){const{data:t,getHexagon:e,updateTriggers:n,coverage:i}=this.props,r=this.getSubLayerClass("hexagon-cell-hifi",Z.A),o=this._getForwardProps();return o.updateTriggers.getPolygon=function(t,e){let n;return n=null==t?e:"object"==typeof t?{...t,coverage:e}:{getHexagon:t,coverage:e},n}(n.getHexagon,i),new r(o,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:o.updateTriggers}),{data:t,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(t,n)=>function(t){const e=new Float64Array(2*t.length);let n=0;for(const i of t)e[n++]=i[0],e[n++]=i[1];return e}(dt(e(t,n),i))})}_renderColumnLayer(){const{data:t,getHexagon:e,updateTriggers:n}=this.props,i=this.getSubLayerClass("hexagon-cell",ct),r=this._getForwardProps();return r.updateTriggers.getPosition=n.getHexagon,new i(r,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:r.updateTriggers}),{data:t,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:pt.bind(null,e)})}}const mt={...Z.A.defaultProps};class yt extends K.A{static{this.layerName="GeoCellLayer"}static{this.defaultProps=mt}indexToBounds(){return null}renderLayers(){const{elevationScale:t,extruded:e,wireframe:n,filled:i,stroked:r,lineWidthUnits:o,lineWidthScale:s,lineWidthMinPixels:a,lineWidthMaxPixels:A,lineJointRounded:u,lineMiterLimit:l,lineDashJustified:c,getElevation:h,getFillColor:f,getLineColor:p,getLineWidth:d}=this.props,{updateTriggers:g,material:_,transitions:m}=this.props,y=this.getSubLayerClass("cell",Z.A),{updateTriggers:v,...E}=this.indexToBounds()||{};return new y({filled:i,wireframe:n,extruded:e,elevationScale:t,stroked:r,lineWidthUnits:o,lineWidthScale:s,lineWidthMinPixels:a,lineWidthMaxPixels:A,lineJointRounded:u,lineMiterLimit:l,lineDashJustified:c,material:_,transitions:m,getElevation:h,getFillColor:f,getLineColor:p,getLineWidth:d},this.getSubLayerProps({id:"cell",updateTriggers:g&&{...v,getElevation:g.getElevation,getFillColor:g.getFillColor,getLineColor:g.getLineColor,getLineWidth:g.getLineWidth}}),E)}}const vt={getHexagons:{type:"accessor",value:t=>t.hexagons}};class Et extends yt{static{this.layerName="H3ClusterLayer"}static{this.defaultProps=vt}initializeState(){_t._checkH3Lib()}updateState({props:t,changeFlags:e}){if(e.dataChanged||e.updateTriggersChanged&&e.updateTriggersChanged.getHexagons){const{data:e,getHexagons:n}=t,i=[],{iterable:r,objectInfo:o}=(0,$.X)(e);for(const t of r){o.index++;const e=Y(n(t,o),!0);for(const n of e){for(const t of n)ft(t);i.push(this.getSubLayerRow({polygon:n},t,o.index))}}this.setState({polygons:i})}}indexToBounds(){const{getElevation:t,getFillColor:e,getLineColor:n,getLineWidth:i}=this.props;return{data:this.state.polygons,getPolygon:t=>t.polygon,getElevation:this.getSubLayerAccessor(t),getFillColor:this.getSubLayerAccessor(e),getLineColor:this.getSubLayerAccessor(n),getLineWidth:this.getSubLayerAccessor(i)}}}},8894:(t,e,n)=>{"use strict";n.d(e,{A:()=>w});var i=n(9452),r=n(6053);var o=n(7790),s=n(660),a=n(908),A=n(7167),u=n(9221);const l={circle:{type:s.A,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:o.A,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:a.A,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},c={type:A.A,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},h={type:u.A,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function f({type:t,props:e}){const n={};for(const i in e)n[i]=t.defaultProps[e[i]];return n}function p(t,e){const{transitions:n,updateTriggers:i}=t.props,r={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in e){const s=e[o];let a=t.props[o];o.startsWith("get")&&(a=t.getSubLayerAccessor(a),r.updateTriggers[s]=i[o],n&&(r.transitions[s]=n[o])),r[s]=a}return r}var d=n(3459);function g(t,e,n={}){const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:o=t.length}=n;for(let s=r;s<o;s++){const n=t[s],{geometry:r}=n;if(r)if("GeometryCollection"===r.type){d.A.assert(Array.isArray(r.geometries),"GeoJSON does not have geometries array");const{geometries:t}=r;for(let r=0;r<t.length;r++){_(t[r],i,e,n,s)}}else _(r,i,e,n,s)}return i}function _(t,e,n,i,r){const{type:o,coordinates:s}=t,{pointFeatures:a,lineFeatures:A,polygonFeatures:u,polygonOutlineFeatures:l}=e;if(function(t,e){let n=m[t];d.A.assert(n,`Unknown GeoJSON type ${t}`);for(;e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}(o,s))switch(o){case"Point":a.push(n({geometry:t},i,r));break;case"MultiPoint":s.forEach((t=>{a.push(n({geometry:{type:"Point",coordinates:t}},i,r))}));break;case"LineString":A.push(n({geometry:t},i,r));break;case"MultiLineString":s.forEach((t=>{A.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}));break;case"Polygon":u.push(n({geometry:t},i,r)),s.forEach((t=>{l.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}));break;case"MultiPolygon":s.forEach((t=>{u.push(n({geometry:{type:"Polygon",coordinates:t}},i,r)),t.forEach((t=>{l.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}))}))}else d.A.warn(`${o} coordinates are malformed`)()}const m={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function y(t){return t.geometry.coordinates}function v(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:i,lines:r,polygons:o}=t,s=function(t,e){const n={points:null,lines:null,polygons:null};for(const i in n){const r=t[i].globalFeatureIds.value;n[i]=new Uint8ClampedArray(3*r.length);const o=[];for(let t=0;t<r.length;t++)e(r[t],o),n[i][3*t+0]=o[0],n[i][3*t+1]=o[1],n[i][3*t+2]=o[2]}return n}(t,e);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:3,value:s.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:s.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{...o.attributes,getPolygon:o.positions,pickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}const E=["points","linestrings","polygons"],b={...f(l.circle),...f(l.icon),...f(l.text),...f(c),...f(h),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class w extends i.A{static{this.layerName="GeoJsonLayer"}static{this.defaultProps=b}initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState({props:t,changeFlags:e}){if(!e.dataChanged)return;const{data:n}=this.props,i=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:i}),i?this._updateStateBinary({props:t,changeFlags:e}):this._updateStateJSON({props:t,changeFlags:e})}_updateStateBinary({props:t,changeFlags:e}){const n=v(t.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:t,changeFlags:e}){const n=function(t){if(Array.isArray(t))return t;switch(d.A.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return d.A.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(t.data),i=this.getSubLayerRow.bind(this);let o={};const s={};if(Array.isArray(e.dataChanged)){const t=this.state.features;for(const e in t)o[e]=t[e].slice(),s[e]=[];for(const a of e.dataChanged){const e=g(n,i,a);for(const n in t)s[n].push((0,r.J)({data:o[n],getIndex:t=>t.__source.index,dataRange:a,replace:e[n]}))}}else o=g(n,i);const a=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:i,lineFeatures:r,polygonFeatures:o,polygonOutlineFeatures:s}=t;return n.points.data=i,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=y,n.lines.data=r,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=y,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=y,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=y,n}(o,s);this.setState({features:o,featuresDiff:s,layerProps:a})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n,sourceLayer:i}=e;return e.featureType=E.find((t=>i.id.startsWith(`${this.id}-${t}-`))),n>=0&&i.id.startsWith(`${this.id}-points-text`)&&this.state.binary&&(e.index=this.props.data.points.globalFeatureIds.value[n]),e}_updateAutoHighlight(t){const e=`${this.id}-points-`,n="points"===t.featureType;for(const i of this.getSubLayers())i.id.startsWith(e)===n&&i.updateAutoHighlight(t)}_renderPolygonLayer(){const{extruded:t,wireframe:e}=this.props,{layerProps:n}=this.state,i="polygons-fill",r=this.shouldRenderSubLayer(i,n.polygons?.data)&&this.getSubLayerClass(i,h.type);if(r){const o=p(this,h.props),s=t&&e;return s||delete o.getLineColor,o.updateTriggers.lineColors=s,new r(o,this.getSubLayerProps({id:i,updateTriggers:o.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:t,stroked:e}=this.props,{layerProps:n}=this.state,i="polygons-stroke",r="linestrings",o=!t&&e&&this.shouldRenderSubLayer(i,n.polygonsOutline?.data)&&this.getSubLayerClass(i,c.type),s=this.shouldRenderSubLayer(r,n.lines?.data)&&this.getSubLayerClass(r,c.type);if(o||s){const t=p(this,c.props);return[o&&new o(t,this.getSubLayerProps({id:i,updateTriggers:t.updateTriggers}),n.polygonsOutline),s&&new s(t,this.getSubLayerProps({id:r,updateTriggers:t.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:t}=this.props,{layerProps:e,binary:n}=this.state;let{highlightedObjectIndex:i}=this.props;!n&&Number.isFinite(i)&&(i=e.points.data.findIndex((t=>t.__source.index===i)));const r=new Set(t.split("+")),o=[];for(const s of r){const t=`points-${s}`,r=l[s],a=r&&this.shouldRenderSubLayer(t,e.points?.data)&&this.getSubLayerClass(t,r.type);if(a){const A=p(this,r.props);let u=e.points;if("text"===s&&n){const{instancePickingColors:t,...e}=u.data.attributes;u={...u,data:{...u.data,attributes:e}}}o.push(new a(A,this.getSubLayerProps({id:t,updateTriggers:A.updateTriggers,highlightedObjectIndex:i}),u))}}return o}renderLayers(){const{extruded:t}=this.props,e=this._renderPolygonLayer();return[!t&&e,this._renderLineLayers(),this._renderPointLayers(),t&&e]}getSubLayerAccessor(t){const{binary:e}=this.state;return e&&"function"==typeof t?(e,n)=>{const{data:i,index:r}=n,o=function(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,i=t.featureIds.value[n];return-1!==n?function(t,e,n){const i={properties:{...t.properties[e]}};for(const r in t.numericProps)i.properties[r]=t.numericProps[r].value[n];return i}(t,i,n):null}(i,r);return t(o,n)}:super.getSubLayerAccessor(t)}}},7790:(t,e,n)=>{"use strict";n.d(e,{A:()=>E});var i=n(688),r=n(4175),o=n(3349),s=n(9350),a=n(3459),A=n(9067),u=n(5337);var l=n(3022),c=n(3439);const h=()=>{},f={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},p={x:0,y:0,width:0,height:0};function d(t,e,n,i){const r=Math.min(n/e.width,i/e.height),o=Math.floor(e.width*r),s=Math.floor(e.height*r);return 1===r?{data:e,width:o,height:s}:(t.canvas.height=s,t.canvas.width=o,t.clearRect(0,0,o,s),t.drawImage(e,0,0,e.width,e.height,0,0,o,s),{data:t.canvas,width:o,height:s})}function g(t){return t&&(t.id||t.url)}function _(t,e,n){for(let i=0;i<e.length;i++){const{icon:r,xOffset:o}=e[i];t[g(r)]={...r,x:o,y:n}}}class m{constructor(t,{onUpdate:e=h,onError:n=h}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._textureParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null,this.device=t,this.onUpdate=e,this.onError=n}finalize(){this._texture?.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(t){const e=this._autoPacking?g(t):t;return this._mapping[e]||p}setProps({loadOptions:t,autoPacking:e,iconAtlas:n,iconMapping:i,textureParameters:r}){t&&(this._loadOptions=t),void 0!==e&&(this._autoPacking=e),i&&(this._mapping=i),n&&(this._texture?.delete(),this._texture=null,this._externalTexture=n),r&&(this._textureParameters=r)}get isLoaded(){return 0===this._pendingCount}packIcons(t,e){if(!this._autoPacking||"undefined"==typeof document)return;const n=Object.values(function(t,e,n){if(!t||!e)return null;n=n||{};const i={},{iterable:r,objectInfo:o}=(0,c.X)(t);for(const s of r){o.index++;const t=e(s,o),r=g(t);if(!t)throw new Error("Icon is missing.");if(!t.url)throw new Error("Icon url is missing.");i[r]||n[r]&&t.url===n[r].url||(i[r]={...t,source:s,sourceIndex:o.index})}return i}(t,e,this._mapping)||{});if(n.length>0){const{mapping:t,xOffset:e,yOffset:i,rowHeight:r,canvasHeight:o}=function({icons:t,buffer:e,mapping:n={},xOffset:i=0,yOffset:r=0,rowHeight:o=0,canvasWidth:s}){let a=[];for(let u=0;u<t.length;u++){const A=t[u];if(!n[g(A)]){const{height:t,width:u}=A;i+u+e>s&&(_(n,a,r),i=0,r=o+r+e,o=0,a=[]),a.push({icon:A,xOffset:i}),i=i+u+e,o=Math.max(o,t)}}return a.length>0&&_(n,a,r),{mapping:n,rowHeight:o,xOffset:i,yOffset:r,canvasWidth:s,canvasHeight:(A=o+r+e,Math.pow(2,Math.ceil(Math.log2(A))))};var A}({icons:n,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=r,this._mapping=t,this._xOffset=e,this._yOffset=i,this._canvasHeight=o,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",width:this._canvasWidth,height:this._canvasHeight,sampler:this._textureParameters||f})),this._texture.height!==this._canvasHeight&&(this._texture=function(t,e,n,i){const{width:r,height:o,device:s}=t,a=s.createTexture({format:"rgba8unorm",width:e,height:n,sampler:i}),A=s.createCommandEncoder();return A.copyTextureToTexture({source:t,destination:a,width:r,height:o}),A.finish(),t.destroy(),a}(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||f)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(n)}}_loadIcons(t){const e=this._canvas.getContext("2d",{willReadFrequently:!0});for(const n of t)this._pendingCount++,(0,l.H)(n.url,this._loadOptions).then((t=>{const i=g(n),r=this._mapping[i],{x:o,y:s,width:a,height:A}=r,{data:u,width:l,height:c}=d(e,t,a,A);this._texture.setSubImageData({data:u,x:o+(a-l)/2,y:s+(A-c)/2,width:l,height:c}),r.width=l,r.height=c,this._texture.generateMipmap(),this.onUpdate()})).catch((t=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:t})})).finally((()=>{this._pendingCount--}))}}const y=[0,0,0,255],v={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:y},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}};class E extends i.A{static{this.defaultProps=v}static{this.layerName="IconLayer"}getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME icon-layer-vertex-shader\nin vec2 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin float instanceSizes;\nin float instanceAngles;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin vec4 instanceIconFrames;\nin float instanceColorModes;\nin vec2 instanceOffsets;\nin vec2 instancePixelOffset;\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\nout float vColorMode;\nout vec4 vColor;\nout vec2 vTextureCoords;\nout vec2 uv;\nvec2 rotate_by_angle(vec2 vertex, float angle) {\nfloat angle_radian = angle * PI / 180.0;\nfloat cos_angle = cos(angle_radian);\nfloat sin_angle = sin(angle_radian);\nmat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\nreturn rotationMatrix * vertex;\n}\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.uv = positions;\ngeometry.pickingColor = instancePickingColors;\nuv = positions;\nvec2 iconSize = instanceIconFrames.zw;\nfloat sizePixels = clamp(\nproject_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\nsizeMinPixels, sizeMaxPixels\n);\nfloat instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\nvec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\npixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\npixelOffset += instancePixelOffset;\npixelOffset.y *= -1.0;\nif (billboard)  {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = vec3(pixelOffset, 0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\nDECKGL_FILTER_SIZE(offset_common, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvTextureCoords = mix(\ninstanceIconFrames.xy,\ninstanceIconFrames.xy + iconSize,\n(positions.xy + 1.0) / 2.0\n) / iconsTextureDim;\nvColor = instanceColors;\nDECKGL_FILTER_COLOR(vColor, geometry);\nvColorMode = instanceColorModes;\n}\n",fs:"#version 300 es\n#define SHADER_NAME icon-layer-fragment-shader\nprecision highp float;\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\nin float vColorMode;\nin vec4 vColor;\nin vec2 vTextureCoords;\nin vec2 uv;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nvec4 texColor = texture(iconsTexture, vTextureCoords);\nvec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\nfloat a = texColor.a * opacity * vColor.a;\nif (a < alphaCutoff) {\ndiscard;\n}\nfragColor = vec4(color, a);\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[r.A,o.A]})}initializeState(){this.state={iconManager:new m(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})};this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:y},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:i}=t,r=this.getAttributeManager(),{iconAtlas:o,iconMapping:s,data:a,getIcon:A,textureParameters:u}=e,{iconManager:l}=this.state;if("string"==typeof o)return;const c=o||this.internalState.isAsyncPropLoading("iconAtlas");l.setProps({loadOptions:e.loadOptions,autoPacking:!c,iconAtlas:o,iconMapping:c?s:null,textureParameters:u}),c?n.iconMapping!==e.iconMapping&&r.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&l.packIcons(a,A),i.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),r.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(t){super.finalizeState(t),this.state.iconManager.finalize()}draw({uniforms:t}){const{sizeScale:e,sizeMinPixels:n,sizeMaxPixels:i,sizeUnits:r,billboard:o,alphaCutoff:a}=this.props,{iconManager:A}=this.state,u=A.getTexture();if(u){const A=this.state.model;A.setBindings({iconsTexture:u}),A.setUniforms(t),A.setUniforms({iconsTextureDim:[u.width,u.height],sizeUnits:s.p5[r],sizeScale:e,sizeMinPixels:n,sizeMaxPixels:i,billboard:o,alphaCutoff:a}),A.draw(this.context.renderPass)}}_getModel(){return new A.K(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new u.V({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([-1,-1,1,-1,-1,1,1,1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(t){const e=this.getCurrentLayer()?.props.onIconError;e?e(t):a.A.error(t.error.message)()}getInstanceOffset(t){const{width:e,height:n,anchorX:i=e/2,anchorY:r=n/2}=this.state.iconManager.getIconMapping(t);return[e/2-i,n/2-r]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){const{x:e,y:n,width:i,height:r}=this.state.iconManager.getIconMapping(t);return[e,n,i,r]}}},772:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});var i=n(688),r=n(4175),o=n(3349),s=n(9350),a=n(5337),A=n(9067);const u={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getColor:{type:"accessor",value:[0,0,0,255]},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class l extends i.A{static{this.layerName="LineLayer"}static{this.defaultProps=u}getBounds(){return this.getAttributeManager()?.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME line-layer-vertex-shader\nin vec3 positions;\nin vec3 instanceSourcePositions;\nin vec3 instanceTargetPositions;\nin vec3 instanceSourcePositions64Low;\nin vec3 instanceTargetPositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin float instanceWidths;\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float useShortestPath;\nuniform int widthUnits;\nout vec4 vColor;\nout vec2 uv;\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\nvec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\ndir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\nreturn dir_screenspace * offset_direction * width / 2.0;\n}\nvec3 splitLine(vec3 a, vec3 b, float x) {\nfloat t = (x - a.x) / (b.x - a.x);\nreturn vec3(x, mix(a.yz, b.yz, t));\n}\nvoid main(void) {\ngeometry.worldPosition = instanceSourcePositions;\ngeometry.worldPositionAlt = instanceTargetPositions;\nvec3 source_world = instanceSourcePositions;\nvec3 target_world = instanceTargetPositions;\nvec3 source_world_64low = instanceSourcePositions64Low;\nvec3 target_world_64low = instanceTargetPositions64Low;\nif (useShortestPath > 0.5 || useShortestPath < -0.5) {\nsource_world.x = mod(source_world.x + 180., 360.0) - 180.;\ntarget_world.x = mod(target_world.x + 180., 360.0) - 180.;\nfloat deltaLng = target_world.x - source_world.x;\nif (deltaLng * useShortestPath > 180.) {\nsource_world.x += 360. * useShortestPath;\nsource_world = splitLine(source_world, target_world, 180. * useShortestPath);\nsource_world_64low = vec3(0.0);\n} else if (deltaLng * useShortestPath < -180.) {\ntarget_world.x += 360. * useShortestPath;\ntarget_world = splitLine(source_world, target_world, 180. * useShortestPath);\ntarget_world_64low = vec3(0.0);\n} else if (useShortestPath < 0.) {\ngl_Position = vec4(0.);\nreturn;\n}\n}\nvec4 source_commonspace;\nvec4 target_commonspace;\nvec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);\nvec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);\nfloat segmentIndex = positions.x;\nvec4 p = mix(source, target, segmentIndex);\ngeometry.position = mix(source_commonspace, target_commonspace, segmentIndex);\nuv = positions.xy;\ngeometry.uv = uv;\ngeometry.pickingColor = instancePickingColors;\nfloat widthPixels = clamp(\nproject_size_to_pixel(instanceWidths * widthScale, widthUnits),\nwidthMinPixels, widthMaxPixels\n);\nvec3 offset = vec3(\ngetExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),\n0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\nDECKGL_FILTER_GL_POSITION(p, geometry);\ngl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\nvColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME line-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nin vec2 uv;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nfragColor = vColor;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[r.A,o.A]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState(t){super.updateState(t),t.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:t}){const{widthUnits:e,widthScale:n,widthMinPixels:i,widthMaxPixels:r,wrapLongitude:o}=this.props,a=this.state.model;a.setUniforms(t),a.setUniforms({widthUnits:s.p5[e],widthScale:n,widthMinPixels:i,widthMaxPixels:r,useShortestPath:o?1:0}),a.draw(this.context.renderPass),o&&(a.setUniforms({useShortestPath:-1}),a.draw(this.context.renderPass))}_getModel(){return new A.K(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new a.V({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array([0,-1,0,0,1,0,1,-1,0,1,1,0])}}}),isInstanced:!0})}}},7167:(t,e,n)=>{"use strict";n.d(e,{A:()=>g});var i=n(688),r=n(4175),o=n(3349),s=n(9350),a=n(5337),A=n(9067),u=n(4941),l=n(1746);class c extends u.A{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(t){return this.attributes[t]}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):null}normalizeGeometry(t){return this.normalize?function(t,e,n,i){let r;if(Array.isArray(t[0])){const n=t.length*e;r=new Array(n);for(let i=0;i<t.length;i++)for(let n=0;n<e;n++)r[i*e+n]=t[i][n]||0}else r=t;return n?(0,l.Mk)(r,{size:e,gridResolution:n}):i?(0,l.Iy)(r,{size:e}):r}(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}getGeometrySize(t){if(h(t)){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}const e=this.getPathLength(t);return e<2?0:this.isClosed(t)?e<3?0:e+2:e}updateGeometryAttributes(t,e){if(0!==e.geometrySize)if(t&&h(t))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}_updateSegmentTypes(t,e){const n=this.attributes.segmentTypes,i=!!t&&this.isClosed(t),{vertexStart:r,geometrySize:o}=e;n.fill(0,r,r+o),i?(n[r]=4,n[r+o-2]=4):(n[r]+=1,n[r+o-2]+=2),n[r+o-1]=4}_updatePositions(t,e){const{positions:n}=this.attributes;if(!n||!t)return;const{vertexStart:i,geometrySize:r}=e,o=new Array(3);for(let s=i,a=0;a<r;s++,a++)this.getPointOnPath(t,a,o),n[3*s]=o[0],n[3*s+1]=o[1],n[3*s+2]=o[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,e,n=[]){const{positionSize:i}=this;e*i>=t.length&&(e+=1-t.length/i);const r=e*i;return n[0]=t[r],n[1]=t[r+1],n[2]=3===i&&t[r+2]||0,n}isClosed(t){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:e}=this,n=t.length-e;return t[0]===t[n]&&t[1]===t[n+1]&&(2===e||t[2]===t[n+2])}}function h(t){return Array.isArray(t[0])}const f=[0,0,0,255],p={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:f},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},d={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class g extends i.A{static{this.defaultProps=p}static{this.layerName="PathLayer"}getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME path-layer-vertex-shader\nin vec2 positions;\nin float instanceTypes;\nin vec3 instanceStartPositions;\nin vec3 instanceEndPositions;\nin vec3 instanceLeftPositions;\nin vec3 instanceRightPositions;\nin vec3 instanceLeftPositions64Low;\nin vec3 instanceStartPositions64Low;\nin vec3 instanceEndPositions64Low;\nin vec3 instanceRightPositions64Low;\nin float instanceStrokeWidths;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\nuniform float opacity;\nout vec4 vColor;\nout vec2 vCornerOffset;\nout float vMiterLength;\nout vec2 vPathPosition;\nout float vPathLength;\nout float vJointType;\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\nfloat flipIfTrue(bool flag) {\nreturn -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\nvec3 prevPoint, vec3 currPoint, vec3 nextPoint,\nvec2 width\n) {\nbool isEnd = positions.x > 0.0;\nfloat sideOfPath = positions.y;\nfloat isJoint = float(sideOfPath == 0.0);\nvec3 deltaA3 = (currPoint - prevPoint);\nvec3 deltaB3 = (nextPoint - currPoint);\nmat3 rotationMatrix;\nbool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\nif (needsRotation) {\ndeltaA3 = deltaA3 * rotationMatrix;\ndeltaB3 = deltaB3 * rotationMatrix;\n}\nvec2 deltaA = deltaA3.xy / width;\nvec2 deltaB = deltaB3.xy / width;\nfloat lenA = length(deltaA);\nfloat lenB = length(deltaB);\nvec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\nvec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\nvec2 perpA = vec2(-dirA.y, dirA.x);\nvec2 perpB = vec2(-dirB.y, dirB.x);\nvec2 tangent = dirA + dirB;\ntangent = length(tangent) > 0. ? normalize(tangent) : perpA;\nvec2 miterVec = vec2(-tangent.y, tangent.x);\nvec2 dir = isEnd ? dirA : dirB;\nvec2 perp = isEnd ? perpA : perpB;\nfloat L = isEnd ? lenA : lenB;\nfloat sinHalfA = abs(dot(miterVec, perp));\nfloat cosHalfA = abs(dot(dirA, miterVec));\nfloat turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\nfloat cornerPosition = sideOfPath * turnDirection;\nfloat miterSize = 1.0 / max(sinHalfA, EPSILON);\nmiterSize = mix(\nmin(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\nmiterSize,\nstep(0.0, cornerPosition)\n);\nvec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n* (sideOfPath + isJoint * turnDirection);\nbool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\nbool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\nbool isCap = isStartCap || isEndCap;\nif (isCap) {\noffsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\nvJointType = capType;\n} else {\nvJointType = jointType;\n}\nvPathLength = L;\nvCornerOffset = offsetVec;\nvMiterLength = dot(vCornerOffset, miterVec * turnDirection);\nvMiterLength = isCap ? isJoint : vMiterLength;\nvec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\nvPathPosition = vec2(\ndot(offsetFromStartOfPath, perp),\ndot(offsetFromStartOfPath, dir)\n);\ngeometry.uv = vPathPosition;\nfloat isValid = step(instanceTypes, 3.5);\nvec3 offset = vec3(offsetVec * width * isValid, 0.0);\nif (needsRotation) {\noffset = rotationMatrix * offset;\n}\nreturn offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\nif (position.w < EPSILON) {\nfloat r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\nposition = refPosition + (position - refPosition) * r;\n}\n}\nvoid main() {\ngeometry.pickingColor = instancePickingColors;\nvColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\nfloat isEnd = positions.x;\nvec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\nvec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\nvec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\nvec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\nvec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\nvec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\ngeometry.worldPosition = currPosition;\nvec2 widthPixels = vec2(clamp(\nproject_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\nwidthMinPixels, widthMaxPixels) / 2.0);\nvec3 width;\nif (billboard) {\nvec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\nvec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\nvec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\nclipLine(prevPositionScreen, currPositionScreen);\nclipLine(nextPositionScreen, currPositionScreen);\nclipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\nwidth = vec3(widthPixels, 0.0);\nDECKGL_FILTER_SIZE(width, geometry);\nvec3 offset = getLineJoinOffset(\nprevPositionScreen.xyz / prevPositionScreen.w,\ncurrPositionScreen.xyz / currPositionScreen.w,\nnextPositionScreen.xyz / nextPositionScreen.w,\nproject_pixel_size_to_clipspace(width.xy)\n);\nDECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\ngl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n} else {\nprevPosition = project_position(prevPosition, prevPosition64Low);\ncurrPosition = project_position(currPosition, currPosition64Low);\nnextPosition = project_position(nextPosition, nextPosition64Low);\nwidth = vec3(project_pixel_size(widthPixels), 0.0);\nDECKGL_FILTER_SIZE(width, geometry);\nvec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\ngeometry.position = vec4(currPosition + offset, 1.0);\ngl_Position = project_common_position_to_clipspace(geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME path-layer-fragment-shader\nprecision highp float;\nuniform float miterLimit;\nin vec4 vColor;\nin vec2 vCornerOffset;\nin float vMiterLength;\nin vec2 vPathPosition;\nin float vPathLength;\nin float vJointType;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = vPathPosition;\nif (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\nif (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\ndiscard;\n}\nif (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\ndiscard;\n}\n}\nfragColor = vColor;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[r.A,o.A]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){const t=!0;this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:d,accessor:"getPath",update:this.calculatePositions,noAlloc:t,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:t},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:d,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:d,defaultValue:f},instancePickingColors:{size:4,type:"uint8",accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n)}}),this.setState({pathTesselator:new c({fp64:this.use64bitPositions()})})}updateState(t){super.updateState(t);const{props:e,changeFlags:n}=t,i=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:t}=this.state,r=e.data.attributes||{};t.updateGeometry({data:e.data,geometryBuffer:r.getPath,buffers:r,normalize:!e._pathType,loop:"loop"===e._pathType,getGeometry:e.getPath,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),n.dataChanged||i.invalidateAll()}n.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),i.invalidateAll())}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,i=this.props.data;return i[0]&&i[0].__source&&(e.object=i.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const e=this.props.data;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else super.disablePickingIndex(t)}draw({uniforms:t}){const{jointRounded:e,capRounded:n,billboard:i,miterLimit:r,widthUnits:o,widthScale:a,widthMinPixels:A,widthMaxPixels:u}=this.props,l=this.state.model;l.setUniforms(t),l.setUniforms({jointType:Number(e),capType:Number(n),billboard:i,widthUnits:s.p5[o],widthScale:a,miterLimit:r,widthMinPixels:A,widthMaxPixels:u}),l.draw(this.context.renderPass)}_getModel(){return new A.K(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new a.V({topology:"triangle-list",attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateSegmentTypes(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("segmentTypes")}}},9751:(t,e,n)=>{"use strict";n.d(e,{A:()=>h});var i=n(9452),r=n(3459),o=n(3439),s=n(9221),a=n(7167),A=n(1661),u=n(6053);const l=[0,0,0,255],c={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:l},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class h extends i.A{static{this.layerName="PolygonLayer"}static{this.defaultProps=c}initializeState(){this.state={paths:[],pathsDiff:null},this.props.getLineDashArray&&r.A.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:t}){const e=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getPolygon);if(e&&Array.isArray(t.dataChanged)){const e=this.state.paths.slice(),n=t.dataChanged.map((t=>(0,u.J)({data:e,getIndex:t=>t.__source.index,dataRange:t,replace:this._getPaths(t)})));this.setState({paths:e,pathsDiff:n})}else e&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(t={}){const{data:e,getPolygon:n,positionFormat:i,_normalize:r}=this.props,s=[],a="XY"===i?2:3,{startRow:u,endRow:l}=t,{iterable:c,objectInfo:h}=(0,o.X)(e,u,l);for(const o of c){h.index++;let t=n(o,h);r&&(t=A.S8(t,a));const{holeIndices:e}=t,i=t.positions||t;if(e)for(let n=0;n<=e.length;n++){const t=i.slice(e[n-1]||0,e[n]||i.length);s.push(this.getSubLayerRow({path:t},o,h.index))}else s.push(this.getSubLayerRow({path:i},o,h.index))}return s}renderLayers(){const{data:t,_dataDiff:e,stroked:n,filled:i,extruded:r,wireframe:o,_normalize:A,_windingOrder:u,elevationScale:c,transitions:h,positionFormat:f}=this.props,{lineWidthUnits:p,lineWidthScale:d,lineWidthMinPixels:g,lineWidthMaxPixels:_,lineJointRounded:m,lineMiterLimit:y,lineDashJustified:v}=this.props,{getFillColor:E,getLineColor:b,getLineWidth:w,getLineDashArray:x,getElevation:S,getPolygon:C,updateTriggers:T,material:I}=this.props,{paths:R,pathsDiff:P}=this.state,M=this.getSubLayerClass("fill",s.A),L=this.getSubLayerClass("stroke",a.A),N=this.shouldRenderSubLayer("fill",R)&&new M({_dataDiff:e,extruded:r,elevationScale:c,filled:i,wireframe:o,_normalize:A,_windingOrder:u,getElevation:S,getFillColor:E,getLineColor:r&&o?b:l,material:I,transitions:h},this.getSubLayerProps({id:"fill",updateTriggers:T&&{getPolygon:T.getPolygon,getElevation:T.getElevation,getFillColor:T.getFillColor,lineColors:r&&o,getLineColor:T.getLineColor}}),{data:t,positionFormat:f,getPolygon:C});return[!r&&N,!r&&n&&this.shouldRenderSubLayer("stroke",R)&&new L({_dataDiff:P&&(()=>P),widthUnits:p,widthScale:d,widthMinPixels:g,widthMaxPixels:_,jointRounded:m,miterLimit:y,dashJustified:v,_pathType:"loop",transitions:h&&{getWidth:h.getLineWidth,getColor:h.getLineColor,getPath:h.getPolygon},getColor:this.getSubLayerAccessor(b),getWidth:this.getSubLayerAccessor(w),getDashArray:this.getSubLayerAccessor(x)},this.getSubLayerProps({id:"stroke",updateTriggers:T&&{getWidth:T.getLineWidth,getColor:T.getLineColor,getDashArray:T.getLineDashArray}}),{data:R,positionFormat:f,getPath:t=>t.path}),r&&N]}}},660:(t,e,n)=>{"use strict";n.d(e,{A:()=>c});var i=n(688),r=n(4175),o=n(3349),s=n(9350),a=n(5337),A=n(9067);const u=[0,0,0,255],l={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:u},getLineColor:{type:"accessor",value:u},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class c extends i.A{static{this.defaultProps=l}static{this.layerName="ScatterplotLayer"}getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME scatterplot-layer-vertex-shader\nin vec3 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin float instanceRadius;\nin float instanceLineWidths;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin vec3 instancePickingColors;\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\nout vec4 vFillColor;\nout vec4 vLineColor;\nout vec2 unitPosition;\nout float innerUnitRadius;\nout float outerRadiusPixels;\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\nouterRadiusPixels = clamp(\nproject_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\nradiusMinPixels, radiusMaxPixels\n);\nfloat lineWidthPixels = clamp(\nproject_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\nlineWidthMinPixels, lineWidthMaxPixels\n);\nouterRadiusPixels += stroked * lineWidthPixels / 2.0;\nfloat edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\nunitPosition = edgePadding * positions.xy;\ngeometry.uv = unitPosition;\ngeometry.pickingColor = instancePickingColors;\ninnerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\nif (billboard) {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = edgePadding * positions * outerRadiusPixels;\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\nDECKGL_FILTER_COLOR(vFillColor, geometry);\nvLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\nDECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME scatterplot-layer-fragment-shader\nprecision highp float;\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\nin vec4 vFillColor;\nin vec4 vLineColor;\nin vec2 unitPosition;\nin float innerUnitRadius;\nin float outerRadiusPixels;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = unitPosition;\nfloat distToCenter = length(unitPosition) * outerRadiusPixels;\nfloat inCircle = antialiasing ?\nsmoothedge(distToCenter, outerRadiusPixels) :\nstep(distToCenter, outerRadiusPixels);\nif (inCircle == 0.0) {\ndiscard;\n}\nif (stroked > 0.5) {\nfloat isLine = antialiasing ?\nsmoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\nstep(innerUnitRadius * outerRadiusPixels, distToCenter);\nif (filled) {\nfragColor = mix(vFillColor, vLineColor, isLine);\n} else {\nif (isLine == 0.0) {\ndiscard;\n}\nfragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n}\n} else if (!filled) {\ndiscard;\n} else {\nfragColor = vFillColor;\n}\nfragColor.a *= inCircle;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[r.A,o.A]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){super.updateState(t),t.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:t}){const{radiusUnits:e,radiusScale:n,radiusMinPixels:i,radiusMaxPixels:r,stroked:o,filled:a,billboard:A,antialiasing:u,lineWidthUnits:l,lineWidthScale:c,lineWidthMinPixels:h,lineWidthMaxPixels:f}=this.props,p=this.state.model;p.setUniforms(t),p.setUniforms({stroked:o?1:0,filled:a,billboard:A,antialiasing:u,radiusUnits:s.p5[e],radiusScale:n,radiusMinPixels:i,radiusMaxPixels:r,lineWidthUnits:s.p5[l],lineWidthScale:c,lineWidthMinPixels:h,lineWidthMaxPixels:f}),p.draw(this.context.renderPass)}_getModel(){return new A.K(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new a.V({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,-1,1,0,1,1,0])}}}),isInstanced:!0})}}},1661:(t,e,n)=>{"use strict";n.d(e,{$q:()=>d,A4:()=>u,Dt:()=>A,S8:()=>h});var i=n(6570),r=n(1746);const o=r.rJ.CLOCKWISE,s=r.rJ.COUNTER_CLOCKWISE,a={isClosed:!0};function A(t){return"positions"in t?t.positions:t}function u(t){return"holeIndices"in t?t.holeIndices:null}function l(t,e,n,i,o){let s=e;const A=n.length;for(let r=0;r<A;r++)for(let e=0;e<i;e++)t[s++]=n[r][e]||0;if(!function(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}(n))for(let r=0;r<i;r++)t[s++]=n[0][r]||0;return a.start=e,a.end=s,a.size=i,(0,r.UD)(t,o,a),s}function c(t,e,n,i,o=0,s,A){const u=(s=s||n.length)-o;if(u<=0)return e;let l=e;for(let r=0;r<u;r++)t[l++]=n[o+r];if(!function(t,e,n,i){for(let r=0;r<e;r++)if(t[n+r]!==t[i-e+r])return!1;return!0}(n,i,o,s))for(let r=0;r<i;r++)t[l++]=n[o+r];return a.start=e,a.end=l,a.size=i,(0,r.UD)(t,A,a),l}function h(t,e){!function(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}(t);const n=[],i=[];if("positions"in t){const{positions:r,holeIndices:a}=t;if(a){let t=0;for(let A=0;A<=a.length;A++)t=c(n,t,r,e,a[A-1],a[A],0===A?o:s),i.push(t);return i.pop(),{positions:n,holeIndices:i}}t=r}if(!function(t){return Array.isArray(t[0])}(t))return c(n,0,t,e,0,n.length,o),n;if(!function(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}(t)){let r=0;for(const[a,A]of t.entries())r=l(n,r,A,e,0===a?o:s),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return l(n,0,t,e,o),n}function f(t,e,n){const i=t.length/3;let r=0;for(let o=0;o<i;o++){const s=(o+1)%i;r+=t[3*o+e]*t[3*s+n],r-=t[3*s+e]*t[3*o+n]}return Math.abs(r/2)}function p(t,e,n,i){const r=t.length/3;for(let o=0;o<r;o++){const r=3*o,s=t[r+0],a=t[r+1],A=t[r+2];t[r+e]=s,t[r+n]=a,t[r+i]=A}}function d(t,e,n,r){let o=u(t);o&&(o=o.map((t=>t/e)));let s=A(t);const a=r&&3===e;if(n){const t=s.length;s=s.slice();const i=[];for(let r=0;r<t;r+=e){i[0]=s[r],i[1]=s[r+1],a&&(i[2]=s[r+2]);const t=n(i);s[r]=t[0],s[r+1]=t[1],a&&(s[r+2]=t[2])}}if(a){const t=f(s,0,1),e=f(s,0,2),i=f(s,1,2);if(!t&&!e&&!i)return[];t>e&&t>i||(e>i?(n||(s=s.slice()),p(s,0,2,1)):(n||(s=s.slice()),p(s,2,0,1)))}return i(s,o,e)}},9221:(t,e,n)=>{"use strict";n.d(e,{A:()=>E});var i=n(688),r=n(4175),o=n(9105),s=n(3349),a=n(9350),A=n(9067),u=n(5337),l=n(1661),c=n(4941),h=n(1746);class f extends c.A{constructor(t){const{fp64:e,IndexType:n=Uint32Array}=t;super({...t,attributes:{positions:{size:3,type:e?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:n,size:1}}})}get(t){const{attributes:e}=this;return"indices"===t?e.indices&&e.indices.subarray(0,this.vertexCount):e[t]}updateGeometry(t){super.updateGeometry(t);const e=this.buffers.indices;if(e)this.vertexCount=(e.value||e).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(t){if(this.normalize){const e=l.S8(t,this.positionSize);return this.opts.resolution?(0,h.wk)(l.Dt(e),l.A4(e),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?(0,h.Eg)(l.Dt(e),l.A4(e),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):e}return t}getGeometrySize(t){if(p(t)){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}return l.Dt(t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):null}updateGeometryAttributes(t,e){if(t&&p(t))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t,e.indexStart=this.indexStarts[e.geometryIndex+1]}else{const n=t;this._updateIndices(n,e),this._updatePositions(n,e),this._updateVertexValid(n,e)}}_updateIndices(t,{geometryIndex:e,vertexStart:n,indexStart:i}){const{attributes:r,indexStarts:o,typedArrayManager:s}=this;let a=r.indices;if(!a||!t)return;let A=i;const u=l.$q(t,this.positionSize,this.opts.preproject,this.opts.full3d);a=s.allocate(a,i+u.length,{copy:!0});for(let l=0;l<u.length;l++)a[A++]=u[l]+n;o[e+1]=i+u.length,r.indices=a}_updatePositions(t,{vertexStart:e,geometrySize:n}){const{attributes:{positions:i},positionSize:r}=this;if(!i||!t)return;const o=l.Dt(t);for(let s=e,a=0;a<n;s++,a++){const t=o[a*r],e=o[a*r+1],n=r>2?o[a*r+2]:0;i[3*s]=t,i[3*s+1]=e,i[3*s+2]=n}}_updateVertexValid(t,{vertexStart:e,geometrySize:n}){const{positionSize:i}=this,r=this.attributes.vertexValid,o=t&&l.A4(t);if(t&&t.edgeTypes?r.set(t.edgeTypes,e):r.fill(1,e,e+n),o)for(let s=0;s<o.length;s++)r[e+o[s]/i-1]=0;r[e+n-1]=0}}function p(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const d="uniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\nout vec4 vColor;\nstruct PolygonProps {\nvec4 fillColors;\nvec4 lineColors;\nvec3 positions;\nvec3 positions64Low;\nvec3 pickingColors;\nvec3 normal;\nfloat elevations;\n};\nvec3 project_offset_normal(vec3 vector) {\nif (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\nproject_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\nreturn normalize(vector * project_uCommonUnitsPerWorldUnit);\n}\nreturn project_normal(vector);\n}\nvoid calculatePosition(PolygonProps props) {\nvec3 pos = props.positions;\nvec3 pos64Low = props.positions64Low;\nvec3 normal = props.normal;\nvec4 colors = isWireframe ? props.lineColors : props.fillColors;\ngeometry.worldPosition = props.positions;\ngeometry.pickingColor = props.pickingColors;\nif (extruded) {\npos.z += props.elevations * elevationScale;\n}\ngl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nif (extruded) {\n#ifdef IS_SIDE_VERTEX\nnormal = project_offset_normal(normal);\n#else\nnormal = project_normal(normal);\n#endif\ngeometry.normal = normal;\nvec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\nvColor = vec4(lightColor, colors.a * opacity);\n} else {\nvColor = vec4(colors.rgb, colors.a * opacity);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",g=`#version 300 es\n#define SHADER_NAME solid-polygon-layer-vertex-shader\nin vec3 vertexPositions;\nin vec3 vertexPositions64Low;\nin float elevations;\nin vec4 fillColors;\nin vec4 lineColors;\nin vec3 pickingColors;\n${d}\nvoid main(void) {\nPolygonProps props;\nprops.positions = vertexPositions;\nprops.positions64Low = vertexPositions64Low;\nprops.elevations = elevations;\nprops.fillColors = fillColors;\nprops.lineColors = lineColors;\nprops.pickingColors = pickingColors;\nprops.normal = vec3(0.0, 0.0, 1.0);\ncalculatePosition(props);\n}\n`,_=`#version 300 es\n#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\nin vec2 positions;\nin vec3 instancePositions;\nin vec3 instanceNextPositions;\nin vec3 instancePositions64Low;\nin vec3 instanceNextPositions64Low;\nin float instanceElevations;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin vec3 instancePickingColors;\nin float instanceVertexValid;\n${d}\nvoid main(void) {\nif(instanceVertexValid < 0.5){\ngl_Position = vec4(0.);\nreturn;\n}\nPolygonProps props;\nvec3 pos;\nvec3 pos64Low;\nvec3 nextPos;\nvec3 nextPos64Low;\n#if RING_WINDING_ORDER_CW == 1\npos = instancePositions;\npos64Low = instancePositions64Low;\nnextPos = instanceNextPositions;\nnextPos64Low = instanceNextPositions64Low;\n#else\npos = instanceNextPositions;\npos64Low = instanceNextPositions64Low;\nnextPos = instancePositions;\nnextPos64Low = instancePositions64Low;\n#endif\nprops.positions = mix(pos, nextPos, positions.x);\nprops.positions64Low = mix(pos64Low, nextPos64Low, positions.x);\nprops.normal = vec3(\npos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),\nnextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),\n0.0);\nprops.elevations = instanceElevations * positions.y;\nprops.fillColors = instanceFillColors;\nprops.lineColors = instanceLineColors;\nprops.pickingColors = instancePickingColors;\ncalculatePosition(props);\n}\n`,m=[0,0,0,255],y={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:m},getLineColor:{type:"accessor",value:m},material:!0},v={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class E extends i.A{static{this.defaultProps=y}static{this.layerName="SolidPolygonLayer"}getShaders(t){return super.getShaders({vs:"top"===t?g:_,fs:"#version 300 es\n#define SHADER_NAME solid-polygon-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nout vec4 fragColor;\nvoid main(void) {\nfragColor = vColor;\ngeometry.uv = vec2(0.);\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[r.A,o.K,s.A]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){const{viewport:t}=this.context;let{coordinateSystem:e}=this.props;const{_full3d:n}=this.props;let i;t.isGeospatial&&e===a.rf.DEFAULT&&(e=a.rf.LNGLAT),e===a.rf.LNGLAT&&(i=n?t.projectPosition.bind(t):t.projectFlat.bind(t)),this.setState({numInstances:0,polygonTesselator:new f({preproject:i,fp64:this.use64bitPositions(),IndexType:Uint32Array})});const r=this.getAttributeManager(),o=!0;r.remove(["instancePickingColors"]),r.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:o},vertexPositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:v,accessor:"getPolygon",update:this.calculatePositions,noAlloc:o,shaderAttributes:{instancePositions:{vertexOffset:0,divisor:1},instanceNextPositions:{vertexOffset:1,divisor:1}}},instanceVertexValid:{size:1,type:"uint16",divisor:1,update:this.calculateVertexValid,noAlloc:o},elevations:{size:1,transition:v,accessor:"getElevation",shaderAttributes:{instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:v,accessor:"getFillColor",defaultValue:m,shaderAttributes:{instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:v,accessor:"getLineColor",defaultValue:m,shaderAttributes:{instanceLineColors:{divisor:1}}},pickingColors:{size:4,type:"uint8",accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n),shaderAttributes:{instancePickingColors:{divisor:1}}}})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,i=this.props.data;return i[0]&&i[0].__source&&(e.object=i.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const e=this.props.data;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else super.disablePickingIndex(t)}draw({uniforms:t}){const{extruded:e,filled:n,wireframe:i,elevationScale:r}=this.props,{topModel:o,sideModel:s,wireframeModel:a,polygonTesselator:A}=this.state,u={...t,extruded:Boolean(e),elevationScale:r};a&&i&&(a.setInstanceCount(A.instanceCount-1),a.setUniforms(u),a.draw(this.context.renderPass)),s&&n&&(s.setInstanceCount(A.instanceCount-1),s.setUniforms(u),s.draw(this.context.renderPass)),o&&n&&(o.setVertexCount(A.vertexCount),o.setUniforms(u),o.draw(this.context.renderPass))}updateState(t){super.updateState(t),this.updateGeometry(t);const{props:e,oldProps:n,changeFlags:i}=t,r=this.getAttributeManager();(i.extensionsChanged||e.filled!==n.filled||e.extruded!==n.extruded)&&(this.state.models?.forEach((t=>t.destroy())),this.setState(this._getModels()),r.invalidateAll())}updateGeometry({props:t,oldProps:e,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){const{polygonTesselator:e}=this.state,i=t.data.attributes||{};e.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:i.getPolygon,buffers:i,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged,full3d:t._full3d}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){const{id:t,filled:e,extruded:n}=this.props;let i,r,o;const s=this.getAttributeManager().getBufferLayouts();if(e){const e=this.getShaders("top");e.defines.NON_INSTANCED_MODEL=1,i=new A.K(this.context.device,{...e,id:`${t}-top`,topology:"triangle-list",uniforms:{isWireframe:!1},bufferLayout:s,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}return n&&(r=new A.K(this.context.device,{...this.getShaders("side"),id:`${t}-side`,bufferLayout:s,uniforms:{isWireframe:!1},geometry:new u.V({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),o=new A.K(this.context.device,{...this.getShaders("side"),id:`${t}-wireframe`,bufferLayout:s,uniforms:{isWireframe:!0},geometry:new u.V({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})),{models:[r,o,i].filter(Boolean),topModel:i,sideModel:r,wireframeModel:o}}calculateIndices(t){const{polygonTesselator:e}=this.state;t.startIndices=e.indexStarts,t.value=e.get("indices")}calculatePositions(t){const{polygonTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}}},908:(t,e,n)=>{"use strict";n.d(e,{A:()=>U});var i=n(9452),r=n(3459),o=n(3439),s=n(7790);const a=.75,A=[],u={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class l extends s.A{static{this.defaultProps=u}static{this.layerName="MultiIconLayer"}getShaders(){return{...super.getShaders(),fs:"#version 300 es\n#define SHADER_NAME multi-icon-layer-fragment-shader\nprecision highp float;\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float sdfBuffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\nin vec4 vColor;\nin vec2 vTextureCoords;\nin vec2 uv;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nif (!bool(picking.isActive)) {\nfloat alpha = texture(iconsTexture, vTextureCoords).a;\nvec4 color = vColor;\nif (sdf) {\nfloat distance = alpha;\nalpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);\nif (outlineBuffer > 0.0) {\nfloat inFill = alpha;\nfloat inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\ncolor = mix(outlineColor, vColor, inFill);\nalpha = inBorder;\n}\n}\nfloat a = alpha * color.a;\nif (a < alphaCutoff) {\ndiscard;\n}\nfragColor = vec4(color.rgb, a * opacity);\n}\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n"}}initializeState(){super.initializeState();this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(t,{index:e,target:n})=>this.encodePickingColor(e,n)}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;let{outlineColor:i}=e;i!==n.outlineColor&&(i=i.map((t=>t/255)),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!e.sdf&&e.outlineWidth&&r.A.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw(t){const{sdf:e,smoothing:n,outlineWidth:i}=this.props,{outlineColor:r}=this.state,o=i?Math.max(n,a*(1-i)):-1;if(t.uniforms={...t.uniforms,sdfBuffer:a,outlineBuffer:o,gamma:n,sdf:Boolean(e),outlineColor:r},super.draw(t),e&&i){const{iconManager:t}=this.state,e=t.getTexture(),n=this.state.model;e&&(n.setUniforms({outlineBuffer:a}),n.draw(this.context.renderPass))}}getInstanceOffset(t){return t?Array.from(t).flatMap((t=>super.getInstanceOffset(t))):A}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).flatMap((t=>super.getInstanceIconFrame(t))):A}}const c=1e20;class h{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:i=.25,fontFamily:r="sans-serif",fontWeight:o="normal",fontStyle:s="normal"}={}){this.buffer=e,this.cutoff=i,this.radius=n;const a=this.size=t+4*e,A=this._createCanvas(a),u=this.ctx=A.getContext("2d",{willReadFrequently:!0});u.font=`${s} ${o} ${t}px ${r}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:i,actualBoundingBoxLeft:r,actualBoundingBoxRight:o}=this.ctx.measureText(t),s=Math.ceil(n),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-r))),A=Math.min(this.size-this.buffer,s+Math.ceil(i)),u=a+2*this.buffer,l=A+2*this.buffer,h=Math.max(u*l,0),p=new Uint8ClampedArray(h),d={data:p,width:u,height:l,glyphWidth:a,glyphHeight:A,glyphTop:s,glyphLeft:0,glyphAdvance:e};if(0===a||0===A)return d;const{ctx:g,buffer:_,gridInner:m,gridOuter:y}=this;g.clearRect(_,_,a,A),g.fillText(t,_,_+s);const v=g.getImageData(_,_,a,A);y.fill(c,0,h),m.fill(0,0,h);for(let f=0;f<A;f++)for(let t=0;t<a;t++){const e=v.data[4*(f*a+t)+3]/255;if(0===e)continue;const n=(f+_)*u+t+_;if(1===e)y[n]=0,m[n]=c;else{const t=.5-e;y[n]=t>0?t*t:0,m[n]=t<0?t*t:0}}f(y,0,0,u,l,u,this.f,this.v,this.z),f(m,_,_,a,A,u,this.f,this.v,this.z);for(let c=0;c<h;c++){const t=Math.sqrt(y[c])-Math.sqrt(m[c]);p[c]=Math.round(255-255*(t/this.radius+this.cutoff))}return d}}function f(t,e,n,i,r,o,s,a,A){for(let u=e;u<e+i;u++)p(t,n*o+u,o,r,s,a,A);for(let u=n;u<n+r;u++)p(t,u*o+e,1,i,s,a,A)}function p(t,e,n,i,r,o,s){o[0]=0,s[0]=-c,s[1]=c,r[0]=t[e];for(let a=1,A=0,u=0;a<i;a++){r[a]=t[e+a*n];const i=a*a;do{const t=o[A];u=(r[a]-r[t]+i-t*t)/(a-t)/2}while(u<=s[A]&&--A>-1);A++,o[A]=a,s[A]=u,s[A+1]=c}for(let a=0,A=0;a<i;a++){for(;s[A+1]<a;)A++;const i=o[A],u=a-i;t[e+a*n]=r[i]+u*u}}const d=32,g=[];function _(t,e,n,i){let r=0;for(let o=e;o<n;o++){const e=t[o];r+=i[e]?.layoutWidth||0}return r}function m(t,e,n,i,r,o){let s=e,a=0;for(let A=e;A<n;A++){const e=_(t,A,A+1,r);a+e>i&&(s<A&&o.push(A),s=A,a=0),a+=e}return a}function y(t,e,n,i,r=0,o){void 0===o&&(o=t.length);const s=[];return"break-all"===e?m(t,r,o,n,i,s):function(t,e,n,i,r,o){let s=e,a=e,A=e,u=0;for(let l=e;l<n;l++)if(" "===t[l]?A=l+1:" "!==t[l+1]&&l+1!==n||(A=l+1),A>a){let e=_(t,a,A,r);u+e>i&&(s<a&&(o.push(a),s=a,u=0),e>i&&(e=m(t,a,A,i,r,o),s=o[o.length-1])),a=A,u+=e}}(t,r,o,n,i,s),s}function v(t,e,n,i,o,s){let a=0,A=0;for(let u=e;u<n;u++){const e=t[u],n=i[e];n?(A||(A=n.layoutHeight),o[u]=a+n.layoutWidth/2,a+=n.layoutWidth):(r.A.warn(`Missing character: ${e} (${e.codePointAt(0)})`)(),o[u]=a,a+=d)}s[0]=a,s[1]=A}class E{constructor(t=5){this._cache={},this._order=[],this.limit=t}get(t){const e=this._cache[t];return e&&(this._deleteOrder(t),this._appendOrder(t)),e}set(t,e){this._cache[t]?(this.delete(t),this._cache[t]=e,this._appendOrder(t)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[t]=e,this._appendOrder(t))}delete(t){this._cache[t]&&(delete this._cache[t],this._deleteOrder(t))}_deleteOrder(t){const e=this._order.indexOf(t);e>=0&&this._order.splice(e,1)}_appendOrder(t){this._order.push(t)}}const b={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};let w=new E(3);function x(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function S(t,e,n,i){t.font=`${i} ${n}px ${e}`,t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}class C{constructor(){this.props={...b}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:t,buffer:e}=this.props;return(1.2*t+2*e)/t}setProps(t={}){Object.assign(this.props,t),this._key=this._getKey();const e=function(t,e){let n;n="string"==typeof e?new Set(Array.from(e)):new Set(e);const i=w.get(t);if(!i)return n;for(const r in i.mapping)n.has(r)&&n.delete(r);return n}(this._key,this.props.characterSet),n=w.get(this._key);if(n&&0===e.size)return void(this._atlas!==n&&(this._atlas=n));const i=this._generateFontAtlas(e,n);this._atlas=i,w.set(this._key,i)}_generateFontAtlas(t,e){const{fontFamily:n,fontWeight:i,fontSize:r,buffer:o,sdf:s,radius:a,cutoff:A}=this.props;let u=e&&e.data;u||(u=document.createElement("canvas"),u.width=1024);const l=u.getContext("2d",{willReadFrequently:!0});S(l,n,r,i);const{mapping:c,canvasHeight:f,xOffset:p,yOffset:d}=function({characterSet:t,getFontWidth:e,fontHeight:n,buffer:i,maxCanvasWidth:r,mapping:o={},xOffset:s=0,yOffset:a=0}){let A=0,u=s;const l=n+2*i;for(const h of t)if(!o[h]){const t=e(h);u+t+2*i>r&&(u=0,A++),o[h]={x:u+i,y:a+A*l+i,width:t,height:l,layoutWidth:t,layoutHeight:n},u+=t+2*i}return{mapping:o,xOffset:u,yOffset:a+A*l,canvasHeight:(c=a+(A+1)*l,Math.pow(2,Math.ceil(Math.log2(c))))};var c}({getFontWidth:t=>l.measureText(t).width,fontHeight:1.2*r,buffer:o,characterSet:t,maxCanvasWidth:1024,...e&&{mapping:e.mapping,xOffset:e.xOffset,yOffset:e.yOffset}});if(u.height!==f){const t=l.getImageData(0,0,u.width,u.height);u.height=f,l.putImageData(t,0,0)}if(S(l,n,r,i),s){const e=new h({fontSize:r,buffer:o,radius:a,cutoff:A,fontFamily:n,fontWeight:`${i}`});for(const n of t){const{data:t,width:i,height:o,glyphTop:s}=e.draw(n);c[n].width=i,c[n].layoutOffsetY=.9*r-s;const a=l.createImageData(i,o);x(t,a),l.putImageData(a,c[n].x,c[n].y)}}else for(const h of t)l.fillText(h,c[h].x,c[h].y+o+.9*r);return{xOffset:p,yOffset:d,mapping:c,data:u,width:u.width,height:u.height}}_getKey(){const{fontFamily:t,fontWeight:e,fontSize:n,buffer:i,sdf:r,radius:o,cutoff:s}=this.props;return r?`${t} ${e} ${n} ${i} ${o} ${s}`:`${t} ${e} ${n} ${i}`}}var T=n(688),I=n(4175),R=n(3349),P=n(9350),M=n(5337),L=n(9067);const N={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class O extends T.A{static{this.defaultProps=N}static{this.layerName="TextBackgroundLayer"}getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME text-background-layer-vertex-shader\nin vec2 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceRects;\nin float instanceSizes;\nin float instanceAngles;\nin vec2 instancePixelOffsets;\nin float instanceLineWidths;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin vec3 instancePickingColors;\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\nout vec4 vFillColor;\nout vec4 vLineColor;\nout float vLineWidth;\nout vec2 uv;\nout vec2 dimensions;\nvec2 rotate_by_angle(vec2 vertex, float angle) {\nfloat angle_radian = radians(angle);\nfloat cos_angle = cos(angle_radian);\nfloat sin_angle = sin(angle_radian);\nmat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\nreturn rotationMatrix * vertex;\n}\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.uv = positions;\ngeometry.pickingColor = instancePickingColors;\nuv = positions;\nvLineWidth = instanceLineWidths;\nfloat sizePixels = clamp(\nproject_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\nsizeMinPixels, sizeMaxPixels\n);\ndimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\nvec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\npixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\npixelOffset += instancePixelOffsets;\npixelOffset.y *= -1.0;\nif (billboard)  {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = vec3(pixelOffset, 0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\nDECKGL_FILTER_SIZE(offset_common, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\nDECKGL_FILTER_COLOR(vFillColor, geometry);\nvLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\nDECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME text-background-layer-fragment-shader\nprecision highp float;\nuniform bool stroked;\nin vec4 vFillColor;\nin vec4 vLineColor;\nin float vLineWidth;\nin vec2 uv;\nin vec2 dimensions;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nvec2 pixelPosition = uv * dimensions;\nif (stroked) {\nfloat distToEdge = min(\nmin(pixelPosition.x, dimensions.x - pixelPosition.x),\nmin(pixelPosition.y, dimensions.y - pixelPosition.y)\n);\nfloat isBorder = smoothedge(distToEdge, vLineWidth);\nfragColor = mix(vFillColor, vLineColor, isBorder);\n} else {\nfragColor = vFillColor;\n}\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[I.A,R.A]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){super.updateState(t);const{changeFlags:e}=t;e.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:t}){const{billboard:e,sizeScale:n,sizeUnits:i,sizeMinPixels:r,sizeMaxPixels:o,getLineWidth:s}=this.props;let{padding:a}=this.props;a.length<4&&(a=[a[0],a[1],a[0],a[1]]);const A=this.state.model;A.setUniforms(t),A.setUniforms({billboard:e,stroked:Boolean(s),padding:a,sizeUnits:P.p5[i],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:o}),A.draw(this.context.renderPass)}_getModel(){return new L.K(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new M.V({topology:"triangle-fan-webgl",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}const D={start:1,middle:0,end:-1},F={top:1,center:0,bottom:-1},k=[0,0,0,255],B={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:k},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:b.characterSet},fontFamily:b.fontFamily,fontWeight:b.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:k},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:k},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class U extends i.A{constructor(){super(...arguments),this.getBoundingRect=(t,e)=>{let{size:[n,i]}=this.transformParagraph(t,e);const{fontSize:r}=this.state.fontAtlasManager.props;n/=r,i/=r;const{getTextAnchor:o,getAlignmentBaseline:s}=this.props;return[(D["function"==typeof o?o(t,e):o]-1)*n/2,(F["function"==typeof s?s(t,e):s]-1)*i/2,n,i]},this.getIconOffsets=(t,e)=>{const{getTextAnchor:n,getAlignmentBaseline:i}=this.props,{x:r,y:o,rowWidth:s,size:[a,A]}=this.transformParagraph(t,e),u=D["function"==typeof n?n(t,e):n],l=F["function"==typeof i?i(t,e):i],c=r.length,h=new Array(2*c);let f=0;for(let p=0;p<c;p++){const t=(1-u)*(a-s[p])/2;h[f++]=(u-1)*a/2+t+r[p],h[f++]=(l-1)*A/2+o[p]}return h}}static{this.defaultProps=B}static{this.layerName="TextLayer"}initializeState(){this.state={styleVersion:0,fontAtlasManager:new C},this.props.maxWidth>0&&r.A.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(t){const{props:e,oldProps:n,changeFlags:i}=t;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText();(this._updateFontAtlas()||e.lineHeight!==n.lineHeight||e.wordBreak!==n.wordBreak||e.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(){const{fontSettings:t,fontFamily:e,fontWeight:n}=this.props,{fontAtlasManager:i,characterSet:r}=this.state,o={...t,characterSet:r,fontFamily:e,fontWeight:n};if(!i.mapping)return i.setProps(o),!0;for(const s in o)if(o[s]!==i.props[s])return i.setProps(o),!0;return!1}_updateText(){const{data:t,characterSet:e}=this.props,n=t.attributes?.getText;let i,{getText:r}=this.props,s=t.startIndices;const a="auto"===e&&new Set;if(n&&s){const{texts:e,characterCount:o}=function({value:t,length:e,stride:n,offset:i,startIndices:r,characterSet:o}){const s=t.BYTES_PER_ELEMENT,a=n?n/s:1,A=i?i/s:0,u=r[e]||Math.ceil((t.length-A)/a),l=o&&new Set,c=new Array(e);let h=t;if(a>1||A>0){h=new(0,t.constructor)(u);for(let e=0;e<u;e++)h[e]=t[e*a+A]}for(let f=0;f<e;f++){const t=r[f],e=r[f+1]||u,n=h.subarray(t,e);c[f]=String.fromCodePoint.apply(null,n),l&&n.forEach(l.add,l)}if(l)for(const f of l)o.add(String.fromCodePoint(f));return{texts:c,characterCount:u}}({...ArrayBuffer.isView(n)?{value:n}:n,length:t.length,startIndices:s,characterSet:a});i=o,r=(t,{index:n})=>e[n]}else{const{iterable:e,objectInfo:n}=(0,o.X)(t);s=[0],i=0;for(const t of e){n.index++;const e=Array.from(r(t,n)||"");a&&e.forEach(a.add,a),i+=e.length,s.push(i)}}this.setState({getText:r,startIndices:s,numInstances:i,characterSet:a||e})}transformParagraph(t,e){const{fontAtlasManager:n}=this.state,i=n.mapping,r=this.state.getText,{wordBreak:o,lineHeight:s,maxWidth:a}=this.props;return function(t,e,n,i,r){const o=Array.from(t),s=o.length,a=new Array(s),A=new Array(s),u=new Array(s),l=("break-word"===n||"break-all"===n)&&isFinite(i)&&i>0,c=[0,0],h=[0,0];let f=0,p=0,d=0;for(let _=0;_<=s;_++){const t=o[_];if("\n"!==t&&_!==s||(d=_),d>p){const t=l?y(o,n,i,r,p,d):g;for(let n=0;n<=t.length;n++){const i=0===n?p:t[n-1],s=n<t.length?t[n]:d;v(o,i,s,r,a,h);for(let t=i;t<s;t++){const e=o[t],n=r[e]?.layoutOffsetY||0;A[t]=f+h[1]/2+n,u[t]=h[0]}f+=h[1]*e,c[0]=Math.max(c[0],h[0])}p=d}"\n"===t&&(a[p]=0,A[p]=0,u[p]=0,p++)}return c[1]=f,{x:a,y:A,rowWidth:u,size:c}}(r(t,e)||"",s,o,a*n.props.fontSize,i)}renderLayers(){const{startIndices:t,numInstances:e,getText:n,fontAtlasManager:{scale:i,atlas:r,mapping:o},styleVersion:s}=this.state,{data:a,_dataDiff:A,getPosition:u,getColor:c,getSize:h,getAngle:f,getPixelOffset:p,getBackgroundColor:d,getBorderColor:g,getBorderWidth:_,backgroundPadding:m,background:y,billboard:v,fontSettings:E,outlineWidth:w,outlineColor:x,sizeScale:S,sizeUnits:C,sizeMinPixels:T,sizeMaxPixels:I,transitions:R,updateTriggers:P}=this.props,M=this.getSubLayerClass("characters",l),L=this.getSubLayerClass("background",O);return[y&&new L({getFillColor:d,getLineColor:g,getLineWidth:_,padding:m,getPosition:u,getSize:h,getAngle:f,getPixelOffset:p,billboard:v,sizeScale:S,sizeUnits:C,sizeMinPixels:T,sizeMaxPixels:I,transitions:R&&{getPosition:R.getPosition,getAngle:R.getAngle,getSize:R.getSize,getFillColor:R.getBackgroundColor,getLineColor:R.getBorderColor,getLineWidth:R.getBorderWidth,getPixelOffset:R.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:P.getPosition,getAngle:P.getAngle,getSize:P.getSize,getFillColor:P.getBackgroundColor,getLineColor:P.getBorderColor,getLineWidth:P.getBorderWidth,getPixelOffset:P.getPixelOffset,getBoundingRect:{getText:P.getText,getTextAnchor:P.getTextAnchor,getAlignmentBaseline:P.getAlignmentBaseline,styleVersion:s}}}),{data:a.attributes&&a.attributes.background?{length:a.length,attributes:a.attributes.background}:a,_dataDiff:A,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new M({sdf:E.sdf,smoothing:Number.isFinite(E.smoothing)?E.smoothing:b.smoothing,outlineWidth:w/(E.radius||b.radius),outlineColor:x,iconAtlas:r,iconMapping:o,getPosition:u,getColor:c,getSize:h,getAngle:f,getPixelOffset:p,billboard:v,sizeScale:S*i,sizeUnits:C,sizeMinPixels:T*i,sizeMaxPixels:I*i,transitions:R&&{getPosition:R.getPosition,getAngle:R.getAngle,getColor:R.getColor,getSize:R.getSize,getPixelOffset:R.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:P.getText,getPosition:P.getPosition,getAngle:P.getAngle,getColor:P.getColor,getSize:P.getSize,getPixelOffset:P.getPixelOffset,getIconOffsets:{getTextAnchor:P.getTextAnchor,getAlignmentBaseline:P.getAlignmentBaseline,styleVersion:s}}}),{data:a,_dataDiff:A,startIndices:t,numInstances:e,getIconOffsets:this.getIconOffsets,getIcon:n})]}static set fontAtlasCacheLimit(t){!function(t){r.A.assert(Number.isFinite(t)&&t>=3,"Invalid cache limit"),w=new E(t)}(t)}}},6053:(t,e,n)=>{"use strict";function i({data:t,getIndex:e,dataRange:n,replace:i}){const{startRow:r=0,endRow:o=1/0}=n,s=t.length;let a=s,A=s;for(let c=0;c<s;c++){const n=e(t[c]);if(a>c&&n>=r&&(a=c),n>=o){A=c;break}}let u=a;const l=A-a!==i.length?t.slice(A):void 0;for(let c=0;c<i.length;c++)t[u++]=i[c];if(l){for(let e=0;e<l.length;e++)t[u++]=l[e];t.length=u}return{startRow:a,endRow:a+i.length}}n.d(e,{J:()=>i})},976:(t,e,n)=>{"use strict";n.d(e,{A:()=>w});var i=n(3459),r=n(688),o=n(4175),s=n(9105),a=n(3349),A=n(698),u=n(5337),l=n(9067),c=n(3439),h=n(9350);const f=Math.PI/180,p=new Float32Array(16),d=new Float32Array(12);function g(t,e,n){const i=e[0]*f,r=e[1]*f,o=e[2]*f,s=Math.sin(o),a=Math.sin(i),A=Math.sin(r),u=Math.cos(o),l=Math.cos(i),c=Math.cos(r),h=n[0],p=n[1],d=n[2];t[0]=h*c*l,t[1]=h*A*l,t[2]=h*-a,t[3]=p*(-A*u+c*a*s),t[4]=p*(c*u+A*a*s),t[5]=p*l*s,t[6]=d*(A*s+c*a*u),t[7]=d*(-c*s+A*a*u),t[8]=d*l*u}function _(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const m={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrixCol0:{size:3,elementOffset:0},instanceModelMatrixCol1:{size:3,elementOffset:3},instanceModelMatrixCol2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:i,getOrientation:r,getScale:o,getTranslation:s,getTransformMatrix:a}=this.props,A=Array.isArray(a),u=A&&16===a.length,l=Array.isArray(o),h=Array.isArray(r),f=Array.isArray(s),m=u||!A&&Boolean(a(i[0]));t.constant=m?u:h&&l&&f;const y=t.value;if(t.constant){let e;if(m)p.set(a),e=_(p);else{e=d;g(e,r,o),e.set(s,9)}t.value=new Float32Array(e)}else{let A=e*t.size;const{iterable:v,objectInfo:E}=(0,c.X)(i,e,n);for(const t of v){let e;if(E.index++,m)p.set(u?a:a(t,E)),e=_(p);else{e=d;g(e,h?r:r(t,E),l?o:o(t,E)),e.set(f?s:s(t,E),9)}y[A++]=e[0],y[A++]=e[1],y[A++]=e[2],y[A++]=e[3],y[A++]=e[4],y[A++]=e[5],y[A++]=e[6],y[A++]=e[7],y[A++]=e[8],y[A++]=e[9],y[A++]=e[10],y[A++]=e[11]}}}};function y(t,e){return e===h.rf.CARTESIAN||e===h.rf.METER_OFFSETS||e===h.rf.DEFAULT&&!t.isGeospatial}function v(t){const e=t.positions||t.POSITION;i.A.assert(e,'no "postions" or "POSITION" attribute in mesh');const n=e.value.length/e.size;let r=t.COLOR_0||t.colors;r||(r={size:3,value:new Float32Array(3*n).fill(1)});let o=t.NORMAL||t.normals;o||(o={size:3,value:new Float32Array(3*n).fill(0)});let s=t.TEXCOORD_0||t.texCoords;return s||(s={size:2,value:new Float32Array(2*n).fill(0)}),{positions:e,colors:r,normals:o,texCoords:s}}function E(t){return t instanceof u.V?(t.attributes=v(t.attributes),t):t.attributes?new u.V({...t,topology:"triangle-list",attributes:v(t.attributes)}):new u.V({topology:"triangle-list",attributes:v(t)})}const b={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0,value:null}};class w extends r.A{static{this.defaultProps=b}static{this.layerName="SimpleMeshLayer"}getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin vec3 instanceModelMatrixCol0;\nin vec3 instanceModelMatrixCol1;\nin vec3 instanceModelMatrixCol2;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.uv = texCoords;\ngeometry.pickingColor = instancePickingColors;\nvTexCoord = texCoords;\ncameraPosition = project_uCameraPosition;\nvColor = vec4(colors * instanceColors.rgb, instanceColors.a);\nmat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);\nvec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\nif (composeModelMatrix) {\nDECKGL_FILTER_SIZE(pos, geometry);\nnormals_commonspace = project_normal(instanceModelMatrix * normals);\ngeometry.worldPosition += pos;\ngl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\ngeometry.position = position_commonspace;\n}\nelse {\npos = project_size(pos);\nDECKGL_FILTER_SIZE(pos, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\ngeometry.position = position_commonspace;\nnormals_commonspace = project_normal(instanceModelMatrix * normals);\n}\ngeometry.normal = normals_commonspace;\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\nprecision highp float;\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = vTexCoord;\nvec3 normal;\nif (flatShading) {\nnormal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n} else {\nnormal = normals_commonspace;\n}\nvec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\nDECKGL_FILTER_COLOR(color, geometry);\nvec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\nfragColor = vec4(lightColor, color.a * opacity);\n}\n",modules:[o.A,s.p,a.A]})}getBounds(){if(this.props._instanced)return super.getBounds();let t=this.state.positionBounds;if(t)return t;const{mesh:e}=this.props;if(!e)return null;if(t=e.header?.boundingBox,!t){const{attributes:n}=E(e);n.POSITION=n.POSITION||n.positions,t=function(t){let e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,s=-1/0;const a=t.POSITION?t.POSITION.value:[],A=a&&a.length;for(let u=0;u<A;u+=3){const t=a[u],A=a[u+1],l=a[u+2];e=t<e?t:e,n=A<n?A:n,i=l<i?l:i,r=t>r?t:r,o=A>o?A:o,s=l>s?l:s}return[[e,n,i],[r,o,s]]}(n)}return this.state.positionBounds=t,t}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:"float64",fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:"unorm8",transition:!0,size:this.props.colorFormat.length,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:m}),this.setState({emptyTexture:this.context.device.createTexture({data:new Uint8Array(4),width:1,height:1})})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:i}=t;if(e.mesh!==n.mesh||i.extensionsChanged){if(this.state.positionBounds=null,this.state.model?.destroy(),e.mesh){this.state.model=this.getModel(e.mesh);const t=e.mesh.attributes||e.mesh;this.setState({hasNormals:Boolean(t.NORMAL||t.normals)})}this.getAttributeManager().invalidateAll()}e.texture!==n.texture&&e.texture instanceof A.g&&this.setTexture(e.texture),this.state.model&&this.state.model.setTopology(this.props.wireframe?"line-strip":"triangle-list")}finalizeState(t){super.finalizeState(t),this.state.emptyTexture.delete()}draw({uniforms:t}){const{model:e}=this.state;if(!e)return;const{viewport:n,renderPass:i}=this.context,{sizeScale:r,coordinateSystem:o,_instanced:s}=this.props;e.setUniforms(t),e.setUniforms({sizeScale:r,composeModelMatrix:!s||y(n,o),flatShading:!this.state.hasNormals}),e.draw(i)}get isLoaded(){return Boolean(this.state?.model&&super.isLoaded)}getModel(t){const e=new l.K(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:E(t),isInstanced:!0}),{texture:n}=this.props,{emptyTexture:i}=this.state;return e.setBindings({sampler:n||i}),e.setUniforms({hasTexture:Boolean(n)}),e}setTexture(t){const{emptyTexture:e,model:n}=this.state;n&&(n.setBindings({sampler:t||e}),n.setUniforms({hasTexture:Boolean(t)}))}}},1198:(t,e,n)=>{"use strict";n.d(e,{A:()=>ao});var i=n(6540);let r=1,o=1;class s{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:o=1}=t,s=r++,a={time:0,delay:e,duration:n,rate:i,repeat:o};return this._setChannelTime(a,this.time),this.channels.set(s,a),s}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}getTime(t){if(void 0===t)return this.time;const e=this.channels.get(t);return void 0===e?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const i of e)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:t,channel:e}=i;t.setTime(this.getTime(e))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=o++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay;n>=t.duration*t.repeat?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}var a=n(766),A=n(3756);const u=[A.A],l=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function c(){const t=a._.getDefaultShaderAssembler();for(const e of u)t.addDefaultModule(e);for(const e of l)t.addShaderHook(e);return t}var h=n(2897),f=n(3459),p=n(3411),d=n(8055),g=n(9842);function _(){let t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}class m{constructor(t,e){(0,g.A)(this,"name",void 0),(0,g.A)(this,"type",void 0),(0,g.A)(this,"sampleSize",1),(0,g.A)(this,"time",void 0),(0,g.A)(this,"count",void 0),(0,g.A)(this,"samples",void 0),(0,g.A)(this,"lastTiming",void 0),(0,g.A)(this,"lastSampleTime",void 0),(0,g.A)(this,"lastSampleCount",void 0),(0,g.A)(this,"_count",0),(0,g.A)(this,"_time",0),(0,g.A)(this,"_samples",0),(0,g.A)(this,"_startTime",0),(0,g.A)(this,"_timerPending",!1),this.name=t,this.type=e,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=_(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(_()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class y{constructor(t){(0,g.A)(this,"id",void 0),(0,g.A)(this,"stats",{}),this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach((e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((t=>this._getOrCreate(t)))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(this.stats[e]=t instanceof m?t:new m(e,n)),this.stats[e]}}var v=n(3022);class E{constructor(t,e,n){this._loadCount=0,this._subscribers=new Set,this.id=t,this.context=n,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let i=t;"string"==typeof t&&(i=(0,v.H)(t)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=t)})).catch((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=t||!0)}))):(this.isLoaded=!0,this._error=void 0,this._content=t);for(const r of this._subscribers)r.onChange(this.getData())}}class b{constructor(t){this.protocol=t.protocol||"resource://",this._context={device:t.device,gl:t.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add({resourceId:t,data:e,forceUpdate:n=!1,persistent:i=!0}){let r=this._resources[t];r?r.setData(e,n):(r=new E(t,e,this._context),this._resources[t]=r),r.persistent=i}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){const e=this._consumers[t];if(e){for(const t in e){const n=e[t],i=this._resources[n.resourceId];i&&i.unsubscribe(n)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:e,consumerId:n,requestId:i="default"}){const{_resources:r,protocol:o}=this;t.startsWith(o)&&(r[t=t.replace(o,"")]||this.add({resourceId:t,data:null,persistent:!1}));const s=r[t];if(this._track(n,i,s,e),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,i){const r=this._consumers,o=r[t]=r[t]||{};let s=o[e];const a=s&&s.resourceId&&this._resources[s.resourceId];a&&(a.unsubscribe(s),this.prune()),n&&(s?(s.onChange=i,s.resourceId=n.id):s={onChange:i,resourceId:n.id},o[e]=s,n.subscribe(s))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];e.persistent||e.inUse()||(e.delete(),delete this._resources[t])}}}var w=n(7345);class x{constructor(t,e){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=t=>{(0,p.A)("layerManager.activateViewport",this,t),t&&(this.context.viewport=t)};const{deck:n,stats:i,viewport:r,timeline:o}=e||{};this.layers=[],this.resourceManager=new b({device:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:t,gl:t?.gl,deck:n,shaderAssembler:c(),defaultShaderModules:[],renderPass:void 0,stats:i||new y({id:"deck.gl"}),viewport:r||new w.A({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new s,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(t);e=e||i}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t}={}){return t?this.layers.filter((e=>t.find((t=>0===e.id.indexOf(t))))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){(0,p.A)("layerManager.setLayers",this,e,t),this._lastRenderedLayers=t;const n=(0,d.B)(t,Boolean);for(const i of n)i.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw(`updating layers: ${t}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}addDefaultShaderModule(t){const{defaultShaderModules:e}=this.context;e.find((e=>e.name===t.name))||(e.push(t),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(t){const{defaultShaderModules:e}=this.context,n=e.findIndex((e=>e.name===t.name));n>=0&&(e.splice(n,1),this._defaultShaderModulesChanged=!0)}_handleError(t,e,n){n.raiseError(e,`${t} of ${n}`)}_updateLayers(t,e){const n={};for(const o of t)n[o.id]?f.A.warn(`Multiple old layers with same id ${o.id}`)():n[o.id]=o;if(this._defaultShaderModulesChanged){for(const e of t)e.setNeedsUpdate(),e.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const i=[];this._updateSublayersRecursively(e,n,i),this._finalizeOldLayers(n);let r=!1;for(const o of i)if(o.hasUniformTransition()){r=`Uniform transition in ${o}`;break}this._needsUpdate=r,this.layers=i}_updateSublayersRecursively(t,e,n){for(const r of t){r.context=this.context;const t=e[r.id];null===t&&f.A.warn(`Multiple new layers with same id ${r.id}`)(),e[r.id]=null;let o=null;try{this._debug&&t!==r&&r.validateProps(),t?(this._transferLayerState(t,r),this._updateLayer(r)):this._initializeLayer(r),n.push(r),o=r.isComposite?r.getSubLayers():null}catch(i){this._handleError("matching",i,r)}o&&this._updateSublayersRecursively(o,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=h.VD.INITIALIZED}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle=h.VD.MATCHED,e!==t&&(t.lifecycle=h.VD.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||`finalized ${t}`,t.lifecycle=h.VD.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=h.VD.FINALIZED}catch(e){this._handleError("finalization",e,t)}}}var S=n(7914);class C{constructor(t){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers){const e=this.controllers[t];e&&e.finalize()}this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter((e=>e.containsPixel(t))):this._viewports}getViews(){const t={};return this.views.forEach((e=>{t[e.id]=e})),t}getView(t){return this.views.find((e=>e.id===t))}getViewState(t){const e="string"==typeof t?this.getView(t):t,n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),i={x:t[0],y:t[1]};for(let r=n.length-1;r>=0;--r){const o=n[r];if(o.containsPixel(i)){const n=t.slice();return n[0]-=o.x,n[1]-=o.y,o.unproject(n,e)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=(0,d.B)(t,Boolean);this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){if(t){!(0,S.b)(t,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=t}else f.A.warn("missing `viewState` or `initialViewState`")()}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>this.getView(t.id)?.makeViewport({viewState:e,width:this.width,height:this.height})})}_updateController(t,e,n,i){const r=t.controller;if(r&&n){const o={...e,...r,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height};return i&&i.constructor===r.type||(i=this._createController(t,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:t}=this,e=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=t.length;i--;){const r=t[i],o=this.getViewState(r),s=r.makeViewport({viewState:o,width:this.width,height:this.height});let a=e[r.id];const A=Boolean(r.controller);A&&!a&&(n=!0),!n&&A||!a||(a.finalize(),a=null),this.controllers[r.id]=this._updateController(r,o,s,a),s&&this._viewports.unshift(s)}for(const i in e){const t=e[i];t&&!this.controllers[i]&&t.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)}))}_diffViews(t,e){return t.length!==e.length||t.some(((n,i)=>!t[i].equals(e[i])))}}var T=n(5800);const I=[255,255,255],R=1;let P=0;class M{constructor(t={}){this.type="ambient";const{color:e=I}=t,{intensity:n=R}=t;this.id=t.id||"ambient-"+P++,this.color=e,this.intensity=n}}var L=n(7597);const N=[255,255,255],O=1,D=[0,0,-1];let F=0;class k{constructor(t={}){this.type="directional";const{color:e=N}=t,{intensity:n=O}=t,{direction:i=D}=t,{_shadow:r=!1}=t;this.id=t.id||"directional-"+F++,this.color=e,this.intensity=n,this.type="directional",this.direction=new L.P(i).normalize().toArray(),this.shadow=r}getProjectedLight(t){return this}}var B=n(5077);class U{constructor(t,e={id:"pass"}){const{id:n}=e;this.id=n,this.device=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}}class G extends U{constructor(){super(...arguments),this._lastRenderIndex=-1}render(t){const[e,n]=this.device.canvasContext.getDrawingBufferSize(),i=t.clearCanvas??!0,r=t.clearColor??(!!i&&[0,0,0,0]),o=!!i&&1,s=!!i&&0,a=t.colorMask??15,A={viewport:[0,0,e,n]};t.colorMask&&(A.colorMask=a),t.scissorRect&&(A.scissorRect=t.scissorRect);const u=this.device.beginRenderPass({framebuffer:t.target,parameters:A,clearColor:r,clearDepth:o,clearStencil:s});try{return this._drawLayers(u,t)}finally{u.end()}}_drawLayers(t,e){const{target:n,moduleParameters:i,viewports:r,views:o,onViewportActive:s,clearStack:a=!0}=e;e.pass=e.pass||"unknown",a&&(this._lastRenderIndex=-1);const A=[];for(const u of r){const r=o&&o[u.id];s?.(u);const a=this._getDrawLayerParams(u,e),l=u.subViewports||[u];for(const o of l){const s=this._drawLayersInViewport(t,{target:n,moduleParameters:i,viewport:o,view:r,pass:e.pass,layers:e.layers},a);A.push(s)}}return A}_getDrawLayerParams(t,{layers:e,pass:n,isPicking:i=!1,layerFilter:r,cullRect:o,effects:s,moduleParameters:a},A=!1){const u=[],l=z(this._lastRenderIndex+1),c={layer:e[0],viewport:t,isPicking:i,renderPass:n,cullRect:o},h={};for(let f=0;f<e.length;f++){const i=e[f],o=this._shouldDrawLayer(i,c,r,h),p={shouldDrawLayer:o};o&&!A&&(p.layerRenderIndex=l(i,o),p.moduleParameters=this._getModuleParameters(i,s,n,a),p.layerParameters={...i.context.deck?.props.parameters,...this.getLayerParameters(i,f,t)}),u[f]=p}return u}_drawLayersInViewport(t,{layers:e,moduleParameters:n,pass:i,target:r,viewport:o,view:s},a){const A=function(t,{moduleParameters:e,target:n,viewport:i}){const r=e&&e.devicePixelRatio||t.canvasContext.cssToDeviceRatio(),[,o]=t.canvasContext.getDrawingBufferSize(),s=n?n.height:o,a=i;return[a.x*r,s-(a.y+a.height)*r,a.width*r,a.height*r]}(this.device,{moduleParameters:n,target:r,viewport:o});if(s&&s.props.clear){const t=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;this.device.withParametersWebGL({scissorTest:!0,scissor:A},(()=>this.device.clearWebGL(t)))}const u={totalCount:e.length,visibleCount:0,compositeCount:0,pickableCount:0};t.setParameters({viewport:A});for(let c=0;c<e.length;c++){const n=e[c],{shouldDrawLayer:r,layerRenderIndex:s,moduleParameters:A,layerParameters:h}=a[c];if(r&&n.props.pickable&&u.pickableCount++,n.isComposite)u.compositeCount++;else if(r){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,s),A.viewport=o,n.context.renderPass=t;try{n._drawLayer({renderPass:t,moduleParameters:A,uniforms:{layerIndex:s},parameters:h})}catch(l){n.raiseError(l,`drawing ${n} to ${i}`)}}}return u}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e,n){return t.props.parameters}_shouldDrawLayer(t,e,n,i){if(!(t.props.visible&&this.shouldDrawLayer(t)))return!1;e.layer=t;let r=t.parent;for(;r;){if(!r.props.visible||!r.filterSubLayer(e))return!1;e.layer=r,r=r.parent}if(n){const t=e.layer.id;if(t in i||(i[t]=n(e)),!i[t])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,i){const r=this.device.canvasContext.cssToDeviceRatio(),o=Object.assign(Object.create(t.internalState?.propsInTransition||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,picking:{isActive:0},devicePixelRatio:r});if(e)for(const s of e)Object.assign(o,s.getModuleParameters?.(t));return Object.assign(o,this.getModuleParameters(t,e),i)}}function z(t=0,e={}){const n={},i=(r,o)=>{const s=r.props._offset,a=r.id,A=r.parent&&r.parent.id;let u;if(A&&!(A in e)&&i(r.parent,!1),A in n){const t=n[A]=n[A]||z(e[A],e);u=t(r,o),n[a]=t}else Number.isFinite(s)?(u=s+(e[A]||0),n[a]=null):u=t;return o&&u>=t&&(t=u+1),e[a]=u,u};return i}class V extends G{constructor(t,e){super(t,e),this.shadowMap=t.createTexture({width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),this.depthBuffer=t.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1,dataFormat:6402,type:5125}),this.fbo=t.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[this.shadowMap],depthStencilAttachment:this.depthBuffer})}render(t){const e=this.fbo,n=this.device.canvasContext.cssToDeviceRatio(),i=t.viewports[0],r=i.width*n,o=i.height*n;r===e.width&&o===e.height||e.resize({width:r,height:o}),super.render({...t,clearColor:[1,1,1,1],target:e,pass:"shadow"})}getLayerParameters(t,e,n){return{...t.props.parameters,blend:!1,depthRange:[0,1],depthTest:!0}}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null),this.shadowMap&&(this.shadowMap.destroy(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.destroy(),this.depthBuffer=null)}}var j=n(9350),W=n(2417),H=n(4697);const X=(0,W.A)((function({viewport:t,center:e}){return new B.k(t.viewProjectionMatrix).invert().transform(e)})),Y=(0,W.A)((function({viewport:t,shadowMatrices:e}){const n=[],i=t.pixelUnprojectionMatrix,r=t.isGeospatial?void 0:1,o=[[0,0,r],[t.width,0,r],[0,t.height,r],[t.width,t.height,r],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map((t=>function(t,e){const[n,i,r]=t,o=(0,H.xJ)([n,i,r],e);if(Number.isFinite(r))return o;return[o[0],o[1],0]}(t,i)));for(const s of e){const e=s.clone().translate(new L.P(t.center).negate()),i=o.map((t=>e.transform(t))),r=(new B.k).ortho({left:Math.min(...i.map((t=>t[0]))),right:Math.max(...i.map((t=>t[0]))),bottom:Math.min(...i.map((t=>t[1]))),top:Math.max(...i.map((t=>t[1]))),near:Math.min(...i.map((t=>-t[2]))),far:Math.max(...i.map((t=>-t[2])))});n.push(r.multiplyRight(s))}return n})),q=[0,0,0,1],Q=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];const $={name:"shadow",dependencies:[A.A],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nout vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nin vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?function(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};const i={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||q,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=X({viewport:t.viewport,center:e.project_uCenter}),o=[],s=Y({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const n=s[a],i=n.clone().translate(new L.P(t.viewport.center).negate());e.project_uCoordinateSystem===j.rf.LNGLAT&&e.project_uProjectionMode===j.Kx.WEB_MERCATOR?(s[a]=i,o[a]=r):(s[a]=n.clone().multiplyRight(Q),o[a]=i.transform(r))}for(let a=0;a<s.length;a++)i[`shadow_uViewProjectionMatrices[${a}]`]=s[a],i[`shadow_uProjectCenters[${a}]`]=o[a];for(let a=0;a<2;a++)i[`shadow_uShadowMap${a}`]=t.shadowMaps&&t.shadowMaps[a]||t.dummyShadowMap;return i}(t,e):{}},K={color:[255,255,255],intensity:1},Z=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],J=[0,0,0,200/255];class tt{constructor(t={}){this.id="lighting-effect",this.shadowColor=J,this.shadow=!1,this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.setProps(t)}setup(t){this.context=t;const{device:e,deck:n}=t;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(e),n._addDefaultShaderModule($),this.dummyShadowMap=e.createTexture({width:1,height:1}))}setProps(t){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((t=>t.shadow)),this.context&&this.setup(this.context),this.props=t}preRender({layers:t,layerFilter:e,viewports:n,onViewportActive:i,views:r}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let o=0;o<this.shadowPasses.length;o++){this.shadowPasses[o].render({layers:t,layerFilter:e,viewports:n,onViewportActive:i,views:r,moduleParameters:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((e=>e.getProjectedLight({layer:t}))),pointLights:this.pointLights.map((e=>e.getProjectedLight({layer:t})))},e}cleanup(t){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,t.deck._removeDefaultShaderModule($))}_calculateMatrices(){const t=[];for(const e of this.directionalLights){const n=(new B.k).lookAt({eye:new L.P(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new V(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;t||0!==e.length||0!==n.length||(this.ambientLight=new M(K),this.directionalLights.push(new k(Z[0]),new k(Z[1])))}}const et=new tt;class nt{constructor(t){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=t,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(t){const e=this._defaultEffects;if(!e.find((e=>e.id===t.id))){const n=e.findIndex((e=>{return n=t,(e.order??1/0)-(n.order??1/0)>0;var n}));n<0?e.push(t):e.splice(n,0,t),t.setup(this._context),this._setEffects(this.effects)}}setProps(t){"effects"in t&&((0,S.b)(t.effects,this.effects,1)||this._setEffects(t.effects))}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._resolvedEffects}_setEffects(t){const e={};for(const i of this.effects)e[i.id]=i;const n=[];for(const i of t){const t=e[i.id];let r=i;t&&t!==i?t.setProps?(t.setProps(i.props),r=t):t.cleanup(this._context):t||i.setup(this._context),n.push(r),delete e[i.id]}for(const i in e)e[i].cleanup(this._context);this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),t.some((t=>t instanceof tt))||this._resolvedEffects.push(et),this._needsRedraw="effects changed"}finalize(){for(const t of this._resolvedEffects)t.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class it extends G{shouldDrawLayer(t){const{operation:e}=t.props;return e.includes("draw")||e.includes("terrain")}}const rt={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class ot extends G{constructor(){super(...arguments),this._colorEncoderState=null}render(t){return"pickingFBO"in t?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer({layers:t,layerFilter:e,views:n,viewports:i,onViewportActive:r,pickingFBO:o,deviceRect:{x:s,y:a,width:A,height:u},cullRect:l,effects:c,pass:h="picking",pickZ:f,moduleParameters:p}){this.pickZ=f;const d=this._resetColorEncoder(f),g=[s,a,A,u],_=super.render({target:o,layers:t,layerFilter:e,views:n,viewports:i,onViewportActive:r,cullRect:l,effects:c?.filter((t=>t.useInPicking)),pass:h,isPicking:!0,moduleParameters:p,clearColor:[0,0,0,0],colorMask:15,scissorRect:g});this._colorEncoderState=null;return{decodePickingColor:d&&st.bind(null,d),stats:_}}shouldDrawLayer(t){const{pickable:e,operation:n}=t.props;return e&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getModuleParameters(){return{picking:{isActive:1,isAttribute:this.pickZ},lightSources:{}}}getLayerParameters(t,e,n){const i={depthMask:!0,depthTest:!0,depthRange:[0,1],...t.props.parameters},{pickable:r,operation:o}=t.props;return!this._colorEncoderState||o.includes("terrain")?i.blend=!1:r&&o.includes("draw")&&(Object.assign(i,rt),i.blend=!0,i.blendColor=function(t,e,n){const{byLayer:i,byAlpha:r}=t;let o,s=i.get(e);s?(s.viewports.push(n),o=s.a):(o=i.size+1,o<=255?(s={a:o,layer:e,viewports:[n]},i.set(e,s),r[o]=s):(f.A.warn("Too many pickable layers, only picking the first 255")(),o=0));return[0,0,0,o/255]}(this._colorEncoderState,t,n)),i}_resetColorEncoder(t){return this._colorEncoderState=t?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function st(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}class at{constructor(t){this.device=t,this.gl=t.gl,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new it(t),this.pickLayersPass=new ot(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){if(!t.viewports.length)return;const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...t};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target;this.lastPostProcessEffect&&(n.clearColor=[0,0,0,0],n.clearCanvas=!0);const r=e.render({...n,target:i});n.effects&&this._postRender(n.effects,n),this.renderCount++,(0,p.A)("deckRenderer.renderLayers",this,r,t)}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){this.lastPostProcessEffect=null,e.preRenderStats=e.preRenderStats||{};for(const n of t)e.preRenderStats[n.id]=n.preRender(e),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:t}=this,e=this.device.canvasContext.getDrawingBufferSize();0===t.length&&[0,1].map((e=>{const n=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});t.push(this.device.createFramebuffer({id:`deck-renderbuffer-${e}`,colorAttachments:[n]}))}));for(const n of t)n.resize(e)}_postRender(t,e){const{renderBuffers:n}=this,i={...e,inputBuffer:n[0],swapBuffer:n[1]};for(const r of t)if(r.postRender){i.target=r.id===this.lastPostProcessEffect?e.target:void 0;const t=r.postRender(i);i.inputBuffer=t,i.swapBuffer=t===n[0]?n[1]:n[0]}}}const At={pickedColor:null,pickedObjectIndex:-1};function ut({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:r,deviceRect:o}){const{x:s,y:a,width:A,height:u}=o;let l=r*r,c=-1,h=0;for(let f=0;f<u;f++){const e=f+a-i,r=e*e;if(r>l)h+=4*A;else for(let i=0;i<A;i++){if(t[h+3]-1>=0){const t=i+s-n,e=t*t+r;e<=l&&(l=e,c=h)}h+=4}}if(c>=0){const n=t.slice(c,c+4),i=e(n);if(i){const t=Math.floor(c/4/A),e=c/4-t*A;return{...i,pickedColor:n,pickedX:s+e,pickedY:a+t}}f.A.error("Picked non-existent layer. Is picking buffer corrupt?")()}return At}function lt({pickInfo:t,viewports:e,pixelRatio:n,x:i,y:r,z:o}){let s,a=e[0];if(e.length>1&&(a=function(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}(t?.pickedViewports||e,{x:i,y:r})),a){const t=[i-a.x,r-a.y];void 0!==o&&(t[2]=o),s=a.unproject(t)}return{color:null,layer:null,viewport:a,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:s,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function ct(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=e,A=s?[s]:[];if("hover"===i){const t=n.index,e=n.layerId,i=s?s.props.id:null;if(i!==e||a!==t){if(i!==e){const t=r.find((t=>t.props.id===e));t&&A.unshift(t)}n.layerId=i,n.index=a,n.info=null}}const u=lt(t),l=new Map;return l.set(null,u),A.forEach((t=>{let e={...u};t===s&&(e.color=o,e.index=a,e.picked=!0),e=ht({layer:t,info:e,mode:i});const r=e.layer;t===s&&"hover"===i&&(n.info=e),l.set(r.id,e),"hover"===i&&r.updateAutoHighlight(e)})),l}function ht({layer:t,info:e,mode:n}){for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}class ft{constructor(t){this._pickable=!0,this.device=t,this.pickLayersPass=new ot(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:e,layers:n,viewports:i},r=this.lastPickedInfo.info){const o=r&&r.layer&&r.layer.id,s=r&&r.viewport&&r.viewport.id,a=o?n.find((t=>t.id===o)):null,A=s&&i.find((t=>t.id===s))||i[0],u=A&&A.unproject([t-A.x,e-A.y]),l={x:t,y:e,viewport:A,coordinate:u,layer:a};return{...r,...l}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const t=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=t}const t=this.device.gl;this.pickingFBO?.resize({width:t.canvas.width,height:t.canvas.height}),this.depthFBO?.resize({width:t.canvas.width,height:t.canvas.height})}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter((t=>this.pickLayersPass.shouldDrawLayer(t)&&!t.isComposite));return e.length?e:null}_pickClosestObject({layers:t,views:e,viewports:n,x:i,y:r,radius:o=0,depth:s=1,mode:a="query",unproject3D:A,onViewportActive:u,effects:l}){const c=this.device.canvasContext.cssToDeviceRatio(),h=this._getPickable(t);if(!h||0===n.length)return{result:[],emptyInfo:lt({viewports:n,x:i,y:r,pixelRatio:c})};this._resizeBuffer();const f=this.device.canvasContext.cssToDevicePixels([i,r],!0),p=[f.x+Math.floor(f.width/2),f.y+Math.floor(f.height/2)],d=Math.round(o*c),{width:g,height:_}=this.pickingFBO,m=this._getPickingRect({deviceX:p[0],deviceY:p[1],deviceRadius:d,deviceWidth:g,deviceHeight:_}),y={x:i-o,y:r-o,width:2*o+1,height:2*o+1};let v;const E=[],b=new Set;for(let w=0;w<s;w++){let t,o;if(m){t=ut({...this._drawAndSample({layers:h,views:e,viewports:n,onViewportActive:u,deviceRect:m,cullRect:y,effects:l,pass:`picking:${a}`}),deviceX:p[0],deviceY:p[1],deviceRadius:d,deviceRect:m})}else t={pickedColor:null,pickedObjectIndex:-1};if(t.pickedLayer&&A&&this.depthFBO){const{pickedColors:i}=this._drawAndSample({layers:[t.pickedLayer],views:e,viewports:n,onViewportActive:u,deviceRect:{x:t.pickedX,y:t.pickedY,width:1,height:1},cullRect:y,effects:l,pass:`picking:${a}:z`},!0);i[3]&&(o=i[0])}t.pickedLayer&&w+1<s&&(b.add(t.pickedLayer),t.pickedLayer.disablePickingIndex(t.pickedObjectIndex)),v=ct({pickInfo:t,lastPickedInfo:this.lastPickedInfo,mode:a,layers:h,viewports:n,x:i,y:r,z:o,pixelRatio:c});for(const e of v.values())e.layer&&E.push(e);if(!t.pickedColor)break}for(const w of b)w.restorePickingColors();return{result:E,emptyInfo:v.get(null)}}_pickVisibleObjects({layers:t,views:e,viewports:n,x:i,y:r,width:o=1,height:s=1,mode:a="query",maxObjects:A=null,onViewportActive:u,effects:l}){const c=this._getPickable(t);if(!c||0===n.length)return[];this._resizeBuffer();const h=this.device.canvasContext.cssToDeviceRatio(),p=this.device.canvasContext.cssToDevicePixels([i,r],!0),d=p.x,g=p.y+p.height,_=this.device.canvasContext.cssToDevicePixels([i+o,r+s],!0),m=_.x+_.width,y=_.y,v={x:d,y:y,width:m-d,height:g-y},E=function({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t)for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const r=t.slice(i,i+4),o=r.join(",");if(!n.has(o)){const t=e(r);t?n.set(o,{...t,color:r}):f.A.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(n.values())}(this._drawAndSample({layers:c,views:e,viewports:n,onViewportActive:u,deviceRect:v,cullRect:{x:i,y:r,width:o,height:s},effects:l,pass:`picking:${a}`})),b=new Map,w=[],x=Number.isFinite(A);for(let f=0;f<E.length&&!(x&&w.length>=A);f++){const t=E[f];let e={color:t.pickedColor,layer:null,index:t.pickedObjectIndex,picked:!0,x:i,y:r,pixelRatio:h};e=ht({layer:t.pickedLayer,info:e,mode:a});const n=e.layer.id;b.has(n)||b.set(n,new Set);const o=b.get(n),s=e.object??e.index;o.has(s)||(o.add(s),w.push(e))}return w}_drawAndSample({layers:t,views:e,viewports:n,onViewportActive:i,deviceRect:r,cullRect:o,effects:s,pass:a},A=!1){const u=A?this.depthFBO:this.pickingFBO,l={layers:t,layerFilter:this.layerFilter,views:e,viewports:n,onViewportActive:i,pickingFBO:u,deviceRect:r,cullRect:o,effects:s,pass:a,pickZ:A,preRenderStats:{}};for(const _ of s)_.useInPicking&&(l.preRenderStats[_.id]=_.preRender(l));const{decodePickingColor:c}=this.pickLayersPass.render(l),{x:h,y:f,width:p,height:d}=r,g=new(A?Float32Array:Uint8Array)(p*d*4);return this.device.readPixelsToArrayWebGL(u,{sourceX:h,sourceY:f,sourceWidth:p,sourceHeight:d,target:g}),{pickedColors:g,decodePickingColor:c}}_getPickingRect({deviceX:t,deviceY:e,deviceRadius:n,deviceWidth:i,deviceHeight:r}){const o=Math.max(0,t-n),s=Math.max(0,e-n),a=Math.min(i,t+n+1)-o,A=Math.min(r,e+n+1)-s;return a<=0||A<=0?null:{x:o,y:s,width:a,height:A}}}const pt={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},dt="top-left",gt="__root";class _t{constructor({deck:t,parentElement:e}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=t,this.parentElement=e}getWidgets(){return this.resolvedWidgets}setProps(t){t.widgets&&!(0,S.b)(t.widgets,this.widgets,1)&&this._setWidgets(t.widgets)}finalize(){for(const t of this.getWidgets())this._remove(t);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const t in this.containers)this.containers[t].remove()}addDefault(t){this.defaultWidgets.find((e=>e.id===t.id))||(this._add(t),this.defaultWidgets.push(t),this._setWidgets(this.widgets))}_setWidgets(t){const e={};for(const n of this.resolvedWidgets)e[n.id]=n;this.resolvedWidgets.length=0;for(const n of this.defaultWidgets)e[n.id]=null,this.resolvedWidgets.push(n);for(let n of t){const t=e[n.id];t?t.viewId!==n.viewId||t.placement!==n.placement?(this._remove(t),this._add(n)):n!==t&&(t.setProps(n.props),n=t):this._add(n),e[n.id]=null,this.resolvedWidgets.push(n)}for(const n in e){const t=e[n];t&&this._remove(t)}this.widgets=t}_add(t){const{viewId:e=null,placement:n=dt}=t,i=t.onAdd({deck:this.deck,viewId:e});i&&this._getContainer(e,n).append(i),t._element=i}_remove(t){t.onRemove(),t._element&&t._element.remove(),t._element=void 0}_getContainer(t,e){const n=t||gt;let i=this.containers[n];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",this.parentElement?.append(i),this.containers[n]=i);let r=i.querySelector(`.${e}`);return r||(r=document.createElement("div"),r.className=e,r.style.position="absolute",Object.assign(r.style,pt[e]),i.append(r)),r}_updateContainers(){const t=this.deck.width,e=this.deck.height;for(const n in this.containers){const i=this.lastViewports[n]||null,r=n===gt||i,o=this.containers[n];r?(o.style.display="block",o.style.left=`${i?i.x:0}px`,o.style.top=`${i?i.y:0}px`,o.style.width=`${i?i.width:t}px`,o.style.height=`${i?i.height:e}px`):o.style.display="none"}}onRedraw({viewports:t,layers:e}){const n=t.reduce(((t,e)=>(t[e.id]=e,t)),{}),{lastViewports:i}=this;for(const r of this.getWidgets()){const{viewId:o}=r;if(o){const t=n[o];t&&(r.onViewportChange&&!t.equals(i[o])&&r.onViewportChange(t),r.onRedraw?.({viewports:[t],layers:e}))}else{if(r.onViewportChange)for(const e of t)e.equals(i[e.id])||r.onViewportChange(e);r.onRedraw?.({viewports:t,layers:e})}}this.lastViewports=n,this._updateContainers()}onHover(t,e){for(const n of this.getWidgets()){const{viewId:i}=n;i&&i!==t.viewport?.id||n.onHover?.(t,e)}}onEvent(t,e){const n=j.qY[e.type];if(n)for(const i of this.getWidgets()){const{viewId:r}=i;r&&r!==t.viewport?.id||i[n.handler]?.(t,e)}}}const mt={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class yt{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:t}){const e=document.createElement("div");return e.className="deck-tooltip",Object.assign(e.style,mt),this.deck=t,this.element=e,e}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(t){this.isVisible&&t.id===this.lastViewport?.id&&t!==this.lastViewport&&this.setTooltip(null)}onHover(t){const{deck:e}=this,n=e&&e.props.getTooltip;if(!n)return;const i=n(t);this.lastViewport=t.viewport,this.setTooltip(i,t.x,t.y)}setTooltip(t,e,n){const i=this.element;if(i){if("string"==typeof t)i.innerText=t;else{if(!t)return this.isVisible=!1,void(i.style.display="none");t.text&&(i.innerText=t.text),t.html&&(i.innerHTML=t.html),t.className&&(i.className=t.className)}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${e}px, ${n}px)`,t&&"object"==typeof t&&"style"in t&&Object.assign(i.style,t.style)}}}var vt=n(5840),Et=n(5223);var bt=n(4976),wt=n(7612);const xt=globalThis.loaders?.parseImageNode,St="undefined"!=typeof Image,Ct="undefined"!=typeof ImageBitmap,Tt=Boolean(xt),It=!!wt.Bd||Tt;function Rt(t){const e=Mt(t);if(!e)throw new Error("Not an image");return e}function Pt(t){switch(Rt(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function Mt(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"==typeof t&&t.data&&t.width&&t.height?"data":null}const Lt=/^data:image\/svg\+xml/,Nt=/\.svg((\?|#).*)?$/;function Ot(t){return t&&(Lt.test(t)||Nt.test(t))}function Dt(t,e){if(Ot(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Ft(t,e,n){const i=function(t,e){if(Ot(e)){let e=(new TextDecoder).decode(t);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(e=unescape(encodeURIComponent(e)))}catch(n){throw new Error(n.message)}return`data:image/svg+xml;base64,${btoa(e)}`}return Dt(t,e)}(t,n),r=self.URL||self.webkitURL,o="string"!=typeof i&&r.createObjectURL(i);try{return await async function(t,e){const n=new Image;if(n.src=t,e.image&&e.image.decode&&n.decode)return await n.decode(),n;return await new Promise(((t,e)=>{try{n.onload=()=>t(n),n.onerror=t=>{const n=t instanceof Error?t.message:"error";e(new Error(n))}}catch(i){e(i)}}))}(o||i,e)}finally{o&&r.revokeObjectURL(o)}}const kt={};let Bt=!0;async function Ut(t,e,n){let i;if(Ot(n)){i=await Ft(t,e,n)}else i=Dt(t,n);const r=e&&e.imagebitmap;return await async function(t,e=null){!function(t){for(const e in t||kt)return!1;return!0}(e)&&Bt||(e=null);if(e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),Bt=!1}return await createImageBitmap(t)}(i,r)}function Gt(t){return function(t,e,n=0){const i=(r=e,[...r].map((t=>t.charCodeAt(0))));var r;for(let o=0;o<i.length;++o)if(i[o]!==t[o+n])return!1;return!0}(t,"ftyp",4)&&96&t[8]?function(t){switch((e=t,n=8,i=12,String.fromCharCode(...e.slice(n,i))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var e,n,i}(t):null}const zt=!1,Vt=!0;function jt(t){const e=Wt(t);return function(t){const e=Wt(t),n=e.byteLength>=24&&2303741511===e.getUint32(0,zt);if(!n)return null;return{mimeType:"image/png",width:e.getUint32(16,zt),height:e.getUint32(20,zt)}}(e)||function(t){const e=Wt(t),n=e.byteLength>=3&&65496===e.getUint16(0,zt)&&255===e.getUint8(2);if(!n)return null;const{tableMarkers:i,sofMarkers:r}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);const e=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:t,sofMarkers:e}}();let o=2;for(;o+9<e.byteLength;){const t=e.getUint16(o,zt);if(r.has(t))return{mimeType:"image/jpeg",height:e.getUint16(o+5,zt),width:e.getUint16(o+7,zt)};if(!i.has(t))return null;o+=2,o+=e.getUint16(o,zt)}return null}(e)||function(t){const e=Wt(t),n=e.byteLength>=10&&1195984440===e.getUint32(0,zt);if(!n)return null;return{mimeType:"image/gif",width:e.getUint16(6,Vt),height:e.getUint16(8,Vt)}}(e)||function(t){const e=Wt(t),n=e.byteLength>=14&&16973===e.getUint16(0,zt)&&e.getUint32(2,Vt)===e.byteLength;if(!n)return null;return{mimeType:"image/bmp",width:e.getUint32(18,Vt),height:e.getUint32(22,Vt)}}(e)||function(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=Gt(e);if(!n)return null;return{mimeType:n.mimeType,width:0,height:0}}(e)}function Wt(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}const Ht={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:"4.2.0",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(t,e,n){const i=((e=e||{}).image||{}).type||"auto",{url:r}=n||{};let o;switch(function(t){switch(t){case"auto":case"data":return function(){if(Ct)return"imagebitmap";if(St)return"image";if(It)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return Ct||St||It;case"imagebitmap":return Ct;case"image":return St;case"data":return It;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}(t),t}}(i)){case"imagebitmap":o=await Ut(t,e,r);break;case"image":o=await Ft(t,e,r);break;case"data":o=await async function(t,e){const{mimeType:n}=jt(t)||{},i=globalThis.loaders?.parseImageNode;return(0,bt.v)(i),await i(t,n)}(t);break;default:(0,bt.v)(!1)}return"data"===i&&(o=Pt(o)),o},tests:[t=>Boolean(jt(new DataView(t)))],options:{image:{type:"auto",decode:!0}}};const Xt={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(t){const e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n},parseTextSync:JSON.parse};const Yt=function(){const t="9.0.12",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${t}`);return e||(f.A.log(1,`deck.gl ${t}`)(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:f.A,_registerLoggers:p.k},(0,Et.mk)([Xt,[Ht,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}();var qt=n(6769),Qt=n(9651);const $t=new class{stats=new Map;getStats(t){return this.get(t)}get(t){return this.stats.has(t)||this.stats.set(t,new y({id:t})),this.stats.get(t)}};const Kt=function(){const t="9.0.12";if(globalThis.luma&&globalThis.luma.VERSION!==t)throw new Error(`luma.gl - multiple VERSIONs detected: ${globalThis.luma.VERSION} vs ${t}`);return globalThis.luma||((0,qt.A)()&&Qt.R.log(1,`${t} - set luma.log.level=1 (or higher) to trace rendering`)(),globalThis.luma=globalThis.luma||{VERSION:t,version:t,log:Qt.R,stats:$t}),t}();var Zt=n(8264),Jt=n(6839),te=n(9202);const ee=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],ne=/^(rg?b?a?)([0-9]*)([a-z]*)(-srgb)?(-webgl|-unsized)?$/;function ie(t){const e=ne.exec(t);if(e){const[,t,n,i,r,o]=e;if(t){const e=`${i}${n}`,s=(0,te.l)(e);return{format:t,components:t.length,srgb:"-srgb"===r,unsized:"-unsized"===o,webgl:"-webgl"===o,...s}}}return function(t){const e=re[t];if(!e)throw new Error(`Unknown format ${t}`);return{format:e.format||"",components:e.components||e.format?.length||1,byteLength:e.bpp||1,srgb:!1,unsized:!1}}(t)}const re={"rgba4unorm-webgl":{format:"rgba",bpp:2},"rgb565unorm-webgl":{format:"rgb",bpp:2},"rgb5a1unorm-webgl":{format:"rgba",bbp:2},rgb9e5ufloat:{format:"rgb",bbp:4},rg11b10ufloat:{format:"rgb",bbp:4},rgb10a2unorm:{format:"rgba",bbp:4},"rgb10a2uint-webgl":{format:"rgba",bbp:4},stencil8:{components:1,bpp:1,a:"stencil"},depth16unorm:{components:1,bpp:2,a:"depth"},depth24plus:{components:1,bpp:3,a:"depth"},depth32float:{components:1,bpp:4,a:"depth"},"depth24plus-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth24unorm-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth32float-stencil8":{components:2,bpp:4,a:"depth-stencil"}};class oe{}class se{features;disabledFeatures;constructor(t=[],e){this.features=new Set(t),this.disabledFeatures=e||{}}*[Symbol.iterator](){yield*this.features}has(t){return!this.disabledFeatures[t]&&this.features.has(t)}}class ae{static defaultProps={id:null,canvas:null,container:null,manageState:!0,width:800,height:600,requestMaxLimits:!0,debug:Boolean(Qt.R.get("debug")),spector:Boolean(Qt.R.get("spector")||Qt.R.get("spectorjs")),break:[],initalizeFeatures:!0,disabledFeatures:{"compilation-status-async-webgl":!0},gl:null,onError:t=>Qt.R.error(t.message)};get[Symbol.toStringTag](){return"Device"}static VERSION=Kt;constructor(t){this.props={...ae.defaultProps,...t},this.id=this.props.id||(0,Zt.L)(this[Symbol.toStringTag].toLowerCase())}id;props;userData={};statsManager=$t;_lumaData={};isTextureFormatCompressed(t){return e=t,ee.some((t=>e.startsWith(t)));var e}loseDevice(){return!1}getCanvasContext(){if(!this.canvasContext)throw new Error("Device has no CanvasContext");return this.canvasContext}createTexture(t){return(t instanceof Promise||"string"==typeof t)&&(t={data:t}),this._createTexture(t)}createCommandEncoder(t={}){throw new Error("not implemented")}readPixelsToArrayWebGL(t,e){throw new Error("not implemented")}readPixelsToBufferWebGL(t,e){throw new Error("not implemented")}setParametersWebGL(t){throw new Error("not implemented")}getParametersWebGL(t){throw new Error("not implemented")}withParametersWebGL(t,e){throw new Error("not implemented")}clearWebGL(t){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}timestamp=0;incrementTimestamp(){return this.timestamp++}onError(t){this.props.onError(t)}_getBufferProps(t){(t instanceof ArrayBuffer||ArrayBuffer.isView(t))&&(t={data:t});const e={...t};return(t.usage||0)&Jt.h.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?e.indexType="uint32":t.data instanceof Uint16Array?e.indexType="uint16":Qt.R.warn("indices buffer content must be of integer type")()),e}}var Ae=n(979);const ue=new Map;class le{static defaultProps={...ae.defaultProps,type:"best-available",devices:void 0};static stats=$t;static log=Qt.R;static registerDevices(t){for(const e of t)(0,Ae.v)(e.type&&e.isSupported&&e.create),ue.set(e.type,e)}static getAvailableDevices(){return Array.from(ue).map((t=>t.type))}static getSupportedDevices(){return Array.from(ue).filter((t=>t.isSupported())).map((t=>t.type))}static setDefaultDeviceProps(t){Object.assign(ae.defaultProps,t)}static async attachDevice(t){const e=ce(t.devices)||ue;if(t.handle instanceof WebGL2RenderingContext){const n=e.get("webgl");if(n)return await n.attach(t.handle)}if(null===t.handle){const t=e.get("unknown");if(t)return await t.attach(null)}throw new Error("Failed to attach device. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static async createDevice(t={}){(t={...le.defaultProps,...t}).gl&&(t.type="webgl");const e=ce(t.devices)||ue;switch(t.type){case"webgpu":let n=e.get("webgpu");if(n)return await n.create(t);break;case"webgl":let i=e.get("webgl");if(i)return await i.create(t);break;case"unknown":const r=e.get("unknown");if(r)return await r.create(t);break;case"best-available":if(n=e.get("webgpu"),n?.isSupported?.())return await n.create(t);if(i=e.get("webgl"),i?.isSupported?.())return await i.create(t)}throw new Error("No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static enforceWebGL2(t=!0){const e=HTMLCanvasElement.prototype;if(!t&&e.originalGetContext)return e.getContext=e.originalGetContext,void(e.originalGetContext=void 0);e.originalGetContext=e.getContext,e.getContext=function(t,e){return"webgl"===t||"experimental-webgl"===t?this.originalGetContext("webgl2",e):this.originalGetContext(t,e)}}}function ce(t){if(!t||0===t?.length)return null;const e=new Map;for(const n of t)e.set(n.type,n);return e}const he=(0,qt.A)()&&"undefined"!=typeof document,fe=()=>he&&"complete"===document.readyState,pe={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,colorSpace:"srgb",alphaMode:"opaque"};class de{id;props;canvas;htmlCanvas;offscreenCanvas;type;width=1;height=1;resizeObserver;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};static get isPageLoaded(){return fe()}static pageLoaded=function(){if(fe()||"undefined"==typeof window)return Promise.resolve();return new Promise((t=>{window.addEventListener("load",(()=>t()))}))}();constructor(t){if(this.props={...pe,...t},t=this.props,!(0,qt.A)())return this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,void(this.canvas=null);if(t.canvas)"string"==typeof t.canvas?this.canvas=function(t){const e=document.getElementById(t);if(!e&&!fe())throw new Error(`Accessing '${t}' before page was loaded`);if(!(e instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return e}(t.canvas):this.canvas=t.canvas;else{const e=function(t){const{width:e,height:n}=t,i=document.createElement("canvas");return i.id="lumagl-auto-created-canvas",i.width=e||1,i.height=n||1,i.style.width=Number.isFinite(e)?`${e}px`:"100%",i.style.height=Number.isFinite(n)?`${n}px`:"100%",i}(t),n=function(t){if("string"==typeof t){const e=document.getElementById(t);if(!e&&!fe())throw new Error(`Accessing '${t}' before page was loaded`);if(!e)throw new Error(`${t} is not an HTML element`);return e}if(t)return t;return document.body}(t?.container||null);n.insertBefore(e,n.firstChild),this.canvas=e,t?.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&t.autoResize&&(this.resizeObserver=new ResizeObserver((t=>{for(const e of t)e.target===this.canvas&&this.update()})),this.resizeObserver.observe(this.canvas))}getDevicePixelRatio(t){if("undefined"!=typeof OffscreenCanvas&&this.canvas instanceof OffscreenCanvas)return 1;if(!(t=void 0===t?this.props.useDevicePixels:t)||t<=0)return 1;if(!0===t){return"undefined"!=typeof window&&window.devicePixelRatio||1}return t}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const t=this.getDevicePixelRatio(),e=this.canvas;return e.parentElement?[e.clientWidth*t,e.clientHeight*t]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[t,e]=this.getPixelSize();return t/e}cssToDeviceRatio(){try{const[t]=this.getDrawingBufferSize(),{clientWidth:e}=this._canvasSizeInfo;return e?t/e:1}catch{return 1}}cssToDevicePixels(t,e=!0){const n=this.cssToDeviceRatio(),[i,r]=this.getDrawingBufferSize();return function(t,e,n,i,r){const o=t,s=ge(o[0],e,n);let a=_e(o[1],e,i,r),A=ge(o[0]+1,e,n);const u=A===n-1?A:A-1;let l;A=_e(o[1]+1,e,i,r),r?(A=0===A?A:A+1,l=a,a=A):l=A===i-1?A:A-1;return{x:s,y:a,width:Math.max(u-s+1,1),height:Math.max(l-a+1,1)}}(t,n,i,r,e)}setDevicePixelRatio(t,e={}){if(!this.htmlCanvas)return;let n="width"in e?e.width:this.htmlCanvas.clientWidth,i="height"in e?e.height:this.htmlCanvas.clientHeight;n&&i||(Qt.R.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,n=this.htmlCanvas.width||1,i=this.htmlCanvas.height||1);const r=this._canvasSizeInfo;if(r.clientWidth!==n||r.clientHeight!==i||r.devicePixelRatio!==t){let e=t;const r=Math.floor(n*e),o=Math.floor(i*e);this.htmlCanvas.width=r,this.htmlCanvas.height=o;const[s,a]=this.getDrawingBufferSize();s===r&&a===o||(e=Math.min(s/n,a/i),this.htmlCanvas.width=Math.floor(n*e),this.htmlCanvas.height=Math.floor(i*e),Qt.R.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=n,this._canvasSizeInfo.clientHeight=i,this._canvasSizeInfo.devicePixelRatio=t}}getDrawingBufferSize(){const t=this.device.gl;if(!t)throw new Error("canvas size");return[t.drawingBufferWidth,t.drawingBufferHeight]}_setAutoCreatedCanvasId(t){"lumagl-auto-created-canvas"===this.htmlCanvas?.id&&(this.htmlCanvas.id=t)}}function ge(t,e,n){return Math.min(Math.round(t*e),n-1)}function _e(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const me={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},ye=(t,e,n)=>e?t.enable(n):t.disable(n),ve=(t,e,n)=>t.hint(n,e),Ee=(t,e,n)=>t.pixelStorei(n,e),be=(t,e,n)=>{const i=36006===n?36009:36008;return t.bindFramebuffer(i,e)},we=(t,e,n)=>{const i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[n];t.bindBuffer(i,e)};function xe(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}const Se={3042:ye,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:ye,2885:(t,e)=>t.cullFace(e),2929:ye,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:ye,35723:ve,35725:(t,e)=>t.useProgram(e),36007:(t,e)=>t.bindRenderbuffer(36161,e),36389:(t,e)=>t.bindTransformFeedback?.(36386,e),34229:(t,e)=>t.bindVertexArray(e),36006:be,36010:be,34964:we,36662:we,36663:we,35053:we,35055:we,2886:(t,e)=>t.frontFace(e),33170:ve,2849:(t,e)=>t.lineWidth(e),32823:ye,32824:"polygonOffset",10752:"polygonOffset",35977:ye,32926:ye,32928:ye,32938:"sampleCoverage",32939:"sampleCoverage",3089:ye,3088:(t,e)=>t.scissor(...e),2960:ye,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),34383:ye,10754:ye,12288:ye,12289:ye,12290:ye,12291:ye,12292:ye,12293:ye,12294:ye,12295:ye,3333:Ee,3317:Ee,37440:Ee,37441:Ee,37443:Ee,3330:Ee,3332:Ee,3331:Ee,3314:Ee,32878:Ee,3316:Ee,3315:Ee,32877:Ee,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{const n="number"==typeof e?[e,e]:e;t.blendEquationSeparate(...n)},blendFunc:(t,e)=>{const n=2===e?.length?[...e,...e]:e;t.blendFuncSeparate(...n)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=xe(e)?e:[e,e];const[n,i]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=xe(e)&&3===e.length?[...e,...e]:e;const[n,i,r,o,s,a]=e;t.stencilFuncSeparate(1028,n,i,r),t.stencilFuncSeparate(1029,o,s,a)},stencilOp:(t,e)=>{e=xe(e)&&3===e.length?[...e,...e]:e;const[n,i,r,o,s,a]=e;t.stencilOpSeparate(1028,n,i,r),t.stencilOpSeparate(1029,o,s,a)},viewport:(t,e)=>t.viewport(...e)};function Ce(t,e,n){return void 0!==e[t]?e[t]:n[t]}const Te={blendEquation:(t,e,n)=>t.blendEquationSeparate(Ce(32777,e,n),Ce(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Ce(32969,e,n),Ce(32968,e,n),Ce(32971,e,n),Ce(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Ce(32824,e,n),Ce(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Ce(32938,e,n),Ce(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Ce(2962,e,n),Ce(2967,e,n),Ce(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Ce(34816,e,n),Ce(36003,e,n),Ce(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Ce(2964,e,n),Ce(2965,e,n),Ce(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Ce(34817,e,n),Ce(34818,e,n),Ce(34819,e,n))},Ie={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),useProgram:(t,e)=>t({35725:e}),bindRenderbuffer:(t,e,n)=>t({36007:n}),bindTransformFeedback:(t,e,n)=>t({36389:n}),bindVertexArray:(t,e)=>t({34229:e}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},bindBuffer:(t,e,n)=>{const i={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return i?t({[i]:n}):{valueChanged:!0}},blendColor:(t,e,n,i,r)=>t({32773:new Float32Array([e,n,i,r])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,i,r)=>t({32969:e,32968:n,32971:i,32970:r}),clearColor:(t,e,n,i,r)=>t({3106:new Float32Array([e,n,i,r])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,i,r)=>t({3107:[e,n,i,r]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,i,r)=>t({3088:new Int32Array([e,n,i,r])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[1028===e?2968:36005]:n}),stencilFunc:(t,e,n,i)=>t({2962:e,2967:n,2963:i,34816:e,36003:n,36004:i}),stencilFuncSeparate:(t,e,n,i,r)=>t({[1028===e?2962:34816]:n,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(t,e,n,i)=>t({2964:e,2965:n,2966:i,34817:e,34818:n,34819:i}),stencilOpSeparate:(t,e,n,i,r)=>t({[1028===e?2964:34817]:n,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(t,e,n,i,r)=>t({2978:[e,n,i,r]})},Re=(t,e)=>t.isEnabled(e),Pe={3042:Re,2884:Re,2929:Re,3024:Re,32823:Re,32926:Re,32928:Re,3089:Re,2960:Re,35977:Re},Me=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function Le(t,e){if(function(t){for(const e in t)return!1;return!0}(e))return;const n={};for(const r in e){const i=Number(r),o=Se[r];o&&("string"==typeof o?n[o]=!0:o(t,e[r],i))}const i=t.state&&t.state.cache;if(i)for(const r in n){(0,Te[r])(t,e,i)}}function Ne(t,e=me){if("number"==typeof e){const n=e,i=Pe[n];return i?i(t,n):t.getParameter(n)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const r of n){const e=Pe[r];i[r]=e?e(t,Number(r)):t.getParameter(Number(r))}return i}function Oe(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),i=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&i&&t.length===e.length){for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}return!1}class De{gl;program=null;stateStack=[];enable=!0;cache;log;constructor(t,{copyState:e=!1,log:n=(()=>{})}={}){this.gl=t,this.cache=e?Ne(t):Object.assign({},me),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(t={}){this.stateStack.push({})}pop(){(0,Ae.v)(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];Le(this.gl,t),this.stateStack.pop()}_updateCache(t){let e,n=!1;const i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const r in t){(0,Ae.v)(void 0!==r);const o=t[r],s=this.cache[r];Oe(o,s)||(n=!0,e=s,i&&!(r in i)&&(i[r]=s),this.cache[r]=o)}return{valueChanged:n,oldValue:e}}}function Fe(t){return t.state}function ke(t,e){const{enable:n=!0,copyState:i}=e;if((0,Ae.v)(void 0!==i),!t.state){t.state=new De(t,{copyState:i}),function(t){const e=t.useProgram.bind(t);t.useProgram=function(n){const i=Fe(t);i.program!==n&&(e(n),i.program=n)}}(t);for(const e in Ie){ze(t,e,Ie[e])}Ge(t,"getParameter"),Ge(t,"isEnabled")}return Fe(t).enable=n,t}function Be(t){let e=Fe(t);e||(ke(t,{copyState:!1}),e=Fe(t)),e.push()}function Ue(t){const e=Fe(t);(0,Ae.v)(e),e.pop()}function Ge(t,e){const n=t[e].bind(t);t[e]=function(e){if(void 0===e||Me.has(e))return n(e);const i=Fe(t);return e in i.cache||(i.cache[e]=n(e)),i.enable?i.cache[e]:n(e)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function ze(t,e,n){if(!t[e])return;const i=t[e].bind(t);t[e]=function(...e){const r=Fe(t),{valueChanged:o,oldValue:s}=n(r._updateCache,...e);return o&&i(...e),s},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}const Ve={powerPreference:"high-performance",onContextLost:()=>console.error("WebGL context lost"),onContextRestored:()=>console.info("WebGL context restored")};function je(t,e,n){return void 0===n[e]&&(n[e]=t.getExtension(e)||null),n[e]}function We(t,e){const n=t.getParameter(7936),i=t.getParameter(7937);je(t,"WEBGL_debug_renderer_info",e);const r=e.WEBGL_debug_renderer_info,o=t.getParameter(r?r.UNMASKED_VENDOR_WEBGL:7936)||n,s=t.getParameter(r?r.UNMASKED_RENDERER_WEBGL:7937)||i,a=t.getParameter(7938),A=He(o,s),u=function(t,e){if(/Metal/i.exec(t)||/Metal/i.exec(e))return"metal";if(/ANGLE/i.exec(t)||/ANGLE/i.exec(e))return"opengl";return"unknown"}(o,s),l=function(t,e){if(/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e))return"cpu";switch(He(t,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}(o,s);return{type:"webgl",gpu:A,gpuType:l,gpuBackend:u,vendor:o,renderer:s,version:a,shadingLanguage:"glsl",shadingLanguageVersion:300}}function He(t,e){return/NVIDIA/i.exec(t)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(t)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(t)||/Apple/i.exec(e)?"apple":/AMD/i.exec(t)||/AMD/i.exec(e)||/ATI/i.exec(t)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e)?"software":"unknown"}function Xe(t){switch(t){case"uint8":case"unorm8":return 5121;case"sint8":case"snorm8":return 5120;case"uint16":case"unorm16":return 5123;case"sint16":case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(t))}const Ye="texture-compression-bc",qe="texture-compression-astc",Qe="texture-compression-etc2",$e="texture-compression-pvrtc-webgl",Ke="texture-compression-atc-webgl",Ze="float32-renderable-webgl",Je="float16-renderable-webgl",tn="snorm8-renderable-webgl",en="norm16-renderable-webgl",nn="snorm16-renderable-webgl",rn="float32-filterable",on="float16-filterable-webgl",sn="WEBGL_compressed_texture_s3tc",an="WEBGL_compressed_texture_s3tc_srgb",An="EXT_texture_compression_rgtc",un="EXT_texture_compression_bptc",ln="EXT_texture_norm16",cn="EXT_render_snorm",hn={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat_renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[cn],"norm16-renderable-webgl":[ln],"snorm16-renderable-webgl":[ln,cn],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[sn,an,An,un],"texture-compression-bc5-webgl":[An],"texture-compression-bc7-webgl":[un],"texture-compression-etc2":["WEBGL_compressed_texture_etc"],"texture-compression-astc":["WEBGL_compressed_texture_astc"],"texture-compression-etc1-webgl":["WEBGL_compressed_texture_etc1"],"texture-compression-pvrtc-webgl":["WEBGL_compressed_texture_pvrtc"],"texture-compression-atc-webgl":["WEBGL_compressed_texture_atc"]};function fn(t,e,n){return(hn[e]||[]).every((e=>je(t,e,n)))}const pn={"rgb8unorm-unsized":{gl:6407,b:4,c:2,bpp:4,dataFormat:6407,types:[5121,33635]},"rgba8unorm-unsized":{gl:6408,b:4,c:2,bpp:4,dataFormat:6408,types:[5121,32819,32820]},r8unorm:{gl:33321,b:1,c:1,rb:!0},r8snorm:{gl:36756,b:1,c:1,render:tn},r8uint:{gl:33330,b:1,c:1,rb:!0},r8sint:{gl:33329,b:1,c:1,rb:!0},rg8unorm:{gl:33323,b:2,c:2,rb:!0},rg8snorm:{gl:36757,b:2,c:2,render:tn},rg8uint:{gl:33336,b:2,c:2,rb:!0},rg8sint:{gl:33335,b:2,c:2,rb:!0},r16uint:{gl:33332,b:2,c:1,rb:!0},r16sint:{gl:33331,b:2,c:1,rb:!0},r16float:{gl:33325,b:2,c:1,render:Je,filter:"float16-filterable-webgl",rb:!0},"r16unorm-webgl":{gl:33322,b:2,c:1,f:en,rb:!0},"r16snorm-webgl":{gl:36760,b:2,c:1,f:nn},"rgba4unorm-webgl":{gl:32854,b:2,c:4,wgpu:!1,rb:!0},"rgb565unorm-webgl":{gl:36194,b:2,c:4,wgpu:!1,rb:!0},"rgb5a1unorm-webgl":{gl:32855,b:2,c:4,wgpu:!1,rb:!0},"rgb8unorm-webgl":{gl:32849,b:3,c:3,wgpu:!1},"rgb8snorm-webgl":{gl:36758,b:3,c:3,wgpu:!1},rgba8unorm:{gl:32856,b:4,c:2,bpp:4},"rgba8unorm-srgb":{gl:35907,b:4,c:4,bpp:4},rgba8snorm:{gl:36759,b:4,c:4,render:tn},rgba8uint:{gl:36220,b:4,c:4,bpp:4},rgba8sint:{gl:36238,b:4,c:4,bpp:4},bgra8unorm:{b:4,c:4},"bgra8unorm-srgb":{b:4,c:4},rg16uint:{gl:33338,b:4,c:1,bpp:4},rg16sint:{gl:33337,b:4,c:2,bpp:4},rg16float:{gl:33327,bpp:4,b:4,c:2,render:Je,filter:on,rb:!0},"rg16unorm-webgl":{gl:33324,b:2,c:2,render:en},"rg16snorm-webgl":{gl:36761,b:2,c:2,render:nn},r32uint:{gl:33334,b:4,c:1,bpp:4,rb:!0},r32sint:{gl:33333,b:4,c:1,bpp:4,rb:!0},r32float:{gl:33326,bpp:4,b:4,c:1,render:Ze,filter:rn},rgb9e5ufloat:{gl:35901,b:4,c:3,p:1,render:"rgb9e5ufloat_renderable-webgl"},rg11b10ufloat:{gl:35898,b:4,c:3,p:1,render:Ze,rb:!0},rgb10a2unorm:{gl:32857,b:4,c:4,p:1,rb:!0},"rgb10a2uint-webgl":{b:4,c:4,gl:36975,p:1,wgpu:!1,bpp:4,rb:!0},"rgb16unorm-webgl":{gl:32852,b:2,c:3,f:en},"rgb16snorm-webgl":{gl:36762,b:2,c:3,f:en},rg32uint:{gl:33340,b:8,c:2,rb:!0},rg32sint:{gl:33339,b:8,c:2,rb:!0},rg32float:{gl:33328,b:8,c:2,render:Ze,filter:rn,rb:!0},rgba16uint:{gl:36214,b:8,c:4,rb:!0},rgba16sint:{gl:36232,b:8,c:4,rb:!0},rgba16float:{gl:34842,b:8,c:4,render:Je,filter:on},"rgba16unorm-webgl":{gl:32859,b:2,c:4,render:en,rb:!0},"rgba16snorm-webgl":{gl:36763,b:2,c:4,render:nn},"rgb32float-webgl":{gl:34837,render:Ze,filter:rn,gl2ext:"EXT_color_buffer_float",dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,b:16,c:4,rb:!0},rgba32sint:{gl:36226,b:16,c:4,rb:!0},rgba32float:{gl:34836,b:16,c:4,render:Ze,filter:rn,rb:!0},stencil8:{gl:36168,b:1,c:1,attachment:36128,rb:!0},depth16unorm:{gl:33189,b:2,c:1,attachment:36096,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,b:3,c:1,attachment:36096,dataFormat:6402,types:[5125]},depth32float:{gl:36012,b:4,c:1,attachment:36096,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth24unorm-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,dataFormat:34041,types:[34042],rb:!0},"depth32float-stencil8":{gl:36013,b:5,c:2,p:1,attachment:33306,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:sn,f:Ye},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:an,f:Ye},"bc1-rgba-unorm":{gl:33777,x:sn,f:Ye},"bc1-rgba-unorm-srgb":{gl:35916,x:an,f:Ye},"bc2-rgba-unorm":{gl:33778,x:sn,f:Ye},"bc2-rgba-unorm-srgb":{gl:35918,x:an,f:Ye},"bc3-rgba-unorm":{gl:33779,x:sn,f:Ye},"bc3-rgba-unorm-srgb":{gl:35919,x:an,f:Ye},"bc4-r-unorm":{gl:36283,x:An,f:Ye},"bc4-r-snorm":{gl:36284,x:An,f:Ye},"bc5-rg-unorm":{gl:36285,x:An,f:Ye},"bc5-rg-snorm":{gl:36286,x:An,f:Ye},"bc6h-rgb-ufloat":{gl:36495,x:un,f:Ye},"bc6h-rgb-float":{gl:36494,x:un,f:Ye},"bc7-rgba-unorm":{gl:36492,x:un,f:Ye},"bc7-rgba-unorm-srgb":{gl:36493,x:un,f:Ye},"etc2-rgb8unorm":{gl:37492,f:Qe},"etc2-rgb8unorm-srgb":{gl:37494,f:Qe},"etc2-rgb8a1unorm":{gl:37496,f:Qe},"etc2-rgb8a1unorm-srgb":{gl:37497,f:Qe},"etc2-rgba8unorm":{gl:37493,f:Qe},"etc2-rgba8unorm-srgb":{gl:37495,f:Qe},"eac-r11unorm":{gl:37488,f:Qe},"eac-r11snorm":{gl:37489,f:Qe},"eac-rg11unorm":{gl:37490,f:Qe},"eac-rg11snorm":{gl:37491,f:Qe},"astc-4x4-unorm":{gl:37808,f:qe},"astc-4x4-unorm-srgb":{gl:37840,f:qe},"astc-5x4-unorm":{gl:37809,f:qe},"astc-5x4-unorm-srgb":{gl:37841,f:qe},"astc-5x5-unorm":{gl:37810,f:qe},"astc-5x5-unorm-srgb":{gl:37842,f:qe},"astc-6x5-unorm":{gl:37811,f:qe},"astc-6x5-unorm-srgb":{gl:37843,f:qe},"astc-6x6-unorm":{gl:37812,f:qe},"astc-6x6-unorm-srgb":{gl:37844,f:qe},"astc-8x5-unorm":{gl:37813,f:qe},"astc-8x5-unorm-srgb":{gl:37845,f:qe},"astc-8x6-unorm":{gl:37814,f:qe},"astc-8x6-unorm-srgb":{gl:37846,f:qe},"astc-8x8-unorm":{gl:37815,f:qe},"astc-8x8-unorm-srgb":{gl:37847,f:qe},"astc-10x5-unorm":{gl:37819,f:qe},"astc-10x5-unorm-srgb":{gl:37851,f:qe},"astc-10x6-unorm":{gl:37817,f:qe},"astc-10x6-unorm-srgb":{gl:37849,f:qe},"astc-10x8-unorm":{gl:37818,f:qe},"astc-10x8-unorm-srgb":{gl:37850,f:qe},"astc-10x10-unorm":{gl:37819,f:qe},"astc-10x10-unorm-srgb":{gl:37851,f:qe},"astc-12x10-unorm":{gl:37820,f:qe},"astc-12x10-unorm-srgb":{gl:37852,f:qe},"astc-12x12-unorm":{gl:37821,f:qe},"astc-12x12-unorm-srgb":{gl:37853,f:qe},"pvrtc-rgb4unorm-webgl":{gl:35840,f:$e},"pvrtc-rgba4unorm-webgl":{gl:35842,f:$e},"pvrtc-rbg2unorm-webgl":{gl:35841,f:$e},"pvrtc-rgba2unorm-webgl":{gl:35843,f:$e},"etc1-rbg-unorm-webgl":{gl:36196,f:"texture-compression-etc1-webgl"},"atc-rgb-unorm-webgl":{gl:35986,f:Ke},"atc-rgba-unorm-webgl":{gl:35986,f:Ke},"atc-rgbai-unorm-webgl":{gl:34798,f:Ke}},dn={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},gn={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function _n(t,e,n){const i=pn[e];if(!i)return!1;if(void 0===i.gl)return!1;const r=i.x||i.gl2ext;return!r||Boolean(je(t,r,n))}function mn(t){const e=pn[t],n=e?.gl;if(void 0===n)throw new Error(`Unsupported texture format ${t}`);return n}function yn(t){const e=pn[t],n=mn(t),i=ie(t);return{format:n,dataFormat:e?.dataFormat||En(i.format,i.integer,i.normalized,n),type:i.dataType?Xe(i.dataType):e?.types?.[0]||5121,compressed:i.compressed}}function vn(t){const e=yn(t);return(dn[e.dataFormat]||4)*(gn[e.type]||1)}function En(t,e,n,i){if(6408===i||6407===i)return i;switch(t){case"r":return e&&!n?36244:6403;case"rg":return e&&!n?33320:33319;case"rgb":return e&&!n?36248:6407;case"rgba":return e&&!n?36249:6408;default:return 6408}}const bn={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class wn extends se{gl;extensions;testedFeatures=new Set;constructor(t,e,n){super([],n),this.gl=t,this.extensions=e,je(t,"EXT_color_buffer_float",e)}*[Symbol.iterator](){const t=this.getFeatures();for(const e of t)this.has(e)&&(yield e);return[]}has(t){return!this.disabledFeatures[t]&&(this.testedFeatures.has(t)||(this.testedFeatures.add(t),function(t){return t in hn}(t)&&fn(this.gl,t,this.extensions)&&this.features.add(t),this.getWebGLFeature(t)&&this.features.add(t)),this.features.has(t))}initializeFeatures(){const t=this.getFeatures().filter((t=>"polygon-mode-webgl"!==t));for(const e of t)this.has(e)}getFeatures(){return[...Object.keys(bn),...Object.keys(hn)]}getWebGLFeature(t){const e=bn[t];return"string"==typeof e?Boolean(je(this.gl,e,this.extensions)):Boolean(e)}}class xn extends oe{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(t){super(),this.gl=t}getParameter(t){return void 0===this.limits[t]&&(this.limits[t]=this.gl.getParameter(t)),this.limits[t]}}var Sn=n(5153),Cn=n(698);class Tn extends Sn.F{static defaultProps={...Sn.F.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null};get[Symbol.toStringTag](){return"Framebuffer"}width;height;colorAttachments=[];depthStencilAttachment=null;constructor(t,e={}){super(t,e,Tn.defaultProps),this.width=this.props.width,this.height=this.props.height}resize(t){let e=!t;if(t){const[n,i]=Array.isArray(t)?t:[t.width,t.height];e=e||i!==this.height||n!==this.width,this.width=n,this.height=i}e&&(Qt.R.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(0===this.props.colorAttachments.length&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((t=>{if("string"==typeof t){const e=this.createColorTexture(t);return this.attachResource(e),e.view}return t instanceof Cn.g?t.view:t}));const t=this.props.depthStencilAttachment;if(t)if("string"==typeof t){const e=this.createDepthStencilTexture(t);this.attachResource(e),this.depthStencilAttachment=e.view}else t instanceof Cn.g?this.depthStencilAttachment=t.view:this.depthStencilAttachment=t}createColorTexture(t){return this.device.createTexture({id:"color-attachment",usage:Cn.g.RENDER_ATTACHMENT,format:t,width:this.width,height:this.height})}createDepthStencilTexture(t){return this.device.createTexture({id:"depth-stencil-attachment",usage:Cn.g.RENDER_ATTACHMENT,format:t,width:this.width,height:this.height})}resizeAttachments(t,e){for(let n=0;n<this.colorAttachments.length;++n)if(this.colorAttachments[n]){const i=this.device._createTexture({...this.colorAttachments[n].props,width:t,height:e});this.destroyAttachedResource(this.colorAttachments[n]),this.colorAttachments[n]=i.view,this.attachResource(i.view)}if(this.depthStencilAttachment){const n=this.device._createTexture({...this.depthStencilAttachment.props,width:t,height:e});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=n.view,this.attachResource(n)}}}let In="";async function Rn(t,e){return await new Promise(((n,i)=>{try{const r=new Image;r.onload=()=>n(r),r.onerror=()=>i(new Error(`Could not load image ${t}.`)),r.crossOrigin=e?.crossOrigin||"anonymous",r.src=t.startsWith("http")?t:In+t}catch(r){i(r)}}))}async function Pn(t,e){const n=document.getElementsByTagName("head")[0];if(!n)throw new Error("loadScript");const i=document.createElement("script");return i.setAttribute("type","text/javascript"),i.setAttribute("src",t),e&&(i.id=e),new Promise(((e,r)=>{i.onload=e,i.onerror=e=>r(new Error(`Unable to load script '${t}': ${e}`)),n.appendChild(i)}))}function Mn(t,e,n){if(function(t){for(const e in t)return!1;return!0}(e))return n(t);const{nocatch:i=!0}=e;let r;if(Be(t),Le(t,e),i)r=n(t),Ue(t);else try{r=n(t)}finally{Ue(t)}return r}function Ln(t,e){const n=t,{gl:i}=n;if(e.cullMode)switch(e.cullMode){case"none":i.disable(2884);break;case"front":i.enable(2884),i.cullFace(1028);break;case"back":i.enable(2884),i.cullFace(1029)}if(e.frontFace&&i.frontFace(kn("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&t.features.has("depth-clip-control")&&i.enable(34383),void 0!==e.depthBias&&(i.enable(32823),i.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&t.features.has("provoking-vertex-webgl")){const t=n.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,i=kn("provokingVertex",e.provokingVertex,{first:36429,last:36430});t?.provokingVertexWEBGL(i)}if((e.polygonMode||e.polygonOffsetLine)&&t.features.has("polygon-mode-webgl")){if(e.polygonMode){const t=n.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,i=kn("polygonMode",e.polygonMode,{fill:6914,line:6913});t?.polygonModeWEBGL(1028,i),t?.polygonModeWEBGL(1029,i)}e.polygonOffsetLine&&i.enable(10754)}if(t.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&i.enable(12288),e.clipDistance1&&i.enable(12289),e.clipDistance2&&i.enable(12290),e.clipDistance3&&i.enable(12291),e.clipDistance4&&i.enable(12292),e.clipDistance5&&i.enable(12293),e.clipDistance6&&i.enable(12294),e.clipDistance7&&i.enable(12295)),void 0!==e.depthWriteEnabled&&i.depthMask(e.depthWriteEnabled),e.depthCompare&&("always"!==e.depthCompare?i.enable(2929):i.disable(2929),i.depthFunc(Nn("depthCompare",e.depthCompare))),e.stencilWriteMask){const t=e.stencilWriteMask;i.stencilMaskSeparate(1028,t),i.stencilMaskSeparate(1029,t)}if(e.stencilReadMask&&Qt.R.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const t=e.stencilReadMask||4294967295,n=Nn("depthCompare",e.stencilCompare);"always"!==e.stencilCompare?i.enable(2960):i.disable(2960),i.stencilFuncSeparate(1028,n,0,t),i.stencilFuncSeparate(1029,n,0,t)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const t=On("stencilPassOperation",e.stencilPassOperation),n=On("stencilFailOperation",e.stencilFailOperation),r=On("stencilDepthFailOperation",e.stencilDepthFailOperation);i.stencilOpSeparate(1028,n,r,t),i.stencilOpSeparate(1029,n,r,t)}if(e.blendColorOperation||e.blendAlphaOperation){i.enable(3042);const t=Dn("blendColorOperation",e.blendColorOperation||"add"),n=Dn("blendAlphaOperation",e.blendAlphaOperation||"add");i.blendEquationSeparate(t,n);const r=Fn("blendColorSrcFactor",e.blendColorSrcFactor||"one"),o=Fn("blendColorDstFactor",e.blendColorDstFactor||"zero"),s=Fn("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),a=Fn("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");i.blendFuncSeparate(r,o,s,a)}}function Nn(t,e){return kn(t,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function On(t,e){return kn(t,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function Dn(t,e){return kn(t,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function Fn(t,e){return kn(t,e,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function kn(t,e,n){if(!(e in n))throw new Error(function(t,e){return`Illegal parameter ${e} for ${t}`}(t,e));return n[e]}function Bn(t){const e={};return t.addressModeU&&(e[10242]=Un(t.addressModeU)),t.addressModeV&&(e[10243]=Un(t.addressModeV)),t.addressModeW&&(e[32882]=Un(t.addressModeW)),t.magFilter&&(e[10240]=Gn(t.magFilter)),(t.minFilter||t.mipmapFilter)&&(e[10241]=function(t,e){if(!e)return Gn(t);switch(t){case"nearest":return"nearest"===e?9984:9986;case"linear":return"nearest"===e?9985:9987}}(t.minFilter||"linear",t.mipmapFilter)),void 0!==t.lodMinClamp&&(e[33082]=t.lodMinClamp),void 0!==t.lodMaxClamp&&(e[33083]=t.lodMaxClamp),"comparison-sampler"===t.type&&(e[34892]=34894),t.compare&&(e[34893]=Nn("compare",t.compare)),t.maxAnisotropy&&(e[34046]=t.maxAnisotropy),e}function Un(t){switch(t){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function Gn(t){switch(t){case"nearest":return 9728;case"linear":return 9729}}class zn extends Jt.h{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength;bytesUsed;constructor(t,e={}){super(t,e),this.device=t,this.gl=this.device.gl;const n="object"==typeof e?e.handle:void 0;this.handle=n||this.gl.createBuffer(),t.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=function(t){if(t&Jt.h.INDEX)return 34963;if(t&Jt.h.VERTEX)return 34962;if(t&Jt.h.UNIFORM)return 35345;return 34962}(this.props.usage),this.glUsage=function(t){if(t&Jt.h.INDEX)return 35044;if(t&Jt.h.VERTEX)return 35044;if(t&Jt.h.UNIFORM)return 35048;return 35044}(this.props.usage),this.glIndexType="uint32"===this.props.indexType?5125:5123,e.data?this._initWithData(e.data,e.byteOffset,e.byteLength):this._initWithByteLength(e.byteLength||0)}_initWithData(t,e=0,n=t.byteLength+e){const i=this.glTarget;this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.glUsage),this.gl.bufferSubData(i,e,t),this.gl.bindBuffer(i,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(t,e,n),this.trackAllocatedMemory(n)}_initWithByteLength(t){(0,Ae.v)(t>=0);let e=t;0===t&&(e=new Float32Array(0));const n=this.glTarget;return this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,e,this.glUsage),this.gl.bindBuffer(n,null),this.bytesUsed=t,this.byteLength=t,this._setDebugData(null,0,t),this.trackAllocatedMemory(t),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(t,e=0){const n=36663;this.gl.bindBuffer(n,this.handle),this.gl.bufferSubData(n,e,t),this.gl.bindBuffer(n,null),this._setDebugData(t,e,t.byteLength)}async readAsync(t=0,e){return this.readSyncWebGL(t,e)}readSyncWebGL(t=0,e){e=e??this.byteLength-t;const n=new Uint8Array(e);return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,n,0,e),this.gl.bindBuffer(36662,null),this._setDebugData(n,t,e),n}}var Vn=n(9277);class jn extends Vn.L{device;handle;parameters;constructor(t,e){super(t,e),this.device=t,this.parameters=Bn(e),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(t){for(const[e,n]of Object.entries(t)){const t=Number(e);switch(t){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,t,n);break;default:this.device.gl.samplerParameteri(this.handle,t,n)}}}}var Wn=n(5638);class Hn extends Wn.X{device;gl;handle;texture;constructor(t,e){super(t,{...Cn.g.defaultProps,...e}),this.device=t,this.gl=this.device.gl,this.handle=null,this.texture=e.texture}}const Xn={parameters:{},pixelStore:{},pixels:null,border:0,dataFormat:void 0,textureUnit:void 0,target:void 0};class Yn extends Cn.g{static FACES=[34069,34070,34071,34072,34073,34074];MAX_ATTRIBUTES;device;gl;handle;sampler=void 0;view=void 0;glFormat=void 0;type=void 0;dataFormat=void 0;mipmaps=void 0;target;textureUnit=void 0;loaded=!1;_video;constructor(t,e){super(t,{...Xn,format:"rgba8unorm",...e}),this.device=t,this.gl=this.device.gl,this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glFormat=6408,this.target=function(t){switch(t.dimension){case"2d":return 3553;case"cube":return 34067;case"2d-array":return 35866;case"3d":return 32879;default:throw new Error(t.dimension)}}(this.props),this.loaded=!1,"string"==typeof this.props?.data&&Object.assign(this.props,{data:Rn(this.props.data)}),this.initialize(this.props),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}toString(){return`Texture(${this.id},${this.width}x${this.height})`}createView(t){return new Hn(this.device,{...t,texture:this})}initialize(t={}){if("cube"===this.props.dimension)return this.initializeCube(t);let e=t.data;if(e instanceof Promise)return e.then((e=>this.initialize(Object.assign({},t,{pixels:e,data:e})))),this;const n="undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",(()=>this.initialize(t))),this;const{parameters:i={}}=t,{pixels:r=null,pixelStore:o={},textureUnit:s,mipmaps:a=!0}=t;e||(e=r);let{width:A,height:u,dataFormat:l,type:c,compressed:h=!1}=t;const{depth:f=0}=t,p=mn(t.format);return({width:A,height:u,compressed:h,dataFormat:l,type:c}=this._deduceParameters({format:t.format,type:c,dataFormat:l,compressed:h,data:e,width:A,height:u})),this.width=A,this.height=u,this.glFormat=p,this.type=c,this.dataFormat=l,this.textureUnit=s,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),this.mipmaps=a,this.setImageData({data:e,width:A,height:u,depth:f,format:p,type:c,dataFormat:l,parameters:o,compressed:h}),this.setSampler(t.sampler),this._setSamplerParameters(i),this.view=this.createView({...this.props,mipLevelCount:1,arrayLayerCount:1}),a&&this.device.isTextureFormatFilterable(t.format)&&this.generateMipmap(),n&&(this._video={video:e,parameters:i,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}initializeCube(t){const{mipmaps:e=!0,parameters:n={}}=t;return this.setCubeMapImageData(t).then((()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setSampler(t.sampler),this._setSamplerParameters(n)})),this}setSampler(t={}){let e;t instanceof jn?(this.sampler=t,e=t.props):(this.sampler=new jn(this.device,t),e=t);const n=Bn(e);return this._setSamplerParameters(n),this}resize(t){const{height:e,width:n,mipmaps:i=!1}=t;return n!==this.width||e!==this.height?this.initialize({width:n,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,mipmaps:i}):this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}generateMipmap(t={}){return this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Mn(this.gl,t,(()=>{this.gl.generateMipmap(this.target)})),this.gl.bindTexture(this.target,null),this}setImageData(t){if("3d"===this.props.dimension||"2d-array"===this.props.dimension)return this.setImageData3D(t);this.trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:i=0,glFormat:r=this.glFormat,offset:o=0,parameters:s={}}=t;let{data:a=null,type:A=this.type,width:u=this.width,height:l=this.height,dataFormat:c=this.dataFormat,compressed:h=!1}=t;a||(a=n),({type:A,dataFormat:c,compressed:h,width:u,height:l}=this._deduceParameters({format:this.props.format,type:A,dataFormat:c,compressed:h,data:a,width:u,height:l}));const{gl:f}=this;f.bindTexture(this.target,this.handle);let p=null;if(({data:a,dataType:p}=this._getDataType({data:a,compressed:h})),Mn(this.gl,s,(()=>{switch(p){case"null":case"browser-object":f.texImage2D(e,i,r,u,l,0,c,A,a);break;case"typed-array":f.texImage2D(e,i,r,u,l,0,c,A,a,o);break;case"buffer":this.device.gl.bindBuffer(35052,a.handle||a),this.device.gl.texImage2D(e,i,r,u,l,0,c,A,o),this.device.gl.bindBuffer(35052,null);break;case"compressed":for(const[t,n]of a.entries())f.compressedTexImage2D(e,t,n.format,n.width,n.height,0,n.data);break;default:(0,Ae.v)(!1,"Unknown image data type")}})),a&&a.byteLength)this.trackAllocatedMemory(a.byteLength,"Texture");else{const t=vn(this.props.format);this.trackAllocatedMemory(this.width*this.height*t,"Texture")}return this.loaded=!0,this}setSubImageData({target:t=this.target,pixels:e=null,data:n=null,x:i=0,y:r=0,width:o=this.width,height:s=this.height,level:a=0,glFormat:A=this.glFormat,type:u=this.type,dataFormat:l=this.dataFormat,compressed:c=!1,offset:h=0,parameters:f={}}){if(({type:u,dataFormat:l,compressed:c,width:o,height:s}=this._deduceParameters({format:this.props.format,type:u,dataFormat:l,compressed:c,data:n,width:o,height:s})),(0,Ae.v)(1===this.depth,"texSubImage not supported for 3D textures"),n||(n=e),n&&n.data){const t=n;n=t.data,o=t.shape[0],s=t.shape[1]}n instanceof zn&&(n=n.handle),this.gl.bindTexture(this.target,this.handle),Mn(this.gl,f,(()=>{c?this.gl.compressedTexSubImage2D(t,a,i,r,o,s,A,n):null===n?this.gl.texSubImage2D(t,a,i,r,o,s,l,u,null):ArrayBuffer.isView(n)?this.gl.texSubImage2D(t,a,i,r,o,s,l,u,n,h):"undefined"!=typeof WebGLBuffer&&n instanceof WebGLBuffer?(this.device.gl.bindBuffer(35052,n),this.device.gl.texSubImage2D(t,a,i,r,o,s,l,u,h),this.device.gl.bindBuffer(35052,null)):this.device.gl.texSubImage2D(t,a,i,r,o,s,l,u,n)})),this.gl.bindTexture(this.target,null)}copyFramebuffer(t={}){return Qt.R.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(t=this.textureUnit){const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(t=this.textureUnit){const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType({data:t,compressed:e=!1}){return e?{data:t,dataType:"compressed"}:null===t?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof zn?{data:t.handle,dataType:"buffer"}:"undefined"!=typeof WebGLBuffer&&t instanceof WebGLBuffer?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:i,height:r,dataFormat:o,type:s,compressed:a}=t;const A=yn(e);return o=o||A.dataFormat,s=s||A.type,a=a||A.compressed,({width:i,height:r}=this._deduceImageSize(n,i,r)),{dataFormat:o,type:s,compressed:a,width:i,height:r,format:e,data:n}}_deduceImageSize(t,e,n){let i;return i="undefined"!=typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?{width:t.width,height:t.height}:"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},(0,Ae.v)(i,"Could not deduced texture size"),(0,Ae.v)(void 0===e||i.width===e,"Deduced texture width does not match supplied width"),(0,Ae.v)(void 0===n||i.height===n,"Deduced texture height does not match supplied height"),i}async setCubeMapImageData(t){const{gl:e}=this,{width:n,height:i,pixels:r,data:o,format:s=6408,type:a=5121}=t,A=r||o,u=await Promise.all(Yn.FACES.map((t=>{const e=A[t];return Promise.all(Array.isArray(e)?e:[e])})));this.bind(),Yn.FACES.forEach(((t,r)=>{u[r].length>1&&!1!==this.props.mipmaps&&Qt.R.warn(`${this.id} has mipmap and multiple LODs.`)(),u[r].forEach(((r,o)=>{n&&i?e.texImage2D(t,o,s,n,i,0,s,a,r):e.texImage2D(t,o,s,s,a,r)}))})),this.unbind()}setImageDataForFace(t){const{face:e,width:n,height:i,pixels:r,data:o,format:s=6408,type:a=5121}=t,{gl:A}=this,u=r||o;return this.bind(),u instanceof Promise?u.then((n=>this.setImageDataForFace(Object.assign({},t,{face:e,data:n,pixels:n})))):this.width||this.height?A.texImage2D(e,0,s,n,i,0,s,a,u):A.texImage2D(e,0,s,s,a,u),this}setImageData3D(t){const{level:e=0,dataFormat:n,format:i,type:r,width:o,height:s,depth:a=1,offset:A=0,data:u,parameters:l={}}=t;this.trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle);const c=yn(i);if(Mn(this.gl,l,(()=>{ArrayBuffer.isView(u)&&this.gl.texImage3D(this.target,e,c.format,o,s,a,0,c.dataFormat,c.type,u),u instanceof zn&&(this.gl.bindBuffer(35052,u.handle),this.gl.texImage3D(this.target,e,n,o,s,a,0,i,r,A))})),u&&u.byteLength)this.trackAllocatedMemory(u.byteLength,"Texture");else{const t=vn(this.props.format);this.trackAllocatedMemory(this.width*this.height*this.depth*t,"Texture")}return this.loaded=!0,this}_setSamplerParameters(t){if(!(0,Zt.Z)(t)){!function(t){Qt.R.log(1,"texture sampler parameters",t)()}(t),this.gl.bindTexture(this.target,this.handle);for(const[e,n]of Object.entries(t)){const t=Number(e),i=n;switch(t){case 33082:case 33083:this.gl.texParameterf(this.target,t,i);break;default:this.gl.texParameteri(this.target,t,i)}}this.gl.bindTexture(this.target,null)}}}class qn extends Tn{device;gl;handle;get texture(){return this.colorAttachments[0]}constructor(t,e){super(t,e);const n=null===e.handle;if(this.device=t,this.gl=t.gl,this.handle=this.props.handle||n?this.props.handle:this.gl.createFramebuffer(),!n){t.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures();const n=this.gl.bindFramebuffer(36160,this.handle);for(let t=0;t<this.colorAttachments.length;++t){const e=this.colorAttachments[t],n=36064+t;e&&this._attachOne(n,e)}if(this.depthStencilAttachment&&this._attachOne(function(t){const e=pn[t];if(!e?.attachment)throw new Error(`${t} is not a depth stencil format`);return e.attachment}(this.depthStencilAttachment.props.format),this.depthStencilAttachment),!1!==e.check){const t=this.gl.checkFramebufferStatus(36160);if(36053!==t)throw new Error(`Framebuffer ${function(t){switch(t){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${t}`}}(t)}`)}this.gl.bindFramebuffer(36160,n)}}destroy(){super.destroy(),this.destroyed||null===this.handle||this.gl.deleteFramebuffer(this.handle)}createDepthStencilTexture(t){return new Yn(this.device,{id:`${this.id}-depth-stencil`,format:t,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(t,e){if(null===this.handle)return this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===e&&(e=this.gl.drawingBufferHeight);for(const n of this.colorAttachments)n.texture.resize({width:t,height:e});return this.depthStencilAttachment&&this.depthStencilAttachment.texture.resize({width:t,height:e}),this}_attachOne(t,e){if(Array.isArray(e)){const[n,i=0,r=0]=e;return this._attachTexture(t,n,i,r),n}if(e instanceof Yn)return this._attachTexture(t,e,0,0),e;if(e instanceof Hn){const n=e;return this._attachTexture(t,n.texture,n.props.baseMipLevel,n.props.baseArrayLayer),e.texture}throw new Error("attach")}_attachTexture(t,e,n,i){const{gl:r}=this.device;switch(r.bindTexture(e.target,e.handle),e.target){case 35866:case 32879:r.framebufferTextureLayer(36160,t,e.target,i,n);break;case 34067:const o=function(t){return t<34069?t+34069:t}(n);r.framebufferTexture2D(36160,t,o,e.handle,i);break;case 3553:r.framebufferTexture2D(36160,t,3553,e.handle,i);break;default:(0,Ae.v)(!1,"Illegal texture type")}r.bindTexture(e.target,null)}}class Qn extends de{device;presentationSize;_framebuffer=null;constructor(t,e){super(e),this.device=t,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new qn(this.device,{handle:null}),this._framebuffer}update(){const t=this.getPixelSize();(t[0]!==this.presentationSize[0]||t[1]!==this.presentationSize[1])&&(this.presentationSize=t,this.resize())}resize(t){if(this.device.gl)if(this.canvas){const e=this.getDevicePixelRatio(t?.useDevicePixels);this.setDevicePixelRatio(e,t)}else;}commit(){}}const $n={spector:Qt.R.get("spector")||Qt.R.get("spectorjs")};let Kn=null,Zn=!1;var Jn;!function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.R16_EXT=33322]="R16_EXT",t[t.RG16_EXT=33324]="RG16_EXT",t[t.RGB16_EXT=32852]="RGB16_EXT",t[t.RGBA16_EXT=32859]="RGBA16_EXT",t[t.R16_SNORM_EXT=36760]="R16_SNORM_EXT",t[t.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",t[t.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",t[t.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",t[t.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",t[t.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",t[t.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",t[t.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",t[t.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",t[t.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",t[t.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",t[t.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",t[t.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",t[t.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",t[t.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",t[t.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",t[t.LINE_WEBGL=6913]="LINE_WEBGL",t[t.FILL_WEBGL=6914]="FILL_WEBGL",t[t.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",t[t.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",t[t.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",t[t.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",t[t.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",t[t.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",t[t.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",t[t.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",t[t.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",t[t.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",t[t.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",t[t.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",t[t.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",t[t.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",t[t.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",t[t.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",t[t.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",t[t.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",t[t.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",t[t.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",t[t.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",t[t.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",t[t.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",t[t.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"}(Jn||(Jn={}));function ti(t){return t.luma=t.luma||{},t.luma}function ei(t,e={}){return t?e.debug?function(t,e){if(!globalThis.WebGLDebugUtils)return Qt.R.warn("webgl-debug not loaded")(),t;const n=ti(t);if(n.debugContext)return n.debugContext;globalThis.WebGLDebugUtils.init({...Jn,...t});const i=globalThis.WebGLDebugUtils.makeDebugContext(t,ii.bind(null,e),ri.bind(null,e));for(const s in Jn)s in i||"number"!=typeof Jn[s]||(i[s]=Jn[s]);class r{}Object.setPrototypeOf(i,Object.getPrototypeOf(t)),Object.setPrototypeOf(r,i);const o=Object.create(r);return n.realContext=t,n.debugContext=o,o.debug=!0,o}(t,e):function(t){const e=ti(t);return e.realContext?e.realContext:t}(t):null}function ni(t,e){e=Array.from(e).map((t=>void 0===t?"undefined":t));let n=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,e);return n=`${n.slice(0,100)}${n.length>100?"...":""}`,`gl.${t}(${n})`}function ii(t,e,n,i){i=Array.from(i).map((t=>void 0===t?"undefined":t));const r=`${globalThis.WebGLDebugUtils.glEnumToString(e)} in gl.${n}(${globalThis.WebGLDebugUtils.glFunctionArgsToString(n,i)})`;if(Qt.R.error(r)(),t.throwOnError)throw new Error(r)}function ri(t,e,n){let i="";if(Qt.R.level>=1&&(i=ni(e,n),Qt.R.log(1,i)()),t.break&&t.break.length>0){i=i||ni(e,n);t.break.every((t=>-1!==i.indexOf(t)))}for(const r of n)if(void 0===r){if(i=i||ni(e,n),t.throwOnError)throw new Error(`Undefined argument: ${i}`);Qt.R.error(`Undefined argument: ${i}`)()}}var oi=n(6795);function si(t){const e=t.toLowerCase();return["warning","error","info"].includes(e)?e:"info"}class ai extends oi.M{device;handle;constructor(t,e){switch(super(t,e),this.device=t,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){return function(t){const e=t.split(/\r?\n/),n=[];for(const i of e){if(i.length<=1)continue;const t=i.split(":");if(2===t.length){const[e,i]=t;n.push({message:i.trim(),type:si(e),lineNum:0,linePos:0});continue}const[e,r,o,...s]=t;let a=parseInt(o,10);isNaN(a)&&(a=0);let A=parseInt(r,10);isNaN(A)&&(A=0),n.push({message:s.join(":").trim(),type:si(e),lineNum:a,linePos:A})}return n}(this.device.gl.getShaderInfoLog(this.handle))}getTranslatedSource(){const t=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return t?.getTranslatedShaderSource(this.handle)}async _compile(t){t=(t=>t.startsWith("#version ")?t:`#version 100\n${t}`)(t);const{gl:e}=this.device;if(e.shaderSource(this.handle,t),e.compileShader(this.handle),0!==Qt.R.level){if(this.device.features.has("compilation-status-async-webgl"))Qt.R.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),Qt.R.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader();else if(this._getCompilationStatus(),this.debugShader(),"error"===this.compilationStatus)throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`)}else this.compilationStatus="pending"}async _waitForCompilationComplete(){const t=async t=>await new Promise((e=>setTimeout(e,t)));if(!this.device.features.has("compilation-status-async-webgl"))return void await t(10);const{gl:e}=this.device;for(;;){if(e.getShaderParameter(this.handle,37297))return;await t(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}class Ai extends Sn.F{static defaultProps={...Sn.F.defaultProps,framebuffer:null,parameters:void 0,clearColor:[0,0,0,0],clearDepth:1,clearStencil:0,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0};get[Symbol.toStringTag](){return"RenderPass"}constructor(t,e){super(t,e,Ai.defaultProps)}}const ui=6144,li=[1,2,4,8];class ci extends Ai{device;glParameters;constructor(t,e){super(t,e),this.device=t,Be(this.device.gl),this.setParameters(this.props.parameters),this.clear()}end(){Ue(this.device.gl)}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}setParameters(t={}){const e={...this.glParameters};this.props.framebuffer&&(e.framebuffer=this.props.framebuffer),this.props.depthReadOnly&&(e.depthMask=!this.props.depthReadOnly),e.stencilMask=this.props.stencilReadOnly?0:1,e[35977]=this.props.discard,t.viewport&&(t.viewport.length>=6?(e.viewport=t.viewport.slice(0,4),e.depthRange=[t.viewport[4],t.viewport[5]]):e.viewport=t.viewport),t.scissorRect&&(e.scissorTest=!0,e.scissor=t.scissorRect),t.blendConstant&&(e.blendColor=t.blendConstant),t.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),t[2967]=t.stencilReference),t.colorMask&&(e.colorMask=li.map((e=>Boolean(e&t.colorMask)))),this.glParameters=e,Le(this.device.gl,e)}beginOcclusionQuery(t){const e=this.props.occlusionQuerySet;e?.beginOcclusionQuery()}endOcclusionQuery(){const t=this.props.occlusionQuerySet;t?.endOcclusionQuery()}clear(){const t={...this.glParameters};let e=0;!1!==this.props.clearColor&&(e|=16384,t.clearColor=this.props.clearColor),!1!==this.props.clearDepth&&(e|=256,t.clearDepth=this.props.clearDepth),!1!==this.props.clearStencil&&(e|=1024,t.clearStencil=this.props.clearStencil),0!==e&&Mn(this.device.gl,t,(()=>{this.device.gl.clear(e)}))}clearColorBuffer(t=0,e=[0,0,0,0]){Mn(this.device.gl,{framebuffer:this.props.framebuffer},(()=>{switch(e.constructor){case Int32Array:this.device.gl.clearBufferiv(ui,t,e);break;case Uint32Array:this.device.gl.clearBufferuiv(ui,t,e);break;case Float32Array:default:this.device.gl.clearBufferfv(ui,t,e)}}))}}var hi=n(2512);var fi=n(1289),pi=n(3884);const di="Failed to deduce GL constant from typed array";function gi(t,e){const{clamped:n=!0}=e||{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}const _i={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},mi={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class yi{offset;stride;type;size;divisor;normalized;integer;buffer;index;static getBytesPerElement(t){return gi(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){(0,Ae.v)(t.size);return gi(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(...t){return new yi(...[_i,...t])}constructor(...t){t.forEach((t=>this._assign(t))),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return yi.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return yi.getBytesPerVertex(this)}_assign(t={}){return void 0!==(t=function(t,e,n){const{removedProps:i={},deprecatedProps:r={},replacedProps:o={}}=n;for(const a in i)if(a in e){const e=i[a]?`${t}.${i[a]}`:"N/A";Qt.R.removed(`${t}.${a}`,e)()}for(const a in r)if(a in e){const e=r[a];Qt.R.deprecated(`${t}.${a}`,`${t}.${e}`)()}let s=null;for(const[a,A]of Object.entries(o))a in e&&(Qt.R.deprecated(`${t}.${a}`,`${t}.${A}`)(),s=s||Object.assign({},e),s[A]=e[a],delete s[a]);return s||e}("Accessor",t,mi)).type&&(this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size=t.size),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalize&&(this.normalized=t.normalize),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.buffer&&(this.buffer=t.buffer),void 0!==t.index&&("boolean"==typeof t.index?this.index=t.index?1:0:this.index=t.index),void 0!==t.instanced&&(this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(this.divisor=t.isInstanced?1:0),void 0===this.offset&&delete this.offset,void 0===this.stride&&delete this.stride,void 0===this.type&&delete this.type,void 0===this.size&&delete this.size,void 0===this.divisor&&delete this.divisor,void 0===this.normalized&&delete this.normalized,void 0===this.integer&&delete this.integer,void 0===this.buffer&&delete this.buffer,void 0===this.index&&delete this.index,this}}const vi=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],Ei={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function bi(t){const e=Ei[t];if(!e)throw new Error("uniform");const[n,i,,r]=e;return{format:r,components:i,glType:n}}function wi(t){const e=Ei[t];if(!e)throw new Error("attribute");const[,n,,i,r]=e;return{attributeType:i,vertexFormat:r,components:n}}function xi(t,e){const n={attributes:[],bindings:[]};n.attributes=function(t,e){const n=[],i=t.getProgramParameter(e,35721);for(let r=0;r<i;r++){const i=t.getActiveAttrib(e,r);if(!i)throw new Error("activeInfo");const{name:o,type:s}=i,a=t.getAttribLocation(e,o);if(a>=0){const{attributeType:t}=wi(s),e=/instance/i.test(o)?"instance":"vertex";n.push({name:o,location:a,stepMode:e,type:t})}}return n.sort(((t,e)=>t.location-e.location)),n}(t,e);const i=function(t,e){const n=(n,i)=>t.getActiveUniformBlockParameter(e,n,i),i=[],r=t.getProgramParameter(e,35382);for(let o=0;o<r;o++){const r={name:t.getActiveUniformBlockName(e,o)||"",location:n(o,35391),byteLength:n(o,35392),vertex:n(o,35396),fragment:n(o,35398),uniformCount:n(o,35394),uniforms:[]},s=n(o,35395)||[],a=t.getActiveUniforms(e,s,35383),A=t.getActiveUniforms(e,s,35384),u=t.getActiveUniforms(e,s,35387),l=t.getActiveUniforms(e,s,35388);for(let n=0;n<r.uniformCount;++n){const i=t.getActiveUniform(e,s[n]);if(!i)throw new Error("activeInfo");r.uniforms.push({name:i.name,format:bi(a[n]).format,type:a[n],arrayLength:A[n],byteOffset:u[n],byteStride:l[n]})}i.push(r)}return i.sort(((t,e)=>t.location-e.location)),i}(t,e);for(const A of i){const t=A.uniforms.map((t=>({name:t.name,format:t.format,byteOffset:t.byteOffset,byteStride:t.byteStride,arrayLength:t.arrayLength})));n.bindings.push({type:"uniform",name:A.name,location:A.location,visibility:(A.vertex?1:0)&(A.fragment?2:0),minBindingSize:A.byteLength,uniforms:t})}const r=function(t,e){const n=[],i=t.getProgramParameter(e,35718);for(let r=0;r<i;r++){const i=t.getActiveUniform(e,r);if(!i)throw new Error("activeInfo");const{name:o,size:s,type:a}=i,{name:A,isArray:u}=Ti(o);let l=t.getUniformLocation(e,A);const c={location:l,name:A,size:s,type:a,isArray:u};if(n.push(c),c.size>1)for(let r=0;r<c.size;r++){const i=`${A}[${r}]`;l=t.getUniformLocation(e,i);const o={...c,name:i,location:l};n.push(o)}}return n}(t,e);let o=0;for(const A of r)if(s=A.type,vi.includes(s)){const{viewDimension:t,sampleType:e}=Ci(A.type);n.bindings.push({type:"texture",name:A.name,location:o,viewDimension:t,sampleType:e}),A.textureUnit=o,o+=1}var s;r.length&&(n.uniforms=r);const a=function(t,e){const n=[],i=t.getProgramParameter(e,35971);for(let r=0;r<i;r++){const i=t.getTransformFeedbackVarying(e,r);if(!i)throw new Error("activeInfo");const{name:o,type:s,size:a}=i,{glType:A,components:u}=bi(s),l={location:r,name:o,accessor:new yi({type:A,size:a*u})};n.push(l)}return n.sort(((t,e)=>t.location-e.location)),n}(t,e);return a?.length&&(n.varyings=a),n}const Si={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function Ci(t){const e=Si[t];if(!e)throw new Error("sampler");const[n,i]=e;return{viewDimension:n,sampleType:i}}function Ti(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/.exec(t);if(!e||e.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:e[1],length:e[2]?1:0,isArray:Boolean(e[2])}}function Ii(t,e,n,i){const r=t;let o=i;!0===o&&(o=1),!1===o&&(o=0);const s="number"==typeof o?[o]:o;switch(n){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if("number"!=typeof i)throw new Error("samplers must be set to integers");return t.uniform1i(e,i);case 5126:return t.uniform1fv(e,s);case 35664:return t.uniform2fv(e,s);case 35665:return t.uniform3fv(e,s);case 35666:return t.uniform4fv(e,s);case 5124:case 35670:return t.uniform1iv(e,s);case 35667:case 35671:return t.uniform2iv(e,s);case 35668:case 35672:return t.uniform3iv(e,s);case 35669:case 35673:return t.uniform4iv(e,s);case 5125:return r.uniform1uiv(e,s,1);case 36294:return r.uniform2uiv(e,s,2);case 36295:return r.uniform3uiv(e,s,3);case 36296:return r.uniform4uiv(e,s,4);case 35674:return t.uniformMatrix2fv(e,!1,s);case 35675:return t.uniformMatrix3fv(e,!1,s);case 35676:return t.uniformMatrix4fv(e,!1,s);case 35685:return r.uniformMatrix2x3fv(e,!1,s);case 35686:return r.uniformMatrix2x4fv(e,!1,s);case 35687:return r.uniformMatrix3x2fv(e,!1,s);case 35688:return r.uniformMatrix3x4fv(e,!1,s);case 35689:return r.uniformMatrix4x2fv(e,!1,s);case 35690:return r.uniformMatrix4x3fv(e,!1,s)}throw new Error("Illegal uniform")}class Ri extends hi.r{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};constructor(t,e){super(t,e),this.device=t,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=e.vs,this.fs=e.fs;const{varyings:n,bufferMode:i=35981}=e;switch(n&&n.length>0&&(this.varyings=n,this.device.gl.transformFeedbackVaryings(this.handle,n,i)),this._linkShaders(),Qt.R.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=xi(this.device.gl,this.handle),Qt.R.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=(0,pi.GE)(this.introspectedLayout,e.shaderLayout),this.props.topology){case"triangle-fan-webgl":case"line-loop-webgl":Qt.R.warn(`Primitive topology ${this.props.topology} is deprecated and will be removed in v9.1`)}}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(t,e){for(const[n,i]of Object.entries(t)){const t=this.shaderLayout.bindings.find((t=>t.name===n))||this.shaderLayout.bindings.find((t=>t.name===`${n}Uniforms`));if(t){switch(i||Qt.R.warn(`Unsetting binding "${n}" in render pipeline "${this.id}"`)(),t.type){case"uniform":if(!(i instanceof zn||i.buffer instanceof zn))throw new Error("buffer value");break;case"texture":if(!(i instanceof Hn||i instanceof Yn||i instanceof qn))throw new Error("texture value");break;case"sampler":Qt.R.warn(`Ignoring sampler ${n}`)();break;default:throw new Error(t.type)}this.bindings[n]=i}else{const t=this.shaderLayout.bindings.map((t=>`"${t.name}"`)).join(", ");e?.disableWarnings||Qt.R.warn(`Unknown binding "${n}" in render pipeline "${this.id}", expected one of ${t}`)()}}}draw(t){const{renderPass:e,parameters:n=this.props.parameters,topology:i=this.props.topology,vertexArray:r,vertexCount:o,instanceCount:s,isInstanced:a=!1,firstVertex:A=0,transformFeedback:u}=t,l=function(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"line-loop-webgl":return 2;case"triangle-list":return 4;case"triangle-strip":return 5;case"triangle-fan-webgl":return 6;default:throw new Error(t)}}(i),c=Boolean(r.indexBuffer),h=r.indexBuffer?.glIndexType;if("success"!==this.linkStatus)return Qt.R.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable()||0===o)return Qt.R.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;if(0===o)return Qt.R.info(2,`RenderPipeline:${this.id}.draw() aborted - no vertices to draw`)(),!0;this.device.gl.useProgram(this.handle),r.bindBeforeRender(e),u&&u.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const f=e;return function(t,e,n,i){if((0,Zt.Z)(e))return i(t);const r=t;Be(r.gl);try{return Ln(t,e),Le(r.gl,n),i(t)}finally{Ue(r.gl)}}(this.device,n,f.glParameters,(()=>{c&&a?this.device.gl.drawElementsInstanced(l,o||0,h,A,s||0):c?this.device.gl.drawElements(l,o||0,h,A):a?this.device.gl.drawArraysInstanced(l,A,o||0,s||0):this.device.gl.drawArrays(l,A,o||0),u&&u.end()})),r.unbindAfterRender(e),!0}setUniformsWebGL(t){const{bindings:e}=(0,fi.l)(t);Object.keys(e).forEach((t=>{Qt.R.warn(`Unsupported value "${JSON.stringify(e[t])}" used in setUniforms() for key ${t}. Use setBindings() instead?`)()})),Object.assign(this.uniforms,t)}async _linkShaders(){const{gl:t}=this.device;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),Qt.R.time(4,`linkProgram for ${this.id}`)(),t.linkProgram(this.handle),Qt.R.timeEnd(4,`linkProgram for ${this.id}`)(),Qt.R.level,!this.device.features.has("compilation-status-async-webgl")){const t=this._getLinkStatus();return void this._reportLinkStatus(t)}Qt.R.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),Qt.R.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const e=this._getLinkStatus();this._reportLinkStatus(e)}_reportLinkStatus(t){if("success"!==t){if("error"===this.vs.compilationStatus)throw this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`);if("error"===this.fs?.compilationStatus)throw this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`);throw new Error(`Error during ${t}: ${this.device.gl.getProgramInfoLog(this.handle)}`)}}_getLinkStatus(){const{gl:t}=this.device;if(!t.getProgramParameter(this.handle,35714))return this.linkStatus="error","linking";t.validateProgram(this.handle);return t.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")}async _waitForLinkComplete(){const t=async t=>await new Promise((e=>setTimeout(e,t)));if(!this.device.features.has("compilation-status-async-webgl"))return void await t(10);const{gl:e}=this.device;for(;;){if(e.getProgramParameter(this.handle,37297))return;await t(10)}}_areTexturesRenderable(){let t=!0;for(const[,e]of Object.entries(this.bindings))e instanceof Yn&&(e.update(),t=t&&e.loaded);return t}_applyBindings(){if("success"!==this.linkStatus)return;const{gl:t}=this.device;t.useProgram(this.handle);let e=0,n=0;for(const i of this.shaderLayout.bindings){const r=this.bindings[i.name]||this.bindings[i.name.replace(/Uniforms$/,"")];if(!r)throw new Error(`No value for binding ${i.name} in ${this.id}`);switch(i.type){case"uniform":const{name:o}=i,s=t.getUniformBlockIndex(this.handle,o);if(4294967295===s)throw new Error(`Invalid uniform block name ${o}`);t.uniformBlockBinding(this.handle,n,s),r instanceof zn?t.bindBufferBase(35345,n,r.handle):t.bindBufferRange(35345,n,r.buffer.handle,r.offset||0,r.size||r.buffer.byteLength-r.offset),n+=1;break;case"texture":if(!(r instanceof Hn||r instanceof Yn||r instanceof qn))throw new Error("texture");let a;if(r instanceof Hn)a=r.texture;else if(r instanceof Yn)a=r;else{if(!(r instanceof qn&&r.colorAttachments[0]instanceof Hn))throw new Error("No texture");Qt.R.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),a=r.colorAttachments[0].texture}t.activeTexture(33984+e),t.bindTexture(a.target,a.handle),e+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${i.type}' not supported in WebGL`)}}}_applyUniforms(){for(const t of this.shaderLayout.uniforms||[]){const{name:e,location:n,type:i,textureUnit:r}=t,o=this.uniforms[e]??r;void 0!==o&&Ii(this.device.gl,n,i,o)}}}class Pi extends Sn.F{static defaultProps={...Sn.F.defaultProps,measureExecutionTime:void 0};get[Symbol.toStringTag](){return"CommandEncoder"}constructor(t,e){super(t,e,Pi.defaultProps)}}class Mi extends Sn.F{static defaultProps={...Sn.F.defaultProps};get[Symbol.toStringTag](){return"CommandBuffer"}constructor(t,e){super(t,e,Mi.defaultProps)}}class Li extends Mi{device;commands=[];constructor(t){super(t,{}),this.device=t}submitCommands(t=this.commands){for(const e of t)switch(e.name){case"copy-buffer-to-buffer":Ni(this.device,e.options);break;case"copy-buffer-to-texture":Oi(this.device,e.options);break;case"copy-texture-to-buffer":Di(this.device,e.options);break;case"copy-texture-to-texture":Fi(this.device,e.options)}}}function Ni(t,e){const n=e.source,i=e.destination;t.gl.bindBuffer(36662,n.handle),t.gl.bindBuffer(36663,i.handle),t.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),t.gl.bindBuffer(36662,null),t.gl.bindBuffer(36663,null)}function Oi(t,e){throw new Error("Not implemented")}function Di(t,e){const{source:n,mipLevel:i=0,aspect:r="all",width:o=e.source.width,height:s=e.source.height,depthOrArrayLayers:a=0,origin:A=[0,0],destination:u,byteOffset:l=0,bytesPerRow:c,rowsPerImage:h}=e;if("all"!==r)throw new Error("not supported");if(0!==i||0!==a||c||h)throw new Error("not implemented");const{framebuffer:f,destroyFramebuffer:p}=ki(n);let d;try{const e=u,n=o||f.width,i=s||f.height,r=yn(f.texture.props.format),a=r.dataFormat,c=r.type;t.gl.bindBuffer(35051,e.handle),d=t.gl.bindFramebuffer(36160,f.handle),t.gl.readPixels(A[0],A[1],n,i,a,c,l)}finally{t.gl.bindBuffer(35051,null),void 0!==d&&t.gl.bindFramebuffer(36160,d),p&&f.destroy()}}function Fi(t,e){const{source:n,destinationMipLevel:i=0,origin:r=[0,0],destinationOrigin:o=[0,0],destination:s}=e;let{width:a=e.destination.width,height:A=e.destination.height}=e;const{framebuffer:u,destroyFramebuffer:l}=ki(n),[c,h]=r,[f,p,d]=o,g=t.gl.bindFramebuffer(36160,u.handle);let _,m=null;if(!(s instanceof Yn))throw new Error("invalid destination");switch(m=s,a=Number.isFinite(a)?a:m.width,A=Number.isFinite(A)?A:m.height,m.bind(0),_=m.target,_){case 3553:case 34067:t.gl.copyTexSubImage2D(_,i,f,p,c,h,a,A);break;case 35866:case 32879:t.gl.copyTexSubImage3D(_,i,f,p,d,c,h,a,A)}m&&m.unbind(),t.gl.bindFramebuffer(36160,g),l&&u.destroy()}function ki(t){if(t instanceof Cn.g){const{width:e,height:n,id:i}=t;return{framebuffer:t.device.createFramebuffer({id:`framebuffer-for-${i}`,width:e,height:n,colorAttachments:[t]}),destroyFramebuffer:!0}}return{framebuffer:t,destroyFramebuffer:!1}}class Bi extends Pi{device;commandBuffer;constructor(t,e){super(t,e),this.device=t,this.commandBuffer=new Li(t)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(t){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:t})}copyBufferToTexture(t){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:t})}copyTextureToBuffer(t){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:t})}copyTextureToTexture(t){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:t})}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}resolveQuerySet(t,e,n){}}class Ui extends Sn.F{static defaultProps={...Sn.F.defaultProps,renderPipeline:null};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(t,e){super(t,e,Ui.defaultProps),this.maxVertexAttributes=t.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=(0,pi.Mr)(e.renderPipeline.shaderLayout,e.renderPipeline.bufferLayout,this.maxVertexAttributes)}setConstantWebGL(t,e){throw new Error("constant attributes not supported")}}var Gi=n(3390),zi=n(5399),Vi=n(5526);const ji=globalThis;class Wi extends Ui{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(t){return"Chrome"===function(t){if(!t&&!(0,qt.A)())return"Node";if((0,zi.A)(t))return"Electron";const e=t||Vi.gM.userAgent||"";if(e.indexOf("Edge")>-1)return"Edge";const n=-1!==e.indexOf("MSIE "),i=-1!==e.indexOf("Trident/");return n||i?"IE":ji.chrome?"Chrome":ji.safari?"Safari":ji.mozInnerScreenX?"Firefox":"Unknown"}()}constructor(t,e){super(t,e),this.device=t,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(t){const e=t;if(e&&34963!==e.glTarget)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,e?e.handle:null),this.indexBuffer=e,this.device.gl.bindVertexArray(null)}setBuffer(t,e){const n=e;if(34963===n.glTarget)throw new Error("Use .setIndexBuffer()");const{size:i,type:r,stride:o,offset:s,normalized:a,integer:A,divisor:u}=this._getAccessor(t);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,n.handle),A?this.device.gl.vertexAttribIPointer(t,i,r,o,s):this.device.gl.vertexAttribPointer(t,i,r,a,o,s),this.device.gl.enableVertexAttribArray(t),this.device.gl.vertexAttribDivisor(t,u||0),this.attributes[t]=n,this.device.gl.bindVertexArray(null)}setConstantWebGL(t,e){this._enable(t,!1),this.attributes[t]=e}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let t=0;t<this.maxVertexAttributes;++t){const e=this.attributes[t];ArrayBuffer.isView(e)&&this.device.setConstantAttributeWebGL(t,e)}}_getAccessor(t){const e=this.attributeInfos[t];if(!e)throw new Error(`Unknown attribute location ${t}`);const n=Xe(e.bufferDataType);return{size:e.bufferComponents,type:n,stride:e.byteStride,offset:e.byteOffset,normalized:e.normalized,integer:e.integer,divisor:"instance"===e.stepMode?1:0}}_enable(t,e=!0){const n=Wi.isConstantAttributeZeroSupported(this.device);(e||(n||0!==t))&&(t=Number(t),this.device.gl.bindVertexArray(this.handle),e?this.device.gl.enableVertexAttribArray(t):this.device.gl.disableVertexAttribArray(t),this.device.gl.bindVertexArray(null))}getConstantBuffer(t,e){const n=function(t){if(Array.isArray(t))return new Float32Array(t);return t}(e),i=n.byteLength*t,r=n.length*t;if(this.buffer&&i!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${i} !== ${this.buffer.byteLength}.`);let o=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:i}),o=o||!function(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(n,this.bufferValue),o){const t=(0,Gi.oF)(e.constructor,r);(0,Gi.R2)({target:t,source:n,start:0,count:r}),this.buffer.write(t),this.bufferValue=e}return this.buffer}}class Hi extends Sn.F{static defaultProps={...Sn.F.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(t,e){super(t,e,Hi.defaultProps)}}class Xi extends Hi{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(t,e){super(t,e),this.device=t,this.gl=t.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,e.buffers&&this.setBuffers(e.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(t="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(function(t){switch(t){case"point-list":return 0;case"line-list":case"line-strip":case"line-loop-webgl":return 1;case"triangle-list":case"triangle-strip":case"triangle-fan-webgl":return 4;default:throw new Error(t)}}(t))}end(){this.gl.endTransformFeedback(),this.bindOnUse||this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(t){this.buffers={},this.unusedBuffers={},this.bind((()=>{for(const e in t)this.setBuffer(e,t[e])}))}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:i,byteLength:r,byteOffset:o}=this._getBufferRange(e);if(n<0)return this.unusedBuffers[t]=i,void Qt.R.warn(`${this.id} unusedBuffers varying buffer ${t}`)();this.buffers[n]={buffer:i,byteLength:r,byteOffset:o},this.bindOnUse||this._bindBuffer(n,i,o,r)}getBuffer(t){if(Yi(t))return this.buffers[t]||null;const e=this._getVaryingIndex(t);return e>=0?this.buffers[e]:null}bind(t=this.handle){if("function"!=typeof t)return this.gl.bindTransformFeedback(36386,t),this;let e;return this._bound?e=t():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,e=t(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),e}unbind(){this.bind(null)}_getBufferRange(t){if(t instanceof zn)return{buffer:t,byteOffset:0,byteLength:t.byteLength};const{buffer:e,byteOffset:n=0,byteLength:i=t.buffer.byteLength}=t;return{buffer:e,byteOffset:n,byteLength:i}}_getVaryingIndex(t){if(Yi(t))return Number(t);for(const e of this.layout.varyings)if(t===e.name)return e.location;return-1}_bindBuffers(){for(const t in this.buffers){const{buffer:e,byteLength:n,byteOffset:i}=this._getBufferRange(this.buffers[t]);this._bindBuffer(Number(t),e,i,n)}}_unbindBuffers(){for(const t in this.buffers)this.gl.bindBufferBase(35982,Number(t),null)}_bindBuffer(t,e,n=0,i){const r=e&&e.handle;r&&void 0!==i?this.gl.bindBufferRange(35982,t,r,n,i):this.gl.bindBufferBase(35982,t,r)}}function Yi(t){return"number"==typeof t?Number.isInteger(t):/^\d+$/.test(t)}class qi extends Sn.F{static defaultProps={...Sn.F.defaultProps,type:void 0,count:void 0};get[Symbol.toStringTag](){return"QuerySet"}constructor(t,e){super(t,e,qi.defaultProps)}}class Qi extends qi{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(t,e){if(super(t,e),this.device=t,e.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(t){return this._begin(t?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(t){this._queryPending||(this.target=t,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const t=this.device.gl.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(t=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise(((n,i)=>{const r=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(r)};requestAnimationFrame(r)})),this._pollingPromise}}function $i(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return(0,Ae.v)(!1),0}}function Ki(t,e){const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408,sourceAttachment:o=36064}=e||{};let{target:s=null,sourceWidth:a,sourceHeight:A,sourceType:u}=e||{};const{framebuffer:l,deleteFramebuffer:c}=Ji(t);(0,Ae.v)(l);const{gl:h,handle:f}=l;a=a||l.width,A=A||l.height;const p=o-36064;u=u||l.colorAttachments[p]?.texture?.type||5121,s=function(t,e,n,i,r){if(t)return t;const o=gi(e=e||5121,{clamped:!1}),s=$i(n);return new o(i*r*s)}(s,u,r,a,A),u=u||function(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(di)}}(s);const d=h.bindFramebuffer(36160,f);return h.readPixels(n,i,a,A,r,u,s),h.bindFramebuffer(36160,d||null),c&&l.destroy(),s}function Zi(t,e){const{target:n,sourceX:i=0,sourceY:r=0,sourceFormat:o=6408,targetByteOffset:s=0}=e||{};let{sourceWidth:a,sourceHeight:A,sourceType:u}=e||{};const{framebuffer:l,deleteFramebuffer:c}=Ji(t);(0,Ae.v)(l),a=a||l.width,A=A||l.height;const h=l;u=u||5121;let f=n;if(!f){const t=s+a*A*$i(o)*function(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return(0,Ae.v)(!1),0}}(u);f=h.device.createBuffer({byteLength:t})}const p=t.device.createCommandEncoder();return p.copyTextureToBuffer({source:t,width:a,height:A,origin:[i,r],destination:f,byteOffset:s}),p.destroy(),c&&l.destroy(),f}function Ji(t){return t instanceof Tn?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:tr(t),deleteFramebuffer:!0}}function tr(t,e){const{device:n,width:i,height:r,id:o}=t;return n.createFramebuffer({...e,id:`framebuffer-for-${o}`,width:i,height:r,colorAttachments:[t]})}const er="clear: bad arguments";class nr extends ae{static type="webgl";type="webgl";handle;features;limits;info;canvasContext;lost;_resolveContextLost;static isSupported(){return"undefined"!=typeof WebGL2RenderingContext}static attach(t){if(t instanceof nr)return t;if(t?.device instanceof ae)return t.device;if(!function(t){if("undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext)return!0;return Boolean(t&&Number.isFinite(t._version))}(t))throw new Error("Invalid WebGL2RenderingContext");return new nr({gl:t})}static async create(t={}){Qt.R.groupCollapsed(1,"WebGLDevice created")();const e=[];t.debug&&e.push(async function(){(0,qt.A)()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await Pn("https://unpkg.com/webgl-debug@2.0.1/index.js"))}()),t.spector&&e.push(async function(t){if(!globalThis.SPECTOR)try{await Pn("https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js")}catch(e){Qt.R.warn(String(e))}}()),"string"==typeof t.canvas&&e.push(de.pageLoaded);const n=await Promise.allSettled(e);for(const o of n)"rejected"===o.status&&Qt.R.error(`Failed to initialize debug libraries ${o.reason}`)();if(Qt.R.probe(2,"DOM is loaded")(),t.gl?.device)return Qt.R.warn("reattaching existing device")(),nr.attach(t.gl);const i=new nr(t),r=`Created ${i.type}${i.debug?" debug":""} context: ${i.info.vendor}, ${i.info.renderer} for canvas: ${i.canvasContext.id}`;return Qt.R.probe(1,r)(),Qt.R.table(1,i.info)(),Qt.R.groupEnd(1)(),i}constructor(t){super({...t,id:t.id||(0,Zt.L)("webgl-device")});const e=t.gl?.device;if(e)throw new Error(`WebGL context already attached to device ${e.id}`);const n=t.gl?.canvas||t.canvas;this.canvasContext=new Qn(this,{...t,canvas:n}),this.lost=new Promise((t=>{this._resolveContextLost=t}));let i=t.gl||null;if(i||=function(t,e){e={...Ve,...e};let n=null;const i=t=>n=t.statusMessage||n;t.addEventListener("webglcontextcreationerror",i,!1);let r=null;if(r||=t.getContext("webgl2",e),t.removeEventListener("webglcontextcreationerror",i,!1),!r)throw new Error(`Failed to create WebGL context: ${n||"Unknown error"}`);if(e.onContextLost){const{onContextLost:n}=e;t.addEventListener("webglcontextlost",(t=>n(t)),!1)}if(e.onContextRestored){const{onContextRestored:n}=e;t.addEventListener("webglcontextrestored",(t=>n(t)),!1)}return r}(this.canvasContext.canvas,{...t,onContextLost:t=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."})}),!i)throw new Error("WebGL context creation failed");this.handle=i,this.gl=i,this.gl.device=this,this.gl._version=2,t.spector&&(this.spectorJS=function(t){if(t={...$n,...t},!t?.spector)return null;if(!Kn&&globalThis.SPECTOR&&(Qt.R.probe(1,"SPECTOR found and initialized")(),Kn=new globalThis.SPECTOR.Spector,globalThis.luma&&(globalThis.luma.spector=Kn)),!Kn)return null;if(Zn||(Zn=!0,Kn.spyCanvases(),Kn?.onCaptureStarted.add((t=>Qt.R.info("Spector capture started:",t)())),Kn?.onCapture.add((t=>{Qt.R.info("Spector capture complete:",t)(),Kn?.getResultUI(),Kn?.resultView.display(),Kn?.resultView.addCapture(t)}))),t?.canvas){if("string"==typeof t.spector&&t.spector!==t.canvas.id)return Kn;Kn?.startCapture(t?.canvas,500),new Promise((t=>setTimeout(t,2e3))).then((t=>{Qt.R.info("Spector capture stopped after 2 seconds")(),Kn?.stopCapture()}))}return Kn}({...this.props,canvas:this.handle.canvas})),this.info=We(this.gl,this._extensions),this.limits=new xn(this.gl),this.features=new wn(this.gl,this._extensions,this.props.disabledFeatures),this.props.initalizeFeatures&&this.features.initializeFeatures(),this.canvasContext.resize();const{enable:r=!0,copyState:o=!1}=t;ke(this.gl,{enable:r,copyState:o,log:(...t)=>Qt.R.log(1,...t)()}),t.debug&&(this.gl=ei(this.gl,{...t,throwOnError:!0}),this.debug=!0,Qt.R.level=Math.max(Qt.R.level,1),Qt.R.warn("WebGL debug mode activated. Performance reduced.")())}destroy(){}get isLost(){return this.gl.isContextLost()}getSize(){return[this.gl.drawingBufferWidth,this.gl.drawingBufferHeight]}isTextureFormatSupported(t){return _n(this.gl,t,this._extensions)}isTextureFormatFilterable(t){return function(t,e,n){if(!_n(t,e,n))return!1;if(e.startsWith("depth")||e.startsWith("stencil"))return!1;try{if(ie(e).signed)return!1}catch{return!1}return e.endsWith("32float")?Boolean(je(t,"OES_texture_float_linear, extensions",n)):!e.endsWith("16float")||Boolean(je(t,"OES_texture_half_float_linear, extensions",n))}(this.gl,t,this._extensions)}isTextureFormatRenderable(t){return function(t,e,n){return!!_n(t,e,n)&&"number"!=typeof e}(this.gl,t,this._extensions)}createCanvasContext(t){throw new Error("WebGL only supports a single canvas")}createBuffer(t){const e=this._getBufferProps(t);return new zn(this,e)}_createTexture(t){return new Yn(this,t)}createExternalTexture(t){throw new Error("createExternalTexture() not implemented")}createSampler(t){return new jn(this,t)}createShader(t){return new ai(this,t)}createFramebuffer(t){return new qn(this,t)}createVertexArray(t){return new Wi(this,t)}createTransformFeedback(t){return new Xi(this,t)}createQuerySet(t){return new Qi(this,t)}createRenderPipeline(t){return new Ri(this,t)}beginRenderPass(t){return new ci(this,t)}createComputePipeline(t){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(t){throw new Error("ComputePass not supported in WebGL")}renderPass=null;createCommandEncoder(t){return new Bi(this,t)}submit(){this.renderPass?.end(),this.renderPass=null}readPixelsToArrayWebGL(t,e){return Ki(t,e)}readPixelsToBufferWebGL(t,e){return Zi(t,e)}setParametersWebGL(t){Le(this.gl,t)}getParametersWebGL(t){return Ne(this.gl,t)}withParametersWebGL(t,e){return Mn(this.gl,t,e)}clearWebGL(t){!function(t,e){const{framebuffer:n=null,color:i=null,depth:r=null,stencil:o=null}=e||{},s={};n&&(s.framebuffer=n);let a=0;i&&(a|=16384,!0!==i&&(s.clearColor=i)),r&&(a|=256,!0!==r&&(s.clearDepth=r)),o&&(a|=1024,!0!==r&&(s.clearStencil=r)),(0,Ae.v)(0!==a,er);const A=t.gl;Mn(A,s,(()=>{A.clear(a)}))}(this,t)}resetWebGL(){Qt.R.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),Le(this.gl,me)}gl;debug=!1;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};_extensions={};_polyfilled=!1;spectorJS;loseDevice(){let t=!1;const e=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return e&&(t=!0,e.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),t}pushState(){Be(this.gl)}popState(){Ue(this.gl)}setSpectorMetadata(t,e){t.__SPECTOR_Metadata=e}getGLKey(t,e){e=e||this.gl2||this.gl;const n=Number(t);for(const i in e)if(e[i]===n)return`GL.${i}`;return String(t)}_constants;setConstantAttributeWebGL(t,e){const n=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(n).fill(null);const i=this._constants[t];switch(i&&function(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(i,e)&&Qt.R.info(1,`setConstantAttributeWebGL(${t}) could have been skipped, value unchanged`)(),this._constants[t]=e,e.constructor){case Float32Array:!function(t,e,n){switch(n.length){case 1:t.gl.vertexAttrib1fv(e,n);break;case 2:t.gl.vertexAttrib2fv(e,n);break;case 3:t.gl.vertexAttrib3fv(e,n);break;case 4:t.gl.vertexAttrib4fv(e,n);break;default:(0,Ae.v)(!1)}}(this,t,e);break;case Int32Array:!function(t,e,n){t.gl.vertexAttribI4iv(e,n)}(this,t,e);break;case Uint32Array:!function(t,e,n){t.gl.vertexAttribI4uiv(e,n)}(this,t,e);break;default:(0,Ae.v)(!1)}}getExtension(t){return je(this.gl,t,this._extensions),this._extensions}}let ir=0;const rr={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:t=>console.error(t),stats:le.stats.get("animation-loop-"+ir++),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class or{device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;constructor(t){if(this.props={...rr,...t},!(t=this.props).device)throw new Error("No device provided");const{useDevicePixels:e=!0}=this.props;this.stats=t.stats||new y({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:t.autoResizeViewport,autoResizeDrawingBuffer:t.autoResizeDrawingBuffer,useDevicePixels:e}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setNeedsRedraw(t){return this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.props.autoResizeViewport=t.autoResizeViewport||!1),"autoResizeDrawingBuffer"in t&&(this.props.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer||!1),"useDevicePixels"in t&&(this.props.useDevicePixels=t.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let t;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(!1!==t&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(t){const e=t instanceof Error?t:new Error("Unknown error");throw this.props.onError(e),e}}stop(){return this._running&&(this.animationProps&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers()),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((t=>{this._resolveNextFrame=t}))),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(t){this.display&&(this.display.destroy(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_requestAnimationFrame(){var t;this._running&&(this._animationFrameId=(t=this._animationFrame.bind(this),"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)))}_cancelAnimationFrame(){var t;null!==this._animationFrameId&&(t=this._animationFrameId,"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(t){this.display?this.display._renderFrame(t):(this.props.onRender(this._getAnimationProps()),this.device.submit())}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){if(!this.device)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:this.device?.canvasContext?.canvas,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:t,height:e,aspect:n}=this._getSizeAndAspect();t===this.animationProps.width&&e===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.canvasContext?.canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",this.canvas instanceof HTMLCanvasElement&&t.appendChild(this.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[t,e]=this.device?.canvasContext?.getPixelSize()||[1,1];let n=1;const i=this.device?.canvasContext?.canvas;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.props.autoResizeDrawingBuffer&&this.device?.canvasContext?.resize({useDevicePixels:this.props.useDevicePixels})}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(t){t instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[t.offsetX,t.offsetY])}_onMouseleave(t){this._getAnimationProps()._mousePosition=null}}var sr=n(2332);const ar={mousedown:1,mousemove:2,mouseup:4};!function(t){const e=t.prototype.handler;t.prototype.handler=function(t){const n=this.store;t.button>0&&"pointerdown"===t.type&&(function(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}(n,(e=>e.pointerId===t.pointerId))||n.push(t)),e.call(this,t)}}(sr.PointerEventInput),sr.MouseInput.prototype.handler=function(t){let e=ar[t.type];1&e&&t.button>=0&&(this.pressed=!0),2&e&&0===t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};const Ar=sr.Manager,ur=sr;class lr{constructor(t,e,n){this.element=t,this.callback=e,this.options={enable:!0,...n}}}const cr=ur?[[ur.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[ur.Rotate,{enable:!1}],[ur.Pinch,{enable:!1}],[ur.Swipe,{enable:!1}],[ur.Pan,{threshold:0,enable:!1}],[ur.Press,{enable:!1}],[ur.Tap,{event:"doubletap",taps:2,enable:!1}],[ur.Tap,{event:"anytap",enable:!1}],[ur.Tap,{enable:!1}]]:null,hr={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},fr={doubletap:["tap"]},pr={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},dr={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},gr={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},_r={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},mr="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",yr="undefined"!=typeof window?window:n.g;void 0!==n.g?n.g:window,"undefined"!=typeof document&&document;let vr=!1;try{const t={get passive(){return vr=!0,!0}};yr.addEventListener("test",null,t),yr.removeEventListener("test",null)}catch(Ao){vr=!1}const Er=-1!==mr.indexOf("firefox"),{WHEEL_EVENTS:br}=dr,wr="wheel",xr=4.000244140625;class Sr extends lr{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{if(!this.options.enable)return;let e=t.deltaY;yr.WheelEvent&&(Er&&t.deltaMode===yr.WheelEvent.DOM_DELTA_PIXEL&&(e/=yr.devicePixelRatio),t.deltaMode===yr.WheelEvent.DOM_DELTA_LINE&&(e*=40)),0!==e&&e%xr==0&&(e=Math.floor(e/xr)),t.shiftKey&&e&&(e*=.25),this.callback({type:wr,center:{x:t.clientX,y:t.clientY},delta:-e,srcEvent:t,pointerType:"mouse",target:t.target})},this.events=(this.options.events||[]).concat(br),this.events.forEach((e=>t.addEventListener(e,this.handleEvent,!!vr&&{passive:!1})))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===wr&&(this.options.enable=e)}}const{MOUSE_EVENTS:Cr}=dr,Tr="pointermove",Ir="pointerover",Rr="pointerout",Pr="pointerenter",Mr="pointerleave";class Lr extends lr{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{this.handleOverEvent(t),this.handleOutEvent(t),this.handleEnterEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(Cr),this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===Tr&&(this.enableMoveEvent=e),t===Ir&&(this.enableOverEvent=e),t===Rr&&(this.enableOutEvent=e),t===Pr&&(this.enableEnterEvent=e),t===Mr&&(this.enableLeaveEvent=e)}handleOverEvent(t){this.enableOverEvent&&"mouseover"===t.type&&this._emit(Ir,t)}handleOutEvent(t){this.enableOutEvent&&"mouseout"===t.type&&this._emit(Rr,t)}handleEnterEvent(t){this.enableEnterEvent&&"mouseenter"===t.type&&this._emit(Pr,t)}handleLeaveEvent(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this._emit(Mr,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this._emit(Tr,t);break;case"mouseup":this.pressed=!1}}_emit(t,e){this.callback({type:t,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const{KEY_EVENTS:Nr}=dr,Or="keydown",Dr="keyup";class Fr extends lr{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{const e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:Or,srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:Dr,srcEvent:t,key:t.key,target:t.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Nr),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===Or&&(this.enableDownEvent=e),t===Dr&&(this.enableUpEvent=e)}}const kr="contextmenu";class Br extends lr{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{this.options.enable&&this.callback({type:kr,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===kr&&(this.options.enable=e)}}const Ur={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};function Gr(t){const e=Ur[t.srcEvent.type];if(!e)return null;const{buttons:n,button:i,which:r}=t.srcEvent;let o=!1,s=!1,a=!1;return 4===e||2===e&&!Number.isFinite(n)?(o=1===r,s=2===r,a=3===r):2===e?(o=Boolean(1&n),s=Boolean(4&n),a=Boolean(2&n)):1===e&&(o=0===i,s=1===i,a=2===i),{leftButton:o,middleButton:s,rightButton:a}}function zr(t,e){const n=t.center;if(!n)return null;const i=e.getBoundingClientRect(),r=i.width/e.offsetWidth||1,o=i.height/e.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-i.left-e.clientLeft)/r,y:(n.y-i.top-e.clientTop)/o}}}const Vr={srcElement:"root",priority:0};class jr{constructor(t){this.handleEvent=t=>{if(this.isEmpty())return;const e=this._normalizeEvent(t);let n=t.srcEvent.target;for(;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,e,n,i=!1,r=!1){const{handlers:o,handlersByElement:s}=this;let a=Vr;"string"==typeof n||n&&n.addEventListener?a={...Vr,srcElement:n}:n&&(a={...Vr,...n});let A=s.get(a.srcElement);A||(A=[],s.set(a.srcElement,A));const u={type:t,handler:e,srcElement:a.srcElement,priority:a.priority};i&&(u.once=!0),r&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let l=A.length-1;for(;l>=0&&!(A[l].priority>=u.priority);)l--;A.splice(l+1,0,u)}remove(t,e){const{handlers:n,handlersByElement:i}=this;for(let r=n.length-1;r>=0;r--){const o=n[r];if(o.type===t&&o.handler===e){n.splice(r,1);const t=i.get(o.srcElement);t.splice(t.indexOf(o),1),0===t.length&&i.delete(o.srcElement)}}this._active=n.some((t=>!t.passive))}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let e=!1;const i=()=>{t.handled=!0},r=()=>{t.handled=!0,e=!0},o=[];for(let s=0;s<n.length;s++){const{type:a,handler:A,once:u}=n[s];if(A({...t,type:a,stopPropagation:i,stopImmediatePropagation:r}),u&&o.push(n[s]),e)break}for(let t=0;t<o.length;t++){const{type:e,handler:n}=o[t];this.remove(e,n)}}}_normalizeEvent(t){const e=this.eventManager.getElement();return{...t,...Gr(t),...zr(t,e),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:e}}}const Wr={events:null,recognizers:null,recognizerOptions:{},Manager:Ar,touchAction:"none",tabIndex:0};class Hr{constructor(t=null,e){this._onBasicInput=t=>{const{srcEvent:e}=t,n=pr[e.type];n&&this.manager.emit(n,t)},this._onOtherEvent=t=>{this.manager.emit(t.type,t)},this.options={...Wr,...e},this.events=new Map,this.setElement(t);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,n=e.Manager;this.manager=new n(t,{touchAction:e.touchAction,recognizers:e.recognizers||cr}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(hr).forEach((t=>{const e=this.manager.get(t);e&&hr[t].forEach((t=>{e.recognizeWith(t)}))}));for(const i in e.recognizerOptions){const t=this.manager.get(i);if(t){const n=e.recognizerOptions[i];delete n.enable,t.set(n)}}this.wheelInput=new Sr(t,this._onOtherEvent,{enable:!1}),this.moveInput=new Lr(t,this._onOtherEvent,{enable:!1}),this.keyInput=new Fr(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new Br(t,this._onOtherEvent,{enable:!1});for(const[i,r]of this.events)r.isEmpty()||(this._toggleRecognizer(r.recognizerName,!0),this.manager.on(i,r.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const i=n.get(t);if(i&&i.options.enable!==e){i.set({enable:e});const r=fr[t];r&&!this.options.recognizers&&r.forEach((r=>{const o=n.get(r);e?(o.requireFailure(t),i.dropRequireFailure(r)):o.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,i,r){if("string"!=typeof t){n=e;for(const e in t)this._addEventHandler(e,t[e],n,i,r);return}const{manager:o,events:s}=this,a=_r[t]||t;let A=s.get(a);A||(A=new jr(this),s.set(a,A),A.recognizerName=gr[a]||a,o&&o.on(a,A.handleEvent)),A.add(t,e,n,i,r),A.isEmpty()||this._toggleRecognizer(A.recognizerName,!0)}_removeEventHandler(t,e){if("string"!=typeof t){for(const e in t)this._removeEventHandler(e,t[e]);return}const{events:n}=this,i=_r[t]||t,r=n.get(i);if(r&&(r.remove(t,e),r.isEmpty())){const{recognizerName:t}=r;let e=!1;for(const i of n.values())if(i.recognizerName===t&&!i.isEmpty()){e=!0;break}e||this._toggleRecognizer(t,!1)}}}var Xr=n(4067);function Yr(){}const qr={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{type:"webgl"},gl:null,glOptions:{},canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:Yr,onWebGLInitialized:Yr,onResize:Yr,onViewStateChange:Yr,onInteractionStateChange:Yr,onBeforeRender:Yr,onAfterRender:Yr,onLoad:Yr,onError:t=>f.A.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:({isDragging:t})=>t?"grabbing":"grab",getTooltip:null,debug:!1,drawPickingColors:!1};class Qr{static{this.defaultProps=qr}static{this.VERSION=Yt}constructor(t){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new y({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=t=>{const{_pickRequest:e}=this;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;{const n=t.offsetCenter;if(!n)return;e.x=n.x,e.y=n.y,e.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t},this._onEvent=t=>{const e=j.qY[t.type],n=t.offsetCenter;if(!e||!n||!this.layerManager)return;const i=this.layerManager.getLayers(),r=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:i,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:o}=r,s=o&&(o[e.handler]||o.props[e.handler]),a=this.props[e.handler];let A=!1;s&&(A=s.call(o,r,t)),A||(a?.(r,t),this.widgetManager.onEvent(r,t))},this._onPointerDown=t=>{const e=t.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:e.x,y:e.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo},this.props={...qr,...t},(t=this.props).viewState&&t.initialViewState&&f.A.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,t.device?this.device=t.device:t.gl&&(t.gl instanceof WebGLRenderingContext&&f.A.error("WebGL1 context not supported.")(),this.device=nr.attach(t.gl));let e=this.device;e||(le.registerDevices([nr]),e=le.createDevice({...t.deviceProps,canvas:this._createCanvas(t)})),this.animationLoop=this._createAnimationLoop(e,t),this.setProps(t),t._typedArrayManagerProps&&vt.A.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,this.props.canvas||this.props.device||this.props.gl||!this.canvas||(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&f.A.removed("onLayerHover","onHover")(),"onLayerClick"in t&&f.A.removed("onLayerClick","onClick")(),t.initialViewState&&!(0,S.b)(this.props.initialViewState,t.initialViewState,3)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop?.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e),this.widgetManager.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),i=this.layerManager.needsRedraw(t),r=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return e=e||n||i||r||o,e}redraw(t){if(!this.layerManager)return;let e=this.needsRedraw({clearRedrawFlags:!0});e=t||e,e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}get isInitialized(){return null!==this.viewManager}getViews(){return(0,Xr.A)(this.viewManager),this.viewManager.views}getViewports(t){return(0,Xr.A)(this.viewManager),this.viewManager.getViewports(t)}getCanvas(){return this.canvas}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,e=!1){for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_addDefaultEffect(t){this.effectManager.addDefaultEffect(t)}_addDefaultShaderModule(t){this.layerManager.addDefaultShaderModule(t)}_removeDefaultShaderModule(t){this.layerManager?.removeDefaultShaderModule(t)}_pick(t,e,n){(0,Xr.A)(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(e).timeStart();const r=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(e).timeEnd(),r}_createCanvas(t){let e=t.canvas;if("string"==typeof e&&(e=document.getElementById(e),(0,Xr.A)(e)),!e){e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay";(t.parent||document.body).appendChild(e)}return Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;const{width:e,height:n}=t;if(e||0===e){const t=Number.isFinite(e)?`${e}px`:e;this.canvas.style.width=t}if(n||0===n){const e=Number.isFinite(n)?`${n}px`:n;this.canvas.style.position=t.style?.position||"absolute",this.canvas.style.height=e}}_updateCanvasSize(){const{canvas:t}=this;if(!t)return;const e=t.clientWidth??t.width,n=t.clientHeight??t.height;e===this.width&&n===this.height||(this.width=e,this.height=n,this.viewManager?.setProps({width:e,height:n}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:e,height:n}))}_createAnimationLoop(t,e){const{gl:n,onError:i,useDevicePixels:r}=e;return new or({device:t,useDevicePixels:r,autoResizeDrawingBuffer:!n,autoResizeViewport:!1,onInitialize:t=>this._setDevice(t.device),onRender:this._onRenderFrame.bind(this),onError:i})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:t}=this.props,e=Array.isArray(t)?t:t?[t]:[new T.A({id:"default-view"})];return e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:e,emptyInfo:n}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=e.length>0;let i=n,r=!1;for(const o of e)i=o,r=o.layer?.onHover(o,t.event)||r;r||(this.props.onHover?.(i,t.event),this.widgetManager.onHover(i,t.event)),t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(t){if(this.device=t,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas),this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device instanceof nr&&this.props.onWebGLInitialized(this.device.gl);const e=new s;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new Hr(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in j.qY)this.eventManager.on(i,this._onEvent);this.viewManager=new C({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new x(this.device,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new nt({deck:this,device:this.device}),this.deckRenderer=new at(this.device),this.deckPicker=new ft(this.device),this.widgetManager=new _t({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new yt),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{device:n,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:n,gl:i});const r={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...e};this.deckRenderer?.renderLayers(r),"screen"===r.pass&&this.widgetManager.onRedraw({viewports:r.viewports,layers:r.layers}),this.props.onAfterRender({device:n,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),f.A.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=le.stats.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}const $r="undefined"!=typeof window?i.useLayoutEffect:i.useEffect;function Kr(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}var Zr=n(1152),Jr=n(688);const to={position:"absolute",zIndex:-1};function eo(t,e){if("function"==typeof t)return t(e);if(Array.isArray(t))return t.map((t=>eo(t,e)));if(no(t)){if(n=t,n.props?.mapStyle)return e.style=to,(0,i.cloneElement)(t,e);if(function(t){const e=t.type;return e&&e.deckGLViewProps}(t))return(0,i.cloneElement)(t,e)}var n;return t}function no(t){return t&&"object"==typeof t&&"type"in t||!1}function io(t){if("function"==typeof t)return(0,i.createElement)(Zr.A,{},t);if(Array.isArray(t))return t.map(io);if(no(t)){if(t.type===i.Fragment)return io(t.props.children);if(Kr(t.type,Zr.A))return t}return t}const ro={mixBlendMode:null};function oo(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}const so=i.forwardRef((function(t,e){const[n,r]=(0,i.useState)(0),o=(0,i.useRef)({control:null,version:n,forceUpdate:()=>r((t=>t+1))}).current,s=(0,i.useRef)(null),a=(0,i.useRef)(null),A=(0,i.useMemo)((()=>function({children:t,layers:e=[],views:n=null}){const r=[],o=[],s={};return i.Children.forEach(io(t),(t=>{if(no(t)){const e=t.type;if(Kr(e,Jr.A)){const n=function(t,e){const n={},i=t.defaultProps||{};for(const r in e)i[r]!==e[r]&&(n[r]=e[r]);return new t(n)}(e,t.props);o.push(n)}else r.push(t);if(Kr(e,Zr.A)&&e!==Zr.A&&t.props.id){const n=new e(t.props);s[n.id]=n}}else t&&r.push(t)})),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach((t=>{s[t.id]=t})):n&&(s[n.id]=n),n=Object.values(s)),{layers:e=o.length>0?[...o,...e]:e,children:r,views:n}}(t)),[t.layers,t.views,t.children]);let u=!0;const l=e=>u&&t.viewState?(o.viewStateUpdateRequested=e,null):(o.viewStateUpdateRequested=null,t.onViewStateChange?.(e)),c=e=>{u?o.interactionStateUpdateRequested=e:(o.interactionStateUpdateRequested=null,t.onInteractionStateChange?.(e))},h=(0,i.useMemo)((()=>{const e={...t,style:null,width:"100%",height:"100%",parent:s.current,canvas:a.current,layers:A.layers,views:A.views,onViewStateChange:l,onInteractionStateChange:c};return delete e._customRender,o.deck&&o.deck.setProps(e),e}),[t]);(0,i.useEffect)((()=>{const e=t.Deck||Qr;return o.deck=function(t,e,n){const i=new e({...n,_customRender:e=>{t.redrawReason=e;const n=i.getViewports();t.lastRenderedViewports!==n?t.forceUpdate():oo(t)}});return i}(o,e,{...h,parent:s.current,canvas:a.current}),()=>o.deck?.finalize()}),[]),$r((()=>{oo(o);const{viewStateUpdateRequested:t,interactionStateUpdateRequested:e}=o;t&&l(t),e&&c(e)})),(0,i.useImperativeHandle)(e,(()=>function(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}(o)),[]);const f=o.deck&&o.deck.isInitialized?o.deck.getViewports():void 0,{ContextProvider:p,width:d="100%",height:g="100%",id:_,style:m}=t,{containerStyle:y,canvasStyle:v}=(0,i.useMemo)((()=>function({width:t,height:e,style:n}){const i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},r={left:0,top:0};if(n)for(const o in n)o in ro?r[o]=n[o]:i[o]=n[o];return{containerStyle:i,canvasStyle:r}}({width:d,height:g,style:m})),[d,g,m]);if(!o.viewStateUpdateRequested&&o.lastRenderedViewports===f||o.version!==n){o.lastRenderedViewports=f,o.version=n;const t=function({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const o={},s=r.views[0].id;for(const i of t){let t=s,e=i;no(i)&&Kr(i.type,Zr.A)&&(t=i.props.id||s,e=i.props.children);const n=r.getViewport(t),a=r.getViewState(t);if(n){a.padding=n.padding;const{x:i,y:r,width:s,height:A}=n;e=eo(e,{x:i,y:r,width:s,height:A,viewport:n,viewState:a}),o[t]||(o[t]={viewport:n,children:[]}),o[t].children.push(e)}}return Object.keys(o).map((t=>{const{viewport:r,children:s}=o[t],{x:a,y:A,width:u,height:l}=r,c={position:"absolute",left:a,top:A,width:u,height:l},h=`view-${t}`,f=(0,i.createElement)("div",{key:h,id:h,style:c},...s);if(n){const o={viewport:r,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:n=>{n.viewId=t,e._onViewStateChange(n)}};return(0,i.createElement)(n,{key:h,value:o},f)}return f}))}({children:A.children,deck:o.deck,ContextProvider:p}),e=(0,i.createElement)("canvas",{key:"canvas",id:_||"deckgl-overlay",ref:a,style:v});o.control=(0,i.createElement)("div",{id:`${_||"deckgl"}-wrapper`,ref:s,style:y},[e,t])}return u=!1,o.control})),ao=so},8521:(t,e,n)=>{"use strict";n.d(e,{Gv:()=>o,H1:()=>h,Pe:()=>c,Sv:()=>u,Td:()=>A,aC:()=>s,qf:()=>l,xZ:()=>a});const i=t=>"boolean"==typeof t,r=t=>"function"==typeof t,o=t=>null!==t&&"object"==typeof t,s=t=>o(t)&&t.constructor==={}.constructor,a=t=>Boolean(t)&&"function"==typeof t[Symbol.iterator],A=t=>t&&"function"==typeof t[Symbol.asyncIterator],u=t=>"undefined"!=typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,l=t=>"undefined"!=typeof Blob&&t instanceof Blob,c=t=>t&&"object"==typeof t&&t.isBuffer,h=t=>(t=>"undefined"!=typeof ReadableStream&&t instanceof ReadableStream||o(t)&&r(t.tee)&&r(t.cancel)&&r(t.getReader))(t)||(t=>o(t)&&r(t.read)&&r(t.pipe)&&i(t.readable))(t)},3022:(t,e,n)=>{"use strict";n.d(e,{H:()=>ct});var i=n(8521),r=n(405);let o="";const s={};const a=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,A=/^([-\w.]+\/[-\w.+]+)/;function u(t){const e=a.exec(t);return e?e[1]:""}const l=/\?.*/;function c(t){return t.replace(l,"")}function h(t){if((0,i.Sv)(t)){return t.url}if((0,i.qf)(t)){return t.name||""}return"string"==typeof t?t:""}function f(t){if((0,i.Sv)(t)){const e=t,n=e.headers.get("content-type")||"",i=c(e.url);return function(t){const e=A.exec(t);return e?e[1]:t}(n)||u(i)}if((0,i.qf)(t)){return t.type||""}return"string"==typeof t?u(t):""}async function p(t){if((0,i.Sv)(t))return t;const e={},n=function(t){if((0,i.Sv)(t))return t.headers["content-length"]||-1;if((0,i.qf)(t))return t.size;return"string"==typeof t?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}(t);n>=0&&(e["content-length"]=String(n));const r=h(t),o=f(t);o&&(e["content-type"]=o);const s=await async function(t){const e=5;if("string"==typeof t)return`data:,${t.slice(0,e)}`;if(t instanceof Blob){const e=t.slice(0,5);return await new Promise((t=>{const n=new FileReader;n.onload=e=>{var n;return t(null==e||null===(n=e.target)||void 0===n?void 0:n.result)},n.readAsDataURL(e)}))}if(t instanceof ArrayBuffer){return`data:base64,${function(t){let e="";const n=new Uint8Array(t);for(let i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return btoa(e)}(t.slice(0,e))}`}return null}(t);s&&(e["x-first-bytes"]=s),"string"==typeof t&&(t=(new TextEncoder).encode(t));const a=new Response(t,{headers:e});return Object.defineProperty(a,"url",{value:r}),a}async function d(t,e){if("string"==typeof t){const r=function(t){for(const e in s)if(t.startsWith(e)){const n=s[e];t=t.replace(e,n)}return t.startsWith("http://")||t.startsWith("https://")||(t=`${o}${t}`),t}(t);var n,i;if(function(t){return!function(t){return t.startsWith("http:")||t.startsWith("https:")}(t)&&!function(t){return t.startsWith("data:")}(t)}(r))if(null!==(n=globalThis.loaders)&&void 0!==n&&n.fetchNode)return null===(i=globalThis.loaders)||void 0===i?void 0:i.fetchNode(r,e);return await fetch(r,e)}return await p(t)}var g=n(9027);function _(t,e){const n=(0,g.pp)(),r=t||n;return"function"==typeof r.fetch?r.fetch:(0,i.Gv)(r.fetch)?t=>d(t,r.fetch):null!=e&&e.fetch?null==e?void 0:e.fetch:d}"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document;const m="object"!=typeof process||"[object process]"!==String(process)||process.browser,y="undefined"!=typeof window&&void 0!==window.orientation,v="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);v&&parseFloat(v[1]);class E{terminate(){}}function b(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const w=new Map;function x(t){b(t.source&&!t.url||!t.source&&t.url);let e=w.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return S((e=t,`try {\n  importScripts('${e}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`));var e}(t.url),w.set(t.url,e)),t.source&&(e=S(t.source),w.set(t.source,e))),b(e),e}function S(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function C(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const i=n||new Set;if(t){if(T(t))i.add(t);else if(T(t.buffer))i.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(const r in t)C(t[r],e,i)}else;return void 0===n?Array.from(i):[]}function T(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&t instanceof MessagePort||("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}const I=()=>{};class R{static isSupported(){return"undefined"!=typeof Worker&&m||void 0!==E&&!m}constructor(t){this.name=void 0,this.source=void 0,this.url=void 0,this.terminated=!1,this.worker=void 0,this.onMessage=void 0,this.onError=void 0,this._loadableURL="";const{name:e,source:n,url:i}=t;b(n||i),this.name=e,this.source=n,this.url=i,this.onMessage=I,this.onError=t=>console.log(t),this.worker=m?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=I,this.onError=I,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,e){e=e||C(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+=`worker ${this.name} from ${this.url}. `,t.message&&(e+=`${t.message} in `),t.lineno&&(e+=`:${t.lineno}:${t.colno}`),new Error(e)}_createBrowserWorker(){this._loadableURL=x({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},t.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},t.onmessageerror=t=>console.error(t),t}_createNodeWorker(){let t;if(this.url){const e=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;t=new E(e,{eval:!1})}else{if(!this.source)throw new Error("no worker");t=new E(this.source,{eval:!0})}return t.on("message",(t=>{this.onMessage(t)})),t.on("error",(t=>{this.onError(t)})),t.on("exit",(t=>{})),t}}class P{constructor(t,e){this.name=void 0,this.workerThread=void 0,this.isRunning=!0,this.result=void 0,this._resolve=()=>{},this._reject=()=>{},this.name=t,this.workerThread=e,this.result=new Promise(((t,e)=>{this._resolve=t,this._reject=e}))}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){b(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){b(this.isRunning),this.isRunning=!1,this._reject(t)}}class M{static isSupported(){return R.isSupported()}constructor(t){this.name="unnamed",this.source=void 0,this.url=void 0,this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=()=>{},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach((t=>t.destroy())),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}async startJob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t,e,n)=>t.done(n),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(t,e)=>t.error(e);const i=new Promise((i=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:i}),this)));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const i=new P(e.name,t);t.onMessage=t=>e.onMessage(i,t.type,t.payload),t.onError=t=>e.onError(i,t),e.onStart(i);try{await i.result}catch(n){console.error(`Worker exception: ${n}`)}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){!m||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new R({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return y?this.maxMobileConcurrency:this.maxConcurrency}}const L={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class N{static isSupported(){return R.isSupported()}static getWorkerFarm(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return N._workerFarm=N._workerFarm||new N({}),N._workerFarm.setProps(t),N._workerFarm}constructor(t){this.props=void 0,this.workerPools=new Map,this.props={...L},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:i}=t;let r=this.workerPools.get(e);return r||(r=new M({name:e,source:n,url:i}),r.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,r)),r}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}N._workerFarm=void 0;const O="latest";const D=(null!==(F=globalThis._loadersgl_)&&void 0!==F&&F.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.1.4"),globalThis._loadersgl_.version);var F;async function k(t,e,n,i,r){const o=t.id,s=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e[t.id]||{},i=m?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let r=n.workerUrl;if(r||"compression"!==t.id||(r=e.workerUrl),"test"===e._workerType&&(r=m?`modules/${t.module}/dist/${i}`:`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!r){let e=t.version;"latest"===e&&(e=O);const n=e?`@${e}`:"";r=`https://unpkg.com/@loaders.gl/${t.module}${n}/dist/${i}`}return b(r),r}(t,n),a=N.getWorkerFarm(n).getWorkerPool({name:o,url:s});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const A=await a.startJob("process-on-worker",B.bind(null,r));A.postMessage("process",{input:e,options:n,context:i});const u=await A.result;return await u.result}async function B(t,e,n,i){switch(n){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:o,input:s,options:a}=i;try{const n=await t(s,a);e.postMessage("done",{id:o,result:n})}catch(r){const t=r instanceof Error?r.message:"unknown error";e.postMessage("error",{id:o,error:t})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}function U(t,e){return G(t||{},e)}function G(t,e,n=0){if(n>3)return e;const i={...t};for(const[r,o]of Object.entries(e))o&&"object"==typeof o&&!Array.isArray(o)?i[r]=G(i[r]||{},e[r],n+1):i[r]=e[r];return i}function z(...t){return function(t){const e=t.map((t=>t instanceof ArrayBuffer?new Uint8Array(t):t)),n=e.reduce(((t,e)=>t+e.byteLength),0),i=new Uint8Array(n);let r=0;for(const o of e)i.set(o,r),r+=o.byteLength;return i.buffer}(t)}const V=262144;const j=262144;const W=1048576;var H=n(7612);function X(t){if((e=t)&&"object"==typeof e&&e.isBuffer)return t;var e;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"==typeof t){const e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"==typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function Y(t,e){return H.Bd?async function*(t,e){const n=t.getReader();let i;try{for(;;){const t=i||n.read();null!=e&&e._streamReadAhead&&(i=n.read());const{done:r,value:o}=await t;if(r)return;yield X(o)}}catch(r){n.releaseLock()}}(t,e):async function*(t,e){for await(const n of t)yield X(n)}(t)}function q(t,e){if("string"==typeof t)return function*(t,e){const n=(null==e?void 0:e.chunkSize)||V;let i=0;const r=new TextEncoder;for(;i<t.length;){const e=Math.min(t.length-i,n),o=t.slice(i,i+e);i+=e,yield r.encode(o)}}(t,e);if(t instanceof ArrayBuffer)return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const{chunkSize:n=j}=e;let i=0;for(;i<t.byteLength;){const e=Math.min(t.byteLength-i,n),r=new ArrayBuffer(e),o=new Uint8Array(t,i,e);new Uint8Array(r).set(o),i+=e,yield r}}()}(t,e);if((0,i.qf)(t))return async function*(t,e){const n=(null==e?void 0:e.chunkSize)||W;let i=0;for(;i<t.size;){const e=i+n,r=await t.slice(i,e).arrayBuffer();i=e,yield r}}(t,e);if((0,i.H1)(t))return Y(t,e);if((0,i.Sv)(t)){return Y(t.body,e)}throw new Error("makeIterator")}const Q="Cannot convert supplied data type";async function $(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if("string"==typeof t||r)return function(t,e,n){if(e.text&&"string"==typeof t)return t;if((0,i.Pe)(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const i=t.byteLength||t.length;return 0===t.byteOffset&&i===n.byteLength||(n=n.slice(t.byteOffset,t.byteOffset+i)),n}throw new Error(Q)}(t,e);if((0,i.qf)(t)&&(t=await p(t)),(0,i.Sv)(t)){const n=t;return await async function(t){if(!t.ok){const e=await async function(t){let e=`Failed to fetch resource ${t.url} (${t.status}): `;try{const n=t.headers.get("Content-Type");let i=t.statusText;null!=n&&n.includes("application/json")&&(i+=` ${await t.text()}`),e+=i,e=e.length>60?`${e.slice(0,60)}...`:e}catch(n){}return e}(t);throw new Error(e)}}(n),e.binary?await n.arrayBuffer():await n.text()}if((0,i.H1)(t)&&(t=q(t,n)),(0,i.xZ)(t)||(0,i.Td)(t))return async function(t){const e=[];for await(const n of t)e.push(n);return z(...e)}(t);throw new Error(Q)}function K(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function Z(t,e,n){if(n)return n;const i={fetch:_(e,t),...t};if(i.url){const t=c(i.url);i.baseUrl=t,i.queryString=function(t){const e=t.match(l);return e&&e[0]}(i.url),i.filename=K(t),i.baseUrl=function(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}(t)}return Array.isArray(i.loaders)||(i.loaders=null),i}const J=new(n(1369).t)({id:"loaders.gl"});var tt=n(5223);const et=/\.([^.]+)$/;function nt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!it(t))return null;if(e&&!Array.isArray(e))return(0,r.D)(e);let o=[];e&&(o=o.concat(e)),null!=n&&n.ignoreRegisteredLoaders||o.push(...(0,tt.Ph)()),function(t){for(const e of t)(0,r.D)(e)}(o);const s=function(t,e,n,i){const r=h(t),o=f(t),s=c(r)||(null==i?void 0:i.url);let a=null,A="";null!=n&&n.mimeType&&(a=ot(e,null==n?void 0:n.mimeType),A=`match forced by supplied MIME type ${null==n?void 0:n.mimeType}`);a=a||function(t,e){const n=e&&et.exec(e),i=n&&n[1];return i?function(t,e){e=e.toLowerCase();for(const n of t)for(const t of n.extensions)if(t.toLowerCase()===e)return n;return null}(t,i):null}(e,s),A=A||(a?`matched url ${s}`:""),a=a||ot(e,o),A=A||(a?`matched MIME type ${o}`:""),a=a||function(t,e){if(!e)return null;for(const n of t)if("string"==typeof e){if(st(e,n))return n}else if(ArrayBuffer.isView(e)){if(at(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer){if(at(e,0,n))return n}return null}(e,t),A=A||(a?`matched initial data ${At(t)}`:""),null!=n&&n.fallbackMimeType&&(a=a||ot(e,null==n?void 0:n.fallbackMimeType),A=A||(a?`matched fallback MIME type ${o}`:""));var u;A&&J.log(1,`selectLoader selected ${null===(u=a)||void 0===u?void 0:u.name}: ${A}.`);return a}(t,o,n,i);if(!(s||null!=n&&n.nothrow))throw new Error(rt(t));return s}function it(t){return!(t instanceof Response&&204===t.status)}function rt(t){const e=h(t),n=f(t);let i="No valid loader found (";i+=e?`${K(e)}, `:"no url provided, ",i+=`MIME type: ${n?`"${n}"`:"not provided"}, `;const r=t?At(t):"";return i+=r?` first bytes: "${r}"`:"first bytes: not available",i+=")",i}function ot(t,e){for(const n of t){if(n.mimeTypes&&n.mimeTypes.includes(e))return n;if(e===`application/x.${n.id}`)return n}return null}function st(t,e){if(e.testText)return e.testText(t);return(Array.isArray(e.tests)?e.tests:[e.tests]).some((e=>t.startsWith(e)))}function at(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((n=>function(t,e,n,i){if(i instanceof ArrayBuffer)return function(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const i=new Uint8Array(t),r=new Uint8Array(e);for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0}(i,t,i.byteLength);switch(typeof i){case"function":return i(t);case"string":return i===ut(t,e,i.length);default:return!1}}(t,e,0,n)))}function At(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"==typeof t)return t.slice(0,e);if(ArrayBuffer.isView(t))return ut(t.buffer,t.byteOffset,e);if(t instanceof ArrayBuffer){return ut(t,0,e)}return""}function ut(t,e,n){if(t.byteLength<e+n)return"";const i=new DataView(t);let r="";for(let o=0;o<n;o++)r+=String.fromCharCode(i.getUint8(e+o));return r}async function lt(t,e,n,o){!e||Array.isArray(e)||(0,r.l)(e)||(o=void 0,n=e,e=void 0),n=n||{};const s=h(t=await t),a=function(t,e){if(t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const t=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...t]:t}return n&&n.length?n:void 0}(e,o),A=await async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!it(t))return null;let o=nt(t,e,{...n,nothrow:!0},r);if(o)return o;if((0,i.qf)(t)&&(o=nt(t=await t.slice(0,10).arrayBuffer(),e,n,r)),!(o||null!=n&&n.nothrow))throw new Error(rt(t));return o}(t,a,n);return A?(o=Z({url:s,_parse:lt,loaders:a},n=(0,g.a5)(n,A,a,s),o||null),await async function(t,e,n,r){if(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:D;b(t,"no worker provided");const n=t.version}(t),n=U(t.options,n),(0,i.Sv)(e)){const t=e,{ok:n,redirected:i,status:o,statusText:s,type:a,url:A}=t,u=Object.fromEntries(t.headers.entries());r.response={headers:u,ok:n,redirected:i,status:o,statusText:s,type:a,url:A}}e=await $(e,t,n);const o=t;if(o.parseTextSync&&"string"==typeof e)return o.parseTextSync(e,n,r);if(function(t,e){return!!N.isSupported()&&!(!m&&!e?._nodeWorkers)&&t.worker&&e?.worker}(t,n))return await k(t,e,n,r,lt);if(o.parseText&&"string"==typeof e)return await o.parseText(e,n,r);if(o.parse)return await o.parse(e,n,r);throw b(!o.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}(A,t,n,o)):null}async function ct(t,e,n,o){let s,a;Array.isArray(e)||(0,r.l)(e)?(s=e,a=n):(s=[],a=e);const A=_(a);let u=t;return"string"==typeof t&&(u=await A(t)),(0,i.qf)(t)&&(u=await A(t)),Array.isArray(s),await lt(u,s,a)}},5223:(t,e,n)=>{"use strict";n.d(e,{Ph:()=>a,mk:()=>s});var i=n(405),r=n(9027);const o=()=>{const t=(0,r.K2)();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function s(t){const e=o();t=Array.isArray(t)?t:[t];for(const n of t){const t=(0,i.D)(n);e.find((e=>t===e))||e.unshift(t)}}function a(){return o()}},405:(t,e,n)=>{"use strict";n.d(e,{D:()=>o,l:()=>r});var i=n(4976);function r(t){var e;if(!t)return!1;Array.isArray(t)&&(t=t[0]);return Array.isArray(null===(e=t)||void 0===e?void 0:e.extensions)}function o(t){var e,n;let o;return(0,i.v)(t,"null loader"),(0,i.v)(r(t),"invalid loader"),Array.isArray(t)&&(o=t[1],t=t[0],t={...t,options:{...t.options,...o}}),(null!==(e=t)&&void 0!==e&&e.parseTextSync||null!==(n=t)&&void 0!==n&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}},9027:(t,e,n)=>{"use strict";n.d(e,{pp:()=>l,K2:()=>u,a5:()=>c});var i=n(8521);const r=new(n(1369).t)({id:"loaders.gl"});class o{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}var s=n(7612);const a={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){this.console=void 0,this.console=console}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.log.bind(this.console,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.info.bind(this.console,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.warn.bind(this.console,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.error.bind(this.console,...e)}},useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:s.Bd,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},A={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function u(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}function l(){const t=u();return t.globalOptions=t.globalOptions||{...a},t.globalOptions}function c(t,e,n,i){return n=n||[],function(t,e){h(t,null,a,A,e);for(const n of e){const i=t&&t[n.id]||{},r=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};h(i,n.id,r,o,e)}}(t,n=Array.isArray(n)?n:[n]),p(e,t,i)}function h(t,e,n,o,s){const a=e||"Top level",A=e?`${e}.`:"";for(const u in t){const l=!e&&(0,i.Gv)(t[u]);if(!(u in n)&&!("baseUri"===u&&!e)&&!("workerUrl"===u&&e))if(u in o)r.warn(`${a} loader option '${A}${u}' no longer supported, use '${o[u]}'`)();else if(!l){const t=f(u,s);r.warn(`${a} loader option '${A}${u}' not recognized. ${t}`)()}}}function f(t,e){const n=t.toLowerCase();let i="";for(const r of e)for(const e in r.options){if(t===e)return`Did you mean '${r.id}.${e}'?`;const o=e.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(i=i||`Did you mean '${r.id}.${e}'?`)}return i}function p(t,e,n){const i={...t.options||{}};return function(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}(i,n),null===i.log&&(i.log=new o),d(i,l()),d(i,e),i}function d(t,e){for(const n in e)if(n in e){const r=e[n];(0,i.aC)(r)&&(0,i.aC)(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}},4976:(t,e,n)=>{"use strict";function i(t,e){if(!t)throw new Error(e||"loader assertion failed.")}n.d(e,{v:()=>i})},7612:(t,e,n)=>{"use strict";n.d(e,{Bd:()=>i});"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document;const i=Boolean("object"!=typeof process||"[object process]"!==String(process)||process.browser),r="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);r&&parseFloat(r[1])},3884:(t,e,n)=>{"use strict";n.d(e,{Mr:()=>u,PV:()=>A,GE:()=>h});var i=n(9651);const r={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},o={f32:4,f16:2,i32:4,u32:4};var s=n(9202);function a(t){let e;t.endsWith("-webgl")&&(t.replace("-webgl",""),e=!0);const[n,i]=t.split("x"),r=n,o=i?parseInt(i):1,a=(0,s.l)(r),A={type:r,components:o,byteLength:a.byteLength*o,integer:a.integer,signed:a.signed,normalized:a.normalized};return e&&(A.webglOnly=!0),A}function A(t,e){const n={};for(const i of t.attributes)n[i.name]=l(t,e,i.name);return n}function u(t,e,n=16){const i=A(t,e),r=new Array(n).fill(null);for(const o of Object.values(i))r[o.location]=o;return r}function l(t,e,n){const s=function(t,e){const n=t.attributes.find((t=>t.name===e));n||i.R.warn(`shader layout attribute "${e}" not present in shader`);return n||null}(t,n),A=function(t,e){c(t);let n=function(t,e){for(const n of t)if(n.format&&n.name===e)return{attributeName:n.name,bufferName:e,stepMode:n.stepMode,vertexFormat:n.format,byteOffset:0,byteStride:n.byteStride||0};return null}(t,e);if(n)return n;if(n=function(t,e){for(const n of t){let t=n.byteStride;if("number"!=typeof n.byteStride)for(const e of n.attributes||[]){t+=a(e.format).byteLength}const i=n.attributes?.find((t=>t.attribute===e));if(i)return{attributeName:i.attribute,bufferName:n.name,stepMode:n.stepMode,vertexFormat:i.format,byteOffset:i.byteOffset,byteStride:t}}return null}(t,e),n)return n;return i.R.warn(`layout for attribute "${e}" not present in buffer layout`),null}(e,n);if(!s)return null;const u=function(t){const[e,n]=r[t],i="i32"===e||"u32"===e,s="u32"!==e,a=o[e]*n,A=function(t,e){let n;switch(t){case"f32":n="float32";break;case"i32":n="sint32";break;case"u32":n="uint32";break;case"f16":return e<=2?"float16x2":"float16x4"}return 1===e?n:`${n}x${e}`}(e,n);return{dataType:e,components:n,defaultVertexFormat:A,byteLength:a,integer:i,signed:s}}(s.type),l=A?.vertexFormat||u.defaultVertexFormat,h=a(l);return{attributeName:A?.attributeName||s.name,bufferName:A?.bufferName||s.name,location:s.location,shaderType:s.type,shaderDataType:u.dataType,shaderComponents:u.components,vertexFormat:l,bufferDataType:h.type,bufferComponents:h.components,normalized:h.normalized,integer:u.integer,stepMode:A?.stepMode||s.stepMode,byteOffset:A?.byteOffset||0,byteStride:A?.byteStride||0}}function c(t){for(const e of t)(e.attributes&&e.format||!e.attributes&&!e.format)&&i.R.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function h(t,e){const n={...t,attributes:t.attributes.map((t=>({...t})))};for(const r of e?.attributes||[]){const t=n.attributes.find((t=>t.name===r.name));t?(t.type=r.type||t.type,t.stepMode=r.stepMode||t.stepMode):i.R.warn(`shader layout attribute ${r.name} not present in shader`)}return n}},6839:(t,e,n)=>{"use strict";n.d(e,{h:()=>r});var i=n(5153);class r extends i.F{static defaultProps={...i.F.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1};static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(t,e){const n={...e};(e.usage||0)&r.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?n.indexType="uint32":e.data instanceof Uint16Array&&(n.indexType="uint16")),super(t,n,r.defaultProps),this.usage=e.usage||0,this.indexType=n.indexType,this.updateTimestamp=t.incrementTimestamp()}readSyncWebGL(t,e){throw new Error("not implemented")}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(t,e,n){const i=ArrayBuffer.isView(t)?t.buffer:t,o=Math.min(t?t.byteLength:n,r.DEBUG_DATA_MAX_LENGTH);null===t?this.debugData=new ArrayBuffer(o):0===e&&n===t.byteLength?this.debugData=i.slice(0,o):this.debugData=i.slice(e,e+o)}}},2512:(t,e,n)=>{"use strict";n.d(e,{r:()=>r});var i=n(5153);class r extends i.F{static defaultProps={...i.F.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}};get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(t,e){super(t,e,r.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL(t){throw new Error("Use uniform blocks")}}},5153:(t,e,n)=>{"use strict";n.d(e,{F:()=>r});var i=n(8264);class r{static defaultProps={id:"undefined",handle:void 0,userData:void 0};id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(t,e,n){if(!t)throw new Error("no device");this._device=t,this.props=function(t,e){const n={...e};for(const i in t)void 0!==t[i]&&(n[i]=t[i]);return n}(e,n);const r="undefined"!==this.props.id?this.props.id:(0,i.L)(this[Symbol.toStringTag]);this.props.id=r,this.id=r,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}(${this.id})`}getProps(){return this.props}attachResource(t){this._attachedResources.add(t)}detachResource(t){this._attachedResources.delete(t)}destroyAttachedResource(t){this._attachedResources.delete(t)&&t.destroy()}destroyAttachedResources(){for(const t of Object.values(this._attachedResources))t.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const t=this._device.statsManager.getStats("Resource Counts"),e=this[Symbol.toStringTag];t.get(`${e}s Active`).decrementCount()}trackAllocatedMemory(t,e=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").addCount(t),n.get(`${e} Memory`).addCount(t),this.allocatedBytes=t}trackDeallocatedMemory(t=this[Symbol.toStringTag]){const e=this._device.statsManager.getStats("Resource Counts");e.get("GPU Memory").subtractCount(this.allocatedBytes),e.get(`${t} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const t=this._device.statsManager.getStats("Resource Counts"),e=this[Symbol.toStringTag];t.get("Resources Created").incrementCount(),t.get(`${e}s Created`).incrementCount(),t.get(`${e}s Active`).incrementCount()}}},9277:(t,e,n)=>{"use strict";n.d(e,{L:()=>r});var i=n(5153);class r extends i.F{static defaultProps={...i.F.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"nearest",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(t,e){super(t,e,r.defaultProps)}}},6795:(t,e,n)=>{"use strict";n.d(e,{M:()=>l});var i=n(5153),r=n(8264);function o(t,e,n,i){if(i?.inlineSource){const i=function(t,e,n){let i="";for(let r=e-2;r<=e;r++){const o=t[r-1];void 0!==o&&(i+=s(o,e,n))}return i}(e,n);return`\n${i}${t.linePos>0?`${" ".repeat(t.linePos+5)}^^^\n`:""}${t.type.toUpperCase()}: ${t.message}\n\n`}return i?.html?`<div class='luma-compiler-log-error' style="color:red;"><b> ${t.type.toUpperCase()}: ${t.message}</b></div>`:`${t.type.toUpperCase()}: ${t.message}`}function s(t,e,n){const i=n?.html?t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"):t;return`${function(t,e){let n="";for(let i=t.length;i<e;++i)n+=" ";return n+t}(String(e),4)}: ${i}${n?.html?"<br/>":"\n"}`}function a(t,e){return{name:A(t,e),language:"glsl",version:u(t)}}function A(t,e="unnamed"){const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(t);return n?n[1]:e}function u(t){let e=100;const n=t.match(/[^\s]+/g);if(n&&n.length>=2&&"#version"===n[0]){const t=parseInt(n[1],10);Number.isFinite(t)&&(e=t)}return e}class l extends i.F{static defaultProps={...i.F.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debug:"errors"};get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(t,e){super(t,{id:c(e),...e},l.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(t=this.props.debug){switch(t){case"never":return;case"errors":if("success"===this.compilationStatus)return}const e=await this.getCompilationInfo();"warnings"===this.props.debug&&0===e?.length||this._displayShaderLog(e)}_displayShaderLog(t){if("undefined"==typeof document||!document?.createElement)return;const e=a(this.source).name,n=`${this.stage} ${e}`;let i=function(t,e,n){let i="";const r=e.split(/\r?\n/),a=t.slice().sort(((t,e)=>t.lineNum-e.lineNum));switch(n?.showSourceCode||"no"){case"all":let e=0;for(let t=1;t<=r.length;t++)for(i+=s(r[t-1],t,n);a.length>e&&a[e].lineNum===t;){const t=a[e++];i+=o(t,r,t.lineNum,{...n,inlineSource:!1})}return i;case"issues":case"no":for(const s of t)i+=o(s,r,s.lineNum,{inlineSource:"no"!==n?.showSourceCode});return i}}(t,this.source,{showSourceCode:"all",html:!0});const r=this.getTranslatedSource();r&&(i+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${r}</pre></code>`);const A=document.createElement("Button");A.innerHTML=`\n<h1>Shader Compilation Error in ${n}</h1><br /><br />\n<code style="user-select:text;"><pre>\n${i}\n</pre></code>`,A.style.top="10px",A.style.left="10px",A.style.position="absolute",A.style.zIndex="9999",A.style.width="100%",A.style.textAlign="left",document.body.appendChild(A);const u=document.getElementsByClassName("luma-compiler-log-error");u[0]?.scrollIntoView&&u[0].scrollIntoView(),A.onclick=()=>{const t=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(t)}}}function c(t){return a(t.source).name||t.id||(0,r.L)(`unnamed ${t.stage}-shader`)}},5638:(t,e,n)=>{"use strict";n.d(e,{X:()=>r});var i=n(5153);class r extends i.F{static defaultProps={...i.F.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0};get[Symbol.toStringTag](){return"TextureView"}constructor(t,e){super(t,e,r.defaultProps)}}},698:(t,e,n)=>{"use strict";n.d(e,{g:()=>r});var i=n(5153);class r extends i.F{static defaultProps={...i.F.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!0,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,type:void 0,sampler:{},view:void 0};static COPY_SRC=1;static COPY_DST=2;static TEXTURE_BINDING=4;static STORAGE_BINDING=8;static RENDER_ATTACHMENT=16;get[Symbol.toStringTag](){return"Texture"}dimension;format;width;height;depth;updateTimestamp;constructor(t,e,n=r.defaultProps){super(t,e,n),this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.updateTimestamp=t.incrementTimestamp()}}},9202:(t,e,n)=>{"use strict";function i(t){const e=function(t){const e=o[t];return e}(r[t]),n=t.includes("norm"),i=!n&&!t.startsWith("float"),s=t.startsWith("s");return{dataType:r[t],byteLength:e,integer:i,signed:s,normalized:n}}n.d(e,{l:()=>i});const r={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},o={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4}},3678:(t,e,n)=>{"use strict";function i(t){const e=ArrayBuffer.isView(t)?t.constructor:t;switch(e){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(e.constructor.name)}}function r(t){switch(t){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(t)}}function o(t,e,n){if(!e||e>4)throw new Error(`size ${e}`);const r=e;let o=i(t);if("uint8"===o||"sint8"===o){if(1===r||3===r)throw new Error(`size: ${e}`);return n&&(o=o.replace("int","norm")),`${o}x${r}`}if("uint16"===o||"sint16"===o){if(1===r||3===r)throw new Error(`size: ${e}`);return n&&(o=o.replace("int","norm")),`${o}x${r}`}return 1===r?o:`${o}x${r}`}n.d(e,{OB:()=>o,UE:()=>i,Y0:()=>r})},1289:(t,e,n)=>{"use strict";n.d(e,{l:()=>r});var i=n(1097);function r(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach((n=>{const r=t[n];var o;o=r,null!==(0,i.p)(o)||"number"==typeof o||"boolean"==typeof o?e.uniforms[n]=r:e.bindings[n]=r})),e}},3390:(t,e,n)=>{"use strict";let i;function r(t){return(!i||i.byteLength<t)&&(i=new ArrayBuffer(t)),i}function o(t,e){return new t(r(t.BYTES_PER_ELEMENT*e),0,e)}function s(t){const{target:e,source:n,start:i=0,count:r=1}=t,o=n.length,s=r*o;let a=0;for(let A=i;a<o;a++)e[A++]=n[a];for(;a<s;)a<s-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+s-a),a=s);return t.target}n.d(e,{R2:()=>s,oF:()=>o,oK:()=>r})},979:(t,e,n)=>{"use strict";function i(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}n.d(e,{v:()=>i})},1097:(t,e,n)=>{"use strict";function i(t){return Array.isArray(t)?0===t.length||"number"==typeof t[0]?t:null:function(t){return!ArrayBuffer.isView(t)||t instanceof DataView?null:t}(t)}n.d(e,{p:()=>i})},9651:(t,e,n)=>{"use strict";n.d(e,{R:()=>i});const i=new(n(1369).t)({id:"luma.gl"})},8264:(t,e,n)=>{"use strict";n.d(e,{L:()=>r,Z:()=>o});const i={};function r(t="id"){i[t]=i[t]||1;return`${t}-${i[t]++}`}function o(t){let e=!0;for(const n in t){e=!1;break}return e}},5337:(t,e,n)=>{"use strict";n.d(e,{V:()=>o});var i=n(8264),r=n(979);class o{id;topology;vertexCount;indices;attributes;userData={};constructor(t){const{attributes:e={},indices:n=null,vertexCount:o=null}=t;this.id=t.id||(0,i.L)("geometry"),this.topology=t.topology,n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n),this.attributes={};for(const[i,s]of Object.entries(e)){const t=ArrayBuffer.isView(s)?{value:s}:s;(0,r.v)(ArrayBuffer.isView(t.value),`${this._print(i)}: must be typed array or object with value as typed array`),"POSITION"!==i&&"positions"!==i||t.size||(t.size=3),"indices"===i?((0,r.v)(!this.indices),this.indices=t):this.attributes[i]=t}this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return`Geometry ${this.id} attribute ${t}`}_setAttributes(t,e){return this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const i of Object.values(t)){const{value:t,size:e,constant:r}=i;!r&&t&&e>=1&&(n=Math.min(n,t.length/e))}return(0,r.v)(Number.isFinite(n)),n}}},9067:(t,e,n)=>{"use strict";n.d(e,{K:()=>ie});var i=n(5638),r=n(6839),o=n(698),s=n(9277),a=n(2512),A=n(1097);class u{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(t){if(this.name=t?.name,t?.name&&t?.shaderLayout){const e=t?.shaderLayout.bindings?.find((e=>"uniform"===e.type&&e.name===t?.name));if(!e)throw new Error(t?.name);const n=e;for(const t of n.uniforms||[])this.bindingLayout[t.name]=t}}setUniforms(t){for(const[e,n]of Object.entries(t))this._setUniform(e,n),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${e}=${n}`)}setNeedsRedraw(t){this.needsRedraw=this.needsRedraw||t}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(t,e){(function(t,e,n=16){if(t!==e)return!1;const i=(0,A.p)(t);if(!i)return!1;const r=(0,A.p)(e);if(r&&i.length===r.length)for(let o=0;o<i.length;++o)if(r[o]!==i[o])return!1;return!0})(this.uniforms[t],e)||(this.uniforms[t]=function(t){const e=(0,A.p)(t);return e?e.slice():t}(e),this.modifiedUniforms[t]=!0,this.modified=!0)}}var l=n(979);const c={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function h(t){const e=c[t];return(0,l.v)(t),e}function f(t,e){switch(e){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}var p=n(3390),d=n(9651);class g{layout={};byteLength;constructor(t){let e=0;for(const[i,r]of Object.entries(t)){const t=h(r),{type:n,components:o}=t;e=f(e,o);const s=e;e+=o,this.layout[i]={type:n,size:o,offset:s}}e+=(4-e%4)%4;const n=4*e;this.byteLength=Math.max(n,1024)}getData(t){const e=Math.max(this.byteLength,1024),n=(0,p.oK)(e),i={i32:new Int32Array(n),u32:new Uint32Array(n),f32:new Float32Array(n),f16:new Uint16Array(n)};for(const[r,o]of Object.entries(t)){const t=this.layout[r];if(!t){d.R.warn(`Supplied uniform value ${r} not present in uniform block layout`)();continue}const{type:e,size:n,offset:s}=t,a=i[e];if(1===n){if("number"!=typeof o&&"boolean"!=typeof o){d.R.warn(`Supplied value for single component uniform ${r} is not a number: ${o}`)();continue}a[s]=Number(o)}else{const t=(0,A.p)(o);if(!t){d.R.warn(`Supplied value for multi component / array uniform ${r} is not a numeric array: ${o}`)();continue}a.set(t,s)}}return new Uint8Array(n)}has(t){return Boolean(this.layout[t])}get(t){return this.layout[t]}}class _{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(t){for(const[e,n]of Object.entries(t)){const t=e,i=new g(n.uniformTypes||{});this.uniformBufferLayouts.set(t,i);const r=new u({name:e});r.setUniforms(n.defaultUniforms||{}),this.uniformBlocks.set(t,r)}}destroy(){for(const t of this.uniformBuffers.values())t.destroy()}setUniforms(t){for(const[e,n]of Object.entries(t))this.uniformBlocks.get(e).setUniforms(n);this.updateUniformBuffers()}getUniformBufferByteLength(t){return this.uniformBufferLayouts.get(t).byteLength}getUniformBufferData(t){const e=this.uniformBlocks.get(t).getAllUniforms();return this.uniformBufferLayouts.get(t).getData(e)}createUniformBuffer(t,e,n){n&&this.setUniforms(n);const i=this.getUniformBufferByteLength(e),o=t.createBuffer({usage:r.h.UNIFORM|r.h.COPY_DST,byteLength:i}),s=this.getUniformBufferData(e);return o.write(s),o}getManagedUniformBuffer(t,e){if(!this.uniformBuffers.get(e)){const n=this.getUniformBufferByteLength(e),i=t.createBuffer({usage:r.h.UNIFORM|r.h.COPY_DST,byteLength:n});this.uniformBuffers.set(e,i)}return this.uniformBuffers.get(e)}updateUniformBuffers(){let t=!1;for(const e of this.uniformBlocks.keys()){const n=this.updateUniformBuffer(e);t||=n}return t&&d.R.log(3,`UniformStore.updateUniformBuffers(): ${t}`)(),t}updateUniformBuffer(t){const e=this.uniformBlocks.get(t);let n=!1;if(this.uniformBuffers.get(t)&&e.needsRedraw){n||=e.needsRedraw;const i=this.getUniformBufferData(t);this.uniformBuffers.get(t).write(i);const r=this.uniformBlocks.get(t).getAllUniforms();d.R.log(4,`Writing to uniform buffer ${String(t)}`,i,r)()}return n}}var m=n(8264);function y(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!y(t[i],e[i],n-1))return!1;return!0}if(Array.isArray(e))return!1;if("object"==typeof t&&"object"==typeof e){const i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(const o of i){if(!e.hasOwnProperty(o))return!1;if(!y(t[o],e[o],n-1))return!1}return!0}return!1}var v,E,b,w,x,S=n(1289),C=n(3884),T=n(3678),I=n(766);class R{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class P{constructor(){}get isAstNode(){return!0}get astNodeType(){return""}evaluate(t){throw new Error("Cannot evaluate node")}evaluateString(t){return this.evaluate(t).toString()}}class M extends P{constructor(){super()}}class L extends M{constructor(t,e,n,i){super(),this.name=t,this.args=e,this.returnType=n,this.body=i}get astNodeType(){return"function"}}class N extends M{constructor(t){super(),this.expression=t}get astNodeType(){return"staticAssert"}}class O extends M{constructor(t,e){super(),this.condition=t,this.body=e}get astNodeType(){return"while"}}class D extends M{constructor(t){super(),this.body=t}get astNodeType(){return"continuing"}}class F extends M{constructor(t,e,n,i){super(),this.init=t,this.condition=e,this.increment=n,this.body=i}get astNodeType(){return"for"}}class k extends M{constructor(t,e,n,i,r){super(),this.name=t,this.type=e,this.storage=n,this.access=i,this.value=r}get astNodeType(){return"var"}}class B extends M{constructor(t,e,n){super(),this.name=t,this.type=e,this.value=n}get astNodeType(){return"override"}}class U extends M{constructor(t,e,n,i,r){super(),this.name=t,this.type=e,this.storage=n,this.access=i,this.value=r}get astNodeType(){return"let"}}class G extends M{constructor(t,e,n,i,r){super(),this.name=t,this.type=e,this.storage=n,this.access=i,this.value=r}get astNodeType(){return"const"}evaluate(t){return this.value.evaluate(t)}}!function(t){t.increment="++",t.decrement="--"}(v||(v={})),function(t){t.parse=function(e){const n=e;if("parse"==n)throw new Error("Invalid value for IncrementOperator");return t[n]}}(v||(v={}));class z extends M{constructor(t,e){super(),this.operator=t,this.variable=e}get astNodeType(){return"increment"}}!function(t){t.assign="=",t.addAssign="+=",t.subtractAssin="-=",t.multiplyAssign="*=",t.divideAssign="/=",t.moduloAssign="%=",t.andAssign="&=",t.orAssign="|=",t.xorAssign="^=",t.shiftLeftAssign="<<=",t.shiftRightAssign=">>="}(E||(E={})),function(t){t.parse=function(e){const n=e;if("parse"==n)throw new Error("Invalid value for AssignOperator");return t[n]}}(E||(E={}));class V extends M{constructor(t,e,n){super(),this.operator=t,this.variable=e,this.value=n}get astNodeType(){return"assign"}}class j extends M{constructor(t,e){super(),this.name=t,this.args=e}get astNodeType(){return"call"}}class W extends M{constructor(t,e){super(),this.body=t,this.continuing=e}get astNodeType(){return"loop"}}class H extends M{constructor(t,e){super(),this.condition=t,this.body=e}get astNodeType(){return"body"}}class X extends M{constructor(t,e,n,i){super(),this.condition=t,this.body=e,this.elseif=n,this.else=i}get astNodeType(){return"if"}}class Y extends M{constructor(t){super(),this.value=t}get astNodeType(){return"return"}}class q extends M{constructor(t){super(),this.name=t}get astNodeType(){return"enable"}}class Q extends M{constructor(t,e){super(),this.name=t,this.type=e}get astNodeType(){return"alias"}}class $ extends M{constructor(){super()}get astNodeType(){return"discard"}}class K extends M{constructor(){super()}get astNodeType(){return"break"}}class Z extends M{constructor(){super()}get astNodeType(){return"continue"}}class J extends M{constructor(t){super(),this.name=t}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}}class tt extends J{constructor(t,e){super(t),this.members=e}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(t){for(let e=0;e<this.members.length;e++)if(this.members[e].name==t)return e;return-1}}class et extends J{constructor(t,e,n){super(t),this.format=e,this.access=n}get astNodeType(){return"template"}}class nt extends J{constructor(t,e,n,i){super(t),this.storage=e,this.type=n,this.access=i}get astNodeType(){return"pointer"}}class it extends J{constructor(t,e,n,i){super(t),this.attributes=e,this.format=n,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}}class rt extends J{constructor(t,e,n){super(t),this.format=e,this.access=n}get astNodeType(){return"sampler"}}class ot extends P{constructor(){super()}}class st extends ot{constructor(t){super(),this.value=t}get astNodeType(){return"stringExpr"}toString(){return this.value}evaluateString(){return this.value}}class at extends ot{constructor(t,e){super(),this.type=t,this.args=e}get astNodeType(){return"createExpr"}}class At extends ot{constructor(t,e){super(),this.name=t,this.args=e}get astNodeType(){return"callExpr"}evaluate(t){switch(this.name){case"abs":return Math.abs(this.args[0].evaluate(t));case"acos":return Math.acos(this.args[0].evaluate(t));case"acosh":return Math.acosh(this.args[0].evaluate(t));case"asin":return Math.asin(this.args[0].evaluate(t));case"asinh":return Math.asinh(this.args[0].evaluate(t));case"atan":return Math.atan(this.args[0].evaluate(t));case"atan2":return Math.atan2(this.args[0].evaluate(t),this.args[1].evaluate(t));case"atanh":return Math.atanh(this.args[0].evaluate(t));case"ceil":return Math.ceil(this.args[0].evaluate(t));case"clamp":return Math.min(Math.max(this.args[0].evaluate(t),this.args[1].evaluate(t)),this.args[2].evaluate(t));case"cos":return Math.cos(this.args[0].evaluate(t));case"degrees":return 180*this.args[0].evaluate(t)/Math.PI;case"distance":return Math.sqrt(Math.pow(this.args[0].evaluate(t)-this.args[1].evaluate(t),2));case"dot":case"exp":return Math.exp(this.args[0].evaluate(t));case"exp2":return Math.pow(2,this.args[0].evaluate(t));case"floor":return Math.floor(this.args[0].evaluate(t));case"fma":return this.args[0].evaluate(t)*this.args[1].evaluate(t)+this.args[2].evaluate(t);case"fract":case"modf":return this.args[0].evaluate(t)-Math.floor(this.args[0].evaluate(t));case"inverseSqrt":return 1/Math.sqrt(this.args[0].evaluate(t));case"log":return Math.log(this.args[0].evaluate(t));case"log2":return Math.log2(this.args[0].evaluate(t));case"max":return Math.max(this.args[0].evaluate(t),this.args[1].evaluate(t));case"min":return Math.min(this.args[0].evaluate(t),this.args[1].evaluate(t));case"mix":return this.args[0].evaluate(t)*(1-this.args[2].evaluate(t))+this.args[1].evaluate(t)*this.args[2].evaluate(t);case"pow":return Math.pow(this.args[0].evaluate(t),this.args[1].evaluate(t));case"radians":return this.args[0].evaluate(t)*Math.PI/180;case"round":return Math.round(this.args[0].evaluate(t));case"sign":return Math.sign(this.args[0].evaluate(t));case"sin":return Math.sin(this.args[0].evaluate(t));case"sinh":return Math.sinh(this.args[0].evaluate(t));case"saturate":return Math.min(Math.max(this.args[0].evaluate(t),0),1);case"smoothstep":return this.args[0].evaluate(t)*this.args[0].evaluate(t)*(3-2*this.args[0].evaluate(t));case"sqrt":return Math.sqrt(this.args[0].evaluate(t));case"step":return this.args[0].evaluate(t)<this.args[1].evaluate(t)?0:1;case"tan":return Math.tan(this.args[0].evaluate(t));case"tanh":return Math.tanh(this.args[0].evaluate(t));case"trunc":return Math.trunc(this.args[0].evaluate(t));default:throw new Error("Non const function: "+this.name)}}}class ut extends ot{constructor(t){super(),this.name=t}get astNodeType(){return"varExpr"}}class lt extends ot{constructor(t,e){super(),this.name=t,this.initializer=e}get astNodeType(){return"constExpr"}evaluate(t){var e,n;if(this.initializer instanceof at){const i=null===(e=this.postfix)||void 0===e?void 0:e.evaluateString(t),r=null===(n=this.initializer.type)||void 0===n?void 0:n.name,o=t.structs.get(r),s=null==o?void 0:o.getMemberIndex(i);if(-1!=s){return this.initializer.args[s].evaluate(t)}console.log(s)}return this.initializer.evaluate(t)}}class ct extends ot{constructor(t){super(),this.value=t}get astNodeType(){return"literalExpr"}evaluate(){return this.value}}class ht extends ot{constructor(t,e){super(),this.type=t,this.value=e}get astNodeType(){return"bitcastExpr"}}class ft extends ot{constructor(t,e){super(),this.type=t,this.args=e}get astNodeType(){return"typecastExpr"}evaluate(t){return this.args[0].evaluate(t)}}class pt extends ot{constructor(t){super(),this.contents=t}get astNodeType(){return"groupExpr"}evaluate(t){return this.contents[0].evaluate(t)}}class dt extends ot{constructor(){super()}}class gt extends dt{constructor(t,e){super(),this.operator=t,this.right=e}get astNodeType(){return"unaryOp"}evaluate(t){switch(this.operator){case"+":return this.right.evaluate(t);case"-":return-this.right.evaluate(t);case"!":return this.right.evaluate(t)?0:1;case"~":return~this.right.evaluate(t);default:throw new Error("Unknown unary operator: "+this.operator)}}}class _t extends dt{constructor(t,e,n){super(),this.operator=t,this.left=e,this.right=n}get astNodeType(){return"binaryOp"}evaluate(t){switch(this.operator){case"+":return this.left.evaluate(t)+this.right.evaluate(t);case"-":return this.left.evaluate(t)-this.right.evaluate(t);case"*":return this.left.evaluate(t)*this.right.evaluate(t);case"/":return this.left.evaluate(t)/this.right.evaluate(t);case"%":return this.left.evaluate(t)%this.right.evaluate(t);case"==":return this.left.evaluate(t)==this.right.evaluate(t)?1:0;case"!=":return this.left.evaluate(t)!=this.right.evaluate(t)?1:0;case"<":return this.left.evaluate(t)<this.right.evaluate(t)?1:0;case">":return this.left.evaluate(t)>this.right.evaluate(t)?1:0;case"<=":return this.left.evaluate(t)<=this.right.evaluate(t)?1:0;case">=":return this.left.evaluate(t)>=this.right.evaluate(t)?1:0;case"&&":return this.left.evaluate(t)&&this.right.evaluate(t)?1:0;case"||":return this.left.evaluate(t)||this.right.evaluate(t)?1:0;default:throw new Error(`Unknown operator ${this.operator}`)}}}class mt extends P{constructor(){super()}}class yt extends mt{constructor(t,e){super(),this.selector=t,this.body=e}get astNodeType(){return"case"}}class vt extends mt{constructor(t){super(),this.body=t}get astNodeType(){return"default"}}class Et extends P{constructor(t,e,n){super(),this.name=t,this.type=e,this.attributes=n}get astNodeType(){return"argument"}}class bt extends P{constructor(t,e){super(),this.condition=t,this.body=e}get astNodeType(){return"elseif"}}class wt extends P{constructor(t,e,n){super(),this.name=t,this.type=e,this.attributes=n}get astNodeType(){return"member"}}class xt extends P{constructor(t,e){super(),this.name=t,this.value=e}get astNodeType(){return"attribute"}}!function(t){t[t.token=0]="token",t[t.keyword=1]="keyword",t[t.reserved=2]="reserved"}(w||(w={}));class St{constructor(t,e,n){this.name=t,this.type=e,this.rule=n}toString(){return this.name}}class Ct{}b=Ct,Ct.none=new St("",w.reserved,""),Ct.eof=new St("EOF",w.token,""),Ct.reserved={asm:new St("asm",w.reserved,"asm"),bf16:new St("bf16",w.reserved,"bf16"),do:new St("do",w.reserved,"do"),enum:new St("enum",w.reserved,"enum"),f16:new St("f16",w.reserved,"f16"),f64:new St("f64",w.reserved,"f64"),handle:new St("handle",w.reserved,"handle"),i8:new St("i8",w.reserved,"i8"),i16:new St("i16",w.reserved,"i16"),i64:new St("i64",w.reserved,"i64"),mat:new St("mat",w.reserved,"mat"),premerge:new St("premerge",w.reserved,"premerge"),regardless:new St("regardless",w.reserved,"regardless"),typedef:new St("typedef",w.reserved,"typedef"),u8:new St("u8",w.reserved,"u8"),u16:new St("u16",w.reserved,"u16"),u64:new St("u64",w.reserved,"u64"),unless:new St("unless",w.reserved,"unless"),using:new St("using",w.reserved,"using"),vec:new St("vec",w.reserved,"vec"),void:new St("void",w.reserved,"void")},Ct.keywords={array:new St("array",w.keyword,"array"),atomic:new St("atomic",w.keyword,"atomic"),bool:new St("bool",w.keyword,"bool"),f32:new St("f32",w.keyword,"f32"),i32:new St("i32",w.keyword,"i32"),mat2x2:new St("mat2x2",w.keyword,"mat2x2"),mat2x3:new St("mat2x3",w.keyword,"mat2x3"),mat2x4:new St("mat2x4",w.keyword,"mat2x4"),mat3x2:new St("mat3x2",w.keyword,"mat3x2"),mat3x3:new St("mat3x3",w.keyword,"mat3x3"),mat3x4:new St("mat3x4",w.keyword,"mat3x4"),mat4x2:new St("mat4x2",w.keyword,"mat4x2"),mat4x3:new St("mat4x3",w.keyword,"mat4x3"),mat4x4:new St("mat4x4",w.keyword,"mat4x4"),ptr:new St("ptr",w.keyword,"ptr"),sampler:new St("sampler",w.keyword,"sampler"),sampler_comparison:new St("sampler_comparison",w.keyword,"sampler_comparison"),struct:new St("struct",w.keyword,"struct"),texture_1d:new St("texture_1d",w.keyword,"texture_1d"),texture_2d:new St("texture_2d",w.keyword,"texture_2d"),texture_2d_array:new St("texture_2d_array",w.keyword,"texture_2d_array"),texture_3d:new St("texture_3d",w.keyword,"texture_3d"),texture_cube:new St("texture_cube",w.keyword,"texture_cube"),texture_cube_array:new St("texture_cube_array",w.keyword,"texture_cube_array"),texture_multisampled_2d:new St("texture_multisampled_2d",w.keyword,"texture_multisampled_2d"),texture_storage_1d:new St("texture_storage_1d",w.keyword,"texture_storage_1d"),texture_storage_2d:new St("texture_storage_2d",w.keyword,"texture_storage_2d"),texture_storage_2d_array:new St("texture_storage_2d_array",w.keyword,"texture_storage_2d_array"),texture_storage_3d:new St("texture_storage_3d",w.keyword,"texture_storage_3d"),texture_depth_2d:new St("texture_depth_2d",w.keyword,"texture_depth_2d"),texture_depth_2d_array:new St("texture_depth_2d_array",w.keyword,"texture_depth_2d_array"),texture_depth_cube:new St("texture_depth_cube",w.keyword,"texture_depth_cube"),texture_depth_cube_array:new St("texture_depth_cube_array",w.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new St("texture_depth_multisampled_2d",w.keyword,"texture_depth_multisampled_2d"),texture_external:new St("texture_external",w.keyword,"texture_external"),u32:new St("u32",w.keyword,"u32"),vec2:new St("vec2",w.keyword,"vec2"),vec3:new St("vec3",w.keyword,"vec3"),vec4:new St("vec4",w.keyword,"vec4"),bitcast:new St("bitcast",w.keyword,"bitcast"),block:new St("block",w.keyword,"block"),break:new St("break",w.keyword,"break"),case:new St("case",w.keyword,"case"),continue:new St("continue",w.keyword,"continue"),continuing:new St("continuing",w.keyword,"continuing"),default:new St("default",w.keyword,"default"),discard:new St("discard",w.keyword,"discard"),else:new St("else",w.keyword,"else"),enable:new St("enable",w.keyword,"enable"),fallthrough:new St("fallthrough",w.keyword,"fallthrough"),false:new St("false",w.keyword,"false"),fn:new St("fn",w.keyword,"fn"),for:new St("for",w.keyword,"for"),function:new St("function",w.keyword,"function"),if:new St("if",w.keyword,"if"),let:new St("let",w.keyword,"let"),const:new St("const",w.keyword,"const"),loop:new St("loop",w.keyword,"loop"),while:new St("while",w.keyword,"while"),private:new St("private",w.keyword,"private"),read:new St("read",w.keyword,"read"),read_write:new St("read_write",w.keyword,"read_write"),return:new St("return",w.keyword,"return"),storage:new St("storage",w.keyword,"storage"),switch:new St("switch",w.keyword,"switch"),true:new St("true",w.keyword,"true"),alias:new St("alias",w.keyword,"alias"),type:new St("type",w.keyword,"type"),uniform:new St("uniform",w.keyword,"uniform"),var:new St("var",w.keyword,"var"),override:new St("override",w.keyword,"override"),workgroup:new St("workgroup",w.keyword,"workgroup"),write:new St("write",w.keyword,"write"),r8unorm:new St("r8unorm",w.keyword,"r8unorm"),r8snorm:new St("r8snorm",w.keyword,"r8snorm"),r8uint:new St("r8uint",w.keyword,"r8uint"),r8sint:new St("r8sint",w.keyword,"r8sint"),r16uint:new St("r16uint",w.keyword,"r16uint"),r16sint:new St("r16sint",w.keyword,"r16sint"),r16float:new St("r16float",w.keyword,"r16float"),rg8unorm:new St("rg8unorm",w.keyword,"rg8unorm"),rg8snorm:new St("rg8snorm",w.keyword,"rg8snorm"),rg8uint:new St("rg8uint",w.keyword,"rg8uint"),rg8sint:new St("rg8sint",w.keyword,"rg8sint"),r32uint:new St("r32uint",w.keyword,"r32uint"),r32sint:new St("r32sint",w.keyword,"r32sint"),r32float:new St("r32float",w.keyword,"r32float"),rg16uint:new St("rg16uint",w.keyword,"rg16uint"),rg16sint:new St("rg16sint",w.keyword,"rg16sint"),rg16float:new St("rg16float",w.keyword,"rg16float"),rgba8unorm:new St("rgba8unorm",w.keyword,"rgba8unorm"),rgba8unorm_srgb:new St("rgba8unorm_srgb",w.keyword,"rgba8unorm_srgb"),rgba8snorm:new St("rgba8snorm",w.keyword,"rgba8snorm"),rgba8uint:new St("rgba8uint",w.keyword,"rgba8uint"),rgba8sint:new St("rgba8sint",w.keyword,"rgba8sint"),bgra8unorm:new St("bgra8unorm",w.keyword,"bgra8unorm"),bgra8unorm_srgb:new St("bgra8unorm_srgb",w.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new St("rgb10a2unorm",w.keyword,"rgb10a2unorm"),rg11b10float:new St("rg11b10float",w.keyword,"rg11b10float"),rg32uint:new St("rg32uint",w.keyword,"rg32uint"),rg32sint:new St("rg32sint",w.keyword,"rg32sint"),rg32float:new St("rg32float",w.keyword,"rg32float"),rgba16uint:new St("rgba16uint",w.keyword,"rgba16uint"),rgba16sint:new St("rgba16sint",w.keyword,"rgba16sint"),rgba16float:new St("rgba16float",w.keyword,"rgba16float"),rgba32uint:new St("rgba32uint",w.keyword,"rgba32uint"),rgba32sint:new St("rgba32sint",w.keyword,"rgba32sint"),rgba32float:new St("rgba32float",w.keyword,"rgba32float"),static_assert:new St("static_assert",w.keyword,"static_assert")},Ct.tokens={decimal_float_literal:new St("decimal_float_literal",w.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?f?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+f?)|([0-9]+f)/),hex_float_literal:new St("hex_float_literal",w.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+f?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+f?))/),int_literal:new St("int_literal",w.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new St("uint_literal",w.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),ident:new St("ident",w.token,/[a-zA-Z][0-9a-zA-Z_]*/),and:new St("and",w.token,"&"),and_and:new St("and_and",w.token,"&&"),arrow:new St("arrow ",w.token,"->"),attr:new St("attr",w.token,"@"),attr_left:new St("attr_left",w.token,"[["),attr_right:new St("attr_right",w.token,"]]"),forward_slash:new St("forward_slash",w.token,"/"),bang:new St("bang",w.token,"!"),bracket_left:new St("bracket_left",w.token,"["),bracket_right:new St("bracket_right",w.token,"]"),brace_left:new St("brace_left",w.token,"{"),brace_right:new St("brace_right",w.token,"}"),colon:new St("colon",w.token,":"),comma:new St("comma",w.token,","),equal:new St("equal",w.token,"="),equal_equal:new St("equal_equal",w.token,"=="),not_equal:new St("not_equal",w.token,"!="),greater_than:new St("greater_than",w.token,">"),greater_than_equal:new St("greater_than_equal",w.token,">="),shift_right:new St("shift_right",w.token,">>"),less_than:new St("less_than",w.token,"<"),less_than_equal:new St("less_than_equal",w.token,"<="),shift_left:new St("shift_left",w.token,"<<"),modulo:new St("modulo",w.token,"%"),minus:new St("minus",w.token,"-"),minus_minus:new St("minus_minus",w.token,"--"),period:new St("period",w.token,"."),plus:new St("plus",w.token,"+"),plus_plus:new St("plus_plus",w.token,"++"),or:new St("or",w.token,"|"),or_or:new St("or_or",w.token,"||"),paren_left:new St("paren_left",w.token,"("),paren_right:new St("paren_right",w.token,")"),semicolon:new St("semicolon",w.token,";"),star:new St("star",w.token,"*"),tilde:new St("tilde",w.token,"~"),underscore:new St("underscore",w.token,"_"),xor:new St("xor",w.token,"^"),plus_equal:new St("plus_equal",w.token,"+="),minus_equal:new St("minus_equal",w.token,"-="),times_equal:new St("times_equal",w.token,"*="),division_equal:new St("division_equal",w.token,"/="),modulo_equal:new St("modulo_equal",w.token,"%="),and_equal:new St("and_equal",w.token,"&="),or_equal:new St("or_equal",w.token,"|="),xor_equal:new St("xor_equal",w.token,"^="),shift_right_equal:new St("shift_right_equal",w.token,">>="),shift_left_equal:new St("shift_left_equal",w.token,"<<=")},Ct.storage_class=[b.keywords.function,b.keywords.private,b.keywords.workgroup,b.keywords.uniform,b.keywords.storage],Ct.access_mode=[b.keywords.read,b.keywords.write,b.keywords.read_write],Ct.sampler_type=[b.keywords.sampler,b.keywords.sampler_comparison],Ct.sampled_texture_type=[b.keywords.texture_1d,b.keywords.texture_2d,b.keywords.texture_2d_array,b.keywords.texture_3d,b.keywords.texture_cube,b.keywords.texture_cube_array],Ct.multisampled_texture_type=[b.keywords.texture_multisampled_2d],Ct.storage_texture_type=[b.keywords.texture_storage_1d,b.keywords.texture_storage_2d,b.keywords.texture_storage_2d_array,b.keywords.texture_storage_3d],Ct.depth_texture_type=[b.keywords.texture_depth_2d,b.keywords.texture_depth_2d_array,b.keywords.texture_depth_cube,b.keywords.texture_depth_cube_array,b.keywords.texture_depth_multisampled_2d],Ct.texture_external_type=[b.keywords.texture_external],Ct.any_texture_type=[...b.sampled_texture_type,...b.multisampled_texture_type,...b.storage_texture_type,...b.depth_texture_type,...b.texture_external_type],Ct.texel_format=[b.keywords.r8unorm,b.keywords.r8snorm,b.keywords.r8uint,b.keywords.r8sint,b.keywords.r16uint,b.keywords.r16sint,b.keywords.r16float,b.keywords.rg8unorm,b.keywords.rg8snorm,b.keywords.rg8uint,b.keywords.rg8sint,b.keywords.r32uint,b.keywords.r32sint,b.keywords.r32float,b.keywords.rg16uint,b.keywords.rg16sint,b.keywords.rg16float,b.keywords.rgba8unorm,b.keywords.rgba8unorm_srgb,b.keywords.rgba8snorm,b.keywords.rgba8uint,b.keywords.rgba8sint,b.keywords.bgra8unorm,b.keywords.bgra8unorm_srgb,b.keywords.rgb10a2unorm,b.keywords.rg11b10float,b.keywords.rg32uint,b.keywords.rg32sint,b.keywords.rg32float,b.keywords.rgba16uint,b.keywords.rgba16sint,b.keywords.rgba16float,b.keywords.rgba32uint,b.keywords.rgba32sint,b.keywords.rgba32float],Ct.const_literal=[b.tokens.int_literal,b.tokens.uint_literal,b.tokens.decimal_float_literal,b.tokens.hex_float_literal,b.keywords.true,b.keywords.false],Ct.literal_or_ident=[b.tokens.ident,b.tokens.int_literal,b.tokens.uint_literal,b.tokens.decimal_float_literal,b.tokens.hex_float_literal],Ct.element_count_expression=[b.tokens.int_literal,b.tokens.uint_literal,b.tokens.ident],Ct.template_types=[b.keywords.vec2,b.keywords.vec3,b.keywords.vec4,b.keywords.mat2x2,b.keywords.mat2x3,b.keywords.mat2x4,b.keywords.mat3x2,b.keywords.mat3x3,b.keywords.mat3x4,b.keywords.mat4x2,b.keywords.mat4x3,b.keywords.mat4x4,b.keywords.atomic,b.keywords.bitcast,...b.any_texture_type],Ct.attribute_name=[b.tokens.ident,b.keywords.block],Ct.assignment_operators=[b.tokens.equal,b.tokens.plus_equal,b.tokens.minus_equal,b.tokens.times_equal,b.tokens.division_equal,b.tokens.modulo_equal,b.tokens.and_equal,b.tokens.or_equal,b.tokens.xor_equal,b.tokens.shift_right_equal,b.tokens.shift_left_equal],Ct.increment_operators=[b.tokens.plus_plus,b.tokens.minus_minus];class Tt{constructor(t,e,n){this.type=t,this.lexeme=e,this.line=n}toString(){return this.lexeme}isTemplateType(){return-1!=Ct.template_types.indexOf(this.type)}isArrayType(){return this.type==Ct.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class It{constructor(t){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=null!=t?t:""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new Tt(Ct.eof,"",this._line)),this._tokens}scanToken(){let t=this._advance();if("\n"==t)return this._line++,!0;if(this._isWhitespace(t))return!0;if("/"==t){if("/"==this._peekAhead()){for(;"\n"!=t;){if(this._isAtEnd())return!0;t=this._advance()}return this._line++,!0}if("*"==this._peekAhead()){this._advance();let e=1;for(;e>0;){if(this._isAtEnd())return!0;if(t=this._advance(),"\n"==t)this._line++;else if("*"==t){if("/"==this._peekAhead()&&(this._advance(),e--,0==e))return!0}else"/"==t&&"*"==this._peekAhead()&&(this._advance(),e++)}return!0}}let e=Ct.none;for(;;){let n=this._findType(t);const i=this._peekAhead();if(">"==t&&(">"==i||"="==i)){let t=!1,e=this._tokens.length-1;for(let n=0;n<5&&e>=0;++n,--e)if(this._tokens[e].type===Ct.tokens.less_than){e>0&&this._tokens[e-1].isArrayOrTemplateType()&&(t=!0);break}if(t)return this._addToken(n),!0}if(n===Ct.none){let i=t,r=0;const o=2;for(let t=0;t<o;++t)if(i+=this._peekAhead(t),n=this._findType(i),n!==Ct.none){r=t;break}if(n===Ct.none)return e!==Ct.none&&(this._current--,this._addToken(e),!0);t=i,this._current+=r+1}if(e=n,this._isAtEnd())break;t+=this._advance()}return e!==Ct.none&&(this._addToken(e),!0)}_findType(t){for(const e in Ct.keywords){const n=Ct.keywords[e];if(this._match(t,n.rule))return n}for(const e in Ct.tokens){const n=Ct.tokens[e];if(this._match(t,n.rule))return n}return Ct.none}_match(t,e){if("string"==typeof e){if(e==t)return!0}else{const n=e.exec(t);if(n&&0==n.index&&n[0]==t)return!0}return!1}_isAtEnd(){return this._current>=this._source.length}_isWhitespace(t){return" "==t||"\t"==t||"\r"==t}_advance(t=0){let e=this._source[this._current];return t=t||0,t++,this._current+=t,e}_peekAhead(t=0){return t=t||0,this._current+t>=this._source.length?"\0":this._source[this._current+t]}_addToken(t){const e=this._source.substring(this._start,this._current);this._tokens.push(new Tt(t,e,this._line))}}class Rt{constructor(){this._tokens=[],this._current=0,this._context=new R}parse(t){this._initialize(t);let e=[];for(;!this._isAtEnd();){const t=this._global_decl_or_directive();if(!t)break;e.push(t)}return e}_initialize(t){if(t)if("string"==typeof t){const e=new It(t);this._tokens=e.scanTokens()}else this._tokens=t;else this._tokens=[];this._current=0}_error(t,e){return console.error(t,e),{token:t,message:e,toString:function(){return`${e}`}}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==Ct.eof}_match(t){if(t instanceof St)return!!this._check(t)&&(this._advance(),!0);for(let e=0,n=t.length;e<n;++e){const n=t[e];if(this._check(n))return this._advance(),!0}return!1}_consume(t,e){if(this._check(t))return this._advance();throw this._error(this._peek(),e)}_check(t){if(this._isAtEnd())return!1;const e=this._peek();if(t instanceof Array){let n=e.type;return-1!=t.indexOf(n)}return e.type==t}_advance(){return this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(Ct.tokens.semicolon)&&!this._isAtEnd(););if(this._match(Ct.keywords.alias)){const t=this._type_alias();return this._consume(Ct.tokens.semicolon,"Expected ';'"),t}if(this._match(Ct.keywords.enable)){const t=this._enable_directive();return this._consume(Ct.tokens.semicolon,"Expected ';'"),t}const t=this._attribute();if(this._check(Ct.keywords.var)){const e=this._global_variable_decl();return null!=e&&(e.attributes=t),this._consume(Ct.tokens.semicolon,"Expected ';'."),e}if(this._check(Ct.keywords.override)){const e=this._override_variable_decl();return null!=e&&(e.attributes=t),this._consume(Ct.tokens.semicolon,"Expected ';'."),e}if(this._check(Ct.keywords.let)){const e=this._global_let_decl();return null!=e&&(e.attributes=t),this._consume(Ct.tokens.semicolon,"Expected ';'."),e}if(this._check(Ct.keywords.const)){const e=this._global_const_decl();return null!=e&&(e.attributes=t),this._consume(Ct.tokens.semicolon,"Expected ';'."),e}if(this._check(Ct.keywords.struct)){const e=this._struct_decl();return null!=e&&(e.attributes=t),e}if(this._check(Ct.keywords.fn)){const e=this._function_decl();return null!=e&&(e.attributes=t),e}return null}_function_decl(){if(!this._match(Ct.keywords.fn))return null;const t=this._consume(Ct.tokens.ident,"Expected function name.").toString();this._consume(Ct.tokens.paren_left,"Expected '(' for function arguments.");const e=[];if(!this._check(Ct.tokens.paren_right))do{if(this._check(Ct.tokens.paren_right))break;const t=this._attribute(),n=this._consume(Ct.tokens.ident,"Expected argument name.").toString();this._consume(Ct.tokens.colon,"Expected ':' for argument type.");const i=this._attribute(),r=this._type_decl();null!=r&&(r.attributes=i,e.push(new Et(n,r,t)))}while(this._match(Ct.tokens.comma));this._consume(Ct.tokens.paren_right,"Expected ')' after function arguments.");let n=null;if(this._match(Ct.tokens.arrow)){const t=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=t)}const i=this._compound_statement();return new L(t,e,n,i)}_compound_statement(){const t=[];for(this._consume(Ct.tokens.brace_left,"Expected '{' for block.");!this._check(Ct.tokens.brace_right);){const e=this._statement();null!==e&&t.push(e)}return this._consume(Ct.tokens.brace_right,"Expected '}' for block."),t}_statement(){for(;this._match(Ct.tokens.semicolon)&&!this._isAtEnd(););if(this._check(Ct.keywords.if))return this._if_statement();if(this._check(Ct.keywords.switch))return this._switch_statement();if(this._check(Ct.keywords.loop))return this._loop_statement();if(this._check(Ct.keywords.for))return this._for_statement();if(this._check(Ct.keywords.while))return this._while_statement();if(this._check(Ct.keywords.continuing))return this._continuing_statement();if(this._check(Ct.keywords.static_assert))return this._static_assert_statement();if(this._check(Ct.tokens.brace_left))return this._compound_statement();let t=null;return t=this._check(Ct.keywords.return)?this._return_statement():this._check([Ct.keywords.var,Ct.keywords.let,Ct.keywords.const])?this._variable_statement():this._match(Ct.keywords.discard)?new $:this._match(Ct.keywords.break)?new K:this._match(Ct.keywords.continue)?new Z:this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement(),null!=t&&this._consume(Ct.tokens.semicolon,"Expected ';' after statement."),t}_static_assert_statement(){if(!this._match(Ct.keywords.static_assert))return null;let t=this._optional_paren_expression();return new N(t)}_while_statement(){if(!this._match(Ct.keywords.while))return null;let t=this._optional_paren_expression();const e=this._compound_statement();return new O(t,e)}_continuing_statement(){if(!this._match(Ct.keywords.continuing))return null;const t=this._compound_statement();return new D(t)}_for_statement(){if(!this._match(Ct.keywords.for))return null;this._consume(Ct.tokens.paren_left,"Expected '('.");const t=this._check(Ct.tokens.semicolon)?null:this._for_init();this._consume(Ct.tokens.semicolon,"Expected ';'.");const e=this._check(Ct.tokens.semicolon)?null:this._short_circuit_or_expression();this._consume(Ct.tokens.semicolon,"Expected ';'.");const n=this._check(Ct.tokens.paren_right)?null:this._for_increment();this._consume(Ct.tokens.paren_right,"Expected ')'.");const i=this._compound_statement();return new F(t,e,n,i)}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(Ct.keywords.var)){const t=this._variable_decl();if(null===t)throw this._error(this._peek(),"Variable declaration expected.");let e=null;return this._match(Ct.tokens.equal)&&(e=this._short_circuit_or_expression()),new k(t.name,t.type,t.storage,t.access,e)}if(this._match(Ct.keywords.let)){const t=this._consume(Ct.tokens.ident,"Expected name for let.").toString();let e=null;if(this._match(Ct.tokens.colon)){const t=this._attribute();e=this._type_decl(),null!=e&&(e.attributes=t)}this._consume(Ct.tokens.equal,"Expected '=' for let.");const n=this._short_circuit_or_expression();return new U(t,e,null,null,n)}if(this._match(Ct.keywords.const)){const t=this._consume(Ct.tokens.ident,"Expected name for const.").toString();let e=null;if(this._match(Ct.tokens.colon)){const t=this._attribute();e=this._type_decl(),null!=e&&(e.attributes=t)}this._consume(Ct.tokens.equal,"Expected '=' for const.");const n=this._short_circuit_or_expression();return new G(t,e,null,null,n)}return null}_increment_decrement_statement(){const t=this._current,e=this._unary_expression();if(null==e)return null;if(!this._check(Ct.increment_operators))return this._current=t,null;const n=this._consume(Ct.increment_operators,"Expected increment operator");return new z(n.type===Ct.tokens.plus_plus?v.increment:v.decrement,e)}_assignment_statement(){let t=null;if(this._check(Ct.tokens.brace_right))return null;let e=this._match(Ct.tokens.underscore);if(e||(t=this._unary_expression()),!e&&null==t)return null;const n=this._consume(Ct.assignment_operators,"Expected assignment operator."),i=this._short_circuit_or_expression();return new V(E.parse(n.lexeme),t,i)}_func_call_statement(){if(!this._check(Ct.tokens.ident))return null;const t=this._current,e=this._consume(Ct.tokens.ident,"Expected function name."),n=this._argument_expression_list();return null===n?(this._current=t,null):new j(e.lexeme,n)}_loop_statement(){if(!this._match(Ct.keywords.loop))return null;this._consume(Ct.tokens.brace_left,"Expected '{' for loop.");const t=[];let e=this._statement();for(;null!==e;){if(Array.isArray(e))for(let n of e)t.push(n);else t.push(e);e=this._statement()}let n=null;return this._match(Ct.keywords.continuing)&&(n=this._compound_statement()),this._consume(Ct.tokens.brace_right,"Expected '}' for loop."),new W(t,n)}_switch_statement(){if(!this._match(Ct.keywords.switch))return null;const t=this._optional_paren_expression();this._consume(Ct.tokens.brace_left,"Expected '{' for switch.");const e=this._switch_body();if(null==e||0==e.length)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(Ct.tokens.brace_right,"Expected '}' for switch."),new H(t,e)}_switch_body(){const t=[];if(this._match(Ct.keywords.case)){const e=this._case_selectors();this._match(Ct.tokens.colon),this._consume(Ct.tokens.brace_left,"Exected '{' for switch case.");const n=this._case_body();this._consume(Ct.tokens.brace_right,"Exected '}' for switch case."),t.push(new yt(e,n))}if(this._match(Ct.keywords.default)){this._match(Ct.tokens.colon),this._consume(Ct.tokens.brace_left,"Exected '{' for switch default.");const e=this._case_body();this._consume(Ct.tokens.brace_right,"Exected '}' for switch default."),t.push(new vt(e))}if(this._check([Ct.keywords.default,Ct.keywords.case])){const e=this._switch_body();t.push(e[0])}return t}_case_selectors(){var t,e,n,i;const r=[null!==(e=null===(t=this._shift_expression())||void 0===t?void 0:t.evaluate(this._context).toString())&&void 0!==e?e:""];for(;this._match(Ct.tokens.comma);)r.push(null!==(i=null===(n=this._shift_expression())||void 0===n?void 0:n.evaluate(this._context).toString())&&void 0!==i?i:"");return r}_case_body(){if(this._match(Ct.keywords.fallthrough))return this._consume(Ct.tokens.semicolon,"Expected ';'"),[];let t=this._statement();if(null==t)return[];t instanceof Array||(t=[t]);const e=this._case_body();return 0==e.length?t:[...t,e[0]]}_if_statement(){if(!this._match(Ct.keywords.if))return null;const t=this._optional_paren_expression(),e=this._compound_statement();let n=[];this._match_elseif()&&(n=this._elseif_statement(n));let i=null;return this._match(Ct.keywords.else)&&(i=this._compound_statement()),new X(t,e,n,i)}_match_elseif(){return this._tokens[this._current].type===Ct.keywords.else&&this._tokens[this._current+1].type===Ct.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(t=[]){const e=this._optional_paren_expression(),n=this._compound_statement();return t.push(new bt(e,n)),this._match_elseif()&&this._elseif_statement(t),t}_return_statement(){if(!this._match(Ct.keywords.return))return null;const t=this._short_circuit_or_expression();return new Y(t)}_short_circuit_or_expression(){let t=this._short_circuit_and_expr();for(;this._match(Ct.tokens.or_or);)t=new _t(this._previous().toString(),t,this._short_circuit_and_expr());return t}_short_circuit_and_expr(){let t=this._inclusive_or_expression();for(;this._match(Ct.tokens.and_and);)t=new _t(this._previous().toString(),t,this._inclusive_or_expression());return t}_inclusive_or_expression(){let t=this._exclusive_or_expression();for(;this._match(Ct.tokens.or);)t=new _t(this._previous().toString(),t,this._exclusive_or_expression());return t}_exclusive_or_expression(){let t=this._and_expression();for(;this._match(Ct.tokens.xor);)t=new _t(this._previous().toString(),t,this._and_expression());return t}_and_expression(){let t=this._equality_expression();for(;this._match(Ct.tokens.and);)t=new _t(this._previous().toString(),t,this._equality_expression());return t}_equality_expression(){const t=this._relational_expression();return this._match([Ct.tokens.equal_equal,Ct.tokens.not_equal])?new _t(this._previous().toString(),t,this._relational_expression()):t}_relational_expression(){let t=this._shift_expression();for(;this._match([Ct.tokens.less_than,Ct.tokens.greater_than,Ct.tokens.less_than_equal,Ct.tokens.greater_than_equal]);)t=new _t(this._previous().toString(),t,this._shift_expression());return t}_shift_expression(){let t=this._additive_expression();for(;this._match([Ct.tokens.shift_left,Ct.tokens.shift_right]);)t=new _t(this._previous().toString(),t,this._additive_expression());return t}_additive_expression(){let t=this._multiplicative_expression();for(;this._match([Ct.tokens.plus,Ct.tokens.minus]);)t=new _t(this._previous().toString(),t,this._multiplicative_expression());return t}_multiplicative_expression(){let t=this._unary_expression();for(;this._match([Ct.tokens.star,Ct.tokens.forward_slash,Ct.tokens.modulo]);)t=new _t(this._previous().toString(),t,this._unary_expression());return t}_unary_expression(){return this._match([Ct.tokens.minus,Ct.tokens.bang,Ct.tokens.tilde,Ct.tokens.star,Ct.tokens.and])?new gt(this._previous().toString(),this._unary_expression()):this._singular_expression()}_singular_expression(){const t=this._primary_expression(),e=this._postfix_expression();return e&&(t.postfix=e),t}_postfix_expression(){if(this._match(Ct.tokens.bracket_left)){const t=this._short_circuit_or_expression();this._consume(Ct.tokens.bracket_right,"Expected ']'.");const e=this._postfix_expression();return e&&(t.postfix=e),t}if(this._match(Ct.tokens.period)){const t=this._consume(Ct.tokens.ident,"Expected member name."),e=this._postfix_expression(),n=new st(t.lexeme);return e&&(n.postfix=e),n}return null}_getStruct(t){if(this._context.aliases.has(t)){return this._context.aliases.get(t).type}if(this._context.structs.has(t)){return this._context.structs.get(t)}return null}_primary_expression(){if(this._match(Ct.tokens.ident)){const t=this._previous().toString();if(this._check(Ct.tokens.paren_left)){const e=this._argument_expression_list(),n=this._getStruct(t);return null!=n?new at(n,e):new At(t,e)}if(this._context.constants.has(t)){const e=this._context.constants.get(t);return new lt(t,e.value)}return new ut(t)}if(this._match(Ct.const_literal))return new ct(parseFloat(this._previous().toString()));if(this._check(Ct.tokens.paren_left))return this._paren_expression();if(this._match(Ct.keywords.bitcast)){this._consume(Ct.tokens.less_than,"Expected '<'.");const t=this._type_decl();this._consume(Ct.tokens.greater_than,"Expected '>'.");const e=this._paren_expression();return new ht(t,e)}const t=this._type_decl(),e=this._argument_expression_list();return new ft(t,e)}_argument_expression_list(){if(!this._match(Ct.tokens.paren_left))return null;const t=[];do{if(this._check(Ct.tokens.paren_right))break;const e=this._short_circuit_or_expression();t.push(e)}while(this._match(Ct.tokens.comma));return this._consume(Ct.tokens.paren_right,"Expected ')' for agument list"),t}_optional_paren_expression(){this._match(Ct.tokens.paren_left);const t=this._short_circuit_or_expression();return this._match(Ct.tokens.paren_right),new pt([t])}_paren_expression(){this._consume(Ct.tokens.paren_left,"Expected '('.");const t=this._short_circuit_or_expression();return this._consume(Ct.tokens.paren_right,"Expected ')'."),new pt([t])}_struct_decl(){if(!this._match(Ct.keywords.struct))return null;const t=this._consume(Ct.tokens.ident,"Expected name for struct.").toString();this._consume(Ct.tokens.brace_left,"Expected '{' for struct body.");const e=[];for(;!this._check(Ct.tokens.brace_right);){const t=this._attribute(),n=this._consume(Ct.tokens.ident,"Expected variable name.").toString();this._consume(Ct.tokens.colon,"Expected ':' for struct member type.");const i=this._attribute(),r=this._type_decl();null!=r&&(r.attributes=i),this._check(Ct.tokens.brace_right)?this._match(Ct.tokens.comma):this._consume(Ct.tokens.comma,"Expected ',' for struct member."),e.push(new wt(n,r,t))}this._consume(Ct.tokens.brace_right,"Expected '}' after struct body.");const n=new tt(t,e);return this._context.structs.set(t,n),n}_global_variable_decl(){const t=this._variable_decl();return t&&this._match(Ct.tokens.equal)&&(t.value=this._const_expression()),t}_override_variable_decl(){const t=this._override_decl();return t&&this._match(Ct.tokens.equal)&&(t.value=this._const_expression()),t}_global_const_decl(){if(!this._match(Ct.keywords.const))return null;const t=this._consume(Ct.tokens.ident,"Expected variable name");let e=null;if(this._match(Ct.tokens.colon)){const t=this._attribute();e=this._type_decl(),null!=e&&(e.attributes=t)}let n=null;if(this._match(Ct.tokens.equal)){const t=this._short_circuit_or_expression();if(t instanceof at)n=t;else if(t instanceof lt&&t.initializer instanceof at)n=t.initializer;else try{const e=t.evaluate(this._context);n=new ct(e)}catch(b){n=t}}const i=new G(t.toString(),e,"","",n);return this._context.constants.set(i.name,i),i}_global_let_decl(){if(!this._match(Ct.keywords.let))return null;const t=this._consume(Ct.tokens.ident,"Expected variable name");let e=null;if(this._match(Ct.tokens.colon)){const t=this._attribute();e=this._type_decl(),null!=e&&(e.attributes=t)}let n=null;return this._match(Ct.tokens.equal)&&(n=this._const_expression()),new U(t.toString(),e,"","",n)}_const_expression(){if(this._match(Ct.const_literal))return new st(this._previous().toString());const t=this._type_decl();this._consume(Ct.tokens.paren_left,"Expected '('.");let e=[];for(;!this._check(Ct.tokens.paren_right)&&(e.push(this._const_expression()),this._check(Ct.tokens.comma));)this._advance();return this._consume(Ct.tokens.paren_right,"Expected ')'."),new at(t,e)}_variable_decl(){if(!this._match(Ct.keywords.var))return null;let t="",e="";this._match(Ct.tokens.less_than)&&(t=this._consume(Ct.storage_class,"Expected storage_class.").toString(),this._match(Ct.tokens.comma)&&(e=this._consume(Ct.access_mode,"Expected access_mode.").toString()),this._consume(Ct.tokens.greater_than,"Expected '>'."));const n=this._consume(Ct.tokens.ident,"Expected variable name");let i=null;if(this._match(Ct.tokens.colon)){const t=this._attribute();i=this._type_decl(),null!=i&&(i.attributes=t)}return new k(n.toString(),i,t,e,null)}_override_decl(){if(!this._match(Ct.keywords.override))return null;const t=this._consume(Ct.tokens.ident,"Expected variable name");let e=null;if(this._match(Ct.tokens.colon)){const t=this._attribute();e=this._type_decl(),null!=e&&(e.attributes=t)}return new B(t.toString(),e,null)}_enable_directive(){const t=this._consume(Ct.tokens.ident,"identity expected.");return new q(t.toString())}_type_alias(){const t=this._consume(Ct.tokens.ident,"identity expected.");this._consume(Ct.tokens.equal,"Expected '=' for type alias.");let e=this._type_decl();if(null===e)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(e.name)&&(e=this._context.aliases.get(e.name).type);const n=new Q(t.toString(),e);return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([Ct.tokens.ident,...Ct.texel_format,Ct.keywords.bool,Ct.keywords.f32,Ct.keywords.i32,Ct.keywords.u32])){const t=this._advance(),e=t.toString();return this._context.structs.has(e)?this._context.structs.get(e):this._context.aliases.has(e)?this._context.aliases.get(e).type:new J(t.toString())}let t=this._texture_sampler_types();if(t)return t;if(this._check(Ct.template_types)){let t=this._advance().toString(),e=null,n=null;return this._match(Ct.tokens.less_than)&&(e=this._type_decl(),n=null,this._match(Ct.tokens.comma)&&(n=this._consume(Ct.access_mode,"Expected access_mode for pointer").toString()),this._consume(Ct.tokens.greater_than,"Expected '>' for type.")),new et(t,e,n)}if(this._match(Ct.keywords.ptr)){let t=this._previous().toString();this._consume(Ct.tokens.less_than,"Expected '<' for pointer.");const e=this._consume(Ct.storage_class,"Expected storage_class for pointer");this._consume(Ct.tokens.comma,"Expected ',' for pointer.");const n=this._type_decl();let i=null;return this._match(Ct.tokens.comma)&&(i=this._consume(Ct.access_mode,"Expected access_mode for pointer").toString()),this._consume(Ct.tokens.greater_than,"Expected '>' for pointer."),new nt(t,e.toString(),n,i)}const e=this._attribute();if(this._match(Ct.keywords.array)){let t=null,n=-1;const i=this._previous();if(this._match(Ct.tokens.less_than)){t=this._type_decl(),this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);let e="";if(this._match(Ct.tokens.comma)){e=this._shift_expression().evaluate(this._context).toString()}this._consume(Ct.tokens.greater_than,"Expected '>' for array."),n=e?parseInt(e):0}return new it(i.toString(),e,t,n)}return null}_texture_sampler_types(){if(this._match(Ct.sampler_type))return new rt(this._previous().toString(),null,null);if(this._match(Ct.depth_texture_type))return new rt(this._previous().toString(),null,null);if(this._match(Ct.sampled_texture_type)||this._match(Ct.multisampled_texture_type)){const t=this._previous();this._consume(Ct.tokens.less_than,"Expected '<' for sampler type.");const e=this._type_decl();return this._consume(Ct.tokens.greater_than,"Expected '>' for sampler type."),new rt(t.toString(),e,null)}if(this._match(Ct.storage_texture_type)){const t=this._previous();this._consume(Ct.tokens.less_than,"Expected '<' for sampler type.");const e=this._consume(Ct.texel_format,"Invalid texel format.").toString();this._consume(Ct.tokens.comma,"Expected ',' after texel format.");const n=this._consume(Ct.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(Ct.tokens.greater_than,"Expected '>' for sampler type."),new rt(t.toString(),e,n)}return null}_attribute(){let t=[];for(;this._match(Ct.tokens.attr);){const e=this._consume(Ct.attribute_name,"Expected attribute name"),n=new xt(e.toString(),null);if(this._match(Ct.tokens.paren_left)){if(n.value=this._consume(Ct.literal_or_ident,"Expected attribute value").toString(),this._check(Ct.tokens.comma)){this._advance();do{const t=this._consume(Ct.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(t)}while(this._match(Ct.tokens.comma))}this._consume(Ct.tokens.paren_right,"Expected ')'")}t.push(n)}for(;this._match(Ct.tokens.attr_left);){if(!this._check(Ct.tokens.attr_right))do{const e=this._consume(Ct.attribute_name,"Expected attribute name"),n=new xt(e.toString(),null);if(this._match(Ct.tokens.paren_left)){if(n.value=[this._consume(Ct.literal_or_ident,"Expected attribute value").toString()],this._check(Ct.tokens.comma)){this._advance();do{const t=this._consume(Ct.literal_or_ident,"Expected attribute value").toString();n.value.push(t)}while(this._match(Ct.tokens.comma))}this._consume(Ct.tokens.paren_right,"Expected ')'")}t.push(n)}while(this._match(Ct.tokens.comma));this._consume(Ct.tokens.attr_right,"Expected ']]' after attribute declarations")}return 0==t.length?null:t}}class Pt{constructor(t,e){this.name=t,this.attributes=e,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}}class Mt{constructor(t,e,n){this.name=t,this.type=e,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class Lt extends Pt{constructor(t,e){super(t,e),this.members=[],this.align=0}get isStruct(){return!0}}class Nt extends Pt{constructor(t,e){super(t,e),this.count=0,this.stride=0}get isArray(){return!0}}class Ot extends Pt{constructor(t,e,n,i){super(t,n),this.format=e,this.access=i}get isTemplate(){return!0}}!function(t){t[t.Uniform=0]="Uniform",t[t.Storage=1]="Storage",t[t.Texture=2]="Texture",t[t.Sampler=3]="Sampler",t[t.StorageTexture=4]="StorageTexture"}(x||(x={}));class Dt{constructor(t,e,n,i,r,o,s){this.name=t,this.type=e,this.group=n,this.binding=i,this.attributes=r,this.resourceType=o,this.access=s}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class Ft{constructor(t,e){this.name=t,this.type=e}}class kt{constructor(t,e){this.align=t,this.size=e}}class Bt{constructor(t,e,n,i){this.name=t,this.type=e,this.locationType=n,this.location=i,this.interpolation=null}}class Ut{constructor(t,e,n,i){this.name=t,this.type=e,this.locationType=n,this.location=i}}class Gt{constructor(t,e=null){this.stage=null,this.inputs=[],this.outputs=[],this.name=t,this.stage=e}}class zt{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}class Vt{constructor(t,e,n,i){this.name=t,this.type=e,this.attributes=n,this.id=i}}class jt{constructor(t){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new zt,this._types=new Map,t&&this.update(t)}_isStorageTexture(t){return"texture_storage_1d"==t.name||"texture_storage_2d"==t.name||"texture_storage_2d_array"==t.name||"texture_storage_3d"==t.name}update(t){const e=(new Rt).parse(t);for(const n of e)if(n instanceof tt){const t=this._getTypeInfo(n,null);t instanceof Lt&&this.structs.push(t)}else if(n instanceof Q)this.aliases.push(this._getAliasInfo(n));else if(n instanceof B){const t=n,e=this._getAttributeNum(t.attributes,"id",0),i=null!=t.type?this._getTypeInfo(t.type,t.attributes):null;this.overrides.push(new Vt(t.name,i,t.attributes,e))}else if(this._isUniformVar(n)){const t=n,e=this._getAttributeNum(t.attributes,"group",0),i=this._getAttributeNum(t.attributes,"binding",0),r=this._getTypeInfo(t.type,t.attributes),o=new Dt(t.name,r,e,i,t.attributes,x.Uniform,t.access);this.uniforms.push(o)}else if(this._isStorageVar(n)){const t=n,e=this._getAttributeNum(t.attributes,"group",0),i=this._getAttributeNum(t.attributes,"binding",0),r=this._getTypeInfo(t.type,t.attributes),o=this._isStorageTexture(r),s=new Dt(t.name,r,e,i,t.attributes,o?x.StorageTexture:x.Storage,t.access);this.storage.push(s)}else if(this._isTextureVar(n)){const t=n,e=this._getAttributeNum(t.attributes,"group",0),i=this._getAttributeNum(t.attributes,"binding",0),r=this._getTypeInfo(t.type,t.attributes),o=this._isStorageTexture(r),s=new Dt(t.name,r,e,i,t.attributes,o?x.StorageTexture:x.Texture,t.access);o?this.storage.push(s):this.textures.push(s)}else if(this._isSamplerVar(n)){const t=n,e=this._getAttributeNum(t.attributes,"group",0),i=this._getAttributeNum(t.attributes,"binding",0),r=this._getTypeInfo(t.type,t.attributes),o=new Dt(t.name,r,e,i,t.attributes,x.Sampler,t.access);this.samplers.push(o)}else if(n instanceof L){const t=this._getAttribute(n,"vertex"),e=this._getAttribute(n,"fragment"),i=this._getAttribute(n,"compute"),r=t||e||i;if(r){const t=new Gt(n.name,r.name);t.inputs=this._getInputs(n.args),t.outputs=this._getOutputs(n.returnType),this.entry[r.name].push(t)}}else;}getBindGroups(){const t=[];function e(e,n){e>=t.length&&(t.length=e+1),void 0===t[e]&&(t[e]=[]),n>=t[e].length&&(t[e].length=n+1)}for(const n of this.uniforms){e(n.group,n.binding);t[n.group][n.binding]=n}for(const n of this.storage){e(n.group,n.binding);t[n.group][n.binding]=n}for(const n of this.textures){e(n.group,n.binding);t[n.group][n.binding]=n}for(const n of this.samplers){e(n.group,n.binding);t[n.group][n.binding]=n}return t}_getOutputs(t,e=void 0){if(void 0===e&&(e=[]),t instanceof tt)this._getStructOutputs(t,e);else{const n=this._getOutputInfo(t);null!==n&&e.push(n)}return e}_getStructOutputs(t,e){for(const n of t.members)if(n.type instanceof tt)this._getStructOutputs(n.type,e);else{const t=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(null!==t){const i=this._getTypeInfo(n.type,n.type.attributes),r=this._parseInt(t.value),o=new Ut(n.name,i,t.name,r);e.push(o)}}}_getOutputInfo(t){const e=this._getAttribute(t,"location")||this._getAttribute(t,"builtin");if(null!==e){const n=this._getTypeInfo(t,t.attributes),i=this._parseInt(e.value);return new Ut("",n,e.name,i)}return null}_getInputs(t,e=void 0){void 0===e&&(e=[]);for(const n of t)if(n.type instanceof tt)this._getStructInputs(n.type,e);else{const t=this._getInputInfo(n);null!==t&&e.push(t)}return e}_getStructInputs(t,e){for(const n of t.members)if(n.type instanceof tt)this._getStructInputs(n.type,e);else{const t=this._getInputInfo(n);null!==t&&e.push(t)}}_getInputInfo(t){const e=this._getAttribute(t,"location")||this._getAttribute(t,"builtin");if(null!==e){const n=this._getAttribute(t,"interpolation"),i=this._getTypeInfo(t.type,t.attributes),r=this._parseInt(e.value),o=new Bt(t.name,i,e.name,r);return null!==n&&(o.interpolation=this._parseString(n.value)),o}return null}_parseString(t){return t instanceof Array&&(t=t[0]),t}_parseInt(t){t instanceof Array&&(t=t[0]);const e=parseInt(t);return isNaN(e)?t:e}_getAlias(t){for(const e of this.aliases)if(e.name==t)return e.type;return null}_getAliasInfo(t){return new Ft(t.name,this._getTypeInfo(t.type,null))}_getTypeInfo(t,e){if(this._types.has(t))return this._types.get(t);if(t instanceof it){const n=t,i=this._getTypeInfo(n.format,n.attributes),r=new Nt(n.name,e);return r.format=i,r.count=n.count,this._types.set(t,r),this._updateTypeInfo(r),r}if(t instanceof tt){const n=t,i=new Lt(n.name,e);for(const t of n.members){const e=this._getTypeInfo(t.type,t.attributes);i.members.push(new Mt(t.name,e,t.attributes))}return this._types.set(t,i),this._updateTypeInfo(i),i}if(t instanceof rt){const n=t,i=n.format instanceof J,r=n.format?i?this._getTypeInfo(n.format,null):new Pt(n.format,null):null,o=new Ot(n.name,r,e,n.access);return this._types.set(t,o),this._updateTypeInfo(o),o}if(t instanceof et){const n=t,i=n.format?this._getTypeInfo(n.format,null):null,r=new Ot(n.name,i,e,n.access);return this._types.set(t,r),this._updateTypeInfo(r),r}const n=new Pt(t.name,e);return this._types.set(t,n),this._updateTypeInfo(n),n}_updateTypeInfo(t){var e,n;const i=this._getTypeSize(t);if(t.size=null!==(e=null==i?void 0:i.size)&&void 0!==e?e:0,t instanceof Nt){const e=this._getTypeSize(t.format);t.stride=null!==(n=null==e?void 0:e.size)&&void 0!==n?n:0,this._updateTypeInfo(t.format)}t instanceof Lt&&this._updateStructInfo(t)}_updateStructInfo(t){var e;let n=0,i=0,r=0,o=0;for(let s=0,a=t.members.length;s<a;++s){const a=t.members[s],A=this._getTypeSize(a);if(!A)continue;null!==(e=this._getAlias(a.type.name))&&void 0!==e||a.type;const u=A.align,l=A.size;n=this._roundUp(u,n+i),i=l,r=n,o=Math.max(o,u),a.offset=n,a.size=l,this._updateTypeInfo(a.type)}t.size=this._roundUp(o,r+i),t.align=o}_getTypeSize(t){var e;if(null==t)return null;const n=this._getAttributeNum(t.attributes,"size",0),i=this._getAttributeNum(t.attributes,"align",0);if(t instanceof Mt&&(t=t.type),t instanceof Pt){const e=this._getAlias(t.name);null!==e&&(t=e)}{const e=jt._typeInfo[t.name];if(void 0!==e){const r="f16"===t.format?2:1;return new kt(Math.max(i,e.align/r),Math.max(n,e.size/r))}}{const e=jt._typeInfo[t.name.substring(0,t.name.length-1)];if(e){const r="h"===t.name[t.name.length-1]?2:1;return new kt(Math.max(i,e.align/r),Math.max(n,e.size/r))}}if(t instanceof Nt){let r=t,o=8,s=8;const a=this._getTypeSize(r.format);null!==a&&(s=a.size,o=a.align);return s=r.count*this._getAttributeNum(null!==(e=null==t?void 0:t.attributes)&&void 0!==e?e:null,"stride",this._roundUp(o,s)),n&&(s=n),new kt(Math.max(i,o),Math.max(n,s))}if(t instanceof Lt){let e=0,r=0,o=0,s=0,a=0;for(const n of t.members){const t=this._getTypeSize(n.type);null!==t&&(e=Math.max(t.align,e),o=this._roundUp(t.align,o+s),s=t.size,a=o)}return r=this._roundUp(e,a+s),new kt(Math.max(i,e),Math.max(n,r))}return null}_isUniformVar(t){return t instanceof k&&"uniform"==t.storage}_isStorageVar(t){return t instanceof k&&"storage"==t.storage}_isTextureVar(t){return t instanceof k&&null!==t.type&&-1!=jt._textureTypes.indexOf(t.type.name)}_isSamplerVar(t){return t instanceof k&&null!==t.type&&-1!=jt._samplerTypes.indexOf(t.type.name)}_getAttribute(t,e){const n=t;if(!n||!n.attributes)return null;const i=n.attributes;for(let r of i)if(r.name==e)return r;return null}_getAttributeNum(t,e,n){if(null===t)return n;for(let i of t)if(i.name==e){let t=null!==i&&null!==i.value?i.value:n;return t instanceof Array&&(t=t[0]),"number"==typeof t?t:"string"==typeof t?parseInt(t):n}return n}_roundUp(t,e){return Math.ceil(e/t)*t}}function Wt(t){const e={attributes:[],bindings:[]};let n;try{n=function(t){try{return new jt(t)}catch(e){if(e instanceof Error)throw e;let t="WGSL parse error";throw"object"==typeof e&&e?.message&&(t+=`: ${e.message} `),"object"==typeof e&&e?.token&&(t+=e.token.line||""),new Error(t,{cause:e})}}(t)}catch(o){return d.R.error(o.message)(),e}for(const s of n.uniforms){const t=[];for(const e of s.type.members)t.push({name:e.name,type:Ht(e.type)});e.bindings.push({type:"uniform",name:s.name,location:s.binding,group:s.group,members:t})}const i=n.entry.vertex[0],r=i?.inputs.length||0;for(let s=0;s<r;s++){const t=i.inputs[s];if("location"===t.locationType){const n=Ht(t.type);e.attributes.push({name:t.name,location:t.location,type:n})}}return e}function Ht(t){return t.format?`${t.name}<${t.format.name}>`:t.name}jt._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},jt._textureTypes=Ct.any_texture_type.map((t=>t.name)),jt._samplerTypes=Ct.sampler_type.map((t=>t.name));class Xt{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(t){this.id=t.id||(0,m.L)("geometry"),this.topology=t.topology,this.indices=t.indices||null,this.attributes=t.attributes,this.vertexCount=t.vertexCount,this.bufferLayout=t.bufferLayout||[],this.indices&&(0,l.v)(this.indices.usage===r.h.INDEX)}destroy(){this.indices?.destroy();for(const t of Object.values(this.attributes))t.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices}_calculateVertexCount(t){return t.byteLength/12}}function Yt(t,e){if(e instanceof Xt)return e;const n=function(t,e){if(!e.indices)return;const n=e.indices.value;return t.createBuffer({usage:r.h.INDEX,data:n})}(t,e),{attributes:i,bufferLayout:o}=function(t,e){const n=[],i={};for(const[o,s]of Object.entries(e.attributes)){let e=o;switch(o){case"POSITION":e="positions";break;case"NORMAL":e="normals";break;case"TEXCOORD_0":e="texCoords";break;case"COLOR_0":e="colors"}i[e]=t.createBuffer({data:s.value,id:`${o}-buffer`});const{value:r,size:a,normalized:A}=s;n.push({name:e,format:(0,T.OB)(r,a,A)})}const r=e._calculateVertexCount(e.attributes,e.indices);return{attributes:i,bufferLayout:n,vertexCount:r}}(t,e);return new Xt({topology:e.topology||"triangle-list",bufferLayout:o,vertexCount:e.vertexCount,indices:n,attributes:i})}var qt=n(163);class Qt{modules;moduleUniforms;moduleBindings;moduleUniformsChanged;constructor(t){const e=(0,qt.KC)(Object.values(t).filter((t=>t.dependencies)));for(const n of e)t[n.name]=n;d.R.log(1,"Creating ShaderInputs with modules",Object.keys(t))(),this.modules=t,this.moduleUniforms={},this.moduleBindings={};for(const[n,i]of Object.entries(t)){const t=n;this.moduleUniforms[t]=i.defaultUniforms||{},this.moduleBindings[t]={}}}destroy(){}setProps(t){for(const e of Object.keys(t)){const n=e,i=t[n],r=this.modules[n];if(!r){d.R.warn(`Module ${e} not found`)();continue}const o=this.moduleUniforms[n],s=r.getUniforms?.(i,this.moduleUniforms[n])||i;this.moduleUniforms[n]={...o,...s}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindings(){const t={};for(const e of Object.values(this.moduleBindings))Object.assign(t,e);return t}getDebugTable(){const t={};for(const[e,n]of Object.entries(this.moduleUniforms))for(const[i,r]of Object.entries(n))t[`${e}.${i}`]={type:this.modules[e].uniformTypes?.[i],value:String(r)};return t}}var $t=n(5153);class Kt extends $t.F{static defaultProps={...$t.F.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0};get[Symbol.toStringTag](){return"ComputePipeline"}hash="";constructor(t,e){super(t,e,Kt.defaultProps)}}class Zt{static defaultProps={...a.r.defaultProps};device;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};static getDefaultPipelineFactory(t){return t._lumaData.defaultPipelineFactory=t._lumaData.defaultPipelineFactory||new Zt(t),t._lumaData.defaultPipelineFactory}constructor(t){this.device=t}createRenderPipeline(t){const e={...a.r.defaultProps,...t},n=this._hashRenderPipeline(e);if(!this._renderPipelineCache[n]){const t=this.device.createRenderPipeline({...e,id:e.id?`${e.id}-cached`:void 0});t.hash=n,this._renderPipelineCache[n]={pipeline:t,useCount:0}}return this._renderPipelineCache[n].useCount++,this._renderPipelineCache[n].pipeline}createComputePipeline(t){const e={...Kt.defaultProps,...t},n=this._hashComputePipeline(e);if(!this._computePipelineCache[n]){const t=this.device.createComputePipeline({...e,id:e.id?`${e.id}-cached`:void 0});t.hash=n,this._computePipelineCache[n]={pipeline:t,useCount:0}}return this._computePipelineCache[n].useCount++,this._computePipelineCache[n].pipeline}release(t){const e=t.hash,n=t instanceof Kt?this._computePipelineCache:this._renderPipelineCache;n[e].useCount--,0===n[e].useCount&&(n[e].pipeline.destroy(),delete n[e])}_hashComputePipeline(t){return`${this._getHash(t.shader.source)}`}_hashRenderPipeline(t){const e=this._getHash(t.vs.source),n=t.fs?this._getHash(t.fs.source):0,i=this._getHash(JSON.stringify(t.bufferLayout));if("webgl"===this.device.type)return`${e}/${n}V-BL${i}`;{const r=this._getHash(JSON.stringify(t.parameters));return`${e}/${n}V-T${t.topology}P${r}BL${i}`}}_getHash(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}}var Jt=n(6795);class te{static defaultProps={...Jt.M.defaultProps};device;_cache={};static getDefaultShaderFactory(t){return t._lumaData.defaultShaderFactory||=new te(t),t._lumaData.defaultShaderFactory}constructor(t){this.device=t}createShader(t){const e=this._hashShader(t);let n=this._cache[e];if(!n){const i=this.device.createShader({...t,id:t.id?`${t.id}-cached`:void 0});this._cache[e]=n={shader:i,useCount:0}}return n.useCount++,n.shader}release(t){const e=this._hashShader(t),n=this._cache[e];n&&(n.useCount--,0===n.useCount&&(delete this._cache[e],n.shader.destroy()))}_hashShader(t){return`${t.stage}:${t.source}`}}let ee=null,ne=null;class ie{static defaultProps={...a.r.defaultProps,source:null,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:I._.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};uniforms={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;_getModuleUniforms;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;constructor(t,e){this.props={...ie.defaultProps,...e},e=this.props,this.id=e.id||(0,m.L)("model"),this.device=t,Object.assign(this.userData,e.userData);const n=Object.fromEntries(this.props.modules?.map((t=>[t.name,t]))||[]);this.setShaderInputs(e.shaderInputs||new Qt(n));const i=function(t){return{type:t.type,shaderLanguage:t.info.shadingLanguage,shaderLanguageVersion:t.info.shadingLanguageVersion,gpu:t.info.gpu,features:t.features}}(t),r=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if("webgpu"===this.device.type&&this.props.source){this.props.shaderLayout||=Wt(this.props.source);const{source:t,getUniforms:e}=this.props.shaderAssembler.assembleShader({platformInfo:i,...this.props,modules:r});this.source=t,this._getModuleUniforms=e}else{const{vs:t,fs:e,getUniforms:n}=this.props.shaderAssembler.assembleShaderPair({platformInfo:i,...this.props,modules:r});this.vs=t,this.fs=e,this._getModuleUniforms=n}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,e.geometry&&this.setGeometry(e.geometry),this.pipelineFactory=e.pipelineFactory||Zt.getDefaultPipelineFactory(this.device),this.shaderFactory=e.shaderFactory||te.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=t.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in e&&(this.isInstanced=e.isInstanced),e.instanceCount&&this.setInstanceCount(e.instanceCount),e.vertexCount&&this.setVertexCount(e.vertexCount),e.indexBuffer&&this.setIndexBuffer(e.indexBuffer),e.attributes&&this.setAttributes(e.attributes),e.constantAttributes&&this.setConstantAttributes(e.constantAttributes),e.bindings&&this.setBindings(e.bindings),e.uniforms&&this.setUniforms(e.uniforms),e.moduleSettings&&this.updateModuleSettings(e.moduleSettings),e.transformFeedback&&(this.transformFeedback=e.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const t=this._needsRedraw;return this._needsRedraw=!1,t}setNeedsRedraw(t){this._needsRedraw||=t}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(t){let e;this.predraw();try{this._logDrawCallStart(),this.pipeline=this._updatePipeline(),this.pipeline.setBindings(this.bindings,{disableWarnings:this.props.disableWarnings}),(0,m.Z)(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:n}=this.vertexArray,i=n?n.byteLength/("uint32"===n.indexType?4:2):void 0;e=this.pipeline.draw({renderPass:t,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:i,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{this._logDrawCallEnd()}return this._logFramebuffer(t),e?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",e}setGeometry(t){this._gpuGeometry?.destroy();const e=t&&Yt(this.device,t);e&&(this.setTopology(e.topology||"triangle-list"),this.bufferLayout=re(e.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(e)),this._gpuGeometry=e}setTopology(t){t!==this.topology&&(this.topology=t,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(t){this.bufferLayout=this._gpuGeometry?re(t,this._gpuGeometry.bufferLayout):t,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(t){y(t,this.parameters,2)||(this.parameters=t,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(t){this.instanceCount=t,void 0===this.isInstanced&&t>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(t){this.vertexCount=t,this.setNeedsRedraw("vertexCount")}setShaderInputs(t){this.shaderInputs=t,this._uniformStore=new _(this.shaderInputs.modules);for(const e of Object.keys(this.shaderInputs.modules)){const t=this._uniformStore.getManagedUniformBuffer(this.device,e);this.bindings[`${e}Uniforms`]=t}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setNeedsRedraw("shaderInputs")}setBindings(t){Object.assign(this.bindings,t),this.setNeedsRedraw("bindings")}setTransformFeedback(t){this.transformFeedback=t,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(t){this.vertexArray.setIndexBuffer(t),this.setNeedsRedraw("indexBuffer")}setAttributes(t,e){t.indices&&d.R.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)();for(const[n,i]of Object.entries(t)){const t=this.bufferLayout.find((t=>oe(t).includes(n)));if(!t){d.R.warn(`Model(${this.id}): Missing layout for buffer "${n}".`)();continue}const r=oe(t);let o=!1;for(const e of r){const t=this._attributeInfos[e];t&&(this.vertexArray.setBuffer(t.location,i),o=!0)}o||(e?.disableWarnings??this.props.disableWarnings)||d.R.warn(`Model(${this.id}): Ignoring buffer "${i.id}" for unknown attribute "${n}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(t,e){for(const[n,i]of Object.entries(t)){const t=this._attributeInfos[n];t?this.vertexArray.setConstantWebGL(t.location,i):(e?.disableWarnings??this.props.disableWarnings)||d.R.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${n}"`)()}this.setNeedsRedraw("constants")}setUniforms(t){(0,m.Z)(t)||(this.pipeline.setUniformsWebGL(t),Object.assign(this.uniforms,t)),this.setNeedsRedraw("uniforms")}updateModuleSettings(t){const{bindings:e,uniforms:n}=(0,S.l)(this._getModuleUniforms(t));Object.assign(this.bindings,e),Object.assign(this.uniforms,n),this.setNeedsRedraw("moduleSettings")}_getBindingsUpdateTimestamp(){let t=0;for(const e of Object.values(this.bindings))e instanceof i.X?t=Math.max(t,e.texture.updateTimestamp):e instanceof r.h||e instanceof o.g?t=Math.max(t,e.updateTimestamp):e instanceof s.L||(t=Math.max(t,e.buffer.updateTimestamp));return t}_setGeometryAttributes(t){const e={...t.attributes};for(const[n]of Object.entries(e))this.pipeline.shaderLayout.attributes.find((t=>t.name===n))||"positions"===n||delete e[n];this.vertexCount=t.vertexCount,this.setIndexBuffer(t.indices||null),this.setAttributes(t.attributes,{disableWarnings:!0}),this.setAttributes(e,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(t){this._pipelineNeedsUpdate||=t,this.setNeedsRedraw(t)}_updatePipeline(){if(this._pipelineNeedsUpdate){let t=null,e=null;this.pipeline&&(d.R.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),t=this.pipeline.vs,e=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const n=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debug:this.props.debugShaders});let i=null;this.source?i=n:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debug:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,vs:n,fs:i}),this._attributeInfos=(0,C.PV)(this.pipeline.shaderLayout,this.bufferLayout),t&&this.shaderFactory.release(t),e&&this.shaderFactory.release(e)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){const t=d.R.level>3?0:1e4;d.R.level<2||Date.now()-this._lastLogTime<t||(this._lastLogTime=Date.now(),this._logOpen=!0,d.R.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:d.R.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const t=function(t,e){const n={},i="Values";if(0===t.attributes.length&&!t.varyings?.length)return{"No attributes or varyings":{[i]:"N/A"}};for(const r of t.attributes)r&&(n[`in ${r.location} ${r.name}: ${r.type}`]={[i]:r.stepMode||"vertex"});for(const r of t.varyings||[])n[`out ${r.location} ${r.name}`]={[i]:JSON.stringify(r.accessor)};return n}(this.pipeline.shaderLayout,this.id);d.R.table(2,t)();const e=this.shaderInputs.getDebugTable();for(const[i,r]of Object.entries(this.uniforms))e[i]={value:r};d.R.table(2,e)();const n=this._getAttributeDebugTable();d.R.table(2,this._attributeInfos)(),d.R.table(2,n)(),d.R.groupEnd(2)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(t){const e=d.R.get("framebuffer");if(this._drawCount++,!e||this._drawCount++>3&&this._drawCount%60)return;const n=t.props.framebuffer;n&&function(t,{id:e,minimap:n,opaque:i,top:r="0",left:o="0",rgbaScale:s=1}){ee||(ee=document.createElement("canvas"),ee.id=e,ee.title=e,ee.style.zIndex="100",ee.style.position="absolute",ee.style.top=r,ee.style.left=o,ee.style.border="blue 1px solid",ee.style.transform="scaleY(-1)",document.body.appendChild(ee),ne=ee.getContext("2d")),ee.width===t.width&&ee.height===t.height||(ee.width=t.width/2,ee.height=t.height/2,ee.style.width="400px",ee.style.height="400px");const a=t.device.readPixelsToArrayWebGL(t),A=ne.createImageData(t.width,t.height);for(let u=0;u<a.length;u+=4)A.data[0+u+0]=a[u+0]*s,A.data[0+u+1]=a[u+1]*s,A.data[0+u+2]=a[u+2]*s,A.data[0+u+3]=i?255:a[u+3]*s;ne.putImageData(A,0,0)}(n,{id:n.id,minimap:!0})}_getAttributeDebugTable(){const t={};for(const[e,n]of Object.entries(this._attributeInfos))t[n.location]={name:e,type:n.shaderType,values:this._getBufferOrConstantValues(this.vertexArray.attributes[n.location],n.bufferDataType)};if(this.vertexArray.indexBuffer){const{indexBuffer:e}=this.vertexArray,n="uint32"===e.indexType?new Uint32Array(e.debugData):new Uint16Array(e.debugData);t.indices={name:"indices",type:e.indexType,values:n.toString()}}return t}_getBufferOrConstantValues(t,e){const n=(0,T.Y0)(e);return(t instanceof r.h?new n(t.debugData):t).toString()}}function re(t,e){const n=[...t];for(const i of e){const t=n.findIndex((t=>t.name===i.name));t<0?n.push(i):n[t]=i}return n}function oe(t){return t.attributes?t.attributes?.map((t=>t.attribute)):[t.name]}},766:(t,e,n)=>{"use strict";n.d(e,{_:()=>w});var i=n(3091);function r(t){if(t.source&&"webgpu"===t.platformInfo.type){return{...t,vs:void 0,fs:void 0}}if(!t.vs)throw new Error("no vertex shader");const e=o(t.platformInfo,t.vs);let n;return t.fs&&(n=o(t.platformInfo,t.fs)),{...t,vs:e,fs:n}}function o(t,e){if("string"==typeof e)return e;if("webgpu"===t.type){if(e?.wgsl)return e.wgsl;throw new Error("WebGPU does not support GLSL shaders")}if(e?.glsl)return e.glsl;throw new Error("WebGL does not support WGSL shaders")}var s=n(163);var a=n(2984);const A=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],u=[...A,[h("attribute"),"in $1"],[h("varying"),"out $1"]],l=[...A,[h("varying"),"in $1"]];function c(t,e){for(const[n,i]of e)t=t.replace(n,i);return t}function h(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function f(t,e){let n="";for(const i in t){const r=t[i];if(n+=`void ${r.signature} {\n`,r.header&&(n+=`  ${r.header}`),e[i]){const t=e[i];t.sort(((t,e)=>t.order-e.order));for(const e of t)n+=`  ${e.injection}\n`}r.footer&&(n+=`  ${r.footer}`),n+="}\n"}return n}function p(t){const e={vertex:{},fragment:{}};for(const n of t){let t,i;"string"!=typeof n?(t=n,i=t.hook):(t={},i=n),i=i.trim();const[r,o]=i.split(":"),s=i.replace(/\(.+/,""),a=Object.assign(t,{signature:o});switch(r){case"vs":e.vertex[s]=a;break;case"fs":e.fragment[s]=a;break;default:throw new Error(r)}}return e}var d=n(8074);function g(t,e="unnamed"){const n=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(t);return n?n[1]:e}function _(t){let e=100;const n=t.match(/[^\s]+/g);if(n&&n.length>=2&&"#version"===n[0]){const t=parseInt(n[1],10);Number.isFinite(t)&&(e=t)}if(100!==e&&300!==e)throw new Error(`Invalid GLSL version ${e}`);return e}const m=`\n\n${a.O_}\n`,y="precision highp float;\n";function v(t,e){const{source:n,stage:i,modules:r,hookFunctions:o=[],inject:s={},log:A}=e;(0,d.v)("string"==typeof n,"shader source must be a string");const u=n;let l="";const c=p(o),h={},g={},_={};for(const a in s){const t="string"==typeof s[a]?{injection:s[a],order:0}:s[a],e=/^(v|f)s:(#)?([\w-]+)$/.exec(a);if(e){const n=e[2],i=e[3];n?"decl"===i?g[a]=[t]:_[a]=[t]:h[a]=[t]}else _[a]=[t]}const y="webgpu"!==t.type?r:[];for(const a of y){A&&a.checkDeprecations(u,A);l+=a.getModuleSource(i,"wgsl");const t=a.injections[i];for(const e in t){const n=/^(v|f)s:#([\w-]+)$/.exec(e);if(n){const i="decl"===n[2]?g:_;i[e]=i[e]||[],i[e].push(t[e])}else h[e]=h[e]||[],h[e].push(t[e])}}return l+=m,l=(0,a.bv)(l,i,g),l+=f(c[i],h),l+=u,l=(0,a.bv)(l,i,_),l}function E(t,e){const{id:n,source:i,stage:r,language:o="glsl",modules:s,defines:A={},hookFunctions:h=[],inject:v={},prologue:E=!0,log:b}=e;(0,d.v)("string"==typeof i,"shader source must be a string");const w="glsl"===o?function(t,e){return{name:g(t,e),language:"glsl",version:_(t)}}(i).version:-1,x=t.shaderLanguageVersion,S=100===w?"#version 100":"#version 300 es",C=i.split("\n").slice(1).join("\n"),T={};s.forEach((t=>{Object.assign(T,t.getDefines())})),Object.assign(T,A);let I="";switch(o){case"wgsl":break;case"glsl":I=E?`${S}\n\n// ----- PROLOGUE -------------------------\n${function(t){const{id:e,source:n,stage:i}=t,r=e&&-1===n.indexOf("SHADER_NAME");return r?`\n#define SHADER_NAME ${e}_${i}\n\n`:""}({id:n,source:i,stage:r})}\n#define SHADER_TYPE_${r.toUpperCase()}\n${function(t){switch(t?.gpu.toLowerCase()){case"apple":return"#define APPLE_GPU\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"nvidia":return"#define NVIDIA_GPU\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(t)}\n${"fragment"===r?y:""}\n\n// ----- APPLICATION DEFINES -------------------------\n\n${function(t={}){let e="";for(const n in t){const i=t[n];(i||Number.isFinite(i))&&(e+=`#define ${n.toUpperCase()} ${t[n]}\n`)}return e}(T)}\n\n`:`${S}\n`}const R=p(h),P={},M={},L={};for(const a in v){const t="string"==typeof v[a]?{injection:v[a],order:0}:v[a],e=/^(v|f)s:(#)?([\w-]+)$/.exec(a);if(e){const n=e[2],i=e[3];n?"decl"===i?M[a]=[t]:L[a]=[t]:P[a]=[t]}else L[a]=[t]}for(const a of s){b&&a.checkDeprecations(C,b);I+=a.getModuleSource(r);const t=a.injections[r];for(const e in t){const n=/^(v|f)s:#([\w-]+)$/.exec(e);if(n){const i="decl"===n[2]?M:L;i[e]=i[e]||[],i[e].push(t[e])}else P[e]=P[e]||[],P[e].push(t[e])}}return I+="// ----- MAIN SHADER SOURCE -------------------------",I+=m,I=(0,a.bv)(I,r,M),I+=f(R[r],P),I+=C,I=(0,a.bv)(I,r,L),"glsl"===o&&w!==x&&(I=function(t,e){if(300!==Number(t.match(/^#version[ \t]+(\d+)/m)?.[1]||100))throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return c(t,u);case"fragment":return c(t,l);default:throw new Error(e)}}(I,r)),I.trim()}function b(t){return function(e){const n={};for(const i of t){const t=i.getUniforms(e,n);Object.assign(n,t)}return n}}class w{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return w.defaultShaderAssembler=w.defaultShaderAssembler||new w,w.defaultShaderAssembler}addDefaultModule(t){this._defaultModules.find((e=>e.name===("string"==typeof t?t:t.name)))||this._defaultModules.push(t)}removeDefaultModule(t){const e="string"==typeof t?t:t.name;this._defaultModules=this._defaultModules.filter((t=>t.name!==e))}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t)}assembleShader(t){const e=this._getModuleList(t.modules),n=this._hookFunctions,i=r(t),o=function(t){const e=(0,s.KC)(t.modules||[]);return{source:v(t.platformInfo,{...t,source:t.source,stage:"vertex",modules:e}),getUniforms:b(e)}}({platformInfo:t.platformInfo,...i,modules:e,hookFunctions:n});return{...o,modules:e}}assembleShaderPair(t){const e=r(t),n=this._getModuleList(t.modules),i=this._hookFunctions,{platformInfo:o}=t,a="wgsl"===t.platformInfo.shaderLanguage?function(t){const e=(0,s.KC)(t.modules||[]);return{vs:v(t.platformInfo,{...t,source:t.vs,stage:"vertex",modules:e}),fs:v(t.platformInfo,{...t,source:t.fs,stage:"fragment",modules:e}),getUniforms:b(e)}}({platformInfo:o,...e,modules:n,hookFunctions:i}):function(t){const{vs:e,fs:n}=t,i=(0,s.KC)(t.modules||[]);return{vs:E(t.platformInfo,{...t,source:e,stage:"vertex",modules:i}),fs:E(t.platformInfo,{...t,source:n,stage:"fragment",modules:i}),getUniforms:b(i)}}({platformInfo:o,...e,modules:n,hookFunctions:i});return{...a,modules:n}}_getModuleList(t=[]){const e=new Array(this._defaultModules.length+t.length),n={};let r=0;for(let i=0,o=this._defaultModules.length;i<o;++i){const t=this._defaultModules[i],o=t.name;e[r++]=t,n[o]=!0}for(let i=0,o=t.length;i<o;++i){const o=t[i],s=o.name;n[s]||(e[r++]=o,n[s]=!0)}return e.length=r,i.z.instantiateModules(e)}}},163:(t,e,n)=>{"use strict";n.d(e,{KC:()=>r});var i=n(3091);function r(t){return o(i.z.instantiateModules(t))}function o(t){const e={},n={};return s({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort(((t,e)=>n[e]-n[t])).map((t=>e[t]))}function s(t){const{modules:e,level:n,moduleMap:i,moduleDepth:r}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const o of e)i[o.name]=o,(void 0===r[o.name]||r[o.name]<n)&&(r[o.name]=n);for(const o of e)o.dependencies&&s({modules:o.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}},2984:(t,e,n)=>{"use strict";n.d(e,{O_:()=>a,bv:()=>l,Uu:()=>A});const i={vertex:"#ifdef MODULE_LOGDEPTH\nlogdepth_adjustPosition(gl_Position);\n#endif\n",fragment:"#ifdef MODULE_MATERIAL\ngl_FragColor = material_filterColor(gl_FragColor);\n#endif\n#ifdef MODULE_LIGHTING\ngl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n#ifdef MODULE_FOG\ngl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n#ifdef MODULE_PICKING\ngl_FragColor = picking_filterHighlightColor(gl_FragColor);\ngl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n#ifdef MODULE_LOGDEPTH\nlogdepth_setFragDepth();\n#endif\n"},r=/void\s+main\s*\([^)]*\)\s*\{\n?/,o=/}\n?[^{}]*$/,s=[],a="__LUMA_INJECT_DECLARATIONS__";function A(t){const e={vertex:{},fragment:{}};for(const n in t){let i=t[n];"string"==typeof i&&(i={order:0,injection:i}),e[u(n)][n]=i}return e}function u(t){const e=t.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function l(t,e,n,A=!1){const u="vertex"===e;for(const i in n){const e=n[i];e.sort(((t,e)=>t.order-e.order)),s.length=e.length;for(let t=0,n=e.length;t<n;++t)s[t]=e[t].injection;const A=`${s.join("\n")}\n`;switch(i){case"vs:#decl":u&&(t=t.replace(a,A));break;case"vs:#main-start":u&&(t=t.replace(r,(t=>t+A)));break;case"vs:#main-end":u&&(t=t.replace(o,(t=>A+t)));break;case"fs:#decl":u||(t=t.replace(a,A));break;case"fs:#main-start":u||(t=t.replace(r,(t=>t+A)));break;case"fs:#main-end":u||(t=t.replace(o,(t=>A+t)));break;default:t=t.replace(i,(t=>t+A))}}return t=t.replace(a,""),A&&(t=t.replace(/\}\s*$/,(t=>t+i[e]))),t}},3091:(t,e,n)=>{"use strict";n.d(e,{z:()=>u});var i=n(8074);const r={number:{type:"number",validate:(t,e)=>Number.isFinite(t)&&"object"==typeof e&&(void 0===e.max||t<=e.max)&&(void 0===e.min||t>=e.min)},array:{type:"array",validate:(t,e)=>Array.isArray(t)||ArrayBuffer.isView(t)}};function o(t){let e=s(t);if("object"!==e)return{value:t,...r[e],type:e};if("object"==typeof t)return t?void 0!==t.type?{...t,...r[t.type],type:t.type}:void 0===t.value?{type:"object",value:t}:(e=s(t.value),{...t,...r[e],type:e}):{type:"object",value:null};throw new Error("props")}function s(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}var a=n(2984);let A=1;class u{name;vs;fs;getModuleUniforms;dependencies;deprecations;defines;injections;uniforms={};uniformTypes={};static instantiateModules(t){return t.map((t=>{if(t instanceof u)return t;(0,i.v)("string"!=typeof t,`Shader module use by name is deprecated. Import shader module '${JSON.stringify(t)}' and use it directly.`),t.name||(console.warn("shader module has no name"),t.name="shader-module-"+A++);const e=new u(t);return e.dependencies=u.instantiateModules(t.dependencies||[]),e}))}constructor(t){const{name:e,vs:n,fs:r,dependencies:s=[],uniformTypes:A={},uniformPropTypes:l={},getUniforms:c,deprecations:h=[],defines:f={},inject:p={}}=t;(0,i.v)("string"==typeof e),this.name=e,this.vs=n,this.fs=r,this.getModuleUniforms=c,this.dependencies=u.instantiateModules(s),this.deprecations=this._parseDeprecationDefinitions(h),this.defines=f,this.injections=(0,a.Uu)(p),this.uniformTypes=A,l&&(this.uniforms=function(t){const e={};for(const[n,i]of Object.entries(t))e[n]=o(i);return e}(l))}getModuleSource(t){let e;switch(t){case"vertex":e=this.vs||"";break;case"fragment":e=this.fs||"";break;default:(0,i.v)(!1)}const n=this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");return`// ----- MODULE ${this.name} ---------------\n\n#define MODULE_${n}\n${e}\n\n`}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):function(t,e,n){const r={};for(const[o,s]of Object.entries(e))t&&o in t&&!s.private?(s.validate&&(0,i.v)(s.validate(t[o],s),`${n}: invalid ${o}`),r[o]=t[o]):r[o]=s.value;return r}(t,this.uniforms,this.name)}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach((n=>{n.regex?.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())}))}_parseDeprecationDefinitions(t){return t.forEach((t=>{if("function"===t.type)t.regex=new RegExp(`\\b${t.old}\\(`);else t.regex=new RegExp(`${t.type} ${t.old};`)})),t}_defaultGetUniforms(t={}){const e={},n=this.uniforms;for(const r in n){const o=n[r];r in t&&!o.private?(o.validate&&(0,i.v)(o.validate(t[r],o),`${this.name}: invalid ${r}`),e[r]=t[r]):e[r]=o.value}return e}}},8074:(t,e,n)=>{"use strict";function i(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}n.d(e,{v:()=>i})},9105:(t,e,n)=>{"use strict";n.d(e,{K:()=>l,p:()=>c});const i="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\nstruct AmbientLight {\nvec3 color;\n};\nstruct PointLight {\nvec3 color;\nvec3 position;\nvec3 attenuation;\n};\nstruct DirectionalLight {\nvec3 color;\nvec3 direction;\n};\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\nuniform bool lighting_uEnabled;\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\nreturn pointLight.attenuation.x\n+ pointLight.attenuation.y * distance\n+ pointLight.attenuation.z * distance * distance;\n}\n#endif\n",r={lightSources:{}};function o(t={}){const{color:e=[0,0,0],intensity:n=1}=t;return e.map((t=>t*n/255))}const s={name:"lights",vs:i,fs:i,getUniforms:function t(e=r){if("lightSources"in e){const{ambientLight:t,pointLights:n,directionalLights:i}=e.lightSources||{};return t||n&&n.length>0||i&&i.length>0?Object.assign({},function({ambientLight:t,pointLights:e=[],directionalLights:n=[]}){const i={};return i["lighting_uAmbientLight.color"]=t?o(t):[0,0,0],e.forEach(((t,e)=>{i[`lighting_uPointLight[${e}].color`]=o(t),i[`lighting_uPointLight[${e}].position`]=t.position,i[`lighting_uPointLight[${e}].attenuation`]=t.attenuation||[1,0,0]})),i.lighting_uPointLightCount=e.length,n.forEach(((t,e)=>{i[`lighting_uDirectionalLight[${e}].color`]=o(t),i[`lighting_uDirectionalLight[${e}].direction`]=t.direction})),i.lighting_uDirectionalLightCount=n.length,i}({ambientLight:t,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){const n={pointLights:[],directionalLights:[]};for(const t of e.lights||[])switch(t.type){case"ambient":n.ambientLight=t;break;case"directional":n.directionalLights?.push(t);break;case"point":n.pointLights?.push(t)}return t({lightSources:n})}return{}},defines:{MAX_LIGHTS:3}},a="uniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\nvec3 halfway_direction = normalize(light_direction + view_direction);\nfloat lambertian = dot(light_direction, normal_worldspace);\nfloat specular = 0.0;\nif (lambertian > 0.0) {\nfloat specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\nspecular = pow(specular_angle, lighting_uShininess);\n}\nlambertian = max(lambertian, 0.0);\nreturn (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\nvec3 lightColor = surfaceColor;\nif (lighting_uEnabled) {\nvec3 view_direction = normalize(cameraPosition - position_worldspace);\nlightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (i >= lighting_uPointLightCount) {\nbreak;\n}\nPointLight pointLight = lighting_uPointLight[i];\nvec3 light_position_worldspace = pointLight.position;\nvec3 light_direction = normalize(light_position_worldspace - position_worldspace);\nlightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n}\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (i >= lighting_uDirectionalLightCount) {\nbreak;\n}\nDirectionalLight directionalLight = lighting_uDirectionalLight[i];\nlightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n}\n}\nreturn lightColor;\n}\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\nvec3 lightColor = vec3(0, 0, 0);\nvec3 surfaceColor = vec3(0, 0, 0);\nif (lighting_uEnabled) {\nvec3 view_direction = normalize(cameraPosition - position_worldspace);\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (i >= lighting_uPointLightCount) {\nbreak;\n}\nPointLight pointLight = lighting_uPointLight[i];\nvec3 light_position_worldspace = pointLight.position;\nvec3 light_direction = normalize(light_position_worldspace - position_worldspace);\nlightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n}\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (i >= lighting_uDirectionalLightCount) {\nbreak;\n}\nDirectionalLight directionalLight = lighting_uDirectionalLight[i];\nlightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n}\n}\nreturn lightColor;\n}\n",A={};function u(t=A){if(!("material"in t))return{};const{material:e}=t;return e?function(t){const{ambient:e=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map((t=>t/255))}}(e):{lighting_uEnabled:!1}}const l={name:"gouraud-lighting",dependencies:[s],vs:a,defines:{LIGHTING_VERTEX:1},getUniforms:u},c={name:"phong-lighting",dependencies:[s],fs:a,defines:{LIGHTING_FRAGMENT:1},getUniforms:u}},8073:(t,e,n)=>{"use strict";n.d(e,{a:()=>r});var i=n(4901);class r extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:(0,i.cy)(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(i.$W)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+(0,i.Fl)(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!(0,i.aI)(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){if(void 0===n)return this.lerp(this,t,e);for(let i=0;i<this.ELEMENTS;++i){const r=t[i],o="number"==typeof e?e:e[i];this[i]=r+n*(o-r)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if("number"==typeof t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(let e=0;e<this.ELEMENTS&&e<t.length;++e)this[e]*=t[e];return this.check()}multiplyByScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}check(){if(i.$W.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}get elements(){return this}}},5715:(t,e,n)=>{"use strict";n.d(e,{M:()=>s});var i=n(8073),r=n(3731);function o(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}class s extends i.a{get x(){return this[0]}set x(t){this[0]=(0,r.ws)(t)}get y(){return this[1]}set y(t){this[1]=(0,r.ws)(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-t[n];e+=i*i}return(0,r.ws)(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return(0,r.ws)(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return o(t>=0&&t<this.ELEMENTS,"index is out of range"),(0,r.ws)(this[t])}setComponent(t,e){return o(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}},5077:(t,e,n)=>{"use strict";n.d(e,{k:()=>m});var i=n(8073),r=n(3731),o=n(4901);class s extends i.a{toString(){let t="[";if(o.$W.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=(0,r.ws)(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let i=0;i<this.RANK;++i)e[i]=this[n+i];return e}setColumn(t,e){const n=t*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=e[i];return this}}var a,A=n(8225),u=n(218),l=n(3588),c=n(2859),h=n(9426);!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"}(a||(a={}));const f=45*Math.PI/180,p=1,d=.1,g=500,_=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class m extends s{static get IDENTITY(){return function(){v||(v=new m,Object.freeze(v));return v}()}static get ZERO(){return function(){y||(y=new m([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(y));return y}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return a}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,i,r,o,s,a,A,u,l,c,h,f,p,d){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=r,this[5]=o,this[6]=s,this[7]=a,this[8]=A,this[9]=u,this[10]=l,this[11]=c,this[12]=h,this[13]=f,this[14]=p,this[15]=d,this.check()}setRowMajor(t,e,n,i,r,o,s,a,A,u,l,c,h,f,p,d){return this[0]=t,this[1]=r,this[2]=A,this[3]=h,this[4]=e,this[5]=o,this[6]=u,this[7]=f,this[8]=n,this[9]=s,this[10]=l,this[11]=p,this[12]=i,this[13]=a,this[14]=c,this[15]=d,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(_)}fromObject(t){return this.check()}fromQuaternion(t){return(0,u.I0)(this,t),this.check()}frustum(t){const{left:e,right:n,bottom:i,top:r,near:o=d,far:s=g}=t;return s===1/0?function(t,e,n,i,r,o){const s=2*o/(n-e),a=2*o/(r-i),A=(n+e)/(n-e),u=(r+i)/(r-i),l=-1,c=-1,h=-2*o;t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=A,t[9]=u,t[10]=l,t[11]=c,t[12]=0,t[13]=0,t[14]=h,t[15]=0}(this,e,n,i,r,o):(0,u.$h)(this,e,n,i,r,o,s),this.check()}lookAt(t){const{eye:e,center:n=[0,0,0],up:i=[0,1,0]}=t;return(0,u.t5)(this,e,n,i),this.check()}ortho(t){const{left:e,right:n,bottom:i,top:r,near:o=d,far:s=g}=t;return(0,u.v3)(this,e,n,i,r,o,s),this.check()}orthographic(t){const{fovy:e=f,aspect:n=p,focalDistance:i=1,near:r=d,far:o=g}=t;E(e);const s=e/2,a=i*Math.tan(s),A=a*n;return this.ortho({left:-A,right:A,bottom:-a,top:a,near:r,far:o})}perspective(t){const{fovy:e=45*Math.PI/180,aspect:n=1,near:i=.1,far:r=500}=t;return E(e),(0,u.fN)(this,e,n,i,r),this.check()}determinant(){return(0,u.a4)(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*r,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*r,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=this[4]*i,t[4]=this[5]*r,t[5]=this[6]*o,t[6]=this[8]*i,t[7]=this[9]*r,t[8]=this[10]*o,t}transpose(){return(0,u.mg)(this,this),this.check()}invert(){return(0,u.B8)(this,this),this.check()}multiplyLeft(t){return(0,u.lw)(this,t,this),this.check()}multiplyRight(t){return(0,u.lw)(this,this,t),this.check()}rotateX(t){return(0,u.eL)(this,this,t),this.check()}rotateY(t){return(0,u.Z8)(this,this,t),this.check()}rotateZ(t){return(0,u.Qr)(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,e){return(0,u.e$)(this,this,t,e),this.check()}scale(t){return(0,u.hs)(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return(0,u.Tl)(this,this,t),this.check()}transform(t,e){return 4===t.length?(e=(0,h.Z0)(e||[-0,-0,-0,-0],t,this),(0,r.qk)(e,4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;let i;switch(n){case 2:i=(0,l.Z0)(e||[-0,-0],t,this);break;case 3:i=(0,c.Z0)(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,r.qk)(i,t.length),i}transformAsVector(t,e){let n;switch(t.length){case 2:n=(0,A.B$)(e||[-0,-0],t,this);break;case 3:n=(0,A.cL)(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,r.qk)(n,t.length),n}transformPoint(t,e){return this.transformAsPoint(t,e)}transformVector(t,e){return this.transformAsPoint(t,e)}transformDirection(t,e){return this.transformAsVector(t,e)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}}let y,v;function E(t){if(t>2*Math.PI)throw Error("expected radians")}},7422:(t,e,n)=>{"use strict";n.d(e,{I:()=>A});var i=n(5715),r=n(4901),o=n(3731),s=n(3588),a=n(8225);class A extends i.M{constructor(t=0,e=0){super(2),(0,r.cy)(t)&&1===arguments.length?this.copy(t):(r.$W.debug&&((0,o.ws)(t),(0,o.ws)(e)),this[0]=t,this[1]=e)}set(t,e){return this[0]=t,this[1]=e,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return r.$W.debug&&((0,o.ws)(t.x),(0,o.ws)(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return(0,s.Z0)(this,this,t),this.check()}transformAsVector(t){return(0,a.B$)(this,this,t),this.check()}transformByMatrix3(t){return(0,s.ei)(this,this,t),this.check()}transformByMatrix2x3(t){return(0,s.l0)(this,this,t),this.check()}transformByMatrix2(t){return(0,s.ZF)(this,this,t),this.check()}}},7597:(t,e,n)=>{"use strict";n.d(e,{P:()=>l});var i=n(5715),r=n(4901),o=n(3731),s=n(2859),a=n(8225);const A=[0,0,0];let u;class l extends i.M{static get ZERO(){return u||(u=new l(0,0,0),Object.freeze(u)),u}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&(0,r.cy)(t)?this.copy(t):(r.$W.debug&&((0,o.ws)(t),(0,o.ws)(e),(0,o.ws)(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return r.$W.debug&&((0,o.ws)(t.x),(0,o.ws)(t.y),(0,o.ws)(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=(0,o.ws)(t)}angle(t){return(0,s.g7)(this,t)}cross(t){return(0,s.$A)(this,this,t),this.check()}rotateX({radians:t,origin:e=A}){return(0,s.eL)(this,this,e,t),this.check()}rotateY({radians:t,origin:e=A}){return(0,s.Z8)(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=A}){return(0,s.x6)(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return(0,s.Z0)(this,this,t),this.check()}transformAsVector(t){return(0,a.cL)(this,this,t),this.check()}transformByMatrix3(t){return(0,s.ei)(this,this,t),this.check()}transformByMatrix2(t){return(0,a.J4)(this,this,t),this.check()}transformByQuaternion(t){return(0,s.gL)(this,this,t),this.check()}}},741:(t,e,n)=>{"use strict";n.d(e,{p8:()=>i,tb:()=>r});const i=1e-6;let r="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI},218:(t,e,n)=>{"use strict";n.d(e,{$h:()=>d,B8:()=>o,I0:()=>p,Qr:()=>f,Tl:()=>A,Z8:()=>h,a4:()=>s,aI:()=>y,e$:()=>l,eL:()=>c,fN:()=>g,hs:()=>u,lw:()=>a,mg:()=>r,t5:()=>m,v3:()=>_});var i=n(741);function r(t,e){if(t===e){const n=e[1],i=e[2],r=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function o(t,e){const n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],A=e[6],u=e[7],l=e[8],c=e[9],h=e[10],f=e[11],p=e[12],d=e[13],g=e[14],_=e[15],m=n*a-i*s,y=n*A-r*s,v=n*u-o*s,E=i*A-r*a,b=i*u-o*a,w=r*u-o*A,x=l*d-c*p,S=l*g-h*p,C=l*_-f*p,T=c*g-h*d,I=c*_-f*d,R=h*_-f*g;let P=m*R-y*I+v*T+E*C-b*S+w*x;return P?(P=1/P,t[0]=(a*R-A*I+u*T)*P,t[1]=(r*I-i*R-o*T)*P,t[2]=(d*w-g*b+_*E)*P,t[3]=(h*b-c*w-f*E)*P,t[4]=(A*C-s*R-u*S)*P,t[5]=(n*R-r*C+o*S)*P,t[6]=(g*v-p*w-_*y)*P,t[7]=(l*w-h*v+f*y)*P,t[8]=(s*I-a*C+u*x)*P,t[9]=(i*C-n*I-o*x)*P,t[10]=(p*b-d*v+_*m)*P,t[11]=(c*v-l*b-f*m)*P,t[12]=(a*S-s*T-A*x)*P,t[13]=(n*T-i*S+r*x)*P,t[14]=(d*y-p*E-g*m)*P,t[15]=(l*E-c*y+h*m)*P,t):null}function s(t){const e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],A=t[7],u=t[8],l=t[9],c=t[10],h=t[11],f=t[12],p=t[13],d=t[14],g=e*s-n*o,_=e*a-i*o,m=n*a-i*s,y=u*p-l*f,v=u*d-c*f,E=l*d-c*p;return A*(e*E-n*v+i*y)-r*(o*E-s*v+a*y)+t[15]*(u*m-l*_+c*g)-h*(f*m-p*_+d*g)}function a(t,e,n){const i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],A=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],p=e[11],d=e[12],g=e[13],_=e[14],m=e[15];let y=n[0],v=n[1],E=n[2],b=n[3];return t[0]=y*i+v*a+E*c+b*d,t[1]=y*r+v*A+E*h+b*g,t[2]=y*o+v*u+E*f+b*_,t[3]=y*s+v*l+E*p+b*m,y=n[4],v=n[5],E=n[6],b=n[7],t[4]=y*i+v*a+E*c+b*d,t[5]=y*r+v*A+E*h+b*g,t[6]=y*o+v*u+E*f+b*_,t[7]=y*s+v*l+E*p+b*m,y=n[8],v=n[9],E=n[10],b=n[11],t[8]=y*i+v*a+E*c+b*d,t[9]=y*r+v*A+E*h+b*g,t[10]=y*o+v*u+E*f+b*_,t[11]=y*s+v*l+E*p+b*m,y=n[12],v=n[13],E=n[14],b=n[15],t[12]=y*i+v*a+E*c+b*d,t[13]=y*r+v*A+E*h+b*g,t[14]=y*o+v*u+E*f+b*_,t[15]=y*s+v*l+E*p+b*m,t}function A(t,e,n){const i=n[0],r=n[1],o=n[2];let s,a,A,u,l,c,h,f,p,d,g,_;return e===t?(t[12]=e[0]*i+e[4]*r+e[8]*o+e[12],t[13]=e[1]*i+e[5]*r+e[9]*o+e[13],t[14]=e[2]*i+e[6]*r+e[10]*o+e[14],t[15]=e[3]*i+e[7]*r+e[11]*o+e[15]):(s=e[0],a=e[1],A=e[2],u=e[3],l=e[4],c=e[5],h=e[6],f=e[7],p=e[8],d=e[9],g=e[10],_=e[11],t[0]=s,t[1]=a,t[2]=A,t[3]=u,t[4]=l,t[5]=c,t[6]=h,t[7]=f,t[8]=p,t[9]=d,t[10]=g,t[11]=_,t[12]=s*i+l*r+p*o+e[12],t[13]=a*i+c*r+d*o+e[13],t[14]=A*i+h*r+g*o+e[14],t[15]=u*i+f*r+_*o+e[15]),t}function u(t,e,n){const i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function l(t,e,n,r){let o,s,a,A,u,l,c,h,f,p,d,g,_,m,y,v,E,b,w,x,S,C,T,I,R=r[0],P=r[1],M=r[2],L=Math.sqrt(R*R+P*P+M*M);return L<i.p8?null:(L=1/L,R*=L,P*=L,M*=L,s=Math.sin(n),o=Math.cos(n),a=1-o,A=e[0],u=e[1],l=e[2],c=e[3],h=e[4],f=e[5],p=e[6],d=e[7],g=e[8],_=e[9],m=e[10],y=e[11],v=R*R*a+o,E=P*R*a+M*s,b=M*R*a-P*s,w=R*P*a-M*s,x=P*P*a+o,S=M*P*a+R*s,C=R*M*a+P*s,T=P*M*a-R*s,I=M*M*a+o,t[0]=A*v+h*E+g*b,t[1]=u*v+f*E+_*b,t[2]=l*v+p*E+m*b,t[3]=c*v+d*E+y*b,t[4]=A*w+h*x+g*S,t[5]=u*w+f*x+_*S,t[6]=l*w+p*x+m*S,t[7]=c*w+d*x+y*S,t[8]=A*C+h*T+g*I,t[9]=u*C+f*T+_*I,t[10]=l*C+p*T+m*I,t[11]=c*C+d*T+y*I,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function c(t,e,n){const i=Math.sin(n),r=Math.cos(n),o=e[4],s=e[5],a=e[6],A=e[7],u=e[8],l=e[9],c=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+u*i,t[5]=s*r+l*i,t[6]=a*r+c*i,t[7]=A*r+h*i,t[8]=u*r-o*i,t[9]=l*r-s*i,t[10]=c*r-a*i,t[11]=h*r-A*i,t}function h(t,e,n){const i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],A=e[3],u=e[8],l=e[9],c=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-u*i,t[1]=s*r-l*i,t[2]=a*r-c*i,t[3]=A*r-h*i,t[8]=o*i+u*r,t[9]=s*i+l*r,t[10]=a*i+c*r,t[11]=A*i+h*r,t}function f(t,e,n){const i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],A=e[3],u=e[4],l=e[5],c=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+u*i,t[1]=s*r+l*i,t[2]=a*r+c*i,t[3]=A*r+h*i,t[4]=u*r-o*i,t[5]=l*r-s*i,t[6]=c*r-a*i,t[7]=h*r-A*i,t}function p(t,e){const n=e[0],i=e[1],r=e[2],o=e[3],s=n+n,a=i+i,A=r+r,u=n*s,l=i*s,c=i*a,h=r*s,f=r*a,p=r*A,d=o*s,g=o*a,_=o*A;return t[0]=1-c-p,t[1]=l+_,t[2]=h-g,t[3]=0,t[4]=l-_,t[5]=1-u-p,t[6]=f+d,t[7]=0,t[8]=h+g,t[9]=f-d,t[10]=1-u-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function d(t,e,n,i,r,o,s){const a=1/(n-e),A=1/(r-i),u=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*A,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*A,t[10]=(s+o)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*u,t[15]=0,t}const g=function(t,e,n,i,r){const o=1/Math.tan(e/2);if(t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0){const e=1/(i-r);t[10]=(r+i)*e,t[14]=2*r*i*e}else t[10]=-1,t[14]=-2*i;return t};const _=function(t,e,n,i,r,o,s){const a=1/(e-n),A=1/(i-r),u=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*A,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*A,t[14]=(s+o)*u,t[15]=1,t};function m(t,e,n,r){let o,s,a,A,u,l,c,h,f,p;const d=e[0],g=e[1],_=e[2],m=r[0],y=r[1],v=r[2],E=n[0],b=n[1],w=n[2];return Math.abs(d-E)<i.p8&&Math.abs(g-b)<i.p8&&Math.abs(_-w)<i.p8?function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(t):(h=d-E,f=g-b,p=_-w,o=1/Math.sqrt(h*h+f*f+p*p),h*=o,f*=o,p*=o,s=y*p-v*f,a=v*h-m*p,A=m*f-y*h,o=Math.sqrt(s*s+a*a+A*A),o?(o=1/o,s*=o,a*=o,A*=o):(s=0,a=0,A=0),u=f*A-p*a,l=p*s-h*A,c=h*a-f*s,o=Math.sqrt(u*u+l*l+c*c),o?(o=1/o,u*=o,l*=o,c*=o):(u=0,l=0,c=0),t[0]=s,t[1]=u,t[2]=h,t[3]=0,t[4]=a,t[5]=l,t[6]=f,t[7]=0,t[8]=A,t[9]=c,t[10]=p,t[11]=0,t[12]=-(s*d+a*g+A*_),t[13]=-(u*d+l*g+c*_),t[14]=-(h*d+f*g+p*_),t[15]=1,t)}function y(t,e){const n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],A=t[5],u=t[6],l=t[7],c=t[8],h=t[9],f=t[10],p=t[11],d=t[12],g=t[13],_=t[14],m=t[15],y=e[0],v=e[1],E=e[2],b=e[3],w=e[4],x=e[5],S=e[6],C=e[7],T=e[8],I=e[9],R=e[10],P=e[11],M=e[12],L=e[13],N=e[14],O=e[15];return Math.abs(n-y)<=i.p8*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-v)<=i.p8*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(o-E)<=i.p8*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(s-b)<=i.p8*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(a-w)<=i.p8*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(A-x)<=i.p8*Math.max(1,Math.abs(A),Math.abs(x))&&Math.abs(u-S)<=i.p8*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(l-C)<=i.p8*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(c-T)<=i.p8*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(h-I)<=i.p8*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(f-R)<=i.p8*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(p-P)<=i.p8*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(d-M)<=i.p8*Math.max(1,Math.abs(d),Math.abs(M))&&Math.abs(g-L)<=i.p8*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(_-N)<=i.p8*Math.max(1,Math.abs(_),Math.abs(N))&&Math.abs(m-O)<=i.p8*Math.max(1,Math.abs(m),Math.abs(O))}},3588:(t,e,n)=>{"use strict";n.d(e,{Cc:()=>s,WQ:()=>r,Z0:()=>l,ZF:()=>a,ei:()=>u,l0:()=>A,ze:()=>o});var i=n(741);function r(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function o(t,e){return t[0]=-e[0],t[1]=-e[1],t}function s(t,e,n,i){const r=e[0],o=e[1];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t}function a(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t}function A(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t}function u(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t}function l(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}!function(){const t=function(){const t=new i.tb(2);return i.tb!=Float32Array&&(t[0]=0,t[1]=0),t}()}()},2859:(t,e,n)=>{"use strict";n.d(e,{$A:()=>a,WQ:()=>r,Z0:()=>A,Z8:()=>h,eL:()=>c,ei:()=>u,g7:()=>p,gL:()=>l,jb:()=>d,lK:()=>g,x6:()=>f,ze:()=>o});var i=n(741);function r(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function o(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function s(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function a(t,e,n){const i=e[0],r=e[1],o=e[2],s=n[0],a=n[1],A=n[2];return t[0]=r*A-o*a,t[1]=o*s-i*A,t[2]=i*a-r*s,t}function A(t,e,n){const i=e[0],r=e[1],o=e[2];let s=n[3]*i+n[7]*r+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/s,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/s,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/s,t}function u(t,e,n){const i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t}function l(t,e,n){const i=n[0],r=n[1],o=n[2],s=n[3],a=e[0],A=e[1],u=e[2];let l=r*u-o*A,c=o*a-i*u,h=i*A-r*a,f=r*h-o*c,p=o*l-i*h,d=i*c-r*l;const g=2*s;return l*=g,c*=g,h*=g,f*=2,p*=2,d*=2,t[0]=a+l+f,t[1]=A+c+p,t[2]=u+h+d,t}function c(t,e,n,i){const r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),o[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function h(t,e,n,i){const r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),o[1]=r[1],o[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function f(t,e,n,i){const r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function p(t,e){const n=t[0],i=t[1],r=t[2],o=e[0],a=e[1],A=e[2],u=Math.sqrt((n*n+i*i+r*r)*(o*o+a*a+A*A)),l=u&&s(t,e)/u;return Math.acos(Math.min(Math.max(l,-1),1))}const d=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},g=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t};!function(){const t=function(){const t=new i.tb(3);return i.tb!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}()},9426:(t,e,n)=>{"use strict";n.d(e,{Z0:()=>o,hs:()=>r});var i=n(741);function r(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function o(t,e,n){const i=e[0],r=e[1],o=e[2],s=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*s,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*s,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*s,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*s,t}!function(){const t=function(){const t=new i.tb(4);return i.tb!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}()},4901:(t,e,n)=>{"use strict";n.d(e,{$W:()=>i,Cc:()=>a,Fl:()=>r,aI:()=>A,cy:()=>o,qE:()=>s});Math.PI,Math.PI;globalThis.mathgl=globalThis.mathgl||{config:{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1}};const i=globalThis.mathgl.config;function r(t,{precision:e=i.precision}={}){return t=function(t){return Math.round(t/i.EPSILON)*i.EPSILON}(t),"".concat(parseFloat(t.toPrecision(e)))}function o(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function s(t,e,n){return u(t,(t=>Math.max(e,Math.min(n,t))))}function a(t,e,n){return o(t)?t.map(((t,i)=>a(t,e[i],n))):n*e+(1-n)*t}function A(t,e,n){const r=i.EPSILON;n&&(i.EPSILON=n);try{if(t===e)return!0;if(o(t)&&o(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!A(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):"number"==typeof t&&"number"==typeof e&&Math.abs(t-e)<=i.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{i.EPSILON=r}}function u(t,e,n){if(o(t)){const i=t;n=n||function(t){return t.clone?t.clone():new Array(t.length)}(i);for(let r=0;r<n.length&&r<i.length;++r){const i="number"==typeof t?t:t[r];n[r]=e(i,r,n)}return n}return e(t)}},8225:(t,e,n)=>{"use strict";function i(t,e,n){const i=e[0],r=e[1],o=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/o,t[1]=(n[1]*i+n[5]*r)/o,t}function r(t,e,n){const i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o||1;return t[0]=(n[0]*i+n[4]*r+n[8]*o)/s,t[1]=(n[1]*i+n[5]*r+n[9]*o)/s,t[2]=(n[2]*i+n[6]*r+n[10]*o)/s,t}function o(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t}n.d(e,{B$:()=>i,J4:()=>o,cL:()=>r})},3731:(t,e,n)=>{"use strict";n.d(e,{qk:()=>o,ws:()=>r});var i=n(4901);function r(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(JSON.stringify(t)));return t}function o(t,e,n=""){if(i.$W.debug&&!function(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}},1746:(t,e,n)=>{"use strict";n.d(e,{rJ:()=>i,wk:()=>p,Eg:()=>b,Mk:()=>c,Iy:()=>E,UD:()=>r});const i={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function r(t,e,n={}){const i=function(t,e={}){return Math.sign(function(t,e={}){const{start:n=0,end:i=t.length,plane:r="xy"}=e,s=e.size||2;let a=0;const A=o[r[0]],u=o[r[1]];for(let o=n,l=i-s;o<i;o+=s)a+=(t[o+A]-t[l+A])*(t[o+u]+t[l+u]),l=o;return a/2}(t,e))}(t,n);return i!==e&&(function(t,e){const{start:n=0,end:i=t.length,size:r=2}=e,o=(i-n)/r,s=Math.floor(o/2);for(let a=0;a<s;++a){const e=n+a*r,i=n+(o-1-a)*r;for(let n=0;n<r;++n){const r=t[e+n];t[e+n]=t[i+n],t[i+n]=r}}}(t,n),!0)}const o={x:0,y:1,z:2};function s(t,e,n,i,r=[]){let o,s;if(8&n)o=(i[3]-t[1])/(e[1]-t[1]),s=3;else if(4&n)o=(i[1]-t[1])/(e[1]-t[1]),s=1;else if(2&n)o=(i[2]-t[0])/(e[0]-t[0]),s=2;else{if(!(1&n))return null;o=(i[0]-t[0])/(e[0]-t[0]),s=0}for(let a=0;a<t.length;a++)r[a]=(1&s)===a?i[s]:o*(e[a]-t[a])+t[a];return r}function a(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function A(t,e){const n=e.length,i=t.length;if(i>0){let r=!0;for(let o=0;o<n;o++)if(t[i-n+o]!==e[o]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)t[i+r]=e[r];return!0}function u(t,e){const n=e.length;for(let i=0;i<n;i++)t[i]=e[i]}function l(t,e,n,i,r=[]){const o=i+e*n;for(let s=0;s<n;s++)r[s]=t[o+s];return r}function c(t,e){const{size:n=2,broken:i=!1,gridResolution:r=10,gridOffset:o=[0,0],startIndex:c=0,endIndex:h=t.length}=e||{},f=(h-c)/n;let p=[];const d=[p],m=l(t,0,n,c);let y,v;const E=g(m,r,o,[]),b=[];A(p,m);for(let g=1;g<f;g++){for(y=l(t,g,n,c,y),v=a(y,E);v;){s(m,y,v,E,b);const t=a(b,E);t&&(s(m,b,t,E,b),v=t),A(p,b),u(m,b),_(E,r,v),i&&p.length>n&&(p=[],d.push(p),A(p,m)),v=a(y,E)}A(p,y),u(m,y)}return i?d:d[0]}const h=0,f=1;function p(t,e=null,n){if(!t.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n||{},A=[],u=[{pos:t,types:s?new Array(t.length/i).fill(f):null,holes:e||[]}],l=[[],[]];let c=[];for(;u.length;){const{pos:t,types:e,holes:n}=u.shift();m(t,i,n[0]||t.length,l),c=g(l[0],r,o,c);const h=a(l[1],c);if(h){let r=d(t,e,i,0,n[0]||t.length,c,h);const o={pos:r[0].pos,types:r[0].types,holes:[]},a={pos:r[1].pos,types:r[1].types,holes:[]};u.push(o,a);for(let A=0;A<n.length;A++)r=d(t,e,i,n[A],n[A+1]||t.length,c,h),r[0]&&(o.holes.push(o.pos.length),o.pos=y(o.pos,r[0].pos),s&&(o.types=y(o.types,r[0].types))),r[1]&&(a.holes.push(a.pos.length),a.pos=y(a.pos,r[1].pos),s&&(a.types=y(a.types,r[1].types)))}else{const i={positions:t};s&&(i.edgeTypes=e),n.length&&(i.holeIndices=n),A.push(i)}}return A}function d(t,e,n,i,r,o,a){const c=(r-i)/n,f=[],p=[],d=[],g=[],_=[];let m,y,v;const E=l(t,c-1,n,i);let b=Math.sign(8&a?E[1]-o[3]:E[0]-o[2]),w=e&&e[c-1],x=0,S=0;for(let C=0;C<c;C++)m=l(t,C,n,i,m),y=Math.sign(8&a?m[1]-o[3]:m[0]-o[2]),v=e&&e[i/n+C],y&&b&&b!==y&&(s(E,m,a,o,_),A(f,_)&&d.push(w),A(p,_)&&g.push(w)),y<=0?(A(f,m)&&d.push(v),x-=y):d.length&&(d[d.length-1]=h),y>=0?(A(p,m)&&g.push(v),S+=y):g.length&&(g[g.length-1]=h),u(E,m),b=y,w=v;return[x?{pos:f,types:e&&d}:null,S?{pos:p,types:e&&g}:null]}function g(t,e,n,i){const r=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return i[0]=r,i[1]=o,i[2]=r+e,i[3]=o+e,i}function _(t,e,n){8&n?(t[1]+=e,t[3]+=e):4&n?(t[1]-=e,t[3]-=e):2&n?(t[0]+=e,t[2]+=e):1&n&&(t[0]-=e,t[2]-=e)}function m(t,e,n,i){let r=1/0,o=-1/0,s=1/0,a=-1/0;for(let A=0;A<n;A+=e){const e=t[A],n=t[A+1];r=e<r?e:r,o=e>o?e:o,s=n<s?n:s,a=n>a?n:a}return i[0][0]=r,i[0][1]=s,i[1][0]=o,i[1][1]=a,i}function y(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}const v=85.051129;function E(t,e){const{size:n=2,startIndex:i=0,endIndex:r=t.length,normalize:o=!0}=e||{},s=t.slice(i,r);S(s,n,0,r-i);const a=c(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const A of a)C(A,n);return a}function b(t,e=null,n){const{size:i=2,normalize:r=!0,edgeTypes:o=!1}=n||{};e=e||[];const s=[],a=[];let A=0,u=0;for(let c=0;c<=e.length;c++){const r=e[c]||t.length,o=u,l=w(t,i,A,r);for(let e=l;e<r;e++)s[u++]=t[e];for(let e=A;e<l;e++)s[u++]=t[e];S(s,i,o,u),x(s,i,o,u,null==n?void 0:n.maxLatitude),A=r,a[c]=u}a.pop();const l=p(s,a,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(r)for(const c of l)C(c.positions,i);return l}function w(t,e,n,i){let r=-1,o=-1;for(let s=n+1;s<i;s+=e){const e=Math.abs(t[s]);e>r&&(r=e,o=s-1)}return o}function x(t,e,n,i,r=v){const o=t[n],s=t[i-e];if(Math.abs(o-s)>180){const i=l(t,0,e,n);i[0]+=360*Math.round((s-o)/360),A(t,i),i[1]=Math.sign(i[1])*r,A(t,i),i[0]=o,A(t,i)}}function S(t,e,n,i){let r,o=t[0];for(let s=n;s<i;s+=e){r=t[s];const e=r-o;(e>180||e<-180)&&(r-=360*Math.round(e/360)),t[s]=o=r}}function C(t,e){let n;const i=t.length/e;for(let o=0;o<i&&(n=t[o*e],(n+180)%360==0);o++);const r=360*-Math.round(n/360);if(0!==r)for(let o=0;o<i;o++)t[o*e]+=r}},4697:(t,e,n)=>{"use strict";n.d(e,{KH:()=>k,dT:()=>C,Os:()=>R,Fe:()=>N,wZ:()=>P,gW:()=>D,nI:()=>S,fO:()=>w,om:()=>I,rY:()=>T,Gw:()=>E,CK:()=>U,xJ:()=>L,mY:()=>x,iV:()=>b,VJ:()=>M});var i=n(9842),r=n(9426);function o(t,e){const n=r.Z0([],e,t);return r.hs(n,n,1/n[3]),n}function s(t,e){const n=t%e;return n<0?e+n:n}function a(t,e,n){return t<e?e:t>n?n:t}const A=Math.log2||function(t){return Math.log(t)*Math.LOG2E};var u=n(218),l=n(2859),c=n(3588);function h(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const f=Math.PI,p=f/4,d=f/180,g=180/f,_=512,m=4003e4,y=85.051129,v=1.5;function E(t){const[e,n]=t;h(Number.isFinite(e)),h(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const i=n*d;return[_*(e*d+f)/(2*f),_*(f+Math.log(Math.tan(p+.5*i)))/(2*f)]}function b(t){const[e,n]=t,i=e/_*(2*f)-f,r=2*(Math.atan(Math.exp(n/_*(2*f)-f))-p);return[i*g,r*g]}function w(t){const{latitude:e}=t;h(Number.isFinite(e));const n=Math.cos(e*d);return A(m*n)-9}function x(t){const e=Math.cos(t*d);return _/m/e}function S(t){const{latitude:e,longitude:n,highPrecision:i=!1}=t;h(Number.isFinite(e)&&Number.isFinite(n));const r=_,o=Math.cos(e*d),s=r/360,a=s/o,A=r/m/o,u={unitsPerMeter:[A,A,A],metersPerUnit:[1/A,1/A,1/A],unitsPerDegree:[s,a,A],degreesPerUnit:[1/s,1/a,1/A]};if(i){const t=d*Math.tan(e*d)/o,n=s*t/2,i=r/m*t,l=i/a*A;u.unitsPerDegree2=[0,n,i],u.unitsPerMeter2=[l,0,l]}return u}function C(t,e){const[n,i,r]=t,[o,s,a]=e,{unitsPerMeter:A,unitsPerMeter2:u}=S({longitude:n,latitude:i,highPrecision:!0}),l=E(t);l[0]+=o*(A[0]+u[0]*s),l[1]+=s*(A[1]+u[1]*s);const c=b(l),h=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[c[0],c[1],h]:c}function T(t){const{height:e,pitch:n,bearing:i,altitude:r,scale:o,center:s}=t,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u.Tl(a,a,[0,0,-r]),u.eL(a,a,-n*d),u.Qr(a,a,i*d);const A=o/e;return u.hs(a,a,[A,A,A]),s&&u.Tl(a,a,l.ze([],s)),a}function I(t){const{width:e,height:n,altitude:i,pitch:r=0,offset:o,center:s,scale:A,nearZMultiplier:u=1,farZMultiplier:l=1}=t;let{fovy:c=R(v)}=t;void 0!==i&&(c=R(i));const h=c*d,f=r*d,p=P(c);let g=p;s&&(g+=s[2]*A/Math.cos(f)/n);const _=h*(.5+(o?o[1]:0)/n),m=Math.sin(_)*g/Math.sin(a(Math.PI/2-f-_,.01,Math.PI-.01)),y=Math.sin(f)*m+g,E=10*g;return{fov:h,aspect:e/n,focalDistance:p,near:u,far:Math.min(y*l,E)}}function R(t){return 2*Math.atan(.5/t)*g}function P(t){return.5/Math.tan(.5*t*d)}function M(t,e){const[n,i,r=0]=t;return h(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(r)),o(e,[n,i,r,1])}function L(t,e,n=0){const[i,r,s]=t;if(h(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s)){return o(e,[i,r,s,1])}const a=o(e,[i,r,0,1]),A=o(e,[i,r,1,1]),u=a[2],l=A[2],f=u===l?0:((n||0)-u)/(l-u);return c.Cc([],a,A,f)}function N(t){const{width:e,height:n,bounds:i,minExtent:r=0,maxZoom:o=24,offset:s=[0,0]}=t,[[u,l],[c,f]]=i,p=function(t=0){if("number"==typeof t)return{top:t,bottom:t,left:t,right:t};return h(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t}(t.padding),d=E([u,a(f,-y,y)]),g=E([c,a(l,-y,y)]),_=[Math.max(Math.abs(g[0]-d[0]),r),Math.max(Math.abs(g[1]-d[1]),r)],m=[e-p.left-p.right-2*Math.abs(s[0]),n-p.top-p.bottom-2*Math.abs(s[1])];h(m[0]>0&&m[1]>0);const v=m[0]/_[0],w=m[1]/_[1],x=(p.right-p.left)/2/v,S=(p.top-p.bottom)/2/w,C=b([(g[0]+d[0])/2+x,(g[1]+d[1])/2+S]),T=Math.min(o,A(Math.abs(Math.min(v,w))));return h(Number.isFinite(T)),{longitude:C[0],latitude:C[1],zoom:T}}const O=Math.PI/180;function D(t,e=0){const{width:n,height:i,unproject:r}=t,o={targetZ:e},s=r([0,i],o),a=r([n,i],o);let A,u;return(t.fovy?.5*t.fovy*O:Math.atan(.5/t.altitude))>(90-t.pitch)*O-.01?(A=F(t,0,e),u=F(t,n,e)):(A=r([0,0],o),u=r([n,0],o)),[s,a,u,A]}function F(t,e,n){const{pixelUnprojectionMatrix:i}=t,r=o(i,[e,0,1,1]),s=o(i,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2]),A=b(c.Cc([],r,s,a));return A.push(n),A}class k{constructor(t={width:1,height:1}){(0,i.A)(this,"latitude",void 0),(0,i.A)(this,"longitude",void 0),(0,i.A)(this,"zoom",void 0),(0,i.A)(this,"pitch",void 0),(0,i.A)(this,"bearing",void 0),(0,i.A)(this,"altitude",void 0),(0,i.A)(this,"fovy",void 0),(0,i.A)(this,"meterOffset",void 0),(0,i.A)(this,"center",void 0),(0,i.A)(this,"width",void 0),(0,i.A)(this,"height",void 0),(0,i.A)(this,"scale",void 0),(0,i.A)(this,"distanceScales",void 0),(0,i.A)(this,"viewMatrix",void 0),(0,i.A)(this,"projectionMatrix",void 0),(0,i.A)(this,"viewProjectionMatrix",void 0),(0,i.A)(this,"pixelProjectionMatrix",void 0),(0,i.A)(this,"pixelUnprojectionMatrix",void 0),(0,i.A)(this,"equals",(t=>t instanceof k&&(t.width===this.width&&t.height===this.height&&u.aI(t.projectionMatrix,this.projectionMatrix)&&u.aI(t.viewMatrix,this.viewMatrix)))),(0,i.A)(this,"project",((t,e={})=>{const{topLeft:n=!0}=e,i=M(this.projectPosition(t),this.pixelProjectionMatrix),[r,o]=i,s=n?o:this.height-o;return 2===t.length?[r,s]:[r,s,i[2]]})),(0,i.A)(this,"unproject",((t,e={})=>{const{topLeft:n=!0,targetZ:i}=e,[r,o,s]=t,a=n?o:this.height-o,A=i&&i*this.distanceScales.unitsPerMeter[2],u=L([r,a,s],this.pixelUnprojectionMatrix,A),[l,c,h]=this.unprojectPosition(u);return Number.isFinite(s)?[l,c,h]:Number.isFinite(i)?[l,c,i]:[l,c]})),(0,i.A)(this,"projectPosition",(t=>{const[e,n]=E(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]})),(0,i.A)(this,"unprojectPosition",(t=>{const[e,n]=b(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}));let{width:e,height:n,altitude:r=null,fovy:o=null}=t;const{latitude:s=0,longitude:a=0,zoom:A=0,pitch:c=0,bearing:h=0,position:f=null,nearZMultiplier:p=.02,farZMultiplier:d=1.01}=t;e=e||1,n=n||1,null===o&&null===r?(r=v,o=R(r)):null===o?o=R(r):null===r&&(r=P(o));const g=function(t){return Math.pow(2,t)}(A);r=Math.max(.75,r);const _=S({longitude:a,latitude:s}),m=E([a,s]);m.push(0),f&&l.WQ(m,m,l.lK([],f,_.unitsPerMeter)),this.projectionMatrix=function(t){const{fov:e,aspect:n,near:i,far:r}=I(t);return u.fN([],e,n,i,r)}({width:e,height:n,scale:g,center:m,pitch:c,fovy:o,nearZMultiplier:p,farZMultiplier:d}),this.viewMatrix=T({height:n,scale:g,center:m,pitch:c,bearing:h,altitude:r}),this.width=e,this.height=n,this.scale=g,this.latitude=s,this.longitude=a,this.zoom=A,this.pitch=c,this.bearing=h,this.altitude=r,this.fovy=o,this.center=m,this.meterOffset=f||[0,0,0],this.distanceScales=_,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:t,height:e,projectionMatrix:n,viewMatrix:i}=this,r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u.lw(r,r,n),u.lw(r,r,i),this.viewProjectionMatrix=r;const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u.hs(o,o,[t/2,-e/2,1]),u.Tl(o,o,[1,-1,0]),u.lw(o,o,r);const s=u.B8([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o);if(!s)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=s}projectFlat(t){return E(t)}unprojectFlat(t){return b(t)}getMapCenterByLngLatPosition({lngLat:t,pos:e}){const n=L(e,this.pixelUnprojectionMatrix),i=E(t),r=c.WQ([],i,c.ze([],n));return b(c.WQ([],this.center,r))}fitBounds(t,e={}){const{width:n,height:i}=this,{longitude:r,latitude:o,zoom:s}=N(Object.assign({width:n,height:i,bounds:t},e));return new k({width:n,height:i,longitude:r,latitude:o,zoom:s})}getBounds(t){const e=this.getBoundingRegion(t),n=Math.min(...e.map((t=>t[0]))),i=Math.max(...e.map((t=>t[0])));return[[n,Math.min(...e.map((t=>t[1])))],[i,Math.max(...e.map((t=>t[1])))]]}getBoundingRegion(t={}){return D(this,t.z||0)}getLocationAtPoint({lngLat:t,pos:e}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:e})}}const B=512;function U(t){const{width:e,height:n,pitch:i=0}=t;let{longitude:r,latitude:o,zoom:a,bearing:u=0}=t;(r<-180||r>180)&&(r=s(r+180,360)-180),(u<-180||u>180)&&(u=s(u+180,360)-180);const l=A(n/B);if(a<=l)a=l,o=0;else{const t=n/2/Math.pow(2,a),e=b([0,t])[1];if(o<e)o=e;else{const e=b([0,B-t])[1];o>e&&(o=e)}}return{width:e,height:n,longitude:r,latitude:o,zoom:a,pitch:i,bearing:u}}},5526:(t,e,n)=>{"use strict";n.d(e,{eh:()=>r,gM:()=>o,x:()=>i});globalThis.self||globalThis.window||globalThis.global;const i=globalThis.window||globalThis.self||globalThis.global,r=(globalThis.document,globalThis.process||{}),o=(globalThis.console,globalThis.navigator||{})},6769:(t,e,n)=>{"use strict";n.d(e,{A:()=>r});var i=n(5399);function r(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||(0,i.A)()}},5399:(t,e,n)=>{"use strict";function i(t){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}n.d(e,{A:()=>i})},1369:(t,e,n)=>{"use strict";n.d(e,{t:()=>_});var i=n(6769);const r="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source";(0,i.A)();class o{constructor(t,e,n="sessionStorage"){this.storage=function(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(e){return null}}(n),this.id=t,this.config=e,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}var s;!function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(s||(s={}));const a=10;function A(t){return"string"!=typeof t?t:(t=t.toUpperCase(),s[t]||s.WHITE)}function u(t,e){if(!t)throw new Error(e||"Assertion failed")}var l=n(5526);function c(){let t;if((0,i.A)()&&l.x.performance)t=l.x?.performance?.now?.();else if("hrtime"in l.eh){const e=l.eh?.hrtime?.();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}const h={debug:(0,i.A)()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},f={enabled:!0,level:0};function p(){}const d={},g={once:!0};class _{constructor({id:t}={id:""}){this.VERSION=r,this._startTs=c(),this._deltaTs=c(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=t,this.userData={},this._storage=new o(`__probe-${this.id}__`,f),this.timeStamp(`${this.id} started`),function(t,e=["constructor"]){const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n),r=t;for(const o of i){const n=r[o];"function"==typeof n&&(e.find((t=>o===t))||(r[o]=n.bind(t)))}}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((c()-this._startTs).toPrecision(10))}getDelta(){return Number((c()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,e){this._storage.setConfiguration({[t]:e})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,e){if(!t)throw new Error(e||"Assertion failed")}warn(t){return this._getLogFunction(0,t,h.warn,arguments,g)}error(t){return this._getLogFunction(0,t,h.error,arguments)}deprecated(t,e){return this.warn(`\`${t}\` is deprecated and will be removed in a later version. Use \`${e}\` instead`)}removed(t,e){return this.error(`\`${t}\` has been removed. Use \`${e}\` instead`)}probe(t,e){return this._getLogFunction(t,e,h.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,h.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){return this._getLogFunction(t,e,h.debug||h.info,arguments,g)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||p,n&&[n],{tag:v(e)}):p}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||p)}group(t,e,n={collapsed:!1}){const i=y({logLevel:t,message:e,opts:n}),{collapsed:r}=n;return i.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,e,n={}){return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||p)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=m(t)}_getLogFunction(t,e,n,r,o){if(this._shouldLog(t)){o=y({logLevel:t,message:e,args:r,opts:o}),u(n=n||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=c();const s=o.tag||o.message;if(o.once&&s){if(d[s])return p;d[s]=c()}return e=function(t,e,n){if("string"==typeof e){const r=n.time?function(t,e=8){const n=Math.max(e-t.length,0);return`${" ".repeat(n)}${t}`}(function(t){let e;return e=t<10?`${t.toFixed(2)}ms`:t<100?`${t.toFixed(1)}ms`:t<1e3?`${t.toFixed(0)}ms`:`${(t/1e3).toFixed(2)}s`,e}(n.total)):"";e=function(t,e,n){i.A||"string"!=typeof t||(e&&(t=`\x1b[${A(e)}m${t}\x1b[39m`),n&&(t=`\x1b[${A(n)+a}m${t}\x1b[49m`));return t}(e=n.time?`${t}: ${r}  ${e}`:`${t}: ${e}`,n.color,n.background)}return e}(this.id,o.message,o),n.bind(console,e,...o.args)}return p}}function m(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return u(Number.isFinite(e)&&e>=0),e}function y(t){const{logLevel:e,message:n}=t;t.logLevel=m(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":void 0!==n&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"==typeof t.message&&(t.message=t.message());const r=typeof t.message;return u("string"===r||"object"===r),Object.assign(t,{args:i},t.opts)}function v(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}_.VERSION=r},9842:(t,e,n)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}function o(t,e,n){return(e=r(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{A:()=>o})},8453:(t,e,n)=>{"use strict";n.d(e,{R:()=>s,x:()=>a});var i=n(6540);const r={},o=i.createContext(r);function s(t){const e=i.useContext(o);return i.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function a(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(r):t.components||r:s(t.components),i.createElement(o.Provider,{value:e},t.children)}},491:(t,e,n)=>{"use strict";n.d(e,{A:()=>A});var i=n(7604),r=n(6558),o=n(669),s=n(3279),a=n(5046);function A(t,e,n){void 0===n&&(n={});for(var A=(0,a.bg)(t).coordinates,u=0,l=0;l<A.length&&!(e>=u&&l===A.length-1);l++){if(u>=e){var c=e-u;if(c){var h=(0,i.A)(A[l],A[l-1])-180;return(0,r.A)(A[l],c,h,n)}return(0,s.zx)(A[l])}u+=(0,o.A)(A[l],A[l+1],n)}return(0,s.zx)(A[A.length-1])}},999:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(9987),r=6378137;function o(t){return(0,i.jE)(t,(function(t,e){return t+function(t){var e,n=0;switch(t.type){case"Polygon":return s(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)n+=s(t.coordinates[e]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}function s(t){var e=0;if(t&&t.length>0){e+=Math.abs(a(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(a(t[n]))}return e}function a(t){var e,n,i,o,s,a,u=0,l=t.length;if(l>2){for(a=0;a<l;a++)a===l-2?(i=l-2,o=l-1,s=0):a===l-1?(i=l-1,o=0,s=1):(i=a,o=a+1,s=a+2),e=t[i],n=t[o],u+=(A(t[s][0])-A(e[0]))*Math.sin(A(n[1]));u=u*r*r/2}return u}function A(t){return t*Math.PI/180}},1234:(t,e,n)=>{"use strict";n.d(e,{A:()=>r});var i=n(3279);function r(t,e){void 0===e&&(e={});var n=Number(t[0]),r=Number(t[1]),o=Number(t[2]),s=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[n,r],A=[n,s],u=[o,s],l=[o,r];return(0,i.n1)([[a,l,u,A,a]],e.properties,{bbox:t,id:e.id})}},5917:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(9987);function r(t){var e=[1/0,1/0,-1/0,-1/0];return(0,i.Fh)(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}r.default=r;const o=r},7604:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(3279),r=n(5046);function o(t,e,n){if(void 0===n&&(n={}),!0===n.final)return function(t,e){var n=o(e,t);return n=(n+180)%360}(t,e);var s=(0,r.uG)(t),a=(0,r.uG)(e),A=(0,i.tR)(s[0]),u=(0,i.tR)(a[0]),l=(0,i.tR)(s[1]),c=(0,i.tR)(a[1]),h=Math.sin(u-A)*Math.cos(c),f=Math.cos(l)*Math.sin(c)-Math.sin(l)*Math.cos(c)*Math.cos(u-A);return(0,i.nv)(Math.atan2(h,f))}},2608:(t,e,n)=>{"use strict";n.d(e,{A:()=>r});var i=n(5046);function r(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=(0,i.uG)(t),s=(0,i.bg)(e),a=s.type,A=e.bbox,u=s.coordinates;if(A&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(r,A))return!1;"Polygon"===a&&(u=[u]);for(var l=!1,c=0;c<u.length&&!l;c++)if(o(r,u[c][0],n.ignoreBoundary)){for(var h=!1,f=1;f<u[c].length&&!h;)o(r,u[c][f],!n.ignoreBoundary)&&(h=!0),f++;h||(l=!0)}return l}function o(t,e,n){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,o=e.length-1;r<e.length;o=r++){var s=e[r][0],a=e[r][1],A=e[o][0],u=e[o][1];if(t[1]*(s-A)+a*(A-t[0])+u*(t[0]-s)==0&&(s-t[0])*(A-t[0])<=0&&(a-t[1])*(u-t[1])<=0)return!n;a>t[1]!=u>t[1]&&t[0]<(A-s)*(t[1]-a)/(u-a)+s&&(i=!i)}return i}},6599:(t,e,n)=>{"use strict";n.d(e,{A:()=>jt});var i=n(5903),r=n(39),o=n(9987);function s(){return new a}function a(){this.reset()}a.prototype={constructor:a,reset:function(){this.s=this.t=0},add:function(t){u(A,t,this.t),u(this,A.s,this.s),this.s?this.t+=A.t:this.s=A.t},valueOf:function(){return this.s}};var A=new a;function u(t,e,n){var i=t.s=e+n,r=i-e,o=i-r;t.t=e-o+(n-r)}var l=1e-6,c=Math.PI,h=c/2,f=c/4,p=2*c,d=180/c,g=c/180,_=Math.abs,m=Math.atan,y=Math.atan2,v=Math.cos,E=(Math.ceil,Math.exp),b=(Math.floor,Math.log),w=(Math.pow,Math.sin),x=(Math.sign,Math.sqrt),S=Math.tan;function C(t){return t>1?0:t<-1?c:Math.acos(t)}function T(t){return t>1?h:t<-1?-h:Math.asin(t)}function I(){}function R(t,e){t&&M.hasOwnProperty(t.type)&&M[t.type](t,e)}var P={Feature:function(t,e){R(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)R(n[i].geometry,e)}},M={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){L(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)L(n[i],e,0)},Polygon:function(t,e){N(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)N(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)R(n[i],e)}};function L(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function N(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)L(t[n],e,1);e.polygonEnd()}function O(t,e){t&&P.hasOwnProperty(t.type)?P[t.type](t,e):R(t,e)}s(),s();function D(t){return[y(t[1],t[0]),T(t[2])]}function F(t){var e=t[0],n=t[1],i=v(n);return[i*v(e),i*w(e),w(n)]}function k(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function B(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function U(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function G(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function z(t){var e=x(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}s();function V(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n}function j(t,e){return[t>c?t-p:t<-c?t+p:t,e]}function W(t,e,n){return(t%=p)?e||n?V(X(t),Y(e,n)):X(t):e||n?Y(e,n):j}function H(t){return function(e,n){return[(e+=t)>c?e-p:e<-c?e+p:e,n]}}function X(t){var e=H(t);return e.invert=H(-t),e}function Y(t,e){var n=v(t),i=w(t),r=v(e),o=w(e);function s(t,e){var s=v(e),a=v(t)*s,A=w(t)*s,u=w(e),l=u*n+a*i;return[y(A*r-l*o,a*n-u*i),T(l*r+A*o)]}return s.invert=function(t,e){var s=v(e),a=v(t)*s,A=w(t)*s,u=w(e),l=u*r-A*o;return[y(A*r+u*o,a*n+l*i),T(l*n-a*i)]},s}function q(t,e,n,i,r,o){if(n){var s=v(e),a=w(e),A=i*n;null==r?(r=e+i*p,o=e-A/2):(r=Q(s,r),o=Q(s,o),(i>0?r<o:r>o)&&(r+=i*p));for(var u,l=r;i>0?l>o:l<o;l-=A)u=D([s,-a*v(l),-a*w(l)]),t.point(u[0],u[1])}}function Q(t,e){(e=F(e))[0]-=t,z(e);var n=C(-e[1]);return((-e[2]<0?-n:n)+p-l)%p}function $(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:I,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function K(t,e){return _(t[0]-e[0])<l&&_(t[1]-e[1])<l}function Z(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function J(t,e,n,i,r){var o,s,a=[],A=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],s=t[e];if(K(i,s)){for(r.lineStart(),o=0;o<e;++o)r.point((i=t[o])[0],i[1]);r.lineEnd()}else a.push(n=new Z(i,t,null,!0)),A.push(n.o=new Z(i,null,n,!1)),a.push(n=new Z(s,t,null,!1)),A.push(n.o=new Z(s,null,n,!0))}})),a.length){for(A.sort(e),tt(a),tt(A),o=0,s=A.length;o<s;++o)A[o].e=n=!n;for(var u,l,c=a[0];;){for(var h=c,f=!0;h.v;)if((h=h.n)===c)return;u=h.z,r.lineStart();do{if(h.v=h.o.v=!0,h.e){if(f)for(o=0,s=u.length;o<s;++o)r.point((l=u[o])[0],l[1]);else i(h.x,h.n.x,1,r);h=h.n}else{if(f)for(u=h.p.z,o=u.length-1;o>=0;--o)r.point((l=u[o])[0],l[1]);else i(h.x,h.p.x,-1,r);h=h.p}u=(h=h.o).z,f=!f}while(!h.v);r.lineEnd()}}}function tt(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function et(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}j.invert=j;var nt=1e9,it=-nt;function rt(t,e,n,i){function r(r,o){return t<=r&&r<=n&&e<=o&&o<=i}function o(r,o,a,u){var l=0,c=0;if(null==r||(l=s(r,a))!==(c=s(o,a))||A(r,o)<0^a>0)do{u.point(0===l||3===l?t:n,l>1?i:e)}while((l=(l+a+4)%4)!==c);else u.point(o[0],o[1])}function s(i,r){return _(i[0]-t)<l?r>0?0:3:_(i[0]-n)<l?r>0?2:1:_(i[1]-e)<l?r>0?1:0:r>0?3:2}function a(t,e){return A(t.x,e.x)}function A(t,e){var n=s(t,1),i=s(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){var A,u,l,c,h,f,p,d,g,_,m,y=s,v=$(),E={point:b,lineStart:function(){E.point=w,u&&u.push(l=[]);_=!0,g=!1,p=d=NaN},lineEnd:function(){A&&(w(c,h),f&&g&&v.rejoin(),A.push(v.result()));E.point=b,g&&y.lineEnd()},polygonStart:function(){y=v,A=[],u=[],m=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,r=u.length;n<r;++n)for(var o,s,a=u[n],A=1,l=a.length,c=a[0],h=c[0],f=c[1];A<l;++A)o=h,s=f,h=(c=a[A])[0],f=c[1],s<=i?f>i&&(h-o)*(i-s)>(f-s)*(t-o)&&++e:f<=i&&(h-o)*(i-s)<(f-s)*(t-o)&&--e;return e}(),n=m&&e,r=(A=et(A)).length;(n||r)&&(s.polygonStart(),n&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),r&&J(A,a,e,o,s),s.polygonEnd());y=s,A=u=l=null}};function b(t,e){r(t,e)&&y.point(t,e)}function w(o,s){var a=r(o,s);if(u&&l.push([o,s]),_)c=o,h=s,f=a,_=!1,a&&(y.lineStart(),y.point(o,s));else if(a&&g)y.point(o,s);else{var A=[p=Math.max(it,Math.min(nt,p)),d=Math.max(it,Math.min(nt,d))],v=[o=Math.max(it,Math.min(nt,o)),s=Math.max(it,Math.min(nt,s))];!function(t,e,n,i,r,o){var s,a=t[0],A=t[1],u=0,l=1,c=e[0]-a,h=e[1]-A;if(s=n-a,c||!(s>0)){if(s/=c,c<0){if(s<u)return;s<l&&(l=s)}else if(c>0){if(s>l)return;s>u&&(u=s)}if(s=r-a,c||!(s<0)){if(s/=c,c<0){if(s>l)return;s>u&&(u=s)}else if(c>0){if(s<u)return;s<l&&(l=s)}if(s=i-A,h||!(s>0)){if(s/=h,h<0){if(s<u)return;s<l&&(l=s)}else if(h>0){if(s>l)return;s>u&&(u=s)}if(s=o-A,h||!(s<0)){if(s/=h,h<0){if(s>l)return;s>u&&(u=s)}else if(h>0){if(s<u)return;s<l&&(l=s)}return u>0&&(t[0]=a+u*c,t[1]=A+u*h),l<1&&(e[0]=a+l*c,e[1]=A+l*h),!0}}}}}(A,v,t,e,n,i)?a&&(y.lineStart(),y.point(o,s),m=!1):(g||(y.lineStart(),y.point(A[0],A[1])),y.point(v[0],v[1]),a||y.lineEnd(),m=!1)}p=o,d=s,g=a}return E}}var ot=s();function st(t,e){var n=e[0],i=e[1],r=[w(n),-v(n),0],o=0,s=0;ot.reset();for(var a=0,A=t.length;a<A;++a)if(h=(u=t[a]).length)for(var u,h,d=u[h-1],g=d[0],_=d[1]/2+f,m=w(_),E=v(_),b=0;b<h;++b,g=S,m=I,E=R,d=x){var x=u[b],S=x[0],C=x[1]/2+f,I=w(C),R=v(C),P=S-g,M=P>=0?1:-1,L=M*P,N=L>c,O=m*I;if(ot.add(y(O*M*w(L),E*R+O*v(L))),o+=N?P+M*p:P,N^g>=n^S>=n){var D=B(F(d),F(x));z(D);var k=B(r,D);z(k);var U=(N^P>=0?-1:1)*T(k[2]);(i>U||i===U&&(D[0]||D[1]))&&(s+=N^P>=0?1:-1)}}return(o<-l||o<l&&ot<-l)^1&s}s();s(),s();var at=1/0,At=at,ut=-at,lt=ut,ct={point:function(t,e){t<at&&(at=t);t>ut&&(ut=t);e<At&&(At=e);e>lt&&(lt=e)},lineStart:I,lineEnd:I,polygonStart:I,polygonEnd:I,result:function(){var t=[[at,At],[ut,lt]];return ut=lt=-(At=at=1/0),t}};const ht=ct;s();function ft(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function pt(t,e,n,i){return function(r,o){var s,a,A,u=e(o),l=r.invert(i[0],i[1]),c=$(),h=e(c),f=!1,p={point:d,lineStart:_,lineEnd:m,polygonStart:function(){p.point=y,p.lineStart=v,p.lineEnd=E,a=[],s=[]},polygonEnd:function(){p.point=d,p.lineStart=_,p.lineEnd=m,a=et(a);var t=st(s,l);a.length?(f||(o.polygonStart(),f=!0),J(a,gt,t,n,o)):t&&(f||(o.polygonStart(),f=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),f&&(o.polygonEnd(),f=!1),a=s=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function d(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&o.point(e,n)}function g(t,e){var n=r(t,e);u.point(n[0],n[1])}function _(){p.point=g,u.lineStart()}function m(){p.point=d,u.lineEnd()}function y(t,e){A.push([t,e]);var n=r(t,e);h.point(n[0],n[1])}function v(){h.lineStart(),A=[]}function E(){y(A[0][0],A[0][1]),h.lineEnd();var t,e,n,i,r=h.clean(),u=c.result(),l=u.length;if(A.pop(),s.push(A),A=null,l)if(1&r){if((e=(n=u[0]).length-1)>0){for(f||(o.polygonStart(),f=!0),o.lineStart(),t=0;t<e;++t)o.point((i=n[t])[0],i[1]);o.lineEnd()}}else l>1&&2&r&&u.push(u.pop().concat(u.shift())),a.push(u.filter(dt))}return p}}function dt(t){return t.length>1}function gt(t,e){return((t=t.x)[0]<0?t[1]-h-l:h-t[1])-((e=e.x)[0]<0?e[1]-h-l:h-e[1])}ft(4.5);const _t=pt((function(){return!0}),(function(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?c:-c,A=_(o-n);_(A-c)<l?(t.point(n,i=(i+s)/2>0?h:-h),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),t.point(o,i),e=0):r!==a&&A>=c&&(_(n-r)<l&&(n-=r*l),_(o-a)<l&&(o-=a*l),i=function(t,e,n,i){var r,o,s=w(t-n);return _(s)>l?m((w(e)*(o=v(i))*w(n)-w(i)*(r=v(e))*w(t))/(r*o*s)):(e+i)/2}(n,i,o,s),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),e=0),t.point(n=o,i=s),r=a},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}),(function(t,e,n,i){var r;if(null==t)r=n*h,i.point(-c,r),i.point(0,r),i.point(c,r),i.point(c,0),i.point(c,-r),i.point(0,-r),i.point(-c,-r),i.point(-c,0),i.point(-c,r);else if(_(t[0]-e[0])>l){var o=t[0]<e[0]?c:-c;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])}),[-c,-h]);function mt(t){return t}function yt(t){return function(e){var n=new vt;for(var i in t)n[i]=t[i];return n.stream=e,n}}function vt(){}function Et(t,e,n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),O(n,t.stream(ht));var s=ht.result(),a=Math.min(i/(s[1][0]-s[0][0]),r/(s[1][1]-s[0][1])),A=+e[0][0]+(i-a*(s[1][0]+s[0][0]))/2,u=+e[0][1]+(r-a*(s[1][1]+s[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*a).translate([A,u])}vt.prototype={constructor:vt,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var bt=16,wt=v(30*g);function xt(t,e){return+e?function(t,e){function n(i,r,o,s,a,A,u,c,h,f,p,d,g,m){var v=u-i,E=c-r,b=v*v+E*E;if(b>4*e&&g--){var w=s+f,S=a+p,C=A+d,I=x(w*w+S*S+C*C),R=T(C/=I),P=_(_(C)-1)<l||_(o-h)<l?(o+h)/2:y(S,w),M=t(P,R),L=M[0],N=M[1],O=L-i,D=N-r,F=E*O-v*D;(F*F/b>e||_((v*O+E*D)/b-.5)>.3||s*f+a*p+A*d<wt)&&(n(i,r,o,s,a,A,L,N,P,w/=I,S/=I,C,g,m),m.point(L,N),n(L,N,P,w,S,C,u,c,h,f,p,d,g,m))}}return function(e){var i,r,o,s,a,A,u,l,c,h,f,p,d={point:g,lineStart:_,lineEnd:y,polygonStart:function(){e.polygonStart(),d.lineStart=v},polygonEnd:function(){e.polygonEnd(),d.lineStart=_}};function g(n,i){n=t(n,i),e.point(n[0],n[1])}function _(){l=NaN,d.point=m,e.lineStart()}function m(i,r){var o=F([i,r]),s=t(i,r);n(l,c,u,h,f,p,l=s[0],c=s[1],u=i,h=o[0],f=o[1],p=o[2],bt,e),e.point(l,c)}function y(){d.point=g,e.lineEnd()}function v(){_(),d.point=E,d.lineEnd=b}function E(t,e){m(i=t,e),r=l,o=c,s=h,a=f,A=p,d.point=m}function b(){n(l,c,u,h,f,p,r,o,i,s,a,A,bt,e),d.lineEnd=y,y()}return d}}(t,e):function(t){return yt({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var St=yt({point:function(t,e){this.stream.point(t*g,e*g)}});function Ct(t){return function(t){var e,n,i,r,o,s,a,A,u,h,f=150,p=480,m=250,y=0,E=0,b=0,w=0,S=0,C=null,T=_t,I=null,R=mt,P=.5,M=xt(O,P);function L(t){return[(t=o(t[0]*g,t[1]*g))[0]*f+n,i-t[1]*f]}function N(t){return(t=o.invert((t[0]-n)/f,(i-t[1])/f))&&[t[0]*d,t[1]*d]}function O(t,r){return[(t=e(t,r))[0]*f+n,i-t[1]*f]}function z(){o=V(r=W(b,w,S),e);var t=e(y,E);return n=p-t[0]*f,i=m+t[1]*f,j()}function j(){return u=h=null,L}return L.stream=function(t){return u&&h===t?u:u=St(T(r,M(R(h=t))))},L.clipAngle=function(t){return arguments.length?(T=+t?function(t,e){var n=v(t),i=n>0,r=_(n)>l;function o(t,e){return v(t)*v(e)>n}function s(t,e,i){var r=[1,0,0],o=B(F(t),F(e)),s=k(o,o),a=o[0],A=s-a*a;if(!A)return!i&&t;var u=n*s/A,h=-n*a/A,f=B(r,o),p=G(r,u);U(p,G(o,h));var d=f,g=k(p,d),m=k(d,d),y=g*g-m*(k(p,p)-1);if(!(y<0)){var v=x(y),E=G(d,(-g-v)/m);if(U(E,p),E=D(E),!i)return E;var b,w=t[0],S=e[0],C=t[1],T=e[1];S<w&&(b=w,w=S,S=b);var I=S-w,R=_(I-c)<l;if(!R&&T<C&&(b=C,C=T,T=b),R||I<l?R?C+T>0^E[1]<(_(E[0]-w)<l?C:T):C<=E[1]&&E[1]<=T:I>c^(w<=E[0]&&E[0]<=S)){var P=G(d,(-g+v)/m);return U(P,p),[E,D(P)]}}}function a(e,n){var r=i?t:c-t,o=0;return e<-r?o|=1:e>r&&(o|=2),n<-r?o|=4:n>r&&(o|=8),o}return pt(o,(function(t){var e,n,A,u,h;return{lineStart:function(){u=A=!1,h=1},point:function(f,p){var d,g=[f,p],_=o(f,p),m=i?_?0:a(f,p):_?a(f+(f<0?c:-c),p):0;if(!e&&(u=A=_)&&t.lineStart(),_!==A&&(!(d=s(e,g))||K(e,d)||K(g,d))&&(g[0]+=l,g[1]+=l,_=o(g[0],g[1])),_!==A)h=0,_?(t.lineStart(),d=s(g,e),t.point(d[0],d[1])):(d=s(e,g),t.point(d[0],d[1]),t.lineEnd()),e=d;else if(r&&e&&i^_){var y;m&n||!(y=s(g,e,!0))||(h=0,i?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1])))}!_||e&&K(e,g)||t.point(g[0],g[1]),e=g,A=_,n=m},lineEnd:function(){A&&t.lineEnd(),e=null},clean:function(){return h|(u&&A)<<1}}}),(function(n,i,r,o){q(o,t,e,r,n,i)}),i?[0,-t]:[-c,t-c])}(C=t*g,6*g):(C=null,_t),j()):C*d},L.clipExtent=function(t){return arguments.length?(R=null==t?(I=s=a=A=null,mt):rt(I=+t[0][0],s=+t[0][1],a=+t[1][0],A=+t[1][1]),j()):null==I?null:[[I,s],[a,A]]},L.scale=function(t){return arguments.length?(f=+t,z()):f},L.translate=function(t){return arguments.length?(p=+t[0],m=+t[1],z()):[p,m]},L.center=function(t){return arguments.length?(y=t[0]%360*g,E=t[1]%360*g,z()):[y*d,E*d]},L.rotate=function(t){return arguments.length?(b=t[0]%360*g,w=t[1]%360*g,S=t.length>2?t[2]%360*g:0,z()):[b*d,w*d,S*d]},L.precision=function(t){return arguments.length?(M=xt(O,P=t*t),j()):x(P)},L.fitExtent=function(t,e){return Et(L,t,e)},L.fitSize=function(t,e){return function(t,e,n){return Et(t,[[0,0],e],n)}(L,t,e)},function(){return e=t.apply(this,arguments),L.invert=e.invert&&N,z()}}((function(){return t}))()}function Tt(t){return function(e,n){var i=v(e),r=v(n),o=t(i*r);return[o*r*w(e),o*w(n)]}}function It(t){return function(e,n){var i=x(e*e+n*n),r=t(i),o=w(r),s=v(r);return[y(e*o,i*s),T(i&&n*o/i)]}}var Rt=Tt((function(t){return x(2/(1+t))}));Rt.invert=It((function(t){return 2*T(t/2)}));var Pt=Tt((function(t){return(t=C(t))&&t/w(t)}));function Mt(t,e){return[t,b(S((h+e)/2))]}function Lt(t,e){return[t,e]}function Nt(t,e){var n=v(e),i=v(t)*n;return[n*w(t)/i,w(e)/i]}function Ot(t,e){var n=e*e,i=n*n;return[t*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),e*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}function Dt(t,e){return[v(e)*w(t),w(e)]}function Ft(t,e){var n=v(e),i=1+v(t)*n;return[n*w(t)/i,w(e)/i]}function kt(t,e){return[b(S((h+e)/2)),-t]}Pt.invert=It((function(t){return t})),Mt.invert=function(t,e){return[t,2*m(E(e))-h]},Lt.invert=Lt,Nt.invert=It(m),Ot.invert=function(t,e){var n,i=e,r=25;do{var o=i*i,s=o*o;i-=n=(i*(1.007226+o*(.015085+s*(.028874*o-.044475-.005916*s)))-e)/(1.007226+o*(.045255+s*(.259866*o-.311325-.005916*11*s)))}while(_(n)>l&&--r>0);return[t/(.8707+(o=i*i)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),i]},Dt.invert=It(T),Ft.invert=It((function(t){return 2*m(t)})),kt.invert=function(t,e){return[-e,2*m(E(t))-h]};var Bt=n(3279);function Ut(t,e,n,s){var a=t.properties||{},A="Feature"===t.type?t.geometry:t;if("GeometryCollection"===A.type){var u=[];return(0,o.kX)(t,(function(t){var i=Ut(t,e,n,s);i&&u.push(i)})),(0,Bt.Lr)(u)}var l=function(t){var e=(0,i.A)(t).geometry.coordinates,n=[-e[0],-e[1]];return Ct(Pt).scale(79.4188).clipAngle(179.999).rotate(n).scale(Bt.zX)}(A),c={type:A.type,coordinates:zt(A.coordinates,l)},h=(new r.GeoJSONReader).read(c),f=(0,Bt.cJ)((0,Bt.Gf)(e,n),"meters"),p=r.BufferOp.bufferOp(h,f,s);if(!Gt((p=(new r.GeoJSONWriter).write(p)).coordinates)){var d={type:p.type,coordinates:Vt(p.coordinates,l)};return(0,Bt.N4)(d,a)}}function Gt(t){return Array.isArray(t[0])?Gt(t[0]):isNaN(t[0])}function zt(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return zt(t,e)}))}function Vt(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return Vt(t,e)}))}const jt=function(t,e,n){var i=(n=n||{}).units||"kilometers",r=n.steps||8;if(!t)throw new Error("geojson is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof r)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(r<=0)throw new Error("steps must be greater than 0");var s=[];switch(t.type){case"GeometryCollection":return(0,o.kX)(t,(function(t){var n=Ut(t,e,i,r);n&&s.push(n)})),(0,Bt.Lr)(s);case"FeatureCollection":return(0,o.us)(t,(function(t){var n=Ut(t,e,i,r);n&&(0,o.us)(n,(function(t){t&&s.push(t)}))})),(0,Bt.Lr)(s)}return Ut(t,e,i,r)}},5903:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(5917),r=n(3279);const o=function(t,e){void 0===e&&(e={});var n=(0,i.A)(t),o=(n[0]+n[2])/2,s=(n[1]+n[3])/2;return(0,r.zx)([o,s],e.properties,e)}},7450:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(9987),r=n(3279);const o=function(t,e){void 0===e&&(e={});var n=0,o=0,s=0;return(0,i.Fh)(t,(function(t){n+=t[0],o+=t[1],s++}),!0),(0,r.zx)([n/s,o/s],e.properties)}},6338:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(6558),r=n(3279);const o=function(t,e,n){void 0===n&&(n={});for(var o=n.steps||64,s=n.properties?n.properties:!Array.isArray(t)&&"Feature"===t.type&&t.properties?t.properties:{},a=[],A=0;A<o;A++)a.push((0,i.A)(t,e,-360*A/o,n).geometry.coordinates);return a.push(a[0]),(0,r.n1)([a],s)}},7083:(t,e,n)=>{"use strict";function i(t){var e={type:"Feature"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}})),e.properties=r(t.properties),e.geometry=o(t.geometry),e}function r(t){var e={};return t?(Object.keys(t).forEach((function(n){var i=t[n];"object"==typeof i?null===i?e[n]=null:Array.isArray(i)?e[n]=i.map((function(t){return t})):e[n]=r(i):e[n]=i})),e):e}function o(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return o(t)})),e):(e.coordinates=s(t.coordinates),e)}function s(t){var e=t;return"object"!=typeof e[0]?e.slice():e.map((function(t){return s(t)}))}n.d(e,{A:()=>a});const a=function(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return i(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"features":return;default:e[n]=t[n]}})),e.features=t.features.map((function(t){return i(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return o(t);default:throw new Error("unknown GeoJSON type")}}},6558:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(3279),r=n(5046);function o(t,e,n,o){void 0===o&&(o={});var s=(0,r.uG)(t),a=(0,i.tR)(s[0]),A=(0,i.tR)(s[1]),u=(0,i.tR)(n),l=(0,i.Gf)(e,o.units),c=Math.asin(Math.sin(A)*Math.cos(l)+Math.cos(A)*Math.sin(l)*Math.cos(u)),h=a+Math.atan2(Math.sin(u)*Math.sin(l)*Math.cos(A),Math.cos(l)-Math.sin(A)*Math.sin(c)),f=(0,i.nv)(h),p=(0,i.nv)(c);return(0,i.zx)([f,p],o.properties)}},365:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(9004),r=n(3279),o=n(5046);const s=function(t,e){var n=(0,o.bg)(t),s=(0,o.bg)(e),a=t.properties||{},A=i.difference(n.coordinates,s.coordinates);return 0===A.length?null:1===A.length?(0,r.n1)(A[0],a):(0,r.g5)(A,a)}},669:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(5046),r=n(3279);const o=function(t,e,n){void 0===n&&(n={});var o=(0,i.uG)(t),s=(0,i.uG)(e),a=(0,r.tR)(s[1]-o[1]),A=(0,r.tR)(s[0]-o[0]),u=(0,r.tR)(o[1]),l=(0,r.tR)(s[1]),c=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(A/2),2)*Math.cos(u)*Math.cos(l);return(0,r.cJ)(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),n.units)}},3416:(t,e,n)=>{"use strict";n.d(e,{A:()=>A});var i=n(3279),r=n(7861),o=n(5486),s=n(5046);function a(t){var e=t*Math.PI/180;return Math.tan(e)}const A=function(t,e,n,A){var u=(A=A||{}).steps||64,l=A.units||"kilometers",c=A.angle||0,h=A.pivot||t,f=A.properties||t.properties||{};if(!t)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!(0,i.Gv)(A))throw new Error("options must be an object");if(!(0,i.Et)(u))throw new Error("steps must be a number");if(!(0,i.Et)(c))throw new Error("angle must be a number");var p=(0,s.uG)(t);if("degrees"===l)var d=(0,i.tR)(c);else e=(0,r.A)(t,e,90,{units:l}),n=(0,r.A)(t,n,0,{units:l}),e=(0,s.uG)(e)[0]-p[0],n=(0,s.uG)(n)[1]-p[1];for(var g=[],_=0;_<u;_+=1){var m=-360*_/u,y=e*n/Math.sqrt(Math.pow(n,2)+Math.pow(e,2)*Math.pow(a(m),2)),v=e*n/Math.sqrt(Math.pow(e,2)+Math.pow(n,2)/Math.pow(a(m),2));if(m<-90&&m>=-270&&(y=-y),m<-180&&m>=-360&&(v=-v),"degrees"===l){var E=y*Math.cos(d)+v*Math.sin(d),b=v*Math.cos(d)-y*Math.sin(d);y=E,v=b}g.push([y+p[0],v+p[1]])}return g.push(g[0]),"degrees"===l?(0,i.n1)([g],f):(0,o.A)((0,i.n1)([g],f),c,{pivot:h})}},3279:(t,e,n)=>{"use strict";n.d(e,{Et:()=>_,Gf:()=>f,Gv:()=>m,I3:()=>g,Lr:()=>u,N4:()=>o,NU:()=>l,cJ:()=>h,g5:()=>c,n1:()=>a,nv:()=>p,tR:()=>d,wi:()=>A,zX:()=>i,zx:()=>s});var i=6371008.8,r={centimeters:100*i,centimetres:100*i,degrees:i/111325,feet:3.28084*i,inches:39.37*i,kilometers:i/1e3,kilometres:i/1e3,meters:i,metres:i,miles:i/1609.344,millimeters:1e3*i,millimetres:1e3*i,nauticalmiles:i/1852,radians:1,yards:1.0936*i};function o(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function s(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!_(t[0])||!_(t[1]))throw new Error("coordinates must contain numbers");return o({type:"Point",coordinates:t},e,n)}function a(t,e,n){void 0===n&&(n={});for(var i=0,r=t;i<r.length;i++){var s=r[i];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return o({type:"Polygon",coordinates:t},e,n)}function A(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return o({type:"LineString",coordinates:t},e,n)}function u(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function l(t,e,n){return void 0===n&&(n={}),o({type:"MultiLineString",coordinates:t},e,n)}function c(t,e,n){return void 0===n&&(n={}),o({type:"MultiPolygon",coordinates:t},e,n)}function h(t,e){void 0===e&&(e="kilometers");var n=r[e];if(!n)throw new Error(e+" units is invalid");return t*n}function f(t,e){void 0===e&&(e="kilometers");var n=r[e];if(!n)throw new Error(e+" units is invalid");return t/n}function p(t){return 180*(t%(2*Math.PI))/Math.PI}function d(t){return t%360*Math.PI/180}function g(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return h(f(t,e),n)}function _(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function m(t){return!!t&&t.constructor===Object}},5475:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(3279),r=n(5046),o=n(9004);function s(t,e,n){void 0===n&&(n={});var s=(0,r.bg)(t),a=(0,r.bg)(e),A=o.intersection(s.coordinates,a.coordinates);return 0===A.length?null:1===A.length?(0,i.n1)(A[0],n.properties):(0,i.g5)(A,n.properties)}},5046:(t,e,n)=>{"use strict";n.d(e,{$R:()=>r,Pw:()=>a,bg:()=>s,mo:()=>o,uG:()=>i});n(3279);function i(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function r(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function o(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}function s(t){return"Feature"===t.type?t.geometry:t}function a(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}},5085:(t,e,n)=>{"use strict";n.d(e,{A:()=>u});var i=n(3279),r=n(5046),o=n(9987);const s=function(t){if(!t)throw new Error("geojson is required");var e=[];return(0,o.iw)(t,(function(t){!function(t,e){var n=[],o=t.geometry;if(null!==o){switch(o.type){case"Polygon":n=(0,r.$R)(o);break;case"LineString":n=[(0,r.$R)(o)]}n.forEach((function(n){var r=function(t,e){var n=[];return t.reduce((function(t,r){var o,s,a,A,u,l,c=(0,i.wi)([t,r],e);return c.bbox=(s=r,a=(o=t)[0],A=o[1],u=s[0],l=s[1],[a<u?a:u,A<l?A:l,a>u?a:u,A>l?A:l]),n.push(c),r})),n}(n,t.properties);r.forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),(0,i.Lr)(e)};var a=n(4945);function A(t,e){var n=(0,r.$R)(t),o=(0,r.$R)(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==o.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var s=n[0][0],a=n[0][1],A=n[1][0],u=n[1][1],l=o[0][0],c=o[0][1],h=o[1][0],f=o[1][1],p=(f-c)*(A-s)-(h-l)*(u-a),d=(h-l)*(a-c)-(f-c)*(s-l),g=(A-s)*(a-c)-(u-a)*(s-l);if(0===p)return null;var _=d/p,m=g/p;if(_>=0&&_<=1&&m>=0&&m<=1){var y=s+_*(A-s),v=a+_*(u-a);return(0,i.zx)([y,v])}return null}const u=function(t,e){var n={},u=[];if("LineString"===t.type&&(t=(0,i.N4)(t)),"LineString"===e.type&&(e=(0,i.N4)(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var l=A(t,e);return l&&u.push(l),(0,i.Lr)(u)}var c=a();return c.load(s(e)),(0,o.us)(s(t),(function(t){(0,o.us)(c.search(t),(function(e){var i=A(t,e);if(i){var o=(0,r.$R)(i).join(",");n[o]||(n[o]=!0,u.push(i))}}))})),(0,i.Lr)(u)}},9987:(t,e,n)=>{"use strict";n.d(e,{Fh:()=>r,RP:()=>u,iw:()=>A,jE:()=>a,kX:()=>s,us:()=>o});var i=n(3279);function r(t,e,n){if(null!==t)for(var i,o,s,a,A,u,l,c,h=0,f=0,p=t.type,d="FeatureCollection"===p,g="Feature"===p,_=d?t.features.length:1,m=0;m<_;m++){A=(c=!!(l=d?t.features[m].geometry:g?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var y=0;y<A;y++){var v=0,E=0;if(null!==(a=c?l.geometries[y]:l)){u=a.coordinates;var b=a.type;switch(h=!n||"Polygon"!==b&&"MultiPolygon"!==b?0:1,b){case null:break;case"Point":if(!1===e(u,f,m,v,E))return!1;f++,v++;break;case"LineString":case"MultiPoint":for(i=0;i<u.length;i++){if(!1===e(u[i],f,m,v,E))return!1;f++,"MultiPoint"===b&&v++}"LineString"===b&&v++;break;case"Polygon":case"MultiLineString":for(i=0;i<u.length;i++){for(o=0;o<u[i].length-h;o++){if(!1===e(u[i][o],f,m,v,E))return!1;f++}"MultiLineString"===b&&v++,"Polygon"===b&&E++}"Polygon"===b&&v++;break;case"MultiPolygon":for(i=0;i<u.length;i++){for(E=0,o=0;o<u[i].length;o++){for(s=0;s<u[i][o].length-h;s++){if(!1===e(u[i][o][s],f,m,v,E))return!1;f++}E++}v++}break;case"GeometryCollection":for(i=0;i<a.geometries.length;i++)if(!1===r(a.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function s(t,e){var n,i,r,o,s,a,A,u,l,c,h=0,f="FeatureCollection"===t.type,p="Feature"===t.type,d=f?t.features.length:1;for(n=0;n<d;n++){for(a=f?t.features[n].geometry:p?t.geometry:t,u=f?t.features[n].properties:p?t.properties:{},l=f?t.features[n].bbox:p?t.bbox:void 0,c=f?t.features[n].id:p?t.id:void 0,s=(A=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=A?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,h,u,l,c))return!1;break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===e(o.geometries[i],h,u,l,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,h,u,l,c))return!1;h++}}function a(t,e,n){var i=n;return s(t,(function(t,r,o,s,a){i=0===r&&void 0===n?t:e(i,t,r,o,s,a)})),i}function A(t,e){s(t,(function(t,n,r,o,s){var a,A=null===t?null:t.type;switch(A){case null:case"Point":case"LineString":case"Polygon":return!1!==e((0,i.N4)(t,r,{bbox:o,id:s}),n,0)&&void 0}switch(A){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var l={type:a,coordinates:t.coordinates[u]};if(!1===e((0,i.N4)(l,r),n,u))return!1}}))}function u(t,e){A(t,(function(t,n,o){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var A,u=0,l=0,c=0;return!1!==r(t,(function(r,a,h,f,p){if(void 0===A||n>u||f>l||p>c)return A=r,u=n,l=f,c=p,void(s=0);var d=(0,i.wi)([A,r],t.properties);if(!1===e(d,n,o,p,s))return!1;s++,A=r}))&&void 0}}}))}},3922:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(7604),r=n(6558),o=n(669);const s=function(t,e){var n=(0,o.A)(t,e),s=(0,i.A)(t,e);return(0,r.A)(t,n/2,s)}},7028:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});var i=n(7604),r=n(669),o=n(6558),s=n(5085),a=n(9987),A=n(3279),u=n(5046);const l=function(t,e,n){void 0===n&&(n={});var l=(0,A.zx)([1/0,1/0],{dist:1/0}),c=0;return(0,a.iw)(t,(function(t){for(var a=(0,u.$R)(t),h=0;h<a.length-1;h++){var f=(0,A.zx)(a[h]);f.properties.dist=(0,r.A)(e,f,n);var p=(0,A.zx)(a[h+1]);p.properties.dist=(0,r.A)(e,p,n);var d=(0,r.A)(f,p,n),g=Math.max(f.properties.dist,p.properties.dist),_=(0,i.A)(f,p),m=(0,o.A)(e,g,_+90,n),y=(0,o.A)(e,g,_-90,n),v=(0,s.A)((0,A.wi)([m.geometry.coordinates,y.geometry.coordinates]),(0,A.wi)([f.geometry.coordinates,p.geometry.coordinates])),E=null;v.features.length>0&&((E=v.features[0]).properties.dist=(0,r.A)(e,E,n),E.properties.location=c+(0,r.A)(f,E,n)),f.properties.dist<l.properties.dist&&((l=f).properties.index=h,l.properties.location=c),p.properties.dist<l.properties.dist&&((l=p).properties.index=h+1,l.properties.location=c+d),E&&E.properties.dist<l.properties.dist&&((l=E).properties.index=h),c+=d}})),l}},7885:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});var i=n(669),r=n(3279),o=n(5046),s=n(9987),a=n(8664);function A(t,e){return t[0]*e[0]+t[1]*e[1]}function u(t,e,n){return"planar"===n.method?(0,a.A)(t,e,n):(0,i.A)(t,e,n)}const l=function(t,e,n){if(void 0===n&&(n={}),n.method||(n.method="geodesic"),n.units||(n.units="kilometers"),!t)throw new Error("pt is required");if(Array.isArray(t)?t=(0,r.zx)(t):"Point"===t.type?t=(0,r.N4)(t):(0,o.mo)(t,"Point","point"),!e)throw new Error("line is required");Array.isArray(e)?e=(0,r.wi)(e):"LineString"===e.type?e=(0,r.N4)(e):(0,o.mo)(e,"LineString","line");var i=1/0,a=t.geometry.coordinates;return(0,s.RP)(e,(function(t){var e=t.geometry.coordinates[0],r=t.geometry.coordinates[1],o=function(t,e,n,i){var r=[n[0]-e[0],n[1]-e[1]],o=[t[0]-e[0],t[1]-e[1]],s=A(o,r);if(s<=0)return u(t,e,{method:i.method,units:"degrees"});var a=A(r,r);if(a<=s)return u(t,n,{method:i.method,units:"degrees"});var l=s/a,c=[e[0]+l*r[0],e[1]+l*r[1]];return u(t,c,{method:i.method,units:"degrees"})}(a,e,r,n);o<i&&(i=o)})),(0,r.I3)(i,"degrees",n.units)}},5875:(t,e,n)=>{"use strict";n.d(e,{Ay:()=>o});var i=n(3279),r=n(5046);function o(t,e){void 0===e&&(e={});var n=(0,r.bg)(t);switch(e.properties||"Feature"!==t.type||(e.properties=t.properties),n.type){case"Polygon":return function(t,e){void 0===e&&(e={});var n=(0,r.bg)(t),i=n.coordinates,o=e.properties?e.properties:"Feature"===t.type?t.properties:{};return s(i,o)}(n,e);case"MultiPolygon":return function(t,e){void 0===e&&(e={});var n=(0,r.bg)(t),o=n.coordinates,a=e.properties?e.properties:"Feature"===t.type?t.properties:{},A=[];return o.forEach((function(t){A.push(s(t,a))})),(0,i.Lr)(A)}(n,e);default:throw new Error("invalid poly")}}function s(t,e){return t.length>1?(0,i.NU)(t,e):(0,i.wi)(t[0],e)}},8364:(t,e,n)=>{"use strict";n.d(e,{A:()=>c});var i=n(7083),r=n(5046);function o(t){for(var e,n,i=(0,r.$R)(t),o=0,s=1;s<i.length;)e=n||i[0],o+=((n=i[s])[0]-e[0])*(n[1]+e[1]),s++;return o>0}var s=n(9987),a=n(3279);function A(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return(0,s.kX)(t,(function(t){A(t,e)})),t;case"LineString":return u((0,r.$R)(t),e),t;case"Polygon":return l((0,r.$R)(t),e),t;case"MultiLineString":return(0,r.$R)(t).forEach((function(t){u(t,e)})),t;case"MultiPolygon":return(0,r.$R)(t).forEach((function(t){l(t,e)})),t;case"Point":case"MultiPoint":return t}}function u(t,e){o(t)===e&&t.reverse()}function l(t,e){o(t[0])!==e&&t[0].reverse();for(var n=1;n<t.length;n++)o(t[n])===e&&t[n].reverse()}const c=function(t,e){if(e=e||{},!(0,a.Gv)(e))throw new Error("options is invalid");var n=e.reverse||!1,r=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof n)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof r)throw new Error("<mutate> must be a boolean");!1===r&&(t=(0,i.A)(t));var o=[];switch(t.type){case"GeometryCollection":return(0,s.kX)(t,(function(t){A(t,n)})),t;case"FeatureCollection":return(0,s.us)(t,(function(t){(0,s.us)(A(t,n),(function(t){o.push(t)}))})),(0,a.Lr)(o)}return A(t,n)}},7743:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(3279),r=n(5046);function o(t,e){var n=(0,i.tR)(t[1]),r=(0,i.tR)(e[1]),o=(0,i.tR)(e[0]-t[0]);o>Math.PI&&(o-=2*Math.PI),o<-Math.PI&&(o+=2*Math.PI);var s=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),a=Math.atan2(o,s);return((0,i.nv)(a)+360)%360}const s=function(t,e,n){var i;return void 0===n&&(n={}),(i=n.final?o((0,r.uG)(e),(0,r.uG)(t)):o((0,r.uG)(t),(0,r.uG)(e)))>180?-(360-i):i}},7861:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(3279),r=n(5046);const o=function(t,e,n,o){void 0===o&&(o={});var s=e<0,a=(0,i.I3)(Math.abs(e),o.units,"meters");s&&(a=-Math.abs(a));var A=(0,r.uG)(t),u=function(t,e,n,r){r=void 0===r?i.zX:Number(r);var o=e/r,s=t[0]*Math.PI/180,a=(0,i.tR)(t[1]),A=(0,i.tR)(n),u=o*Math.cos(A),l=a+u;Math.abs(l)>Math.PI/2&&(l=l>0?Math.PI-l:-Math.PI-l);var c=Math.log(Math.tan(l/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),h=Math.abs(c)>1e-11?u/c:Math.cos(a),f=o*Math.sin(A)/h;return[(180*(s+f)/Math.PI+540)%360-180,180*l/Math.PI]}(A,a,n);return u[0]+=u[0]-A[0]>180?-360:A[0]-u[0]>180?360:0,(0,i.zx)(u,o.properties)}},8664:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(3279),r=n(5046);const o=function(t,e,n){void 0===n&&(n={});var o=(0,r.uG)(t),s=(0,r.uG)(e);s[0]+=s[0]-o[0]>180?-360:o[0]-s[0]>180?360:0;var a=function(t,e,n){var r=n=void 0===n?i.zX:Number(n),o=t[1]*Math.PI/180,s=e[1]*Math.PI/180,a=s-o,A=Math.abs(e[0]-t[0])*Math.PI/180;A>Math.PI&&(A-=2*Math.PI);var u=Math.log(Math.tan(s/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),l=Math.abs(u)>1e-11?a/u:Math.cos(o);return Math.sqrt(a*a+l*l*A*A)*r}(o,s);return(0,i.I3)(a,"meters",n.units)}},5486:(t,e,n)=>{"use strict";n.d(e,{A:()=>c});var i=n(7450),r=n(7743),o=n(8664),s=n(7861),a=n(7083),A=n(9987),u=n(5046),l=n(3279);const c=function(t,e,n){if(n=n||{},!(0,l.Gv)(n))throw new Error("options is invalid");var c=n.pivot,h=n.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("angle is required");return 0===e||(c||(c=(0,i.A)(t)),!1!==h&&void 0!==h||(t=(0,a.A)(t)),(0,A.Fh)(t,(function(t){var n=(0,r.A)(c,t)+e,i=(0,o.A)(c,t),a=(0,u.$R)((0,s.A)(c,i,n));t[0]=a[0],t[1]=a[1]}))),t}},1349:(t,e,n)=>{"use strict";n.d(e,{A:()=>p});var i=n(7083),r=n(5903),o=n(7450),s=n(5917),a=n(7743),A=n(8664),u=n(7861),l=n(9987),c=n(3279),h=n(5046);function f(t,e,n){var i="Point"===(0,h.Pw)(t);return n=function(t,e){null==e&&(e="centroid");if(Array.isArray(e)||"object"==typeof e)return(0,h.uG)(e);var n=t.bbox?t.bbox:(0,s.A)(t),i=n[0],a=n[1],A=n[2],u=n[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return(0,c.zx)([i,a]);case"se":case"southeast":case"eastsouth":case"bottomright":return(0,c.zx)([A,a]);case"nw":case"northwest":case"westnorth":case"topleft":return(0,c.zx)([i,u]);case"ne":case"northeast":case"eastnorth":case"topright":return(0,c.zx)([A,u]);case"center":return(0,r.A)(t);case void 0:case null:case"centroid":return(0,o.A)(t);default:throw new Error("invalid origin")}}(t,n),1===e||i||(0,l.Fh)(t,(function(t){var i=(0,A.A)(n,t),r=(0,a.A)(n,t),o=i*e,s=(0,h.$R)((0,u.A)(n,o,r));t[0]=s[0],t[1]=s[1],3===t.length&&(t[2]*=e)})),t}const p=function(t,e,n){if(n=n||{},!(0,c.Gv)(n))throw new Error("options is invalid");var r=n.origin,o=n.mutate;if(!t)throw new Error("geojson required");if("number"!=typeof e||0===e)throw new Error("invalid factor");var s=Array.isArray(r)||"object"==typeof r;return!0!==o&&(t=(0,i.A)(t)),"FeatureCollection"!==t.type||s?f(t,e,r):((0,l.us)(t,(function(n,i){t.features[i]=f(n,e,r)})),t)}},4657:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(9004),r=n(5046),o=n(3279);const s=function(t,e,n){void 0===n&&(n={});var s=(0,r.bg)(t),a=(0,r.bg)(e),A=i.union(s.coordinates,a.coordinates);return 0===A.length?null:1===A.length?(0,o.n1)(A[0],n.properties):(0,o.g5)(A,n.properties)}}}]);